This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.claude/
  settings.local.json
app/
  (app)/
    calendar/
      new/
        NewAppointmentForm.tsx
        page.tsx
      CalendarGrid.tsx
      page.tsx
    checkout/
      [appointmentId]/
        page.tsx
    clients/
      new/
        page.tsx
      ClientsTable.tsx
      page.tsx
    customers/
      new/
        page.tsx
      page.tsx
    dashboard/
      page.tsx
    dogs/
      [id]/
        DogDetailClient.tsx
        page.tsx
      new/
        page.tsx
      DogsPageClient.tsx
      page.tsx
    groomers/
      new/
        page.tsx
      GroomersPageClient.tsx
      page.tsx
    history/
      HistoryPageClient.tsx
      page.tsx
    messages/
      page.tsx
    notifications/
      NotificationsPageClient.tsx
      page.tsx
    onboarding/
      page.tsx
    photos/
      page.tsx
    pricing/
      page.tsx
    reports/
      page.tsx
    settings/
      page.tsx
    DashboardClient.tsx
    layout.tsx
  (auth)/
    login/
      page.tsx
    signup/
      page.tsx
    layout.tsx
  api/
    cron/
      reminders/
        route.ts
    sms/
      webhook/
        route.ts
    stripe/
      checkout/
        route.ts
      webhook/
        route.ts
    trial/
      start/
        proxy.ts
        route.ts
  types/
    index.ts
  favicon.ico
  globals.css
  layout.tsx
  page.tsx
components/
  booking/
    NewDogForm.tsx
    QuickBookModal.tsx
  clients/
    NewClientForm.tsx
  dashboard/
    DashboardClient.tsx
    GroomersOnDeck.tsx
    GroomersTodayCard.tsx
    QuickActions.tsx
    StaffOnDutyCard.tsx
    StatCard.tsx
    TodayAppointments.tsx
    TodayAtAGlance.tsx
    TodaysWatchlist.tsx
  layout/
    AppShell.tsx
    Header.tsx
    KeyboardShortcuts.tsx
    Sidebar.tsx
  ui/
    Badge.tsx
    Button.tsx
    Card.tsx
    Input.tsx
    Label.tsx
    Modal.tsx
    Select.tsx
    Textarea.tsx
  AddDogForm.tsx
  DashboardView.tsx
  DogDetail.tsx
  DogDetailModal.tsx
  DogForm.tsx
  DogList.tsx
  LogoutButton.tsx
  PhotoUploader.tsx
lib/
  actions/
    appointments.ts
    booking.ts
    checkout.ts
    client-intake.ts
    clients.ts
    customers.ts
    dashboard.ts
    dogs.ts
    groomers.ts
    notifications.ts
    onboarding.ts
    photos.ts
  constants/
    grooming.ts
  mock/
    appointments.ts
    customers.ts
    dashboard.ts
  sms/
    provider.ts
    send.ts
  stripe/
    client.ts
    utils.ts
  types/
    appointments.ts
  utils/
    date.ts
    receipt.ts
  utils.ts
public/
  file.svg
  globe.svg
  logo.png
  next.svg
  oh-my-dawg-logo.png
  quick-start-guide.html
  setup-guide.html
  vercel.svg
  window.svg
supabase/
  migrations/
    001_initial_schema.sql
    002_payments_table.sql
    003_grooming_preferences.sql
    004_sms_notifications.sql
    005_dog_photos.sql
    006_user_subscriptions.sql
    007_add_in_progress_status.sql
    008_groomers_table.sql
    009_business_settings_table.sql
    010_groomers_on_duty.sql
    011_add_currency_to_settings.sql
utils/
  supabase/
    client.ts
    middleware.ts
    server.ts
.gitignore
cool dog.png
eslint.config.mjs
GroomGroove Setup Guide.pdf
IMG_9684 copy.png
IMG_9684.PNG
ND.pdf
ND.png
new dog.png
new dog2.png
Newdog.png
next.config.ts
package-lock 2.json
package.json
panel.png
postcss.config.mjs
PRD.md
README.md
Screenshot 2026-01-14 at 2.36.58‚ÄØpm.png
Screenshot 2026-01-14 at 3.06.57‚ÄØpm.png
Screenshot 2026-01-14 at 3.12.43‚ÄØpm.png
Screenshot 2026-01-14 at 3.14.01‚ÄØpm.png
Screenshot 2026-01-14 at 3.22.18‚ÄØpm.png
Screenshot 2026-01-14 at 3.24.57‚ÄØpm.png
Screenshot 2026-01-14 at 3.25.07‚ÄØpm.png
Screenshot 2026-01-14 at 3.25.29‚ÄØpm.png
Screenshot 2026-01-14 at 3.37.59‚ÄØpm.png
Screenshot 2026-01-14 at 3.53.40‚ÄØpm.png
Screenshot 2026-01-14 at 3.54.09‚ÄØpm.png
Screenshot 2026-01-14 at 4.16.01‚ÄØpm.png
Screenshot 2026-01-14 at 5.37.46‚ÄØpm.png
Screenshot 2026-01-15 at 1.30.38‚ÄØpm.png
Screenshot 2026-01-15 at 3.06.47‚ÄØpm.png
Screenshot 2026-01-15 at 3.07.03‚ÄØpm.png
Screenshot 2026-01-15 at 3.24.26‚ÄØpm.png
Screenshot 2026-01-15 at 3.31.39‚ÄØpm.png
Screenshot 2026-01-15 at 3.39.10‚ÄØpm.png
Screenshot 2026-01-15 at 3.52.32‚ÄØpm.png
Screenshot 2026-01-15 at 4.51.37‚ÄØpm.png
Screenshot 2026-01-15 at 4.51.59‚ÄØpm.png
Screenshot 2026-01-16 at 1.50.36‚ÄØpm.png
Screenshot 2026-01-16 at 1.50.44‚ÄØpm.png
Screenshot 2026-01-16 at 10.25.34‚ÄØam.png
Screenshot 2026-01-16 at 10.25.58‚ÄØam.png
Screenshot 2026-01-16 at 10.51.19‚ÄØam.png
Screenshot 2026-01-16 at 2.33.51‚ÄØpm.png
Screenshot 2026-01-16 at 2.34.45‚ÄØpm.png
Screenshot 2026-01-17 at 11.02.33‚ÄØam.png
Screenshot 2026-01-17 at 11.39.04‚ÄØam.png
SETUP_GUIDE.md
Small-AI_CORRECTED_Subscriptions.md
STRIPE_SETUP.md
Subscription_Cancellation_Checklist.md
tsconfig.json
Untitled 2.key
vercel.json
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path=".claude/settings.local.json">
{
  "permissions": {
    "allow": [
      "Bash(cat:*)",
      "Bash(npm run build:*)",
      "Bash(curl:*)",
      "Bash(npm run dev:*)",
      "Bash(open http://localhost:3000)",
      "Bash(lsof:*)",
      "Bash(xargs kill:*)",
      "Bash(ls:*)",
      "Bash(npx next:*)",
      "Bash(pkill:*)",
      "Bash(npx tsc:*)",
      "Bash(rm:*)",
      "Bash(vercel --version:*)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(git push:*)",
      "Bash(mkdir:*)",
      "Bash(npm install:*)",
      "Bash(timeout 10 npm run dev:*)",
      "Bash(gh auth status:*)",
      "Bash(git rm:*)",
      "Bash(kill:*)",
      "Bash(npx repomix)"
    ]
  }
}
</file>

<file path="app/api/trial/start/proxy.ts">
import { NextRequest } from 'next/server'
import { updateSession } from '@/utils/supabase/middleware'

export const config = {
  matcher: [
    /*
     * Match all request paths except for the ones starting with:
     * - _next/static (static files)
     * - _next/image (image optimization files)
     * - favicon.ico (favicon file)
     * - images - .svg, .png, .jpg, .jpeg, .gif, .webp
     * - api (API routes)
     * - logo.png (App logo)
     */
    '/((?!_next/static|_next/image|favicon.ico|images/|api/|logo.png).*)',
  ],
}

export async function proxy(request: NextRequest) {
  return await updateSession(request)
}
</file>

<file path="app/(app)/customers/new/page.tsx">
'use client'

import { useState } from 'react'
import { Card } from '@/components/ui/Card'
import { Button } from '@/components/ui/Button'
import { ArrowLeft, User, Mail, Phone, Dog, Calendar } from 'lucide-react'
import Link from 'next/link'
import { useRouter } from 'next/navigation'

export default function CreateCustomerPage() {
  const router = useRouter()
  const [formData, setFormData] = useState({
    name: '',
    email: '',
    phone: '',
    address: '',
    notes: '',
  })
  const [dogs, setDogs] = useState([{ name: '', breed: '', age: '', notes: '' }])
  const [isSubmitting, setIsSubmitting] = useState(false)

  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {
    const { name, value } = e.target
    setFormData(prev => ({ ...prev, [name]: value }))
  }

  const handleDogChange = (index: number, field: string, value: string) => {
    const newDogs = [...dogs]
    newDogs[index] = { ...newDogs[index], [field]: value }
    setDogs(newDogs)
  }

  const addDog = () => {
    setDogs([...dogs, { name: '', breed: '', age: '', notes: '' }])
  }

  const removeDog = (index: number) => {
    if (dogs.length > 1) {
      setDogs(dogs.filter((_, i) => i !== index))
    }
  }

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault()
    setIsSubmitting(true)

    // In a real app, this would be an API call
    console.log('Creating customer:', { ...formData, dogs })
    
    // Simulate API call
    await new Promise(resolve => setTimeout(resolve, 1000))
    
    // Redirect to customers page
    router.push('/customers')
  }

  return (
    <div className="space-y-6">
      <div className="flex items-center justify-between">
        <div className="flex items-center gap-4">
          <Link href="/customers">
            <Button variant="ghost" size="sm">
              <ArrowLeft className="w-4 h-4 mr-2" />
              Back to Customers
            </Button>
          </Link>
          <div>
            <h1 className="text-2xl font-bold text-gray-900">Create New Customer</h1>
            <p className="text-gray-500">Add a new pet parent and their dogs</p>
          </div>
        </div>
      </div>

      <form onSubmit={handleSubmit}>
        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
          {/* Left Column - Customer Info */}
          <div className="lg:col-span-2 space-y-6">
            <Card>
              <div className="p-6">
                <h3 className="font-semibold text-gray-900 mb-4 flex items-center gap-2">
                  <User className="w-5 h-5" />
                  Customer Information
                </h3>
                <div className="space-y-4">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-1">
                      Full Name *
                    </label>
                    <input
                      type="text"
                      name="name"
                      value={formData.name}
                      onChange={handleInputChange}
                      required
                      className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                      placeholder="John Smith"
                    />
                  </div>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">
                        Email Address *
                      </label>
                      <input
                        type="email"
                        name="email"
                        value={formData.email}
                        onChange={handleInputChange}
                        required
                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                        placeholder="john@example.com"
                      />
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">
                        Phone Number *
                      </label>
                      <input
                        type="tel"
                        name="phone"
                        value={formData.phone}
                        onChange={handleInputChange}
                        required
                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                        placeholder="(555) 123-4567"
                      />
                    </div>
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-1">
                      Address
                    </label>
                    <input
                      type="text"
                      name="address"
                      value={formData.address}
                      onChange={handleInputChange}
                      className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                      placeholder="123 Main St, City, State ZIP"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-1">
                      Notes
                    </label>
                    <textarea
                      name="notes"
                      value={formData.notes}
                      onChange={handleInputChange}
                      rows={3}
                      className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                      placeholder="Any special instructions or preferences..."
                    />
                  </div>
                </div>
              </div>
            </Card>

            {/* Dogs Section */}
            <Card>
              <div className="p-6">
                <div className="flex items-center justify-between mb-4">
                  <h3 className="font-semibold text-gray-900 flex items-center gap-2">
                    <Dog className="w-5 h-5" />
                    Dogs ({dogs.length})
                  </h3>
                  <Button type="button" variant="secondary" onClick={addDog}>
                    <Dog className="w-4 h-4 mr-2" />
                    Add Another Dog
                  </Button>
                </div>
                <div className="space-y-6">
                  {dogs.map((dog, index) => (
                    <div key={index} className="p-4 border border-gray-200 rounded-lg">
                      <div className="flex items-center justify-between mb-4">
                        <h4 className="font-medium text-gray-900">Dog #{index + 1}</h4>
                        {dogs.length > 1 && (
                          <Button
                            type="button"
                            variant="ghost"
                            size="sm"
                            onClick={() => removeDog(index)}
                          >
                            Remove
                          </Button>
                        )}
                      </div>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">
                            Dog Name *
                          </label>
                          <input
                            type="text"
                            value={dog.name}
                            onChange={(e) => handleDogChange(index, 'name', e.target.value)}
                            required
                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="Buddy"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">
                            Breed
                          </label>
                          <input
                            type="text"
                            value={dog.breed}
                            onChange={(e) => handleDogChange(index, 'breed', e.target.value)}
                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="Golden Retriever"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">
                            Age
                          </label>
                          <input
                            type="text"
                            value={dog.age}
                            onChange={(e) => handleDogChange(index, 'age', e.target.value)}
                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="3 years"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">
                            Notes
                          </label>
                          <input
                            type="text"
                            value={dog.notes}
                            onChange={(e) => handleDogChange(index, 'notes', e.target.value)}
                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="Allergies, preferences, etc."
                          />
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            </Card>
          </div>

          {/* Right Column - Actions */}
          <div className="space-y-6">
            <Card>
              <div className="p-6">
                <h3 className="font-semibold text-gray-900 mb-4">Quick Actions</h3>
                <div className="space-y-3">
                  <Button type="submit" className="w-full" disabled={isSubmitting}>
                    {isSubmitting ? 'Creating...' : 'Create Customer'}
                  </Button>
                  <Button type="button" variant="secondary" className="w-full justify-start">
                    <Calendar className="w-4 h-4 mr-2" />
                    Schedule First Appointment
                  </Button>
                  <Button type="button" variant="secondary" className="w-full justify-start">
                    <Mail className="w-4 h-4 mr-2" />
                    Send Welcome Email
                  </Button>
                </div>
              </div>
            </Card>

            <Card>
              <div className="p-6">
                <h3 className="font-semibold text-gray-900 mb-4">Tips</h3>
                <ul className="space-y-2 text-sm text-gray-600">
                  <li className="flex items-start gap-2">
                    <div className="w-5 h-5 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 text-xs mt-0.5">
                      ‚úì
                    </div>
                    <span>Add all dogs the customer owns for complete records</span>
                  </li>
                  <li className="flex items-start gap-2">
                    <div className="w-5 h-5 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 text-xs mt-0.5">
                      ‚úì
                    </div>
                    <span>Include any allergies or special care instructions</span>
                  </li>
                  <li className="flex items-start gap-2">
                    <div className="w-5 h-5 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 text-xs mt-0.5">
                      ‚úì
                    </div>
                    <span>Schedule the first appointment to get them started</span>
                  </li>
                </ul>
              </div>
            </Card>
          </div>
        </div>
      </form>
    </div>
  )
}
</file>

<file path="app/(app)/customers/page.tsx">
'use client'

import { useState } from 'react'
import { StatCard } from '@/components/dashboard/StatCard'
import { Card } from '@/components/ui/Card'
import { Button } from '@/components/ui/Button'
import { Badge } from '@/components/ui/Badge'
import { mockCustomerStats, mockCustomers, type Customer } from '@/lib/mock/customers'
import { Users, UserCheck, DollarSign, Mail, Phone, Calendar, Dog, MessageSquare, History, X, Plus } from 'lucide-react'

function StatusBadge({ status }: { status: 'active' | 'vip' | 'inactive' }) {
  const styles = {
    active: 'bg-green-100 text-green-700',
    vip: 'bg-purple-100 text-purple-700',
    inactive: 'bg-gray-100 text-gray-600',
  }
  const labels = {
    active: 'Active',
    vip: 'VIP',
    inactive: 'Inactive',
  }
  return (
    <span className={`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${styles[status]}`}>
      {labels[status]}
    </span>
  )
}

function CustomerDetailPanel({ customer, onClose }: { customer: Customer; onClose: () => void }) {
  const visits = Math.round(customer.lifetimeSpend / 70)
  const avgTicket = Math.round(customer.lifetimeSpend / visits)

  return (
    <div className="fixed inset-y-0 right-0 w-96 bg-white shadow-xl border-l border-gray-200 z-50 overflow-y-auto">
      <div className="p-6">
        <div className="flex items-center justify-between mb-6">
          <h2 className="text-lg font-semibold text-gray-900">Customer Overview</h2>
          <button onClick={onClose} className="p-1 hover:bg-gray-100 rounded">
            <X className="w-5 h-5 text-gray-500" />
          </button>
        </div>

        <div className="space-y-6">
          {/* Customer Info */}
          <div>
            <h3 className="text-xl font-semibold text-gray-900">{customer.name}</h3>
            <div className="mt-2 space-y-1 text-sm text-gray-600">
              <p className="flex items-center gap-2">
                <Mail className="w-4 h-4" />
                {customer.email}
              </p>
              <p className="flex items-center gap-2">
                <Phone className="w-4 h-4" />
                {customer.phone}
              </p>
            </div>
          </div>

          {/* Stats */}
          <div className="grid grid-cols-2 gap-4">
            <div className="bg-gray-50 rounded-lg p-4">
              <p className="text-sm text-gray-500">Lifetime Spend</p>
              <p className="text-2xl font-semibold text-gray-900">${customer.lifetimeSpend}</p>
            </div>
            <div className="bg-gray-50 rounded-lg p-4">
              <p className="text-sm text-gray-500">Estimated Visits</p>
              <p className="text-2xl font-semibold text-gray-900">{visits}</p>
            </div>
            <div className="bg-gray-50 rounded-lg p-4">
              <p className="text-sm text-gray-500">Avg Ticket</p>
              <p className="text-2xl font-semibold text-gray-900">${avgTicket}</p>
            </div>
            <div className="bg-gray-50 rounded-lg p-4">
              <p className="text-sm text-gray-500">Last Visit</p>
              <p className="text-2xl font-semibold text-gray-900">{customer.lastVisit}</p>
            </div>
          </div>

          {/* Dogs */}
          <div>
            <h4 className="font-medium text-gray-900 mb-3 flex items-center gap-2">
              <Dog className="w-4 h-4" />
              Dogs ({customer.dogs.length})
            </h4>
            <div className="space-y-2">
              {customer.dogs.map((dogName, index) => (
                <div key={index} className="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                  <div>
                    <p className="font-medium text-gray-900">{dogName}</p>
                    <p className="text-sm text-gray-500">Dog</p>
                  </div>
                  <Badge variant="default">Active</Badge>
                </div>
              ))}
            </div>
          </div>

          {/* Actions */}
          <div className="pt-4 border-t border-gray-200">
            <h4 className="font-medium text-gray-900 mb-3">Quick Actions</h4>
            <div className="grid grid-cols-2 gap-3">
              <Button variant="secondary" className="justify-start">
                <MessageSquare className="w-4 h-4 mr-2" />
                Send Message
              </Button>
              <Button variant="secondary" className="justify-start">
                <Calendar className="w-4 h-4 mr-2" />
                Book Appointment
              </Button>
              <Button variant="secondary" className="justify-start">
                <History className="w-4 h-4 mr-2" />
                View History
              </Button>
              <Button variant="secondary" className="justify-start">
                <Dog className="w-4 h-4 mr-2" />
                Add Dog
              </Button>
            </div>
          </div>
        </div>
      </div>
    </div>
  )
}

export default function CustomersPage() {
  const [selectedCustomer, setSelectedCustomer] = useState<Customer | null>(null)

  return (
    <div className="space-y-6">
      <div className="flex items-center justify-between">
        <div>
          <h1 className="text-2xl font-bold text-gray-900">Customers</h1>
          <p className="text-gray-500">Manage pet parents, contact details, and spending history.</p>
        </div>
        <Button href="/customers/new">
          <Plus className="w-4 h-4 mr-2" />
          Add New Customer
        </Button>
      </div>

      {/* Stats Row */}
      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
        <StatCard
          title="Total Customers"
          value={mockCustomerStats.totalCustomers}
          icon={Users}
          color="blue"
        />
        <StatCard
          title="Active This Month"
          value={mockCustomerStats.activeThisMonth}
          icon={UserCheck}
          color="green"
        />
        <StatCard
          title="Avg Spend / Customer"
          value={`$${mockCustomerStats.avgSpendPerCustomer.toFixed(2)}`}
          icon={DollarSign}
          color="rose"
        />
      </div>

      {/* Customers Table */}
      <Card className="overflow-hidden">
        <div className="overflow-x-auto">
          <table className="w-full">
            <thead className="bg-gray-50 border-b border-gray-200">
              <tr>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Customer</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contact</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Dogs</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Last Visit</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Lifetime Spend</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
              </tr>
            </thead>
            <tbody className="bg-white divide-y divide-gray-200">
              {mockCustomers.map((customer) => (
                <tr
                  key={customer.id}
                  onClick={() => setSelectedCustomer(customer)}
                  className="hover:bg-gray-50 cursor-pointer transition-colors"
                >
                  <td className="px-6 py-4 whitespace-nowrap">
                    <span className="font-medium text-gray-900">{customer.name}</span>
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap">
                    <div className="text-sm text-gray-900">{customer.email}</div>
                    <div className="text-sm text-gray-500">{customer.phone}</div>
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap">
                    <div className="flex items-center gap-2">
                      <Dog className="w-4 h-4 text-gray-400" />
                      <span className="text-sm text-gray-900">{customer.dogs.length} dogs</span>
                    </div>
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                    {customer.lastVisit}
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                    ${customer.lifetimeSpend}
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap">
                    <StatusBadge status={customer.status} />
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </Card>

      {selectedCustomer && (
        <>
          <div
            className="fixed inset-0 bg-black/20 z-40"
            onClick={() => setSelectedCustomer(null)}
          />
          <CustomerDetailPanel
            customer={selectedCustomer}
            onClose={() => setSelectedCustomer(null)}
          />
        </>
      )}
    </div>
  )
}
</file>

<file path="app/(app)/dogs/page.tsx">
import { getAllDogs } from '@/lib/actions/dogs'
import { DogsPageClient } from './DogsPageClient'

/**
 * Dogs Page (Server Component)
 * Fetches all dogs and passes them to the client component for interactivity.
 * The client component handles the modal for viewing dog details.
 */
export default async function DogsPage() {
  const dogs = await getAllDogs()

  return <DogsPageClient dogs={dogs} />
}
</file>

<file path="app/(app)/groomers/new/page.tsx">
'use client'

import { useState } from 'react'
import { useRouter } from 'next/navigation'
import { createClient } from '@/utils/supabase/client'
import { Button } from '@/components/ui/Button'

export default function AddGroomerPage() {
  const router = useRouter()
  const supabase = createClient()
  const [name, setName] = useState('')
  const [role, setRole] = useState('Groomer')
  const [loading, setLoading] = useState(false)

  async function handleSubmit(e: React.FormEvent) {
    e.preventDefault()
    setLoading(true)
    
    const { error } = await supabase
      .from('groomers')
      .insert([{ name, role, color: '#3b82f6' }])
    
    if (error) {
      alert('Error adding groomer: ' + error.message)
      setLoading(false)
    } else {
      router.push('/groomers')
      router.refresh()
    }
  }

  return (
    <div className="max-w-md mx-auto p-6">
      <h1 className="text-2xl font-bold mb-6">Add New Groomer</h1>
      <form onSubmit={handleSubmit} className="space-y-6 bg-white p-6 rounded-xl border">
        <div className="space-y-2">
          <label className="block text-sm font-medium text-gray-700">
            Name
          </label>
          <input
            type="text"
            value={name}
            onChange={(e) => setName(e.target.value)}
            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
            required
          />
        </div>
        <div className="space-y-2">
          <label className="block text-sm font-medium text-gray-700">
            Role
          </label>
          <input
            type="text"
            value={role}
            onChange={(e) => setRole(e.target.value)}
            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
          />
        </div>
        <div className="flex gap-4 pt-4">
          <Button type="button" variant="ghost" onClick={() => router.back()}>
            Cancel
          </Button>
          <Button type="submit" disabled={loading} className="bg-blue-600 text-white">
            {loading ? 'Adding...' : 'Add Groomer'}
          </Button>
        </div>
      </form>
    </div>
  )
}
</file>

<file path="app/(app)/layout.tsx">
import { createClient } from '@/utils/supabase/server'
import { AppShell } from '@/components/layout/AppShell'

export default async function AppLayout({
  children,
}: {
  children: React.ReactNode
}) {
  const supabase = await createClient()
  const { data: { user } } = await supabase.auth.getUser()

  // Middleware handles redirect if not authenticated
  // This just gets the user for display purposes
  return <AppShell userEmail={user?.email}>{children}</AppShell>
}
</file>

<file path="app/(auth)/layout.tsx">
export default function AuthLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return <>{children}</>
}
</file>

<file path="app/api/cron/reminders/route.ts">
// Reminder Cron Job
// Runs every 15 minutes to send 1-hour reminders for upcoming appointments
// Vercel cron runs this automatically - see vercel.json

import { NextRequest, NextResponse } from 'next/server'
import { createClient } from '@/utils/supabase/server'
import { sendReminderSMS } from '@/lib/sms/send'

export async function GET(request: NextRequest) {
  // üîê SECURITY CHECK ‚Äî MUST BE FIRST
  // In development, allow without auth for testing
  const authHeader = request.headers.get('authorization')
  const isDev = process.env.NODE_ENV === 'development'

  if (!isDev && authHeader !== `Bearer ${process.env.CRON_SECRET}`) {
    return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })
  }

  const supabase = await createClient()
  const now = new Date()

  // Calculate 1-hour window (45 min to 75 min from now)
  // This gives a 30-minute window to catch appointments
  const windowStart = new Date(now.getTime() + 45 * 60 * 1000) // 45 min from now
  const windowEnd = new Date(now.getTime() + 75 * 60 * 1000)   // 75 min from now

  console.log('[Cron] Checking 1-hour reminders for window:', windowStart.toISOString(), 'to', windowEnd.toISOString())

  // Find appointments in the 1-hour window (any status except cancelled/completed)
  const { data: appointments, error } = await supabase
    .from('appointments')
    .select(`
      id,
      scheduled_at,
      status,
      customer:customers(id, phone, sms_consent)
    `)
    .in('status', ['pending_confirmation', 'confirmed']) // Not cancelled or completed
    .gte('scheduled_at', windowStart.toISOString())
    .lte('scheduled_at', windowEnd.toISOString())

  if (error) {
    console.error('[Cron] Failed to fetch appointments:', error)
    return NextResponse.json({ error: 'Database error' }, { status: 500 })
  }

  if (!appointments || appointments.length === 0) {
    console.log('[Cron] No appointments in reminder window')
    return NextResponse.json({ sent: 0, checked: 0, message: 'No appointments in 1-hour window' })
  }

  let sentCount = 0
  let skippedCount = 0
  const results: { id: string; status: string }[] = []

  for (const appointment of appointments) {
    // Handle Supabase relation (may be array or object)
    const customer = Array.isArray(appointment.customer)
      ? appointment.customer[0]
      : appointment.customer

    // Skip if no SMS consent or phone
    if (!customer?.sms_consent || !customer?.phone) {
      skippedCount++
      results.push({ id: appointment.id, status: 'skipped_no_contact' })
      continue
    }

    // Check if reminder already sent (prevent duplicates)
    const { data: existingReminder } = await supabase
      .from('sms_notifications')
      .select('id')
      .eq('appointment_id', appointment.id)
      .eq('type', 'reminder')
      .maybeSingle()

    if (existingReminder) {
      console.log('[Cron] Reminder already sent for appointment:', appointment.id)
      skippedCount++
      results.push({ id: appointment.id, status: 'already_sent' })
      continue
    }

    // Send reminder
    const result = await sendReminderSMS(appointment.id)

    if (result.sent) {
      sentCount++
      results.push({ id: appointment.id, status: 'sent' })
      console.log('[Cron] Sent reminder for appointment:', appointment.id)
    } else {
      results.push({ id: appointment.id, status: 'failed' })
      console.log('[Cron] Failed to send reminder for appointment:', appointment.id)
    }
  }

  console.log(`[Cron] Complete. Sent: ${sentCount}, Skipped: ${skippedCount}`)

  return NextResponse.json({
    sent: sentCount,
    skipped: skippedCount,
    checked: appointments.length,
    results,
  })
}
</file>

<file path="app/api/sms/webhook/route.ts">
// SMS Webhook Handler
// Receives incoming SMS replies from customers (via Twilio)

import { NextRequest, NextResponse } from 'next/server'
import { createClient } from '@/utils/supabase/server'
import { smsProvider } from '@/lib/sms/provider'
import { sendConfirmedSMS, sendCancelledSMS } from '@/lib/sms/send'
import { format } from 'date-fns'

export async function POST(request: NextRequest) {
  const supabase = await createClient()

  // Parse incoming SMS (Twilio format)
  const formData = await request.formData()
  const from = formData.get('From') as string // Customer phone number
  const rawBody = formData.get('Body') as string

  // Normalize reply: trim whitespace and uppercase
  const body = rawBody?.trim().toUpperCase() || ''

  console.log('[SMS Webhook] From:', from, 'Body:', body)

  // STEP 1: Find customer by phone number
  const { data: customer, error: customerError } = await supabase
    .from('customers')
    .select('id')
    .eq('phone', from)
    .single()

  if (customerError || !customer) {
    console.log('[SMS Webhook] Unknown phone number:', from)
    await smsProvider.send({
      to: from,
      body: 'GroomGroove: We could not find your account. Please call (555) 123-4567 for assistance.',
    })
    return new NextResponse('OK', { status: 200 })
  }

  // STEP 2: Find pending appointment(s) for this customer
  // If multiple, use the soonest one
  const { data: appointments } = await supabase
    .from('appointments')
    .select(`
      id,
      scheduled_at,
      status,
      dog:dogs(name)
    `)
    .eq('customer_id', customer.id)
    .eq('status', 'pending_confirmation')
    .order('scheduled_at', { ascending: true })
    .limit(1)

  const appointment = appointments?.[0]

  // STEP 3: Handle case where no pending appointment exists
  if (!appointment) {
    // Check if they have a confirmed appointment
    const { data: confirmedAppt } = await supabase
      .from('appointments')
      .select('scheduled_at')
      .eq('customer_id', customer.id)
      .eq('status', 'confirmed')
      .order('scheduled_at', { ascending: true })
      .limit(1)
      .single()

    if (confirmedAppt) {
      const dateStr = format(new Date(confirmedAppt.scheduled_at), 'EEE, MMM d')
      await smsProvider.send({
        to: from,
        body: `GroomGroove: Your appointment is already confirmed for ${dateStr}. See you then! Questions? Call (555) 123-4567`,
      })
    } else {
      await smsProvider.send({
        to: from,
        body: 'GroomGroove: No pending appointment found. Call (555) 123-4567 to schedule.',
      })
    }
    return new NextResponse('OK', { status: 200 })
  }

  // STEP 4: Process YES response
  if (body === 'YES' || body === 'Y' || body === 'CONFIRM') {
    await handleYesResponse(supabase, appointment, from)
    return new NextResponse('OK', { status: 200 })
  }

  // STEP 5: Process NO response
  if (body === 'NO' || body === 'N' || body === 'CANCEL') {
    await handleNoResponse(supabase, appointment, from)
    return new NextResponse('OK', { status: 200 })
  }

  // STEP 6: Unrecognized response
  await smsProvider.send({
    to: from,
    body: "GroomGroove: Sorry, I didn't understand. Reply YES to confirm or NO to cancel your appointment.",
  })

  return new NextResponse('OK', { status: 200 })
}

/**
 * Handle YES confirmation
 * - Check if appointment time has passed (reject if so)
 * - Update status to confirmed
 * - Send confirmation SMS
 */
async function handleYesResponse(
  supabase: any,
  appointment: any,
  phone: string
): Promise<void> {
  const appointmentTime = new Date(appointment.scheduled_at)
  const now = new Date()

  // EDGE CASE: Late confirmation - appointment time has passed
  if (appointmentTime < now) {
    await smsProvider.send({
      to: phone,
      body: 'GroomGroove: That appointment time has already passed. Please call (555) 123-4567 to reschedule.',
    })
    return
  }

  // Check if already confirmed (duplicate reply)
  if (appointment.status === 'confirmed') {
    const dateStr = format(appointmentTime, 'EEE, MMM d')
    const timeStr = format(appointmentTime, 'h:mm a')
    await smsProvider.send({
      to: phone,
      body: `GroomGroove: Your appointment is already confirmed for ${dateStr} at ${timeStr}. See you then!`,
    })
    return
  }

  // Update appointment status to confirmed
  const { error } = await supabase
    .from('appointments')
    .update({
      status: 'confirmed',
      confirmed_at: now.toISOString(),
      updated_at: now.toISOString(),
    })
    .eq('id', appointment.id)

  if (error) {
    console.error('[SMS Webhook] Failed to confirm appointment:', error)
    await smsProvider.send({
      to: phone,
      body: 'GroomGroove: Something went wrong. Please call (555) 123-4567 for assistance.',
    })
    return
  }

  // Log customer response
  await supabase
    .from('sms_notifications')
    .update({
      customer_response: 'YES',
      response_at: now.toISOString(),
    })
    .eq('appointment_id', appointment.id)
    .eq('type', 'confirmation_request')

  // Send confirmation success SMS
  const dog = Array.isArray(appointment.dog) ? appointment.dog[0] : appointment.dog
  await sendConfirmedSMS(phone, dog?.name || 'your pet', appointment.scheduled_at)
}

/**
 * Handle NO cancellation
 * - Update status to cancelled
 * - Send cancellation SMS
 */
async function handleNoResponse(
  supabase: any,
  appointment: any,
  phone: string
): Promise<void> {
  const now = new Date()

  // Check if already cancelled (duplicate reply)
  if (appointment.status === 'cancelled') {
    await smsProvider.send({
      to: phone,
      body: 'GroomGroove: This appointment was already cancelled. Call (555) 123-4567 to book a new one.',
    })
    return
  }

  // Update appointment status to cancelled
  const { error } = await supabase
    .from('appointments')
    .update({
      status: 'cancelled',
      cancelled_at: now.toISOString(),
      updated_at: now.toISOString(),
    })
    .eq('id', appointment.id)

  if (error) {
    console.error('[SMS Webhook] Failed to cancel appointment:', error)
    await smsProvider.send({
      to: phone,
      body: 'GroomGroove: Something went wrong. Please call (555) 123-4567 for assistance.',
    })
    return
  }

  // Log customer response
  await supabase
    .from('sms_notifications')
    .update({
      customer_response: 'NO',
      response_at: now.toISOString(),
    })
    .eq('appointment_id', appointment.id)
    .eq('type', 'confirmation_request')

  // Send cancellation SMS
  await sendCancelledSMS(phone, appointment.scheduled_at)
}
</file>

<file path="app/api/trial/start/route.ts">
import { createClient } from "@supabase/supabase-js";
import { createClient as createAuthClient } from "@/utils/supabase/server";
import { NextResponse } from "next/server";

const supabaseAdmin = createClient(
  process.env.NEXT_PUBLIC_SUPABASE_URL!,
  process.env.SUPABASE_SERVICE_ROLE_KEY!
);

export async function POST(req: Request) {
  try {
    const authClient = await createAuthClient();
    const {
      data: { user },
    } = await authClient.auth.getUser();

    if (!user) return new NextResponse("Unauthorized", { status: 401 });

    const now = new Date();
    const trialEnd = new Date();
    trialEnd.setDate(now.getDate() + 14);

    const { error } = await supabaseAdmin.from("subscriptions").insert({
      id: `trial_${user.id.slice(0, 8)}_${Date.now()}`,
      user_id: user.id,
      status: "trialing",
      price_id: "price_1SpjQlGzqO94XgciE9C3FJsE",
      quantity: 1,
      cancel_at_period_end: false,
      current_period_start: now.toISOString(),
      current_period_end: trialEnd.toISOString(),
      trial_start: now.toISOString(),
      trial_end: trialEnd.toISOString(),
    });

    if (error) throw error;

    return NextResponse.json({ url: "/dashboard" });
  } catch (error: any) {
    return new NextResponse("Internal Error: " + error.message, { status: 500 });
  }
}
</file>

<file path="app/types/index.ts">
export type Dog = {
  id: string
  created_at: string
  owner_name: string
  owner_phone: string | null
  owner_email: string | null
  dog_name: string
  breed: string | null
  clipper_blade_size: string | null
  nail_clipper_size: string | null
  grooming_notes: string | null
  behavioral_notes: string | null
  user_id: string
}

export type Appointment = {
  id: string
  created_at: string
  dog_id: string
  start_time: string
  service_type: string
  status: 'scheduled' | 'in-progress' | 'completed' | 'cancelled'
  notes: string | null
  user_id: string
  dogs?: Dog // For joining data
}
</file>

<file path="components/clients/NewClientForm.tsx">
'use client'

import { useState } from 'react'
import { useRouter } from 'next/navigation'
import { z } from 'zod'
import { Card } from '@/components/ui/Card'
import { Button } from '@/components/ui/Button'
import { Input } from '@/components/ui/Input'
import { Textarea } from '@/components/ui/Textarea'
import { AlertCircle, Dog, User } from 'lucide-react'
import { createClientWithDog } from '@/lib/actions/client-intake'

const formSchema = z.object({
  owner: z.object({
    firstName: z.string().min(1, 'First name is required'),
    lastName: z.string().min(1, 'Last name is required'),
    phone: z.string().min(1, 'Phone is required'),
    email: z.string().email('Enter a valid email').optional().or(z.literal('')),
  }),
  dog: z.object({
    name: z.string().min(1, 'Dog name is required'),
    breed: z.string().optional().or(z.literal('')),
    weight: z.string().optional().or(z.literal('')),
    notes: z.string().optional().or(z.literal('')),
  }),
})

type FormState = z.infer<typeof formSchema>

const defaultState: FormState = {
  owner: {
    firstName: '',
    lastName: '',
    phone: '',
    email: '',
  },
  dog: {
    name: '',
    breed: '',
    weight: '',
    notes: '',
  },
}

export default function NewClientForm() {
  const router = useRouter()
  const [formState, setFormState] = useState<FormState>(defaultState)
  const [errors, setErrors] = useState<Record<string, string>>({})
  const [isSubmitting, setIsSubmitting] = useState(false)

  const setField = (
    path: keyof FormState,
    field: keyof FormState['owner'] | keyof FormState['dog'],
    value: string
  ) => {
    setFormState((prev) => ({
      ...prev,
      [path]: {
        ...prev[path],
        [field]: value,
      },
    }))
  }

  const handleSubmit = async (event: React.FormEvent<HTMLFormElement>) => {
    event.preventDefault()
    setErrors({})

    const parsed = formSchema.safeParse(formState)
    if (!parsed.success) {
      const nextErrors: Record<string, string> = {}
      parsed.error.issues.forEach((issue) => {
        const path = issue.path.join('.')
        nextErrors[path] = issue.message
      })
      setErrors(nextErrors)
      return
    }

    setIsSubmitting(true)

    try {
      const result = await createClientWithDog({
        owner: {
          firstName: parsed.data.owner.firstName,
          lastName: parsed.data.owner.lastName,
          phone: parsed.data.owner.phone,
          email: parsed.data.owner.email || undefined,
        },
        dog: {
          name: parsed.data.dog.name,
          breed: parsed.data.dog.breed || undefined,
          weight: parsed.data.dog.weight || undefined,
          notes: parsed.data.dog.notes || undefined,
        },
      })

      if (result.success) {
        if (result.dogId) {
          router.push(`/dogs/${result.dogId}`)
        } else {
          router.push('/dashboard')
        }
        return
      }

      setErrors({ form: result.error || 'Unable to create client' })
      setIsSubmitting(false)
    } catch (error) {
      setErrors({
        form: error instanceof Error ? error.message : 'Unable to create client',
      })
      setIsSubmitting(false)
    }
  }

  return (
    <form onSubmit={handleSubmit} className="space-y-6">
      <div>
        <h1 className="text-2xl font-bold text-gray-900">New Client</h1>
        <p className="text-gray-500">Add a client and their first dog in one step.</p>
      </div>

      {errors.form && (
        <div className="bg-red-50 border border-red-200 rounded-lg p-4 flex items-center gap-3">
          <AlertCircle className="w-5 h-5 text-red-500 flex-shrink-0" />
          <p className="text-red-700 text-sm">{errors.form}</p>
        </div>
      )}

      <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <div className="lg:col-span-2 space-y-6">
          <Card>
            <div className="p-6 space-y-4">
              <h3 className="font-semibold text-gray-900 flex items-center gap-2">
                <User className="w-5 h-5" />
                Owner Details
              </h3>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div className="space-y-1">
                  <label className="text-sm font-medium text-gray-700">First Name</label>
                  <Input
                    value={formState.owner.firstName}
                    onChange={(event) => setField('owner', 'firstName', event.target.value)}
                    placeholder="Jamie"
                  />
                  {errors['owner.firstName'] && (
                    <p className="text-xs text-red-500">{errors['owner.firstName']}</p>
                  )}
                </div>
                <div className="space-y-1">
                  <label className="text-sm font-medium text-gray-700">Last Name</label>
                  <Input
                    value={formState.owner.lastName}
                    onChange={(event) => setField('owner', 'lastName', event.target.value)}
                    placeholder="Taylor"
                  />
                  {errors['owner.lastName'] && (
                    <p className="text-xs text-red-500">{errors['owner.lastName']}</p>
                  )}
                </div>
              </div>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div className="space-y-1">
                  <label className="text-sm font-medium text-gray-700">Phone</label>
                  <Input
                    value={formState.owner.phone}
                    onChange={(event) => setField('owner', 'phone', event.target.value)}
                    placeholder="0400 000 000"
                  />
                  {errors['owner.phone'] && (
                    <p className="text-xs text-red-500">{errors['owner.phone']}</p>
                  )}
                </div>
                <div className="space-y-1">
                  <label className="text-sm font-medium text-gray-700">Email</label>
                  <Input
                    type="email"
                    value={formState.owner.email ?? ''}
                    onChange={(event) => setField('owner', 'email', event.target.value)}
                    placeholder="jamie@example.com"
                  />
                  {errors['owner.email'] && (
                    <p className="text-xs text-red-500">{errors['owner.email']}</p>
                  )}
                </div>
              </div>
            </div>
          </Card>

          <Card>
            <div className="p-6 space-y-4">
              <h3 className="font-semibold text-gray-900 flex items-center gap-2">
                <Dog className="w-5 h-5" />
                Dog Details
              </h3>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div className="space-y-1">
                  <label className="text-sm font-medium text-gray-700">Dog Name</label>
                  <Input
                    value={formState.dog.name}
                    onChange={(event) => setField('dog', 'name', event.target.value)}
                    placeholder="Luna"
                  />
                  {errors['dog.name'] && (
                    <p className="text-xs text-red-500">{errors['dog.name']}</p>
                  )}
                </div>
                <div className="space-y-1">
                  <label className="text-sm font-medium text-gray-700">Breed</label>
                  <Input
                    value={formState.dog.breed ?? ''}
                    onChange={(event) => setField('dog', 'breed', event.target.value)}
                    placeholder="Border Collie"
                  />
                </div>
              </div>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div className="space-y-1">
                  <label className="text-sm font-medium text-gray-700">Weight (kg)</label>
                  <Input
                    type="number"
                    value={formState.dog.weight ?? ''}
                    onChange={(event) => setField('dog', 'weight', event.target.value)}
                    placeholder="20"
                  />
                </div>
                <div className="space-y-1">
                  <label className="text-sm font-medium text-gray-700">Notes</label>
                  <Textarea
                    value={formState.dog.notes ?? ''}
                    onChange={(event) => setField('dog', 'notes', event.target.value)}
                    placeholder="Temperament, allergies, grooming notes..."
                    rows={3}
                  />
                </div>
              </div>
            </div>
          </Card>
        </div>

        <div className="space-y-4">
          <Card>
            <div className="p-6 space-y-3">
              <h3 className="font-semibold text-gray-900">Save Client</h3>
              <Button type="submit" className="w-full" disabled={isSubmitting}>
                {isSubmitting ? 'Saving...' : 'Create Client'}
              </Button>
              <Button
                type="button"
                variant="secondary"
                className="w-full"
                onClick={() => router.push('/dashboard')}
              >
                Cancel
              </Button>
            </div>
          </Card>
        </div>
      </div>
    </form>
  )
}
</file>

<file path="components/dashboard/DashboardClient.tsx">
'use client'

import { useState, useMemo } from 'react'
import TodayAppointments from '@/components/dashboard/TodayAppointments'
import { TodayAtAGlance } from '@/components/dashboard/TodayAtAGlance'
import { TodaysWatchlist } from '@/components/dashboard/TodaysWatchlist'
import { QuickActions } from '@/components/dashboard/QuickActions'
import type { DashboardData } from '@/lib/actions/dashboard'

interface DashboardClientProps {
  initialData: DashboardData
  error: string | null
}

export function DashboardClient({ initialData, error }: DashboardClientProps) {
  const [activeFilter, setActiveFilter] = useState<string | null>(null)
  const dashboardData = initialData
  const hasConnectionError = !!error

  // Transform appointments for TodayAppointments component with filtering
  const appointmentsForDisplay = useMemo(() => {
    let filteredAppointments = dashboardData.appointments.filter((a) => a.status !== 'cancelled')

    // Apply filters based on activeFilter
    if (activeFilter === 'special-handling') {
      filteredAppointments = filteredAppointments.filter((a) => {
        const prefs = a.dog?.grooming_preferences
        return prefs?.behavior_notes && (
          prefs.behavior_notes.toLowerCase().includes('anxious') ||
          prefs.behavior_notes.toLowerCase().includes('nervous') ||
          prefs.behavior_notes.toLowerCase().includes('nail') ||
          prefs.behavior_notes.toLowerCase().includes('paw') ||
          prefs.behavior_notes.toLowerCase().includes('shed')
        )
      })
    } else if (activeFilter === 'appointments-remaining') {
      filteredAppointments = filteredAppointments.filter((a) => a.status !== 'completed')
    } else if (activeFilter === 'first-time-dogs') {
      filteredAppointments = filteredAppointments.filter((a) => a.is_first_visit)
    }
    // "last-appointment" filter not needed - it's informational only

    return filteredAppointments.map((a) => ({
      id: a.id,
      time: formatTime(a.scheduled_at),
      dogName: a.dog?.name || 'Unknown',
      breed: a.dog?.breed || 'Unknown breed',
      ownerName: a.customer?.name || 'Unknown',
      service: a.services?.join(', ') || 'Grooming',
      status: mapStatus(a.status),
      flags: getFlags(a),
      dogId: a.dogId
    }))
  }, [dashboardData.appointments, activeFilter])

  return (
    <div className="space-y-6">
      <div>
        <h1 className="text-2xl font-bold text-gray-900">Dashboard</h1>
        <p className="text-gray-500">Welcome back! Here&apos;s what&apos;s happening today.</p>

        {/* Connection Error Banner */}
        {hasConnectionError && (
          <div className="mt-4 p-4 bg-red-50 border border-red-200 rounded-lg">
            <div className="flex items-center">
              <div className="flex-shrink-0">
                <svg className="h-5 w-5 text-red-400" viewBox="0 0 20 20" fill="currentColor">
                  <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clipRule="evenodd" />
                </svg>
              </div>
              <div className="ml-3">
                <h3 className="text-sm font-medium text-red-800">Connection Error: Check Vercel Keys</h3>
                <div className="mt-2 text-sm text-red-700">
                  <p>Unable to connect to the database. Please check your Supabase environment variables in Vercel.</p>
                  <p className="mt-1 text-xs opacity-75">Error: {error}</p>
                </div>
              </div>
            </div>
          </div>
        )}

        {activeFilter && (
          <div className="mt-2 text-sm text-blue-600">
            Filtering by: <span className="font-medium">{activeFilter.replace('-', ' ')}</span>
            <button
              onClick={() => setActiveFilter(null)}
              className="ml-2 text-gray-500 hover:text-gray-700"
            >
              Clear filter
            </button>
          </div>
        )}
      </div>

      {/* MAIN LAYOUT - iPad-first 2-column grid (768px+) */}
      <div className="grid grid-cols-1 md:grid-cols-12 gap-6">

        {/* LEFT COLUMN (8 cols) - Main Operations */}
        <div className="md:col-span-8 space-y-6">
          {/* 1. At a Glance (High Impact) */}
          <TodayAtAGlance
            data={dashboardData.glance}
            activeFilter={activeFilter}
            onFilterChange={setActiveFilter}
          />

          {/* 2. Today's Schedule */}
          <TodayAppointments appointments={appointmentsForDisplay} />
        </div>

        {/* RIGHT COLUMN (4 cols) - Alerts & Quick Actions */}
        <div className="md:col-span-4 space-y-6">
          {/* 1. Watchlist (Critical Alerts) */}
          <TodaysWatchlist items={dashboardData.watchlist} />

          {/* 2. Quick Actions */}
          <QuickActions />
        </div>
      </div>
    </div>
  )
}

function formatTime(isoString: string): string {
  try {
    const date = new Date(isoString)
    // Check if date is valid
    if (isNaN(date.getTime())) {
      return 'Invalid time'
    }
    return date.toLocaleTimeString('en-US', {
      hour: 'numeric',
      minute: '2-digit',
      hour12: true
    })
  } catch {
    return 'Invalid time'
  }
}

function mapStatus(status: string): 'confirmed' | 'in-progress' | 'pending' {
  switch (status) {
    case 'confirmed':
      return 'confirmed'
    case 'in_progress':
    case 'in-progress':
      return 'in-progress'
    default:
      return 'pending'
  }
}

function getFlags(appointment: {
  is_first_visit: boolean
  dog: { grooming_preferences: { behavior_notes?: string; special_instructions?: string } | null } | null
}): string[] {
  const flags: string[] = []

  if (appointment.is_first_visit) {
    flags.push('first-visit')
  }

  const prefs = appointment.dog?.grooming_preferences
  if (prefs?.behavior_notes) {
    const notes = prefs.behavior_notes.toLowerCase()
    if (notes.includes('anxious') || notes.includes('nervous')) {
      flags.push('anxious')
    }
    if (notes.includes('nail') || notes.includes('paw')) {
      flags.push('nail-sensitive')
    }
    if (notes.includes('shed')) {
      flags.push('heavy-shedder')
    }
  }

  return flags
}
</file>

<file path="components/dashboard/GroomersOnDeck.tsx">
'use client'

import { useState } from 'react'
import { X, UserPlus } from 'lucide-react'
import { setGroomerOnDuty, type Groomer } from '@/lib/actions/groomers'
import { useRouter } from 'next/navigation'

interface GroomersOnDeckProps {
  onDutyGroomers: Groomer[]
  offDutyGroomers: Groomer[]
}

// Generate initials from name
const getInitials = (name: string) => {
  return name
    .split(' ')
    .map(n => n[0])
    .join('')
    .toUpperCase()
    .slice(0, 2)
}

export function GroomersOnDeck({ onDutyGroomers, offDutyGroomers }: GroomersOnDeckProps) {
  const router = useRouter()
  const [onDuty, setOnDuty] = useState<Groomer[]>(onDutyGroomers)
  const [offDuty, setOffDuty] = useState<Groomer[]>(offDutyGroomers)
  const [isUpdating, setIsUpdating] = useState<string | null>(null)

  const handleClockIn = async (groomerId: string) => {
    setIsUpdating(groomerId)
    const result = await setGroomerOnDuty(groomerId, true)

    if (result.success) {
      // Move groomer from off duty to on duty in local state
      const groomer = offDuty.find(g => g.id === groomerId)
      if (groomer) {
        setOffDuty(prev => prev.filter(g => g.id !== groomerId))
        setOnDuty(prev => [...prev, { ...groomer, on_duty: true }].sort((a, b) => a.name.localeCompare(b.name)))
      }
      router.refresh()
    }
    setIsUpdating(null)
  }

  const handleClockOut = async (groomerId: string) => {
    setIsUpdating(groomerId)
    const result = await setGroomerOnDuty(groomerId, false)

    if (result.success) {
      // Move groomer from on duty to off duty in local state
      const groomer = onDuty.find(g => g.id === groomerId)
      if (groomer) {
        setOnDuty(prev => prev.filter(g => g.id !== groomerId))
        setOffDuty(prev => [...prev, { ...groomer, on_duty: false }].sort((a, b) => a.name.localeCompare(b.name)))
      }
      router.refresh()
    }
    setIsUpdating(null)
  }

  return (
    <div className="bg-white rounded-2xl shadow-sm border border-gray-100 p-6">
      <div className="flex items-center justify-between mb-4">
        <h2 className="text-xl font-bold text-gray-900">Groomers On Deck</h2>
        <span className="bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm font-medium">
          {onDuty.length} Active
        </span>
      </div>

      <div className="flex flex-col lg:flex-row gap-6">
        {/* Left: On Duty Groomers */}
        <div className="flex-1">
          {onDuty.length === 0 ? (
            <div className="text-center py-8 text-gray-400 border-2 border-dashed border-gray-200 rounded-xl">
              <p>No groomers clocked in</p>
              <p className="text-sm">Use the dropdown to add someone</p>
            </div>
          ) : (
            <div className="flex flex-wrap gap-3">
              {onDuty.map((groomer) => (
                <div
                  key={groomer.id}
                  className="flex items-center gap-2 bg-green-50 border border-green-200 rounded-full pl-1 pr-2 py-1"
                >
                  <div
                    className="w-8 h-8 rounded-full flex items-center justify-center text-white font-bold text-xs"
                    style={{ backgroundColor: groomer.color || '#3B82F6' }}
                  >
                    {getInitials(groomer.name)}
                  </div>
                  <span className="font-medium text-gray-800 text-sm">{groomer.name}</span>
                  <button
                    onClick={() => handleClockOut(groomer.id)}
                    disabled={isUpdating === groomer.id}
                    className="p-1 hover:bg-red-100 rounded-full text-gray-400 hover:text-red-500 transition-colors disabled:opacity-50"
                    title={`Clock out ${groomer.name}`}
                  >
                    <X className="h-4 w-4" />
                  </button>
                </div>
              ))}
            </div>
          )}
        </div>

        {/* Right: Clock In Dropdown */}
        <div className="lg:w-64">
          <label className="block text-sm font-medium text-gray-500 mb-2">
            Clock In Groomer
          </label>
          {offDuty.length === 0 ? (
            <div className="text-sm text-gray-400 italic">
              All groomers are on duty
            </div>
          ) : (
            <div className="relative">
              <select
                onChange={(e) => {
                  if (e.target.value) {
                    handleClockIn(e.target.value)
                    e.target.value = ''
                  }
                }}
                className="w-full appearance-none bg-gray-50 border border-gray-200 rounded-xl px-4 py-2.5 pr-10 text-sm focus:outline-none focus:ring-2 focus:ring-green-500/20 focus:border-green-300 cursor-pointer"
                defaultValue=""
              >
                <option value="" disabled>
                  Select groomer...
                </option>
                {offDuty.map((groomer) => (
                  <option key={groomer.id} value={groomer.id}>
                    {groomer.name} ({groomer.role})
                  </option>
                ))}
              </select>
              <UserPlus className="absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none" />
            </div>
          )}
        </div>
      </div>
    </div>
  )
}
</file>

<file path="components/dashboard/GroomersTodayCard.tsx">
'use client'

import { useState } from 'react'
import { Smile, Plus, X } from 'lucide-react'
import { setGroomerOnDuty, type Groomer } from '@/lib/actions/groomers'
import { useRouter } from 'next/navigation'

interface GroomersTodayCardProps {
  onDutyGroomers: Groomer[]
  offDutyGroomers: Groomer[]
}

export function GroomersTodayCard({ onDutyGroomers, offDutyGroomers }: GroomersTodayCardProps) {
  const router = useRouter()
  const [onDuty, setOnDuty] = useState<Groomer[]>(onDutyGroomers)
  const [offDuty, setOffDuty] = useState<Groomer[]>(offDutyGroomers)
  const [showDropdown, setShowDropdown] = useState(false)
  const [isUpdating, setIsUpdating] = useState<string | null>(null)

  const handleClockIn = async (groomerId: string) => {
    setIsUpdating(groomerId)
    setShowDropdown(false)
    const result = await setGroomerOnDuty(groomerId, true)

    if (result.success) {
      const groomer = offDuty.find(g => g.id === groomerId)
      if (groomer) {
        setOffDuty(prev => prev.filter(g => g.id !== groomerId))
        setOnDuty(prev => [...prev, { ...groomer, on_duty: true }].sort((a, b) => a.name.localeCompare(b.name)))
      }
      router.refresh()
    }
    setIsUpdating(null)
  }

  const handleClockOut = async (groomerId: string) => {
    setIsUpdating(groomerId)
    const result = await setGroomerOnDuty(groomerId, false)

    if (result.success) {
      const groomer = onDuty.find(g => g.id === groomerId)
      if (groomer) {
        setOnDuty(prev => prev.filter(g => g.id !== groomerId))
        setOffDuty(prev => [...prev, { ...groomer, on_duty: false }].sort((a, b) => a.name.localeCompare(b.name)))
      }
      router.refresh()
    }
    setIsUpdating(null)
  }

  return (
    <div className="bg-white p-4 rounded-xl shadow-sm border border-gray-100 relative">
      {/* Header */}
      <div className="flex items-center justify-between mb-3">
        <div className="flex items-center gap-2">
          <div className="bg-yellow-50 p-2 rounded-full">
            <Smile className="h-5 w-5 text-yellow-600" />
          </div>
          <span className="font-semibold text-gray-700">Groomers Today</span>
        </div>

        {/* Add button with dropdown */}
        {offDuty.length > 0 && (
          <div className="relative">
            <button
              onClick={() => setShowDropdown(!showDropdown)}
              className="p-1.5 bg-green-50 hover:bg-green-100 rounded-full text-green-600 transition-colors"
              title="Clock in groomer"
            >
              <Plus className="h-4 w-4" />
            </button>

            {showDropdown && (
              <div className="absolute right-0 top-full mt-1 w-40 bg-white border border-gray-200 rounded-lg shadow-lg z-10 py-1">
                {offDuty.map((groomer) => (
                  <button
                    key={groomer.id}
                    onClick={() => handleClockIn(groomer.id)}
                    disabled={isUpdating === groomer.id}
                    className="w-full text-left px-3 py-2 text-sm hover:bg-gray-50 disabled:opacity-50"
                  >
                    {groomer.name}
                  </button>
                ))}
              </div>
            )}
          </div>
        )}
      </div>

      {/* Active groomers list */}
      <div className="min-h-[32px]">
        {onDuty.length === 0 ? (
          <p className="text-sm text-gray-400 italic">No one clocked in</p>
        ) : (
          <div className="flex flex-wrap gap-1.5">
            {onDuty.map((groomer) => (
              <button
                key={groomer.id}
                onClick={() => handleClockOut(groomer.id)}
                disabled={isUpdating === groomer.id}
                className="inline-flex items-center gap-1 px-2 py-1 bg-green-50 hover:bg-red-50 text-green-700 hover:text-red-600 rounded-full text-xs font-medium transition-colors group disabled:opacity-50"
                title={`Clock out ${groomer.name}`}
              >
                <span
                  className="w-2 h-2 rounded-full"
                  style={{ backgroundColor: groomer.color || '#3B82F6' }}
                />
                {groomer.name.split(' ')[0]}
                <X className="h-3 w-3 opacity-0 group-hover:opacity-100 transition-opacity" />
              </button>
            ))}
          </div>
        )}
      </div>

      {/* Click outside to close dropdown */}
      {showDropdown && (
        <div
          className="fixed inset-0 z-0"
          onClick={() => setShowDropdown(false)}
        />
      )}
    </div>
  )
}
</file>

<file path="components/dashboard/StaffOnDutyCard.tsx">
'use client'

import { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card'
import { Button } from '@/components/ui/Button'
import { cn } from '@/lib/utils'
import { Clock } from 'lucide-react'

interface StaffMember {
  id: string
  name: string
  status: 'working' | 'break' | 'clocked_out'
  avatarUrl?: string
}

interface StaffOnDutyCardProps {
  staff: StaffMember[]
}

function Avatar({ name }: { name: string }) {
  const initials = name
    .split(' ')
    .map((n) => n[0])
    .join('')
    .toUpperCase()
    .slice(0, 2)

  return (
    <div className="w-10 h-10 rounded-full bg-rose-100 flex items-center justify-center">
      <span className="text-sm font-medium text-rose-600">{initials}</span>
    </div>
  )
}

function StatusBadge({ status }: { status: 'working' | 'break' | 'clocked_out' }) {
  return (
    <span
      className={cn(
        'inline-flex items-center gap-1.5 px-2 py-0.5 rounded-full text-xs font-medium',
        status === 'working' && 'bg-green-100 text-green-700',
        status === 'break' && 'bg-amber-100 text-amber-700',
        status === 'clocked_out' && 'bg-gray-100 text-gray-600'
      )}
    >
      <span
        className={cn(
          'w-1.5 h-1.5 rounded-full',
          status === 'working' && 'bg-green-500',
          status === 'break' && 'bg-amber-500',
          status === 'clocked_out' && 'bg-gray-400'
        )}
      />
      {status === 'working' && 'Working'}
      {status === 'break' && 'On Break'}
      {status === 'clocked_out' && 'Clocked Out'}
    </span>
  )
}

function ActionButton({ status }: { status: 'working' | 'break' | 'clocked_out' }) {
  const label = status === 'working' ? 'Clock Out' : status === 'break' ? 'Resume' : 'Clock In'

  return (
    <Button variant="ghost" size="sm">
      <Clock className="w-4 h-4 mr-1" />
      {label}
    </Button>
  )
}

export function StaffOnDutyCard({ staff }: StaffOnDutyCardProps) {
  const isEmpty = staff.length === 0

  return (
    <Card>
      <CardHeader>
        <CardTitle>Staff On Duty</CardTitle>
        <p className="text-sm text-gray-500">Today&apos;s team</p>
      </CardHeader>
      <CardContent>
        {isEmpty ? (
          <div className="text-center py-6">
            <div className="w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3">
              <Clock className="w-6 h-6 text-gray-400" />
            </div>
            <p className="text-sm font-medium text-gray-700">
              No staff currently clocked in
            </p>
            <p className="text-xs text-gray-500 mt-1">
              Staff can clock in from the dashboard
            </p>
          </div>
        ) : (
          <div className="space-y-3">
            {staff.map((member) => (
              <div
                key={member.id}
                className="flex items-center gap-3 p-3 bg-gray-50 rounded-xl"
              >
                <Avatar name={member.name} />
                <div className="flex-1 min-w-0">
                  <p className="font-medium text-gray-900 truncate">
                    {member.name}
                  </p>
                  <StatusBadge status={member.status} />
                </div>
                <ActionButton status={member.status} />
              </div>
            ))}
          </div>
        )}
      </CardContent>
    </Card>
  )
}
</file>

<file path="components/dashboard/StatCard.tsx">
import { Card } from '@/components/ui/Card'
import { cn } from '@/lib/utils'
import { LucideIcon } from 'lucide-react'

interface StatCardProps {
  title: string
  value: string | number
  icon: LucideIcon
  trend?: {
    value: number
    label: string
  }
  subtitle?: string
  color?: 'rose' | 'blue' | 'green' | 'amber'
}

const colorMap = {
  rose: 'bg-rose-50 text-rose-600',
  blue: 'bg-blue-50 text-blue-600',
  green: 'bg-green-50 text-green-600',
  amber: 'bg-amber-50 text-amber-600',
}

export function StatCard({ title, value, icon: Icon, trend, subtitle, color = 'rose' }: StatCardProps) {
  return (
    <Card className="hover:shadow-md transition-shadow">
      <div className="flex items-start justify-between">
        <div>
          <p className="text-sm text-gray-500 mb-1">{title}</p>
          <p className="text-3xl font-bold text-gray-900">{value}</p>
          {trend && (
            <p className={cn(
              'text-xs mt-2',
              trend.value >= 0 ? 'text-green-600' : 'text-red-600'
            )}>
              {trend.value >= 0 ? '+' : ''}{trend.value}% {trend.label}
            </p>
          )}
          {subtitle && (
            <p className="text-xs mt-2 text-gray-500">{subtitle}</p>
          )}
        </div>
        <div className={cn('p-3 rounded-xl', colorMap[color])}>
          <Icon className="w-6 h-6" />
        </div>
      </div>
    </Card>
  )
}
</file>

<file path="components/dashboard/TodaysWatchlist.tsx">
import { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card'
import Link from 'next/link'
import { AlertTriangle, Clock } from 'lucide-react'
import type { WatchlistItem } from '@/lib/actions/dashboard'

interface TodaysWatchlistProps {
  items: WatchlistItem[]
}

export function TodaysWatchlist({ items }: TodaysWatchlistProps) {
  if (items.length === 0) {
    return (
      <Card>
        <CardHeader>
          <CardTitle className="flex items-center gap-2">
            <span>‚ö†Ô∏è</span> Today&apos;s Watchlist
          </CardTitle>
        </CardHeader>
        <CardContent>
          <div className="text-center py-6 text-gray-500">
            <AlertTriangle className="w-8 h-8 mx-auto mb-2 text-gray-300" />
            <p className="text-sm">No dogs requiring special attention today</p>
          </div>
        </CardContent>
      </Card>
    )
  }

  return (
    <Card>
      <CardHeader className="flex flex-row items-center justify-between">
        <CardTitle className="flex items-center gap-2">
          <span>‚ö†Ô∏è</span> Today&apos;s Watchlist
        </CardTitle>
        <span className="text-xs font-medium text-amber-600 bg-amber-50 px-2 py-1 rounded-full">
          {items.length} {items.length === 1 ? 'dog' : 'dogs'}
        </span>
      </CardHeader>
      <CardContent>
        <div className="space-y-3">
          {items.map((item) => (
            <Link
              href={`/dogs/${item.dogId}`}
              key={item.appointmentId}
              className="flex items-start gap-3 p-3 bg-amber-50/50 border border-amber-100 rounded-lg hover:bg-amber-100 transition-colors cursor-pointer"
            >
              <div className="p-1.5 bg-amber-100 rounded-md mt-0.5">
                <AlertTriangle className="w-3.5 h-3.5 text-amber-600" />
              </div>
              <div className="flex-1 min-w-0">
                <div className="flex items-center justify-between gap-2">
                  <span className="font-medium text-gray-900 truncate">
                    {item.dogName}
                  </span>
                  <div className="flex items-center gap-1 text-xs text-gray-500 flex-shrink-0">
                    <Clock className="w-3 h-3" />
                    {item.time}
                  </div>
                </div>
                <p className="text-sm text-amber-700 mt-0.5">
                  {item.reason}
                </p>
              </div>
            </Link>
          ))}
        </div>
      </CardContent>
    </Card>
  )
}
</file>

<file path="components/layout/AppShell.tsx">
import { Sidebar } from './Sidebar'
import { Header } from './Header'
import { KeyboardShortcuts } from './KeyboardShortcuts'

interface AppShellProps {
  children: React.ReactNode
  userEmail?: string
}

export function AppShell({ children, userEmail }: AppShellProps) {
  return (
    <div className="flex min-h-screen bg-gray-50">
      <KeyboardShortcuts />
      <Sidebar />
      <div className="flex-1 flex flex-col">
        <Header userEmail={userEmail} />
        <main className="flex-1 p-6 overflow-auto">
          {children}
        </main>
      </div>
    </div>
  )
}
</file>

<file path="components/layout/Header.tsx">
'use client'

import { Bell, Search } from 'lucide-react'
import { Button } from '@/components/ui/Button'
import LogoutButton from '@/components/LogoutButton'

interface HeaderProps {
  userEmail?: string
}

export function Header({ userEmail }: HeaderProps) {
  return (
    <header className="h-16 bg-white border-b border-gray-200 flex items-center justify-between px-6">
      <div className="flex items-center gap-4 flex-1">
        <div className="relative max-w-md w-full">
          <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400" />
          <input
            type="text"
            placeholder="Search dogs, appointments..."
            className="w-full pl-10 pr-4 py-2 bg-gray-50 border border-gray-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-rose-500/20 focus:border-rose-300 transition-all"
          />
        </div>
      </div>

      <div className="flex items-center gap-4">
        <Button variant="ghost" size="sm" className="relative">
          <Bell className="w-5 h-5" />
          <span className="absolute -top-1 -right-1 w-4 h-4 bg-rose-500 text-white text-xs rounded-full flex items-center justify-center">
            3
          </span>
        </Button>

        {userEmail && (
          <span className="text-sm text-gray-600 hidden sm:block">
            {userEmail}
          </span>
        )}

        <LogoutButton />
      </div>
    </header>
  )
}
</file>

<file path="components/ui/Badge.tsx">
import { cn } from '@/lib/utils'

interface BadgeProps {
  children: React.ReactNode
  variant?: 'default' | 'warning' | 'success' | 'info'
  className?: string
}

export function Badge({ children, variant = 'default', className }: BadgeProps) {
  return (
    <span
      className={cn(
        'inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium',
        {
          'bg-gray-100 text-gray-700': variant === 'default',
          'bg-amber-100 text-amber-700': variant === 'warning',
          'bg-green-100 text-green-700': variant === 'success',
          'bg-blue-100 text-blue-700': variant === 'info',
        },
        className
      )}
    >
      {children}
    </span>
  )
}
</file>

<file path="components/ui/Card.tsx">
import { cn } from '@/lib/utils'

interface CardProps {
  children: React.ReactNode
  className?: string
}

export function Card({ children, className }: CardProps) {
  return (
    <div className={cn('bg-white rounded-2xl shadow-sm border border-gray-100 p-6', className)}>
      {children}
    </div>
  )
}

export function CardHeader({ children, className }: CardProps) {
  return (
    <div className={cn('mb-4', className)}>
      {children}
    </div>
  )
}

export function CardTitle({ children, className }: { children: React.ReactNode; className?: string }) {
  return (
    <h3 className={cn('text-lg font-semibold text-gray-900', className)}>
      {children}
    </h3>
  )
}

export function CardContent({ children, className }: CardProps) {
  return (
    <div className={cn('', className)}>
      {children}
    </div>
  )
}
</file>

<file path="components/ui/Label.tsx">
import * as React from 'react'
import { cn } from '@/lib/utils'

export interface LabelProps extends React.LabelHTMLAttributes<HTMLLabelElement> {}

const Label = React.forwardRef<HTMLLabelElement, LabelProps>(
  ({ className, ...props }, ref) => {
    return (
      <label
        ref={ref}
        className={cn(
          'text-sm font-medium text-gray-700 leading-none',
          'peer-disabled:cursor-not-allowed peer-disabled:opacity-70',
          className
        )}
        {...props}
      />
    )
  }
)
Label.displayName = 'Label'

export { Label }
</file>

<file path="components/ui/Select.tsx">
'use client'

import * as React from 'react'
import { ChevronDown, Check } from 'lucide-react'
import { cn } from '@/lib/utils'

// Context for Select state
interface SelectContextValue {
  value: string
  onValueChange: (value: string) => void
  open: boolean
  setOpen: (open: boolean) => void
}

const SelectContext = React.createContext<SelectContextValue | null>(null)

function useSelectContext() {
  const context = React.useContext(SelectContext)
  if (!context) {
    throw new Error('Select components must be used within a Select')
  }
  return context
}

// Main Select wrapper
interface SelectProps {
  value?: string
  defaultValue?: string
  onValueChange?: (value: string) => void
  children: React.ReactNode
  disabled?: boolean
}

function Select({ value, defaultValue = '', onValueChange, children, disabled }: SelectProps) {
  const [internalValue, setInternalValue] = React.useState(defaultValue)
  const [open, setOpen] = React.useState(false)

  const currentValue = value !== undefined ? value : internalValue

  const handleValueChange = React.useCallback((newValue: string) => {
    if (disabled) return
    if (value === undefined) {
      setInternalValue(newValue)
    }
    onValueChange?.(newValue)
    setOpen(false)
  }, [disabled, value, onValueChange])

  return (
    <SelectContext.Provider value={{ value: currentValue, onValueChange: handleValueChange, open, setOpen }}>
      <div className="relative">
        {children}
      </div>
    </SelectContext.Provider>
  )
}

// Trigger button
interface SelectTriggerProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {
  children: React.ReactNode
}

const SelectTrigger = React.forwardRef<HTMLButtonElement, SelectTriggerProps>(
  ({ className, children, ...props }, ref) => {
    const { open, setOpen } = useSelectContext()

    return (
      <button
        ref={ref}
        type="button"
        onClick={() => setOpen(!open)}
        className={cn(
          'flex h-10 w-full items-center justify-between rounded-xl border border-gray-200 bg-white px-4 py-2 text-sm',
          'placeholder:text-gray-400',
          'focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-300',
          'disabled:cursor-not-allowed disabled:opacity-50 disabled:bg-gray-100',
          'transition-colors',
          className
        )}
        {...props}
      >
        {children}
        <ChevronDown className={cn('h-4 w-4 text-gray-400 transition-transform', open && 'rotate-180')} />
      </button>
    )
  }
)
SelectTrigger.displayName = 'SelectTrigger'

// Value display
interface SelectValueProps {
  placeholder?: string
}

function SelectValue({ placeholder }: SelectValueProps) {
  const { value } = useSelectContext()

  return (
    <span className={cn(!value && 'text-gray-400')}>
      {value || placeholder}
    </span>
  )
}

// Dropdown content
interface SelectContentProps {
  children: React.ReactNode
  className?: string
}

function SelectContent({ children, className }: SelectContentProps) {
  const { open, setOpen } = useSelectContext()
  const ref = React.useRef<HTMLDivElement>(null)

  // Close on click outside
  React.useEffect(() => {
    if (!open) return

    function handleClickOutside(event: MouseEvent) {
      if (ref.current && !ref.current.contains(event.target as Node)) {
        setOpen(false)
      }
    }

    document.addEventListener('mousedown', handleClickOutside)
    return () => document.removeEventListener('mousedown', handleClickOutside)
  }, [open, setOpen])

  if (!open) return null

  return (
    <div
      ref={ref}
      className={cn(
        'absolute z-50 mt-1 w-full rounded-xl border border-gray-200 bg-white py-1 shadow-lg',
        'max-h-60 overflow-auto',
        'animate-in fade-in-0 zoom-in-95',
        className
      )}
    >
      {children}
    </div>
  )
}

// Individual item
interface SelectItemProps {
  value: string
  children: React.ReactNode
  className?: string
  disabled?: boolean
}

function SelectItem({ value, children, className, disabled }: SelectItemProps) {
  const { value: selectedValue, onValueChange } = useSelectContext()
  const isSelected = selectedValue === value

  return (
    <div
      onClick={() => !disabled && onValueChange(value)}
      className={cn(
        'flex items-center justify-between px-4 py-2 text-sm cursor-pointer',
        'hover:bg-gray-50',
        isSelected && 'bg-blue-50 text-blue-600',
        disabled && 'opacity-50 cursor-not-allowed',
        className
      )}
    >
      <span>{children}</span>
      {isSelected && <Check className="h-4 w-4" />}
    </div>
  )
}

// Group for organizing items
interface SelectGroupProps {
  children: React.ReactNode
}

function SelectGroup({ children }: SelectGroupProps) {
  return <div className="py-1">{children}</div>
}

// Label for groups
interface SelectLabelProps {
  children: React.ReactNode
  className?: string
}

function SelectLabel({ children, className }: SelectLabelProps) {
  return (
    <div className={cn('px-4 py-1.5 text-xs font-semibold text-gray-500 uppercase', className)}>
      {children}
    </div>
  )
}

// Separator
function SelectSeparator() {
  return <div className="my-1 h-px bg-gray-200" />
}

export {
  Select,
  SelectTrigger,
  SelectValue,
  SelectContent,
  SelectItem,
  SelectGroup,
  SelectLabel,
  SelectSeparator,
}
</file>

<file path="components/DashboardView.tsx">
'use client'

import { useState } from 'react'
import AddDogForm from './AddDogForm'
import DogList from './DogList'
import DogDetail from './DogDetail'
import { Dog } from '@/app/types'

export default function DashboardView() {
  const [selectedDog, setSelectedDog] = useState<Dog | null>(null)
  const [refreshKey, setRefreshKey] = useState(0)
  const [showAddForm, setShowAddForm] = useState(false)

  const handleDogAdded = () => {
    setRefreshKey(prev => prev + 1)
    setShowAddForm(false)
  }

  const handleSelectDog = (dog: Dog) => {
    setSelectedDog(dog)
  }

  const handleCloseDogDetail = () => {
    setSelectedDog(null)
  }

  return (
    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
      {/* Left Column */}
      <div>
        {!showAddForm ? (
          <div>
            <button
              onClick={() => setShowAddForm(true)}
              className="w-full mb-4 flex justify-center items-center gap-2 py-4 px-6 border border-transparent rounded-xl shadow-lg text-lg font-semibold text-white bg-gradient-to-r from-pink-500 to-rose-500 hover:from-pink-600 hover:to-rose-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pink-500 min-h-[52px] transition-all duration-200 transform hover:scale-[1.02]"
            >
              <span className="text-2xl">üêï</span>
              Add New Pup
            </button>
            <DogList key={refreshKey} onSelectDog={handleSelectDog} />
          </div>
        ) : (
          <div>
            <button
              onClick={() => setShowAddForm(false)}
              className="mb-4 px-5 py-3 text-sm font-medium text-rose-700 bg-rose-50 rounded-lg hover:bg-rose-100 min-h-[44px] transition-colors"
            >
              ‚Üê Back to Dogs
            </button>
            <AddDogForm onDogAdded={handleDogAdded} />
          </div>
        )}
      </div>

      {/* Right Column */}
      <div>
        {selectedDog ? (
          <DogDetail dog={selectedDog} onClose={handleCloseDogDetail} />
        ) : (
          <div className="bg-gradient-to-br from-pink-50 to-rose-50 rounded-2xl shadow-lg p-8 text-center border-2 border-pink-100">
            <div className="text-6xl mb-4">üêæ</div>
            <p className="text-2xl font-semibold text-gray-800 mb-3">Welcome to GroomGroove!</p>
            <p className="text-gray-600 leading-relaxed">Select a furry friend from the list to view their grooming details, or add a new pup to get started.</p>
          </div>
        )}
      </div>
    </div>
  )
}
</file>

<file path="components/DogList.tsx">
'use client'

import { useState, useEffect } from 'react'
import { createClient } from '@/utils/supabase/client'
import { Dog } from '@/app/types'

export default function DogList({ onSelectDog }: { onSelectDog?: (dog: Dog) => void }) {
  const [dogs, setDogs] = useState<Dog[]>([])
  const [loading, setLoading] = useState(true)
  const [searchTerm, setSearchTerm] = useState('')

  useEffect(() => {
    loadDogs()
  }, [])

  const loadDogs = async () => {
    setLoading(true)
    const supabase = createClient()
    const { data: { user } } = await supabase.auth.getUser()

    if (!user) return

    const { data, error } = await supabase
      .from('dogs')
      .select('*')
      .eq('user_id', user.id)
      .order('created_at', { ascending: false })

    if (!error && data) {
      setDogs(data)
    }
    setLoading(false)
  }

  const filteredDogs = dogs.filter(dog =>
    dog.dog_name.toLowerCase().includes(searchTerm.toLowerCase()) ||
    dog.owner_name.toLowerCase().includes(searchTerm.toLowerCase()) ||
    (dog.breed && dog.breed.toLowerCase().includes(searchTerm.toLowerCase()))
  )

  if (loading) {
    return (
      <div className="bg-white rounded-2xl shadow-lg p-6 border-2 border-pink-100">
        <p className="text-center text-gray-500">Loading adorable pups... üê∂</p>
      </div>
    )
  }

  return (
    <div className="bg-white rounded-2xl shadow-lg p-6 border-2 border-pink-100">
      <div className="flex justify-between items-center mb-5">
        <h2 className="text-2xl font-bold text-gray-800 flex items-center gap-2">
          <span className="text-2xl">üêæ</span>
          My Dogs
        </h2>
        <span className="text-sm font-medium text-rose-600 bg-rose-100 px-3 py-1 rounded-full">{dogs.length} pups</span>
      </div>

      <div className="mb-5">
        <input
          type="text"
          placeholder="üîç Search by name, owner, or breed..."
          className="w-full rounded-xl border-2 border-pink-200 p-3 text-gray-900 shadow-sm focus:border-pink-400 focus:ring-pink-400 min-h-[44px] placeholder:text-gray-400"
          value={searchTerm}
          onChange={(e) => setSearchTerm(e.target.value)}
        />
      </div>

      {filteredDogs.length === 0 ? (
        <div className="text-center text-gray-500 py-12 bg-gradient-to-br from-pink-50 to-rose-50 rounded-xl">
          <div className="text-5xl mb-3">üêï</div>
          <p className="font-medium">
            {searchTerm ? 'No pups match your search.' : 'No pups yet! Add your first furry friend above.'}
          </p>
        </div>
      ) : (
        <div className="space-y-3 max-h-[600px] overflow-y-auto pr-2">
          {filteredDogs.map((dog) => (
            <div
              key={dog.id}
              onClick={() => onSelectDog && onSelectDog(dog)}
              className="border-2 border-pink-100 rounded-xl p-4 hover:bg-gradient-to-r hover:from-pink-50 hover:to-rose-50 cursor-pointer transition-all duration-200 hover:shadow-md hover:border-pink-200"
            >
              <div className="flex justify-between items-start">
                <div className="flex-1">
                  <h3 className="font-bold text-gray-900 text-lg flex items-center gap-2">
                    <span>üêï</span>
                    {dog.dog_name}
                  </h3>
                  <p className="text-gray-600 font-medium">{dog.owner_name}</p>
                  {dog.breed && <p className="text-sm text-gray-500 italic">{dog.breed}</p>}
                </div>
                <div className="text-right">
                  {dog.clipper_blade_size && (
                    <span className="inline-block bg-gradient-to-r from-purple-100 to-pink-100 text-purple-800 text-xs font-semibold px-3 py-1 rounded-full">
                      ‚úÇÔ∏è {dog.clipper_blade_size}
                    </span>
                  )}
                </div>
              </div>

              {(dog.owner_phone || dog.owner_email) && (
                <div className="mt-3 text-sm text-gray-600 space-y-1">
                  {dog.owner_phone && <div className="flex items-center gap-1">üìû {dog.owner_phone}</div>}
                  {dog.owner_email && <div className="flex items-center gap-1">‚úâÔ∏è {dog.owner_email}</div>}
                </div>
              )}
            </div>
          ))}
        </div>
      )}
    </div>
  )
}
</file>

<file path="components/LogoutButton.tsx">
'use client'

import { createClient } from '@/utils/supabase/client'
import { useRouter } from 'next/navigation'

export default function LogoutButton() {
  const router = useRouter()

  const handleLogout = async () => {
    const supabase = createClient()
    await supabase.auth.signOut()
    router.push('/login')
    router.refresh()
  }

  return (
    <button
      onClick={handleLogout}
      className="px-5 py-3 text-sm font-medium text-rose-700 bg-white/80 backdrop-blur-sm border-2 border-rose-200 rounded-xl hover:bg-rose-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-500 min-h-[44px] shadow-md transition-all duration-200"
    >
      üëã Logout
    </button>
  )
}
</file>

<file path="components/PhotoUploader.tsx">
'use client'

import { useState } from 'react'
import { createClient } from '@/utils/supabase/client'
import { Upload, Camera, X } from 'lucide-react'

export default function PhotoUploader({ dogs }: { dogs: any[] }) {
  const [showModal, setShowModal] = useState(false)
  const [selectedFile, setSelectedFile] = useState<File | null>(null)
  const [selectedDogId, setSelectedDogId] = useState('')
  const [uploading, setUploading] = useState(false)
  const [previewUrl, setPreviewUrl] = useState<string | null>(null)
  const supabase = createClient()

  // Handle file selection (happens FIRST)
  const handleFileSelected = (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0]
    if (!file) return

    setSelectedFile(file)
    setPreviewUrl(URL.createObjectURL(file))
    setShowModal(true) // Show dog selection modal
  }

  // Handle upload (happens AFTER dog selection)
  const handleUpload = async () => {
    if (!selectedFile || !selectedDogId) return

    setUploading(true)

    try {
      const fileExt = selectedFile.name.split('.').pop()
      const fileName = `${Date.now()}-${Math.random()}.${fileExt}`
      const filePath = `${selectedDogId}/${fileName}`

      const { error: uploadError } = await supabase.storage
        .from('dog-photos')
        .upload(filePath, selectedFile)

      if (uploadError) throw uploadError

      const { data: { publicUrl } } = supabase.storage
        .from('dog-photos')
        .getPublicUrl(filePath)

      const { error: updateError } = await supabase
        .from('dogs')
        .update({ photo_url: publicUrl })
        .eq('id', selectedDogId)

      if (updateError) throw updateError

      alert('‚úÖ Photo uploaded successfully!')
      window.location.reload()
    } catch (error: any) {
      alert(`Upload failed: ${error.message}`)
    } finally {
      setUploading(false)
    }
  }

  const handleCancel = () => {
    setShowModal(false)
    setSelectedFile(null)
    setPreviewUrl(null)
    setSelectedDogId('')
  }

  return (
    <>
      {/* Always-Active Upload Buttons */}
      <div className="bg-gradient-to-r from-blue-50 to-purple-50 border-2 border-dashed border-blue-300 rounded-xl p-8 mb-6">
        <div className="text-center space-y-4">
          <div className="flex items-center justify-center gap-2 text-blue-900">
            <Camera className="h-6 w-6" />
            <h3 className="text-lg font-semibold">Add Dog Photos</h3>
          </div>
          <p className="text-gray-600 text-sm">
            Upload photos from your computer or take new ones with your camera
          </p>
          
          <div className="flex gap-4 justify-center">
            {/* Upload from Files */}
            <label className="cursor-pointer">
              <input
                type="file"
                accept="image/*"
                onChange={handleFileSelected}
                className="hidden"
              />
              <div className="px-6 py-3 bg-white border-2 border-blue-500 text-blue-600 rounded-lg hover:bg-blue-50 transition-colors font-medium flex items-center gap-2">
                <Upload className="h-5 w-5" />
                Upload Photo
              </div>
            </label>

            {/* Take Photo */}
            <label className="cursor-pointer">
              <input
                type="file"
                accept="image/*"
                capture="environment"
                onChange={handleFileSelected}
                className="hidden"
              />
              <div className="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium flex items-center gap-2">
                <Camera className="h-5 w-5" />
                Take Photo
              </div>
            </label>
          </div>
        </div>
      </div>

      {/* Modal: Select Dog AFTER Photo Chosen */}
      {showModal && (
        <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
          <div className="bg-white rounded-xl shadow-2xl max-w-md w-full p-6 space-y-4">
            <div className="flex items-center justify-between">
              <h3 className="text-xl font-bold text-gray-900">Which dog is this?</h3>
              <button
                onClick={handleCancel}
                className="text-gray-400 hover:text-gray-600"
              >
                <X className="h-6 w-6" />
              </button>
            </div>

            {/* Photo Preview */}
            {previewUrl && (
              <div className="relative w-full h-48 bg-gray-100 rounded-lg overflow-hidden">
                <img
                  src={previewUrl}
                  alt="Preview"
                  className="w-full h-full object-cover"
                />
              </div>
            )}

            {/* Dog Selection */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Select Dog
              </label>
              <select
                value={selectedDogId}
                onChange={(e) => setSelectedDogId(e.target.value)}
                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                disabled={uploading}
              >
                <option value="">Choose a dog...</option>
                {dogs.map((dog) => (
                  <option key={dog.id} value={dog.id}>
                    {dog.name} {dog.customer_name ? `(${dog.customer_name})` : ''}
                  </option>
                ))}
              </select>
            </div>

            {/* Action Buttons */}
            <div className="flex gap-3">
              <button
                onClick={handleCancel}
                disabled={uploading}
                className="flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50"
              >
                Cancel
              </button>
              <button
                onClick={handleUpload}
                disabled={uploading || !selectedDogId}
                className="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium"
              >
                {uploading ? 'Uploading...' : 'Upload Photo'}
              </button>
            </div>
          </div>
        </div>
      )}
    </>
  )
}
</file>

<file path="lib/actions/checkout.ts">
'use server'

// Checkout Action
// Creates payment record and optional next appointment

import { createClient } from '@/utils/supabase/server'
import { generateReceiptNumber } from '@/lib/utils/receipt'
import { sendConfirmationSMS } from '@/lib/sms/send'

interface CheckoutInput {
  customerId: string
  dogId: string
  completedAppointmentId?: string // The appointment just finished (optional)
  services: string[]
  amountCents: number
  nextAppointment?: {
    scheduledAt: string // ISO datetime
    services: string[]
  }
  reminderDate?: string // YYYY-MM-DD format for SMS reminder
}

interface CheckoutResult {
  success: boolean
  paymentId?: string
  receiptNumber?: string
  nextAppointmentId?: string
  error?: string
}

/**
 * Complete checkout process:
 * 1. Mark current appointment as completed
 * 2. Create payment record
 * 3. Optionally create next appointment with reminder date
 * 4. Send confirmation SMS if next appointment created
 */
export async function completeCheckout(input: CheckoutInput): Promise<CheckoutResult> {
  const supabase = await createClient()

  let nextAppointmentId: string | null = null

  try {
    // STEP 1: Create next appointment if proposed
    if (input.nextAppointment) {
      const { data: appointment, error: apptError } = await supabase
        .from('appointments')
        .insert({
          customer_id: input.customerId,
          dog_id: input.dogId,
          scheduled_at: input.nextAppointment.scheduledAt,
          status: 'pending_confirmation',
          services: input.nextAppointment.services,
          reminder_date: input.reminderDate || null,
          reminder_sent: false,
          created_at: new Date().toISOString(),
          updated_at: new Date().toISOString(),
        })
        .select('id')
        .single()

      if (apptError) {
        console.error('[Checkout] Failed to create appointment:', apptError)
        return { success: false, error: 'Failed to create next appointment' }
      }

      nextAppointmentId = appointment.id
    }

    // STEP 2: Generate receipt number
    const receiptNumber = generateReceiptNumber()

    // STEP 3: Create payment record
    const { data: payment, error: paymentError } = await supabase
      .from('payments')
      .insert({
        customer_id: input.customerId,
        appointment_id: input.completedAppointmentId || null,
        next_appointment_id: nextAppointmentId,
        amount_cents: input.amountCents,
        services: input.services,
        receipt_number: receiptNumber,
        reminder_date: input.reminderDate || null,
        paid_at: new Date().toISOString(),
      })
      .select('id')
      .single()

    if (paymentError) {
      console.error('[Checkout] Failed to create payment:', paymentError)
      // Rollback: delete appointment if payment failed
      if (nextAppointmentId) {
        await supabase.from('appointments').delete().eq('id', nextAppointmentId)
      }
      return { success: false, error: 'Failed to create payment' }
    }

    // STEP 4: Mark completed appointment as done (if provided)
    if (input.completedAppointmentId) {
      await supabase
        .from('appointments')
        .update({
          status: 'completed',
          updated_at: new Date().toISOString(),
        })
        .eq('id', input.completedAppointmentId)
    }

    // STEP 5: Send confirmation SMS for next appointment
    if (nextAppointmentId) {
      // Fire and forget - don't block checkout on SMS
      sendConfirmationSMS({
        appointmentId: nextAppointmentId,
        customerId: input.customerId,
      }).catch(err => {
        console.error('[Checkout] SMS send failed:', err)
      })
    }

    return {
      success: true,
      paymentId: payment.id,
      receiptNumber,
      nextAppointmentId: nextAppointmentId || undefined,
    }
  } catch (error: unknown) {
    console.error('[Checkout] Unexpected error:', error)
    return { success: false, error: error instanceof Error ? error.message : 'Unknown error' }
  }
}

/**
 * Get receipt data for display/printing
 */
export async function getReceiptData(paymentId: string) {
  const supabase = await createClient()

  const { data: payment, error } = await supabase
    .from('payments')
    .select(`
      *,
      customer:customers(*),
      next_appointment:appointments!next_appointment_id(
        *,
        dog:dogs(*)
      )
    `)
    .eq('id', paymentId)
    .single()

  if (error || !payment) {
    return null
  }

  const customer = Array.isArray(payment.customer) ? payment.customer[0] : payment.customer
  const nextAppt = Array.isArray(payment.next_appointment) ? payment.next_appointment[0] : payment.next_appointment

  return {
    receiptNumber: payment.receipt_number,
    customerName: customer?.name,
    services: payment.services,
    amountCents: payment.amount_cents,
    paidAt: payment.paid_at,
    nextAppointment: nextAppt ? {
      scheduledAt: nextAppt.scheduled_at,
      dogName: nextAppt.dog?.name,
      services: nextAppt.services,
      status: nextAppt.status,
      reminderDate: nextAppt.reminder_date,
    } : null,
  }
}
</file>

<file path="lib/actions/client-intake.ts">
'use server'

import { createClient } from '@/utils/supabase/server'
import { revalidatePath } from 'next/cache'

export interface NewClientWithDogInput {
  owner: {
    firstName: string
    lastName: string
    phone: string
    email?: string
  }
  dog: {
    name: string
    breed?: string
    weight?: string
    notes?: string
  }
}

export async function createClientWithDog(
  input: NewClientWithDogInput
): Promise<{ success: boolean; error?: string; dogId?: string }> {
  const supabase = await createClient()

  const {
    data: { user },
  } = await supabase.auth.getUser()

  if (!user) {
    return { success: false, error: 'Unauthorized' }
  }

  const fullName = `${input.owner.firstName} ${input.owner.lastName}`.trim()

  const { data: customer, error: customerError } = await supabase
    .from('customers')
    .insert({
      name: fullName,
      phone: input.owner.phone,
      email: input.owner.email || null,
      user_id: user.id,
    })
    .select('id')
    .single()

  if (customerError) {
    return { success: false, error: customerError.message }
  }

  const { data: dog, error: dogError } = await supabase
    .from('dogs')
    .insert({
      name: input.dog.name,
      breed: input.dog.breed || null,
      weight: input.dog.weight ? Number(input.dog.weight) : null,
      notes: input.dog.notes || null,
      customer_id: customer.id,
      user_id: user.id,
    })
    .select('id')
    .single()

  if (dogError) {
    return { success: false, error: dogError.message }
  }

  revalidatePath('/clients')
  revalidatePath('/dogs')

  return { success: true, dogId: dog.id }
}
</file>

<file path="lib/constants/grooming.ts">
export const BLADE_SIZES = [
  { value: '3F', label: '3F (13mm) - Longer Body' },
  { value: '4F', label: '4F (10mm) - Winter Trim' },
  { value: '5f', label: '5f (6mm) - Short Puppy Cut' },
  { value: '7f', label: '7f (3mm) - Summer Cut / Matted' },
  { value: '10', label: '10 (1.8mm) - Sanitary / Paws' },
  { value: '15', label: '15 (1.2mm) - Pads' },
  { value: '30', label: '30 (0.5mm) - Under Comb' },
  { value: 'custom', label: 'Custom (see notes)' },
] as const;

export type BladeSizeValue = typeof BLADE_SIZES[number]['value'];

/**
 * Returns the descriptive label for a given blade size value.
 */
export function getBladeSizeLabel(value: string | null | undefined): string {
  if (!value) return 'Not specified';
  const size = BLADE_SIZES.find(s => s.value === value);
  return size ? size.label : value;
}
</file>

<file path="lib/mock/appointments.ts">
// Mock appointments data for calendar functionality
// Structured for easy filtering by date (YYYY-MM-DD)

export interface CalendarAppointment {
  id: string
  date: string // YYYY-MM-DD
  time: string // HH:MM AM/PM
  dogId: string
  dogName: string
  ownerName: string
  service: string
  status: 'scheduled' | 'completed' | 'cancelled'
  notes?: string
}

export const mockAppointments: CalendarAppointment[] = [
  // January 2026 appointments
  {
    id: 'appt-1',
    date: '2026-01-15',
    time: '9:00 AM',
    dogId: 'dog-1',
    dogName: 'Bella',
    ownerName: 'Sarah Johnson',
    service: 'Full Groom',
    status: 'scheduled',
    notes: 'First visit, anxious about blow dryer'
  },
  {
    id: 'appt-2',
    date: '2026-01-15',
    time: '10:30 AM',
    dogId: 'dog-2',
    dogName: 'Max',
    ownerName: 'Mike Chen',
    service: 'Bath & Brush',
    status: 'scheduled'
  },
  {
    id: 'appt-3',
    date: '2026-01-15',
    time: '2:00 PM',
    dogId: 'dog-3',
    dogName: 'Daisy',
    ownerName: 'Emma Wilson',
    service: 'Full Groom + Nail Trim',
    status: 'completed'
  },
  {
    id: 'appt-4',
    date: '2026-01-16',
    time: '11:00 AM',
    dogId: 'dog-4',
    dogName: 'Rocky',
    ownerName: 'James Brown',
    service: 'Nail Trim Only',
    status: 'scheduled',
    notes: 'Nail sensitive, needs extra care'
  },
  {
    id: 'appt-5',
    date: '2026-01-16',
    time: '3:30 PM',
    dogId: 'dog-5',
    dogName: 'Luna',
    ownerName: 'Lisa Park',
    service: 'De-shedding Treatment',
    status: 'scheduled'
  },
  {
    id: 'appt-6',
    date: '2026-01-17',
    time: '8:30 AM',
    dogId: 'dog-6',
    dogName: 'Charlie',
    ownerName: 'Robert Davis',
    service: 'Teeth Cleaning',
    status: 'cancelled',
    notes: 'Owner sick, rescheduled for next week'
  },
  {
    id: 'appt-7',
    date: '2026-01-17',
    time: '1:00 PM',
    dogId: 'dog-1',
    dogName: 'Bella',
    ownerName: 'Sarah Johnson',
    service: 'Ear Cleaning',
    status: 'scheduled'
  },
  {
    id: 'appt-8',
    date: '2026-01-18',
    time: '10:00 AM',
    dogId: 'dog-7',
    dogName: 'Milo',
    ownerName: 'Jennifer Lee',
    service: 'Full Groom',
    status: 'scheduled'
  },
  {
    id: 'appt-9',
    date: '2026-01-18',
    time: '4:00 PM',
    dogId: 'dog-2',
    dogName: 'Max',
    ownerName: 'Mike Chen',
    service: 'Bath & Brush',
    status: 'scheduled'
  },
  {
    id: 'appt-10',
    date: '2026-01-20',
    time: '9:30 AM',
    dogId: 'dog-8',
    dogName: 'Coco',
    ownerName: 'Alex Turner',
    service: 'Full Groom',
    status: 'scheduled'
  },
  {
    id: 'appt-11',
    date: '2026-01-20',
    time: '2:30 PM',
    dogId: 'dog-9',
    dogName: 'Buddy',
    ownerName: 'Maria Garcia',
    service: 'De-shedding Treatment',
    status: 'scheduled'
  },
  {
    id: 'appt-12',
    date: '2026-01-22',
    time: '11:30 AM',
    dogId: 'dog-10',
    dogName: 'Lucy',
    ownerName: 'Thomas White',
    service: 'Nail Trim Only',
    status: 'scheduled'
  },
  {
    id: 'appt-13',
    date: '2026-01-23',
    time: '3:00 PM',
    dogId: 'dog-3',
    dogName: 'Daisy',
    ownerName: 'Emma Wilson',
    service: 'Bath & Brush',
    status: 'scheduled'
  },
  {
    id: 'appt-14',
    date: '2026-01-25',
    time: '10:30 AM',
    dogId: 'dog-4',
    dogName: 'Rocky',
    ownerName: 'James Brown',
    service: 'Full Groom',
    status: 'scheduled'
  },
  {
    id: 'appt-15',
    date: '2026-01-28',
    time: '1:30 PM',
    dogId: 'dog-5',
    dogName: 'Luna',
    ownerName: 'Lisa Park',
    service: 'Bath & Brush',
    status: 'scheduled'
  }
]

// Helper functions
export function getAppointmentsForDate(date: string): CalendarAppointment[] {
  return mockAppointments.filter(appt => appt.date === date)
}

export function getAppointmentsForWeek(startDate: string, endDate: string): CalendarAppointment[] {
  return mockAppointments.filter(appt => {
    return appt.date >= startDate && appt.date <= endDate
  })
}

export function formatDateForDisplay(dateStr: string): string {
  const date = new Date(dateStr + 'T00:00:00')
  return date.toLocaleDateString('en-US', {
    weekday: 'long',
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  })
}

export function getWeekRange(date: Date): { start: string; end: string } {
  const start = new Date(date)
  const day = start.getDay()
  start.setDate(start.getDate() - day)
  
  const end = new Date(start)
  end.setDate(end.getDate() + 6)
  
  return {
    start: start.toISOString().split('T')[0],
    end: end.toISOString().split('T')[0]
  }
}
</file>

<file path="lib/mock/customers.ts">
// Mock data for customers - will be replaced with real DB calls later

export const mockCustomerStats = {
  totalCustomers: 32,
  activeThisMonth: 18,
  avgSpendPerCustomer: 86.40,
}

export const mockCustomers = [
  {
    id: '1',
    name: 'Sarah Miller',
    email: 'sarah@email.com',
    phone: '(555) 123-4567',
    dogs: ['Bella'],
    lastVisit: 'Jan 6',
    lifetimeSpend: 420,
    customerSince: 'Aug 2024',
    status: 'active' as const,
  },
  {
    id: '2',
    name: 'John Davis',
    email: 'john@email.com',
    phone: '(555) 234-5678',
    dogs: ['Max', 'Rocky'],
    lastVisit: 'Jan 3',
    lifetimeSpend: 780,
    customerSince: 'Mar 2024',
    status: 'vip' as const,
  },
  {
    id: '3',
    name: 'Emily Chen',
    email: 'emily@email.com',
    phone: '(555) 345-6789',
    dogs: ['Luna'],
    lastVisit: 'Dec 18',
    lifetimeSpend: 95,
    customerSince: 'Dec 2024',
    status: 'inactive' as const,
  },
  {
    id: '4',
    name: 'Mike Chen',
    email: 'mike@email.com',
    phone: '(555) 456-7890',
    dogs: ['Max'],
    lastVisit: 'Jan 3',
    lifetimeSpend: 340,
    customerSince: 'Jun 2024',
    status: 'active' as const,
  },
  {
    id: '5',
    name: 'Emma Wilson',
    email: 'emma@email.com',
    phone: '(555) 567-8901',
    dogs: ['Daisy'],
    lastVisit: 'Jan 7',
    lifetimeSpend: 620,
    customerSince: 'Apr 2024',
    status: 'vip' as const,
  },
]

export type Customer = typeof mockCustomers[number]
export type CustomerStatus = 'active' | 'vip' | 'inactive'
</file>

<file path="lib/mock/dashboard.ts">
// Mock data for dashboard - will be replaced with real DB calls later

export const mockStats = {
  todayAppointments: 8,
  totalDogs: 47,
  pendingConfirmations: 3,
}

export const mockStaffOnDuty = [
  {
    id: '1',
    name: 'Jessica Martinez',
    status: 'working' as const,
  },
  {
    id: '2',
    name: 'David Kim',
    status: 'working' as const,
  },
  {
    id: '3',
    name: 'Ashley Thompson',
    status: 'break' as const,
  },
]

export type StaffMember = typeof mockStaffOnDuty[number]

export const mockTodayAppointments = [
  {
    id: '1',
    time: '9:00 AM',
    dogName: 'Bella',
    breed: 'Golden Retriever',
    ownerName: 'Sarah Johnson',
    service: 'Full Groom',
    flags: ['first-visit'],
    status: 'confirmed' as const,
  },
  {
    id: '2',
    time: '10:30 AM',
    dogName: 'Max',
    breed: 'German Shepherd',
    ownerName: 'Mike Chen',
    service: 'Bath & Brush',
    flags: ['anxious'],
    status: 'confirmed' as const,
  },
  {
    id: '3',
    time: '12:00 PM',
    dogName: 'Daisy',
    breed: 'Poodle',
    ownerName: 'Emma Wilson',
    service: 'Full Groom + Nail Trim',
    flags: [],
    status: 'in-progress' as const,
  },
  {
    id: '4',
    time: '2:00 PM',
    dogName: 'Rocky',
    breed: 'Bulldog',
    ownerName: 'James Brown',
    service: 'Nail Trim Only',
    flags: ['nail-sensitive'],
    status: 'pending' as const,
  },
  {
    id: '5',
    time: '3:30 PM',
    dogName: 'Luna',
    breed: 'Husky',
    ownerName: 'Lisa Park',
    service: 'De-shedding Treatment',
    flags: ['heavy-shedder'],
    status: 'pending' as const,
  },
]

export const mockQuickActions = [
  { id: 'new-appointment', label: 'New Appointment', icon: 'calendar-plus' },
  { id: 'add-dog', label: 'Add Dog', icon: 'dog' },
  { id: 'send-reminder', label: 'Send Reminders', icon: 'bell' },
  { id: 'view-reports', label: 'View Reports', icon: 'chart' },
]

export type Appointment = typeof mockTodayAppointments[number]
export type Stats = typeof mockStats
</file>

<file path="lib/sms/provider.ts">
// SMS Provider Abstraction
// Twilio-style implementation - swap provider by changing this file

interface SendSMSParams {
  to: string
  body: string
}

interface SendSMSResult {
  success: boolean
  messageId?: string
  error?: string
}

interface SMSProvider {
  send(params: SendSMSParams): Promise<SendSMSResult>
}

// Twilio implementation
class TwilioProvider implements SMSProvider {
  private accountSid: string
  private authToken: string
  private fromNumber: string

  constructor() {
    this.accountSid = process.env.TWILIO_ACCOUNT_SID || ''
    this.authToken = process.env.TWILIO_AUTH_TOKEN || ''
    this.fromNumber = process.env.TWILIO_PHONE_NUMBER || ''
  }

  async send({ to, body }: SendSMSParams): Promise<SendSMSResult> {
    // In production, use actual Twilio SDK
    // For now, log and simulate success
    if (!this.accountSid || !this.authToken || !this.fromNumber) {
      console.log('[SMS Mock] Would send to:', to)
      console.log('[SMS Mock] Message:', body)
      return { success: true, messageId: `mock-${Date.now()}` }
    }

    try {
      // Production Twilio implementation:
      // const twilio = require('twilio')(this.accountSid, this.authToken)
      // const message = await twilio.messages.create({
      //   body,
      //   from: this.fromNumber,
      //   to,
      // })
      // return { success: true, messageId: message.sid }

      // Mock for development
      console.log('[SMS] Sending to:', to)
      console.log('[SMS] Message:', body)
      return { success: true, messageId: `twilio-${Date.now()}` }
    } catch (error: any) {
      console.error('[SMS Error]', error)
      return { success: false, error: error.message }
    }
  }
}

// Export singleton instance
export const smsProvider: SMSProvider = new TwilioProvider()
</file>

<file path="lib/stripe/utils.ts">
import { createClient } from '@/utils/supabase/server';

/**
 * Check if a user has an active subscription
 */
export async function isUserPro(userId: string): Promise<boolean> {
  const supabase = await createClient();
  
  const { data: subscription } = await supabase
    .from('user_subscriptions')
    .select('status')
    .eq('user_id', userId)
    .single();

  return subscription?.status === 'active' || subscription?.status === 'trialing';
}

/**
 * Get user's subscription details
 */
export async function getUserSubscription(userId: string) {
  const supabase = await createClient();
  
  const { data: subscription } = await supabase
    .from('user_subscriptions')
    .select('*')
    .eq('user_id', userId)
    .single();

  return subscription;
}

/**
 * Get the Stripe customer portal URL for a user to manage their subscription
 */
export async function getCustomerPortalUrl(userId: string, returnUrl: string) {
  const supabase = await createClient();
  
  const { data: subscription } = await supabase
    .from('user_subscriptions')
    .select('stripe_customer_id')
    .eq('user_id', userId)
    .single();

  if (!subscription?.stripe_customer_id) {
    throw new Error('User does not have a Stripe customer ID');
  }

  const { stripe } = await import('./client');
  
  const session = await stripe.billingPortal.sessions.create({
    customer: subscription.stripe_customer_id,
    return_url: returnUrl,
  });

  return session.url;
}
</file>

<file path="lib/types/appointments.ts">
// Database types for appointment confirmation system
// These match the approved schema from STEP 1

export type AppointmentStatus = 'pending_confirmation' | 'confirmed' | 'cancelled'

export interface Appointment {
  id: string
  customer_id: string
  dog_id: string
  scheduled_at: string // ISO datetime
  status: AppointmentStatus
  services: string[]
  notes?: string
  created_at: string
  updated_at: string
  confirmed_at?: string
  cancelled_at?: string
}

export interface Customer {
  id: string
  name: string
  email: string
  phone?: string
  sms_consent: boolean
}

export interface Dog {
  id: string
  customer_id: string
  name: string
  breed?: string
  notes?: string
}

export interface Payment {
  id: string
  customer_id: string
  appointment_id?: string // The completed appointment
  next_appointment_id?: string // The proposed next appointment
  amount_cents: number
  services: string[]
  paid_at: string
  receipt_number: string
}

export type SMSNotificationType = 'confirmation_request' | 'reminder'

export interface SMSNotification {
  id: string
  appointment_id: string
  type: SMSNotificationType
  sent_at: string
  delivered: boolean
  customer_response?: 'YES' | 'NO'
  response_at?: string
}

// Joined types for queries
export interface AppointmentWithRelations extends Appointment {
  customer: Customer
  dog: Dog
}

export interface PaymentWithRelations extends Payment {
  customer: Customer
  appointment?: Appointment
  next_appointment?: Appointment
}
</file>

<file path="lib/utils/date.ts">
/**
 * Safe date utilities to prevent "Invalid time value" errors
 */

/**
 * Safely parse a date value, returning null if invalid
 */
export function safeParseDate(value: string | Date | null | undefined): Date | null {
  if (!value) return null

  try {
    const date = value instanceof Date ? value : new Date(value)
    return isNaN(date.getTime()) ? null : date
  } catch {
    return null
  }
}

/**
 * Format a time string safely, with fallback
 */
export function formatTime(
  value: string | Date | null | undefined,
  fallback = 'Time N/A'
): string {
  const date = safeParseDate(value)
  if (!date) return fallback

  return date.toLocaleTimeString('en-US', {
    hour: 'numeric',
    minute: '2-digit',
    hour12: true,
  })
}

/**
 * Format a date string safely, with fallback
 */
export function formatDate(
  value: string | Date | null | undefined,
  fallback = 'Date N/A'
): string {
  const date = safeParseDate(value)
  if (!date) return fallback

  return date.toLocaleDateString('en-US', {
    weekday: 'short',
    month: 'short',
    day: 'numeric',
  })
}

/**
 * Format a full date with time safely
 */
export function formatDateTime(
  value: string | Date | null | undefined,
  fallback = 'N/A'
): string {
  const date = safeParseDate(value)
  if (!date) return fallback

  return date.toLocaleString('en-US', {
    weekday: 'short',
    month: 'short',
    day: 'numeric',
    hour: 'numeric',
    minute: '2-digit',
    hour12: true,
  })
}

/**
 * Format date for display (e.g., "Friday, January 17")
 */
export function formatDateForDisplay(
  value: string | Date | null | undefined,
  fallback = 'Date N/A'
): string {
  const date = safeParseDate(value)
  if (!date) return fallback

  return date.toLocaleDateString('en-US', {
    weekday: 'long',
    month: 'long',
    day: 'numeric',
  })
}

/**
 * Safely convert a date string (YYYY-MM-DD) to a Date object
 * Handles timezone issues by explicitly setting time to noon
 */
export function parseDateString(dateStr: string | null | undefined): Date | null {
  if (!dateStr) return null

  try {
    // Add time component to avoid timezone issues
    const date = new Date(dateStr + 'T12:00:00')
    return isNaN(date.getTime()) ? null : date
  } catch {
    return null
  }
}

/**
 * Check if a date value is valid
 */
export function isValidDate(value: string | Date | null | undefined): boolean {
  return safeParseDate(value) !== null
}
</file>

<file path="lib/utils/receipt.ts">
// Receipt number generator
// Format: GG-YYYYMMDD-XXX (e.g., GG-20250107-042)

export function generateReceiptNumber(): string {
  const date = new Date()
  const year = date.getFullYear()
  const month = String(date.getMonth() + 1).padStart(2, '0')
  const day = String(date.getDate()).padStart(2, '0')
  const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0')

  return `GG-${year}${month}${day}-${random}`
}
</file>

<file path="lib/utils.ts">
import { clsx, type ClassValue } from 'clsx'
import { twMerge } from 'tailwind-merge'

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}
</file>

<file path="public/file.svg">
<svg fill="none" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14.5 13.5V5.41a1 1 0 0 0-.3-.7L9.8.29A1 1 0 0 0 9.08 0H1.5v13.5A2.5 2.5 0 0 0 4 16h8a2.5 2.5 0 0 0 2.5-2.5m-1.5 0v-7H8v-5H3v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1M9.5 5V2.12L12.38 5zM5.13 5h-.62v1.25h2.12V5zm-.62 3h7.12v1.25H4.5zm.62 3h-.62v1.25h7.12V11z" clip-rule="evenodd" fill="#666" fill-rule="evenodd"/></svg>
</file>

<file path="public/globe.svg">
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><g clip-path="url(#a)"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.27 14.1a6.5 6.5 0 0 0 3.67-3.45q-1.24.21-2.7.34-.31 1.83-.97 3.1M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m.48-1.52a7 7 0 0 1-.96 0H7.5a4 4 0 0 1-.84-1.32q-.38-.89-.63-2.08a40 40 0 0 0 3.92 0q-.25 1.2-.63 2.08a4 4 0 0 1-.84 1.31zm2.94-4.76q1.66-.15 2.95-.43a7 7 0 0 0 0-2.58q-1.3-.27-2.95-.43a18 18 0 0 1 0 3.44m-1.27-3.54a17 17 0 0 1 0 3.64 39 39 0 0 1-4.3 0 17 17 0 0 1 0-3.64 39 39 0 0 1 4.3 0m1.1-1.17q1.45.13 2.69.34a6.5 6.5 0 0 0-3.67-3.44q.65 1.26.98 3.1M8.48 1.5l.01.02q.41.37.84 1.31.38.89.63 2.08a40 40 0 0 0-3.92 0q.25-1.2.63-2.08a4 4 0 0 1 .85-1.32 7 7 0 0 1 .96 0m-2.75.4a6.5 6.5 0 0 0-3.67 3.44 29 29 0 0 1 2.7-.34q.31-1.83.97-3.1M4.58 6.28q-1.66.16-2.95.43a7 7 0 0 0 0 2.58q1.3.27 2.95.43a18 18 0 0 1 0-3.44m.17 4.71q-1.45-.12-2.69-.34a6.5 6.5 0 0 0 3.67 3.44q-.65-1.27-.98-3.1" fill="#666"/></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h16v16H0z"/></clipPath></defs></svg>
</file>

<file path="public/next.svg">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 394 80"><path fill="#000" d="M262 0h68.5v12.7h-27.2v66.6h-13.6V12.7H262V0ZM149 0v12.7H94v20.4h44.3v12.6H94v21h55v12.6H80.5V0h68.7zm34.3 0h-17.8l63.8 79.4h17.9l-32-39.7 32-39.6h-17.9l-23 28.6-23-28.6zm18.3 56.7-9-11-27.1 33.7h17.8l18.3-22.7z"/><path fill="#000" d="M81 79.3 17 0H0v79.3h13.6V17l50.2 62.3H81Zm252.6-.4c-1 0-1.8-.4-2.5-1s-1.1-1.6-1.1-2.6.3-1.8 1-2.5 1.6-1 2.6-1 1.8.3 2.5 1a3.4 3.4 0 0 1 .6 4.3 3.7 3.7 0 0 1-3 1.8zm23.2-33.5h6v23.3c0 2.1-.4 4-1.3 5.5a9.1 9.1 0 0 1-3.8 3.5c-1.6.8-3.5 1.3-5.7 1.3-2 0-3.7-.4-5.3-1s-2.8-1.8-3.7-3.2c-.9-1.3-1.4-3-1.4-5h6c.1.8.3 1.6.7 2.2s1 1.2 1.6 1.5c.7.4 1.5.5 2.4.5 1 0 1.8-.2 2.4-.6a4 4 0 0 0 1.6-1.8c.3-.8.5-1.8.5-3V45.5zm30.9 9.1a4.4 4.4 0 0 0-2-3.3 7.5 7.5 0 0 0-4.3-1.1c-1.3 0-2.4.2-3.3.5-.9.4-1.6 1-2 1.6a3.5 3.5 0 0 0-.3 4c.3.5.7.9 1.3 1.2l1.8 1 2 .5 3.2.8c1.3.3 2.5.7 3.7 1.2a13 13 0 0 1 3.2 1.8 8.1 8.1 0 0 1 3 6.5c0 2-.5 3.7-1.5 5.1a10 10 0 0 1-4.4 3.5c-1.8.8-4.1 1.2-6.8 1.2-2.6 0-4.9-.4-6.8-1.2-2-.8-3.4-2-4.5-3.5a10 10 0 0 1-1.7-5.6h6a5 5 0 0 0 3.5 4.6c1 .4 2.2.6 3.4.6 1.3 0 2.5-.2 3.5-.6 1-.4 1.8-1 2.4-1.7a4 4 0 0 0 .8-2.4c0-.9-.2-1.6-.7-2.2a11 11 0 0 0-2.1-1.4l-3.2-1-3.8-1c-2.8-.7-5-1.7-6.6-3.2a7.2 7.2 0 0 1-2.4-5.7 8 8 0 0 1 1.7-5 10 10 0 0 1 4.3-3.5c2-.8 4-1.2 6.4-1.2 2.3 0 4.4.4 6.2 1.2 1.8.8 3.2 2 4.3 3.4 1 1.4 1.5 3 1.5 5h-5.8z"/></svg>
</file>

<file path="public/quick-start-guide.html">
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GroomGroove Quick Start Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        @page {
            size: A4;
            margin: 0;
        }
        
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            color: #2d3748;
            line-height: 1.6;
        }
        
        .page {
            width: 210mm;
            height: 297mm;
            padding: 40px 50px;
            page-break-after: always;
            background: white;
            position: relative;
        }
        
        .page:last-child {
            page-break-after: auto;
        }
        
        /* Header Styles */
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #f43F5e;
        }
        
        .logo {
            font-size: 36px;
            font-weight: bold;
            color: #f43F5e;
            margin-bottom: 10px;
        }
        
        .tagline {
            font-size: 14px;
            color: #64748b;
            font-style: italic;
        }
        
        h1 {
            font-size: 32px;
            color: #1e293b;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        h2 {
            font-size: 24px;
            color: #f43F5e;
            margin: 30px 0 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        h3 {
            font-size: 18px;
            color: #475569;
            margin: 20px 0 10px;
            font-weight: 600;
        }
        
        p {
            margin-bottom: 15px;
            font-size: 14px;
            color: #475569;
        }
        
        .intro {
            background: linear-gradient(135deg, #fce7f3 0%, #dbeafe 100%);
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
            border-left: 5px solid #f43F5e;
        }
        
        .step {
            background: #f8fafc;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #3b82f6;
        }
        
        .step-number {
            display: inline-block;
            background: #f43F5e;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .screenshot-placeholder {
            border: 2px dashed #cbd5e1;
            background: #f1f5f9;
            padding: 60px 20px;
            text-align: center;
            border-radius: 8px;
            margin: 20px 0;
            color: #64748b;
            font-style: italic;
        }
        
        .screenshot-note {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
            font-size: 13px;
        }
        
        .highlight-box {
            background: #dcfce7;
            border: 2px solid #22c55e;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .tip {
            background: #e0f2fe;
            border-left: 4px solid #0ea5e9;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .tip strong {
            color: #0369a1;
        }
        
        ul {
            margin: 15px 0 15px 25px;
        }
        
        li {
            margin-bottom: 10px;
            font-size: 14px;
            color: #475569;
        }
        
        .icon {
            font-size: 24px;
            vertical-align: middle;
        }
        
        .footer {
            position: absolute;
            bottom: 30px;
            left: 50px;
            right: 50px;
            text-align: center;
            color: #94a3b8;
            font-size: 12px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
        }
        
        .page-number {
            font-weight: bold;
            color: #f43F5e;
        }
        
        @media print {
            .page {
                margin: 0;
                border: none;
                border-radius: 0;
                box-shadow: none;
                page-break-after: always;
            }
        }
    </style>
</head>
<body>

    <!-- PAGE 1: Welcome & Setup -->
    <div class="page">
        <div class="header">
            <div class="logo">üêï GroomGroove</div>
            <div class="tagline">Making dog grooming simple & joyful</div>
        </div>
        
        <h1>üëã Welcome to the Groove!</h1>
        
        <div class="intro">
            <p><strong>You're about to experience grooming management that just works.</strong></p>
            <p>This guide will get you up and running in under 5 minutes. No complicated setup, no training videos ‚Äì just simple, speedy tools that help you focus on what you do best: making dogs look fabulous.</p>
        </div>
        
        <h2>üì± CRITICAL FIRST STEP: Add to Home Screen</h2>
        <p>GroomGroove works best as a full-screen app on your iPad. Here's how to set it up:</p>
        
        <div class="step">
            <p><span class="step-number">1</span> Open Safari and go to: <strong>https://groom-groove.vercel.app</strong></p>
        </div>
        
        <div class="step">
            <p><span class="step-number">2</span> Tap the <strong>Share button</strong> (square with an arrow pointing up) at the top of Safari</p>
        </div>
        
        <div class="screenshot-placeholder">
            üì∏ <strong>INSERT SCREENSHOT HERE</strong><br>
            Safari toolbar with Share icon<br>
            <span style="color: #ef4444; font-weight: bold;">‚Üí Draw a RED CIRCLE around the Share button</span>
        </div>
        
        <div class="step">
            <p><span class="step-number">3</span> Scroll down and tap <strong>"Add to Home Screen"</strong></p>
        </div>
        
        <div class="screenshot-placeholder">
            üì∏ <strong>INSERT SCREENSHOT HERE</strong><br>
            Share menu with "Add to Home Screen" option<br>
            <span style="color: #ef4444; font-weight: bold;">‚Üí Draw a RED CIRCLE around "Add to Home Screen"</span>
        </div>
        
        <div class="step">
            <p><span class="step-number">4</span> Tap <strong>"Add"</strong> in the top right</p>
        </div>
        
        <div class="highlight-box">
            <p><strong>‚ú® Done!</strong> You'll now see the GroomGroove icon on your home screen. Tap it to launch the app in full-screen mode ‚Äì it'll feel just like a native app.</p>
        </div>
        
        <div class="tip">
            <p><strong>üí° Pro Tip:</strong> Pin the app to your iPad's dock for instant access throughout your day!</p>
        </div>
        
        <div class="footer">
            <span class="page-number">Page 1 of 4</span> | GroomGroove Quick Start Guide
        </div>
    </div>

    <!-- PAGE 2: The Command Center (Dashboard) -->
    <div class="page">
        <div class="header">
            <div class="logo">üêï GroomGroove</div>
            <div class="tagline">Your Daily Command Center</div>
        </div>
        
        <h1>üè† The Command Center (Dashboard)</h1>
        
        <p>When you open GroomGroove, you land on the <strong>Dashboard</strong> ‚Äì your mission control for the day. Everything you need is right here.</p>
        
        <div class="screenshot-placeholder" style="height: 300px;">
            üì∏ <strong>INSERT FULL DASHBOARD SCREENSHOT HERE</strong><br>
            Show the complete dashboard view<br><br>
            <span style="color: #ef4444; font-weight: bold;">‚Üí Draw RED CIRCLES around:</span><br>
            <span style="color: #ef4444;">1. "New Appointment" button (Top Right)</span><br>
            <span style="color: #ef4444;">2. "Active Dogs" counter card</span>
        </div>
        
        <h2>‚ö° Quick Actions Card</h2>
        <p>The fastest way to get things done:</p>
        <ul>
            <li><strong>New Appointment:</strong> Book a grooming slot in seconds</li>
            <li><strong>Check In Dog:</strong> Mark arrival and start the timer</li>
            <li><strong>Add New Dog:</strong> Register a new furry client</li>
        </ul>
        
        <h2>üìÖ Today's Schedule</h2>
        <p>See all your appointments at a glance:</p>
        <ul>
            <li><strong>Green badges:</strong> Dogs checked in and ready</li>
            <li><strong>Blue badges:</strong> Upcoming appointments</li>
            <li><strong>Gray badges:</strong> Completed grooming sessions</li>
        </ul>
        
        <div class="tip">
            <p><strong>üí° Speed Hack:</strong> Tap any appointment card to instantly see dog details, send SMS reminders, or start checkout.</p>
        </div>
        
        <h2>üìä Today at a Glance</h2>
        <p>Your daily numbers, front and center:</p>
        <ul>
            <li><strong>Active Dogs:</strong> Currently in your salon</li>
            <li><strong>Today's Revenue:</strong> Real-time earnings tracker</li>
            <li><strong>Appointments:</strong> Total bookings for the day</li>
        </ul>
        
        <div class="highlight-box">
            <p><strong>‚ú® Navigation:</strong> Use the sidebar on the left to jump to Clients, Calendar, Photos, or History. The Dashboard is always one tap away via the home icon.</p>
        </div>
        
        <div class="footer">
            <span class="page-number">Page 2 of 4</span> | GroomGroove Quick Start Guide
        </div>
    </div>

    <!-- PAGE 3: Adding a Client & Dog -->
    <div class="page">
        <div class="header">
            <div class="logo">üêï GroomGroove</div>
            <div class="tagline">Building Your Client Base</div>
        </div>
        
        <h1>üë• Adding a Client & Dog</h1>
        
        <p>Before you can book appointments, you need clients and dogs in the system. Here's the quick workflow:</p>
        
        <h2>Step 1: Add a New Client</h2>
        
        <div class="step">
            <p><span class="step-number">1</span> Go to <strong>Clients</strong> in the sidebar</p>
        </div>
        
        <div class="step">
            <p><span class="step-number">2</span> Tap <strong>"Add New Client"</strong></p>
        </div>
        
        <div class="step">
            <p><span class="step-number">3</span> Fill in the essentials:</p>
            <ul>
                <li><strong>First Name & Surname</strong></li>
                <li><strong>Email:</strong> For receipts and confirmations</li>
                <li><strong>Phone:</strong> For SMS reminders (critical!)</li>
            </ul>
        </div>
        
        <div class="step">
            <p><span class="step-number">4</span> Tap <strong>"Create Client"</strong></p>
        </div>
        
        <h2>‚úÇÔ∏è Step 2: Add Their Dog</h2>
        
        <div class="step">
            <p><span class="step-number">1</span> From the client's page, tap <strong>"Add Dog"</strong></p>
        </div>
        
        <div class="step">
            <p><span class="step-number">2</span> Fill in the dog details:</p>
            <ul>
                <li><strong>Name:</strong> e.g., "Milo"</li>
                <li><strong>Breed:</strong> e.g., "Golden Retriever"</li>
                <li><strong>Weight:</strong> Helps with handling</li>
                <li><strong>Age:</strong> Good to know for temperament</li>
            </ul>
        </div>
        
        <div class="screenshot-placeholder" style="height: 280px;">
            üì∏ <strong>INSERT DOG FORM SCREENSHOT HERE</strong><br>
            Show the "Add Dog" form with Grooming Specs section visible<br><br>
            <span style="color: #ef4444; font-weight: bold;">‚Üí Draw RED CIRCLES around:</span><br>
            <span style="color: #ef4444;">1. "Blade Size" dropdown</span><br>
            <span style="color: #ef4444;">2. "Temperament" star rating</span>
        </div>
        
        <h2>üéØ Critical: Grooming Specs</h2>
        
        <p>This is where GroomGroove shines. Set these once, and you'll never forget a preference again:</p>
        
        <ul>
            <li><strong>Blade Size:</strong> Their preferred clipper blade (e.g., #7, #10)</li>
            <li><strong>Shampoo Type:</strong> Hypoallergenic, whitening, etc.</li>
            <li><strong>Special Instructions:</strong> "Nervous with dryer" or "Hates nail trimming"</li>
            <li><strong>Temperament:</strong> Rate from 1‚Äì5 stars (helps you prepare mentally!)</li>
        </ul>
        
        <div class="tip">
            <p><strong>üí° Pro Tip:</strong> Add a photo of the dog! It helps you recognize them instantly when they arrive ‚Äì plus, it builds a beautiful gallery in the Photos section.</p>
        </div>
        
        <div class="footer">
            <span class="page-number">Page 3 of 4</span> | GroomGroove Quick Start Guide
        </div>
    </div>

    <!-- PAGE 4: The Daily Flow -->
    <div class="page">
        <div class="header">
            <div class="logo">üêï GroomGroove</div>
            <div class="tagline">Your Daily Workflow</div>
        </div>
        
        <h1>üîÑ The Daily Flow</h1>
        
        <p>Here's how a typical appointment moves through your day:</p>
        
        <h2>üìÖ 1. Book the Appointment</h2>
        
        <div class="step">
            <p><span class="step-number">1</span> From Dashboard or Calendar, tap <strong>"New Appointment"</strong></p>
        </div>
        
        <div class="step">
            <p><span class="step-number">2</span> Select:</p>
            <ul>
                <li>Client & Dog (from dropdown)</li>
                <li>Date & Time slot</li>
                <li>Services (Full Groom, Bath & Brush, Nail Trim, etc.)</li>
            </ul>
        </div>
        
        <div class="step">
            <p><span class="step-number">3</span> Tap <strong>"Create Appointment"</strong></p>
        </div>
        
        <div class="highlight-box">
            <p><strong>‚ú® Automatic Magic:</strong> The owner receives an SMS reminder 1 hour before the appointment. You don't lift a finger!</p>
        </div>
        
        <h2>üêæ 2. Dog Arrives</h2>
        
        <div class="step">
            <p>When the dog arrives, tap their appointment card on the Dashboard and hit <strong>"Check In"</strong>. This starts the timer and moves them to "Active."</p>
        </div>
        
        <h2>‚úÇÔ∏è 3. Groom the Dog</h2>
        
        <div class="step">
            <p>Do your thing! All the grooming specs you saved earlier are visible in the appointment details ‚Äì blade size, temperament, special notes.</p>
        </div>
        
        <div class="screenshot-placeholder" style="height: 200px;">
            üì∏ <strong>INSERT APPOINTMENT DETAIL SCREENSHOT HERE</strong><br>
            Show the appointment card with dog details and actions<br><br>
            <span style="color: #ef4444; font-weight: bold;">‚Üí Draw a RED CIRCLE around the "Send SMS" or "Notify Owner" button</span>
        </div>
        
        <h2>üí≥ 4. Checkout & Payment</h2>
        
        <div class="step">
            <p><span class="step-number">1</span> Tap the appointment card, then tap <strong>"Complete"</strong></p>
        </div>
        
        <div class="step">
            <p><span class="step-number">2</span> Review the services and total</p>
        </div>
        
        <div class="step">
            <p><span class="step-number">3</span> Select payment method: <strong>Card or Cash</strong></p>
        </div>
        
        <div class="step">
            <p><span class="step-number">4</span> Tap <strong>"Notify Owner"</strong> to send an SMS: "Fluffy is ready for pickup!" üì±</p>
        </div>
        
        <div class="step">
            <p><span class="step-number">5</span> Complete payment and print/email the receipt</p>
        </div>
        
        <div class="tip">
            <p><strong>üí° Speed Hack:</strong> Book the next appointment during checkout ‚Äì you'll never lose a repeat customer!</p>
        </div>
        
        <h2>üéâ You're Ready!</h2>
        
        <p>That's it! You now know the full GroomGroove workflow:</p>
        <ul>
            <li>‚úÖ Dashboard = Your command center</li>
            <li>‚úÖ Add clients & dogs with grooming specs</li>
            <li>‚úÖ Book appointments</li>
            <li>‚úÖ Check in ‚Üí Groom ‚Üí Notify ‚Üí Checkout</li>
        </ul>
        
        <div class="highlight-box">
            <p><strong>Need Help?</strong> Questions? Feature requests? Email us at <strong>support@groomgroove.com</strong> or check our FAQ at <strong>groomgroove.com/help</strong></p>
        </div>
        
        <div style="text-align: center; margin-top: 40px; padding: 30px; background: linear-gradient(135deg, #fce7f3 0%, #dbeafe 100%); border-radius: 12px;">
            <h2 style="color: #f43F5e; margin-bottom: 10px;">Welcome to the Groove! üéâ</h2>
            <p style="font-size: 16px; color: #475569; margin: 0;">Let's make grooming simple, speedy, and joyful.</p>
        </div>
        
        <div class="footer">
            <span class="page-number">Page 4 of 4</span> | GroomGroove Quick Start Guide | ¬© 2026 GroomGroove
        </div>
    </div>

</body>
</html>
</file>

<file path="public/setup-guide.html">
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GroomGroove Setup Guide</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      line-height: 1.6;
      color: #1f2937;
      background: #f9fafb;
    }

    .page {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 60px;
      min-height: 100vh;
      page-break-after: always;
    }

    .cover {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      min-height: 100vh;
    }

    .logo {
      font-size: 80px;
      margin-bottom: 20px;
    }

    h1 {
      font-size: 48px;
      background: linear-gradient(135deg, #f43F5e, #ec4899);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 10px;
    }

    .subtitle {
      font-size: 24px;
      color: #6b7280;
      margin-bottom: 40px;
    }

    .version {
      font-size: 14px;
      color: #9ca3af;
    }

    h2 {
      font-size: 28px;
      color: #111827;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 3px solid #f43F5e;
    }

    h3 {
      font-size: 20px;
      color: #374151;
      margin: 30px 0 15px 0;
    }

    .step {
      margin-bottom: 40px;
    }

    .step-number {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, #f43F5e, #ec4899);
      color: white;
      border-radius: 50%;
      font-weight: bold;
      font-size: 18px;
      margin-right: 15px;
    }

    .step-title {
      display: inline;
      font-size: 22px;
      font-weight: 600;
      color: #111827;
    }

    .step-content {
      margin-left: 55px;
      margin-top: 15px;
    }

    .screenshot {
      background: #f3F4F6;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
      text-align: center;
    }

    .screenshot-placeholder {
      background: linear-gradient(135deg, #fecdd3, #fbcfe8);
      border-radius: 8px;
      padding: 60px 40px;
      color: #be123c;
      font-weight: 500;
    }

    .screenshot img {
      max-width: 100%;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }

    .screenshot-caption {
      margin-top: 10px;
      font-size: 14px;
      color: #6b7280;
      font-style: italic;
    }

    ol, ul {
      margin-left: 20px;
      margin-bottom: 15px;
    }

    li {
      margin-bottom: 10px;
    }

    .highlight {
      background: #fef3c7;
      padding: 2px 8px;
      border-radius: 4px;
      font-weight: 500;
    }

    .button-example {
      display: inline-block;
      background: linear-gradient(135deg, #f43F5e, #ec4899);
      color: white;
      padding: 8px 16px;
      border-radius: 8px;
      font-weight: 500;
      font-size: 14px;
    }

    .button-green {
      background: #16a34a;
    }

    .tip {
      background: #ecfdf5;
      border-left: 4px solid #10b981;
      padding: 15px 20px;
      margin: 20px 0;
      border-radius: 0 8px 8px 0;
    }

    .tip-title {
      font-weight: 600;
      color: #059669;
      margin-bottom: 5px;
    }

    .warning {
      background: #fef3c7;
      border-left: 4px solid #f59e0b;
      padding: 15px 20px;
      margin: 20px 0;
      border-radius: 0 8px 8px 0;
    }

    .warning-title {
      font-weight: 600;
      color: #d97706;
      margin-bottom: 5px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }

    th, td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid #e5e7eb;
    }

    th {
      background: #f9fafb;
      font-weight: 600;
      color: #374151;
    }

    .nav-icon {
      font-size: 20px;
      margin-right: 10px;
    }

    .workflow-box {
      background: #f0f9ff;
      border: 2px solid #0ea5e9;
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
    }

    .workflow-title {
      font-weight: 600;
      color: #0369a1;
      margin-bottom: 10px;
      font-size: 18px;
    }

    .keyboard {
      display: inline-block;
      background: #1f2937;
      color: white;
      padding: 4px 10px;
      border-radius: 6px;
      font-family: monospace;
      font-size: 13px;
      margin: 0 2px;
    }

    @media print {
      .page {
        padding: 40px;
        box-shadow: none;
      }

      .screenshot-placeholder {
        border: 2px dashed #d1d5db;
        background: #f9fafb;
      }
    }
  </style>
</head>
<body>

  <!-- Cover Page -->
  <div class="page cover">
    <div class="logo">üêæ</div>
    <h1>GroomGroove</h1>
    <p class="subtitle">Setup & User Guide</p>
    <p class="version">Version 1.0 - January 2026</p>
  </div>

  <!-- Page 2: Getting Started -->
  <div class="page">
    <h2>Getting Started</h2>

    <div class="step">
      <span class="step-number">1</span>
      <span class="step-title">Open the App</span>
      <div class="step-content">
        <p>Open your web browser (Safari, Chrome, or Edge) and go to:</p>
        <div class="screenshot">
          <div class="screenshot-placeholder">
            <strong>http://localhost:3000</strong>
          </div>
          <p class="screenshot-caption">Type this address in your browser's address bar</p>
        </div>
      </div>
    </div>

    <div class="step">
      <span class="step-number">2</span>
      <span class="step-title">Create Your Account</span>
      <div class="step-content">
        <p>You'll see the login screen. Click <span class="highlight">Sign up</span> to create your account.</p>
        <div class="screenshot">
          <div class="screenshot-placeholder">
            üìß Email: your@email.com<br><br>
            üîí Password: ‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢<br><br>
            <span class="button-example">Sign up</span>
          </div>
          <p class="screenshot-caption">Enter your email and create a password (at least 6 characters)</p>
        </div>
        <div class="tip">
          <div class="tip-title">üí° Tip</div>
          <p>Use a password you'll remember! Write it down somewhere safe.</p>
        </div>
      </div>
    </div>

    <div class="step">
      <span class="step-number">3</span>
      <span class="step-title">Welcome to Dashboard</span>
      <div class="step-content">
        <p>After signing up, you'll see your Dashboard - your home base for the day!</p>
        <div class="screenshot">
          <div class="screenshot-placeholder">
            <strong>Dashboard</strong><br><br>
            üìä Today's Stats | üìÖ Today's Appointments | ‚ö° Quick Actions
          </div>
          <p class="screenshot-caption">The Dashboard shows everything happening today</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Page 3: Adding Clients -->
  <div class="page">
    <h2>Adding Your First Client</h2>

    <div class="step">
      <span class="step-number">1</span>
      <span class="step-title">Go to Clients</span>
      <div class="step-content">
        <p>Click <span class="highlight">Clients</span> in the left sidebar.</p>
        <div class="screenshot">
          <div class="screenshot-placeholder">
            <table style="width: auto; margin: 0 auto;">
              <tr><td>üè† Dashboard</td></tr>
              <tr><td style="background: #ffe4e6; border-radius: 8px;"><strong>üë• Clients</strong> ‚Üê Click here</td></tr>
              <tr><td>üìÖ Calendar</td></tr>
              <tr><td>üîî Notifications</td></tr>
            </table>
          </div>
          <p class="screenshot-caption">The sidebar is always on the left</p>
        </div>
      </div>
    </div>

    <div class="step">
      <span class="step-number">2</span>
      <span class="step-title">Click "Add New Client"</span>
      <div class="step-content">
        <p>Click the <span class="button-example">Add New Client</span> button in the top right.</p>
      </div>
    </div>

    <div class="step">
      <span class="step-number">3</span>
      <span class="step-title">Fill in Client Details</span>
      <div class="step-content">
        <div class="screenshot">
          <div class="screenshot-placeholder">
            <strong>Add New Client</strong><br><br>
            First Name: <span class="highlight">Sarah</span><br>
            Surname: <span class="highlight">Johnson</span><br>
            Email: <span class="highlight">sarah@email.com</span><br>
            Phone: <span class="highlight">0412 345 678</span><br><br>
            <span class="button-example">Create Client</span>
          </div>
          <p class="screenshot-caption">Enter the client's contact information</p>
        </div>
        <div class="tip">
          <div class="tip-title">üí° Tip</div>
          <p>The phone number is important for SMS reminders! Make sure it's correct.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Page 4: Adding Dogs -->
  <div class="page">
    <h2>Adding a Dog</h2>

    <p>After creating a client, you can add their dog(s) to the system.</p>

    <div class="step">
      <span class="step-number">1</span>
      <span class="step-title">Click on a Client</span>
      <div class="step-content">
        <p>In the Clients list, click on a client's row to open their details panel.</p>
        <div class="screenshot">
          <div class="screenshot-placeholder">
            <table style="width: 100%;">
              <tr style="background: #fef2f2;">
                <td><strong>Johnson</strong></td>
                <td>Sarah</td>
                <td>0412 345 678</td>
                <td>‚Üê Click anywhere on this row</td>
              </tr>
            </table>
          </div>
        </div>
      </div>
    </div>

    <div class="step">
      <span class="step-number">2</span>
      <span class="step-title">View Client Panel</span>
      <div class="step-content">
        <p>A panel slides out from the right showing client details and quick actions.</p>
        <div class="screenshot">
          <div class="screenshot-placeholder">
            <strong>Client Overview</strong><br><br>
            Johnson, Sarah<br>
            üì± 0412 345 678<br>
            üìß sarah@email.com<br><br>
            <strong>Dogs (0)</strong><br>
            No dogs yet<br><br>
            <strong>Quick Actions</strong><br>
            üí¨ Send Message<br>
            üìÖ Book Appointment<br>
            üêï View Dog
          </div>
          <p class="screenshot-caption">The client panel shows everything about this client</p>
        </div>
      </div>
    </div>

    <div class="warning">
      <div class="warning-title">‚ö†Ô∏è Note</div>
      <p>Dogs are currently added when creating appointments. Select the client, then add dog details in the appointment form.</p>
    </div>
  </div>

  <!-- Page 5: Booking Appointments -->
  <div class="page">
    <h2>Booking an Appointment</h2>

    <div class="step">
      <span class="step-number">1</span>
      <span class="step-title">Go to Calendar</span>
      <div class="step-content">
        <p>Click <span class="highlight">Calendar</span> in the sidebar, then click <span class="button-example">New Appointment</span>.</p>
      </div>
    </div>

    <div class="step">
      <span class="step-number">2</span>
      <span class="step-title">Fill in Appointment Details</span>
      <div class="step-content">
        <div class="screenshot">
          <div class="screenshot-placeholder">
            <strong>New Appointment</strong><br><br>
            Client: <span class="highlight">Sarah Johnson ‚ñº</span><br><br>
            Dog: <span class="highlight">Milo ‚ñº</span><br><br>
            Date: <span class="highlight">20 Jan 2026</span><br><br>
            Time: <span class="highlight">10:00 AM ‚ñº</span><br><br>
            Services:<br>
            ‚òëÔ∏è Full Groom - $85<br>
            ‚òê Bath & Brush - $45<br>
            ‚òê Nail Trim - $25<br><br>
            <span class="button-example">Create Appointment</span>
          </div>
          <p class="screenshot-caption">Select client, dog, time, and services</p>
        </div>
      </div>
    </div>

    <div class="step">
      <span class="step-number">3</span>
      <span class="step-title">Appointment Created!</span>
      <div class="step-content">
        <p>The appointment now appears on:</p>
        <ul>
          <li>üìÖ <strong>Calendar</strong> - on that date</li>
          <li>üè† <strong>Dashboard</strong> - if it's today</li>
          <li>üîî <strong>Notifications</strong> - for SMS reminder tracking</li>
        </ul>
        <div class="tip">
          <div class="tip-title">üí° Automatic Reminders</div>
          <p>The system will automatically send an SMS reminder 1 hour before the appointment!</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Page 6: Completing Appointments -->
  <div class="page">
    <h2>Completing an Appointment (Checkout)</h2>

    <p>When a client arrives and you finish grooming their dog:</p>

    <div class="step">
      <span class="step-number">1</span>
      <span class="step-title">Find the Appointment</span>
      <div class="step-content">
        <p>Go to <span class="highlight">Dashboard</span> and find the appointment in "Today's Appointments".</p>
        <div class="screenshot">
          <div class="screenshot-placeholder">
            <strong>Today's Appointments</strong><br><br>
            <table style="width: 100%;">
              <tr>
                <td>üïê 10:00</td>
                <td><strong>Milo</strong><br>Sarah Johnson</td>
                <td><span class="button-example button-green">‚úì Complete</span></td>
              </tr>
            </table>
          </div>
          <p class="screenshot-caption">Click the green "Complete" button</p>
        </div>
      </div>
    </div>

    <div class="step">
      <span class="step-number">2</span>
      <span class="step-title">Review Services</span>
      <div class="step-content">
        <p>Check the services and total are correct, then click <span class="button-example button-green">Mark Service Complete</span>.</p>
        <div class="screenshot">
          <div class="screenshot-placeholder">
            <strong>Review Services</strong><br><br>
            Full Groom .................. $85.00<br>
            ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ<br>
            <strong>Total ...................... $85.00</strong><br><br>
            <span class="button-example button-green">‚úì Mark Service Complete</span>
          </div>
        </div>
      </div>
    </div>

    <div class="step">
      <span class="step-number">3</span>
      <span class="step-title">Take Payment</span>
      <div class="step-content">
        <p>Select payment method and optionally schedule the next appointment.</p>
        <div class="screenshot">
          <div class="screenshot-placeholder">
            <strong>Payment</strong><br><br>
            üí≥ Card &nbsp;&nbsp;&nbsp; üíµ Cash<br><br>
            ‚òëÔ∏è Schedule Next Appointment<br>
            Return in: <span class="highlight">6 weeks ‚ñº</span><br><br>
            <span class="button-example">Complete Payment - $85.00</span>
          </div>
        </div>
      </div>
    </div>

    <div class="step">
      <span class="step-number">4</span>
      <span class="step-title">Print Receipt</span>
      <div class="step-content">
        <p>A receipt is generated. You can print it or email it to the client.</p>
        <div class="screenshot">
          <div class="screenshot-placeholder">
            ‚úÖ <strong>Payment Complete!</strong><br>
            Receipt #GG-20260120-001<br><br>
            üñ®Ô∏è Print Receipt &nbsp;&nbsp; üìß Email Receipt
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Page 7: Daily Workflow -->
  <div class="page">
    <h2>Your Daily Workflow</h2>

    <div class="workflow-box">
      <div class="workflow-title">‚òÄÔ∏è Morning</div>
      <ol>
        <li>Open GroomGroove and check the <strong>Dashboard</strong></li>
        <li>Review today's appointments</li>
        <li>Note any special concerns (anxious dogs, first visits)</li>
      </ol>
    </div>

    <div class="workflow-box">
      <div class="workflow-title">üêï During the Day</div>
      <ol>
        <li>Client arrives ‚Üí their appointment shows on Dashboard</li>
        <li>Groom the dog</li>
        <li>Click <strong>"Complete"</strong> button</li>
        <li>Review services ‚Üí Take payment ‚Üí Print receipt</li>
        <li>Schedule their next appointment</li>
      </ol>
    </div>

    <div class="workflow-box">
      <div class="workflow-title">üîî Automatic Reminders</div>
      <ul>
        <li>SMS reminders are sent <strong>1 hour before</strong> each appointment</li>
        <li>No action needed from you - it's automatic!</li>
        <li>Check <strong>Notifications</strong> page to see reminder status</li>
      </ul>
    </div>

    <div class="workflow-box">
      <div class="workflow-title">üåô End of Day</div>
      <ol>
        <li>Check all appointments are marked complete</li>
        <li>Review tomorrow's schedule on Calendar</li>
        <li>Log out (click your name ‚Üí Logout)</li>
      </ol>
    </div>
  </div>

  <!-- Page 8: Navigation Reference -->
  <div class="page">
    <h2>Navigation Reference</h2>

    <table>
      <tr>
        <th>Icon</th>
        <th>Page</th>
        <th>What it does</th>
      </tr>
      <tr>
        <td class="nav-icon">üè†</td>
        <td><strong>Dashboard</strong></td>
        <td>Today's overview - appointments, stats, quick actions</td>
      </tr>
      <tr>
        <td class="nav-icon">üë•</td>
        <td><strong>Clients</strong></td>
        <td>View and manage all clients and their dogs</td>
      </tr>
      <tr>
        <td class="nav-icon">üìÖ</td>
        <td><strong>Calendar</strong></td>
        <td>View appointments by date, book new appointments</td>
      </tr>
      <tr>
        <td class="nav-icon">üîî</td>
        <td><strong>Notifications</strong></td>
        <td>See SMS reminder status for today</td>
      </tr>
      <tr>
        <td class="nav-icon">‚è∞</td>
        <td><strong>History</strong></td>
        <td>View past completed appointments</td>
      </tr>
      <tr>
        <td class="nav-icon">‚öôÔ∏è</td>
        <td><strong>Settings</strong></td>
        <td>App settings and preferences</td>
      </tr>
    </table>

    <h3>Keyboard Shortcuts (Power Users)</h3>
    <p>Hold <span class="keyboard">Cmd</span> + <span class="keyboard">Option</span> (Mac) or <span class="keyboard">Ctrl</span> + <span class="keyboard">Alt</span> (Windows) and press:</p>

    <table>
      <tr>
        <th>Key</th>
        <th>Goes to</th>
      </tr>
      <tr><td><span class="keyboard">1</span></td><td>Dashboard</td></tr>
      <tr><td><span class="keyboard">2</span></td><td>Clients</td></tr>
      <tr><td><span class="keyboard">3</span></td><td>Calendar</td></tr>
      <tr><td><span class="keyboard">4</span></td><td>Notifications</td></tr>
      <tr><td><span class="keyboard">5</span></td><td>History</td></tr>
      <tr><td><span class="keyboard">N</span></td><td>New Appointment</td></tr>
    </table>
  </div>

  <!-- Page 9: Troubleshooting -->
  <div class="page">
    <h2>Troubleshooting</h2>

    <h3>üîÑ "Page not loading" or stuck</h3>
    <ul>
      <li>Refresh the page: <span class="keyboard">Cmd</span> + <span class="keyboard">R</span></li>
      <li>Try a hard refresh: <span class="keyboard">Cmd</span> + <span class="keyboard">Shift</span> + <span class="keyboard">R</span></li>
      <li>Check the terminal is still running</li>
    </ul>

    <h3>üîê "Can't log in"</h3>
    <ul>
      <li>Make sure your password is at least 6 characters</li>
      <li>Check you're using the right email</li>
      <li>Try signing up again if needed</li>
    </ul>

    <h3>üìÖ "Appointment not showing"</h3>
    <ul>
      <li>Check you selected the correct date on the calendar</li>
      <li>Refresh the page</li>
      <li>Check the appointment wasn't cancelled</li>
    </ul>

    <h3>üì± "SMS not sending"</h3>
    <ul>
      <li>Check the client has a phone number</li>
      <li>Check SMS consent is enabled for the client</li>
      <li>Reminders are sent 1 hour before - check the timing</li>
    </ul>

    <div class="tip">
      <div class="tip-title">üí° Still having issues?</div>
      <p>Contact support or restart the app by closing and reopening the terminal, then running <code>npm run dev</code> again.</p>
    </div>
  </div>

  <!-- Back Cover -->
  <div class="page cover">
    <div class="logo">üêæ</div>
    <h1>GroomGroove</h1>
    <p class="subtitle">Happy Grooming!</p>
    <br><br>
    <p style="color: #9ca3af;">Made with ‚ù§Ô∏è for dog groomers</p>
  </div>

</body>
</html>
</file>

<file path="public/vercel.svg">
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1155 1000"><path d="m577.3 0 577.4 1000H0z" fill="#fff"/></svg>
</file>

<file path="public/window.svg">
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.5 2.5h13v10a1 1 0 0 1-1 1h-11a1 1 0 0 1-1-1zM0 1h16v11.5a2.5 2.5 0 0 1-2.5 2.5h-11A2.5 2.5 0 0 1 0 12.5zm3.75 4.5a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5M7 4.75a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0m1.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5" fill="#666"/></svg>
</file>

<file path="supabase/migrations/001_initial_schema.sql">
-- GroomGroove Database Schema
-- Run this SQL in your Supabase SQL Editor to create the required tables

-- Enable UUID extension
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

-- Customers table
CREATE TABLE IF NOT EXISTS customers (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  name TEXT NOT NULL,
  email TEXT UNIQUE,
  phone TEXT,
  sms_consent BOOLEAN DEFAULT false,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Dogs table
CREATE TABLE IF NOT EXISTS dogs (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  customer_id UUID REFERENCES customers(id) ON DELETE CASCADE,
  name TEXT NOT NULL,
  breed TEXT,
  weight DECIMAL,
  notes TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Appointments table
CREATE TABLE IF NOT EXISTS appointments (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  customer_id UUID REFERENCES customers(id) ON DELETE CASCADE,
  dog_id UUID REFERENCES dogs(id) ON DELETE CASCADE,
  scheduled_at TIMESTAMPTZ NOT NULL,
  services TEXT[] DEFAULT '{}',
  notes TEXT,
  status TEXT DEFAULT 'pending_confirmation' CHECK (status IN ('pending_confirmation', 'confirmed', 'cancelled', 'completed')),
  confirmed_at TIMESTAMPTZ,
  cancelled_at TIMESTAMPTZ,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Create indexes for common queries
CREATE INDEX IF NOT EXISTS idx_appointments_scheduled_at ON appointments(scheduled_at);
CREATE INDEX IF NOT EXISTS idx_appointments_status ON appointments(status);
CREATE INDEX IF NOT EXISTS idx_appointments_customer_id ON appointments(customer_id);
CREATE INDEX IF NOT EXISTS idx_dogs_customer_id ON dogs(customer_id);

-- Row Level Security (RLS) Policies
-- For now, allow all operations (you should tighten this for production)

ALTER TABLE customers ENABLE ROW LEVEL SECURITY;
ALTER TABLE dogs ENABLE ROW LEVEL SECURITY;
ALTER TABLE appointments ENABLE ROW LEVEL SECURITY;

-- Policies for customers
CREATE POLICY "Allow all operations on customers" ON customers
  FOR ALL USING (true) WITH CHECK (true);

-- Policies for dogs
CREATE POLICY "Allow all operations on dogs" ON dogs
  FOR ALL USING (true) WITH CHECK (true);

-- Policies for appointments
CREATE POLICY "Allow all operations on appointments" ON appointments
  FOR ALL USING (true) WITH CHECK (true);

-- Insert sample data for testing
INSERT INTO customers (id, name, email, phone, sms_consent) VALUES
  ('11111111-1111-1111-1111-111111111111', 'Sarah Johnson', 'sarah@example.com', '+15551234001', true),
  ('22222222-2222-2222-2222-222222222222', 'Mike Chen', 'mike@example.com', '+15551234002', true),
  ('33333333-3333-3333-3333-333333333333', 'Emma Wilson', 'emma@example.com', '+15551234003', true),
  ('44444444-4444-4444-4444-444444444444', 'James Brown', 'james@example.com', '+15551234004', false),
  ('55555555-5555-5555-5555-555555555555', 'Lisa Park', 'lisa@example.com', '+15551234005', true)
ON CONFLICT (id) DO NOTHING;

INSERT INTO dogs (id, customer_id, name, breed, weight) VALUES
  ('aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa', '11111111-1111-1111-1111-111111111111', 'Bella', 'Golden Retriever', 65),
  ('bbbbbbbb-bbbb-bbbb-bbbb-bbbbbbbbbbbb', '22222222-2222-2222-2222-222222222222', 'Max', 'German Shepherd', 75),
  ('cccccccc-cccc-cccc-cccc-cccccccccccc', '33333333-3333-3333-3333-333333333333', 'Daisy', 'Poodle', 45),
  ('dddddddd-dddd-dddd-dddd-dddddddddddd', '44444444-4444-4444-4444-444444444444', 'Rocky', 'Bulldog', 50),
  ('eeeeeeee-eeee-eeee-eeee-eeeeeeeeeeee', '55555555-5555-5555-5555-555555555555', 'Luna', 'Husky', 55)
ON CONFLICT (id) DO NOTHING;
</file>

<file path="supabase/migrations/002_payments_table.sql">
-- Payments table for checkout workflow
-- Run this SQL in your Supabase SQL Editor

CREATE TABLE IF NOT EXISTS payments (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  customer_id UUID REFERENCES customers(id) ON DELETE CASCADE,
  appointment_id UUID REFERENCES appointments(id) ON DELETE SET NULL,
  next_appointment_id UUID REFERENCES appointments(id) ON DELETE SET NULL,
  amount_cents INTEGER NOT NULL,
  services TEXT[] DEFAULT '{}',
  receipt_number TEXT UNIQUE NOT NULL,
  payment_method TEXT DEFAULT 'cash',
  paid_at TIMESTAMPTZ DEFAULT NOW(),
  reminder_date DATE,
  reminder_sent BOOLEAN DEFAULT false,
  receipt_emailed BOOLEAN DEFAULT false,
  notes TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Add reminder_date to appointments table for SMS scheduling
ALTER TABLE appointments
ADD COLUMN IF NOT EXISTS reminder_date DATE,
ADD COLUMN IF NOT EXISTS reminder_sent BOOLEAN DEFAULT false;

-- Create indexes
CREATE INDEX IF NOT EXISTS idx_payments_customer_id ON payments(customer_id);
CREATE INDEX IF NOT EXISTS idx_payments_receipt_number ON payments(receipt_number);
CREATE INDEX IF NOT EXISTS idx_payments_paid_at ON payments(paid_at);
CREATE INDEX IF NOT EXISTS idx_appointments_reminder_date ON appointments(reminder_date);

-- RLS for payments
ALTER TABLE payments ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Allow all operations on payments" ON payments
  FOR ALL USING (true) WITH CHECK (true);
</file>

<file path="supabase/migrations/003_grooming_preferences.sql">
-- Add grooming preferences to dogs table
-- Run this SQL in your Supabase SQL Editor

-- Add grooming_preferences JSONB column to store structured preferences
ALTER TABLE dogs
ADD COLUMN IF NOT EXISTS grooming_preferences JSONB DEFAULT '{}'::jsonb;

-- Example structure for grooming_preferences:
-- {
--   "clipping_length": "5mm",
--   "clipping_notes": "Shorter on belly",
--   "nail_clipper_size": "medium",
--   "nail_tool": "clipper",
--   "coat_notes": "Heavy shedder, matting behind ears",
--   "behavior_notes": "Anxious, doesn't like paws touched",
--   "special_instructions": "Use calming spray before grooming"
-- }

-- Create index for faster JSONB queries if needed
CREATE INDEX IF NOT EXISTS idx_dogs_grooming_preferences ON dogs USING gin (grooming_preferences);
</file>

<file path="supabase/migrations/004_sms_notifications.sql">
-- SMS Notifications table for tracking sent reminders
-- Run this SQL in your Supabase SQL Editor

CREATE TABLE IF NOT EXISTS sms_notifications (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  appointment_id UUID REFERENCES appointments(id) ON DELETE CASCADE,
  type TEXT NOT NULL CHECK (type IN ('reminder', 'confirmation_request', 'confirmed', 'cancelled')),
  delivered BOOLEAN DEFAULT true,
  error_message TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Create indexes
CREATE INDEX IF NOT EXISTS idx_sms_notifications_appointment_id ON sms_notifications(appointment_id);
CREATE INDEX IF NOT EXISTS idx_sms_notifications_type ON sms_notifications(type);
CREATE INDEX IF NOT EXISTS idx_sms_notifications_created_at ON sms_notifications(created_at);

-- RLS for sms_notifications
ALTER TABLE sms_notifications ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Allow all operations on sms_notifications" ON sms_notifications
  FOR ALL USING (true) WITH CHECK (true);
</file>

<file path="supabase/migrations/005_dog_photos.sql">
-- Add photo_url column to dogs table
-- Run this SQL in your Supabase SQL Editor

ALTER TABLE dogs ADD COLUMN IF NOT EXISTS photo_url TEXT;

-- Create storage bucket for dog photos (run this separately in Supabase Dashboard > Storage)
-- Or use this SQL:
INSERT INTO storage.buckets (id, name, public)
VALUES ('dog-photos', 'dog-photos', true)
ON CONFLICT (id) DO NOTHING;

-- Allow public read access to dog photos
CREATE POLICY "Public read access for dog photos"
ON storage.objects FOR SELECT
USING (bucket_id = 'dog-photos');

-- Allow authenticated users to upload dog photos
CREATE POLICY "Authenticated users can upload dog photos"
ON storage.objects FOR INSERT
WITH CHECK (bucket_id = 'dog-photos');

-- Allow authenticated users to update their uploads
CREATE POLICY "Authenticated users can update dog photos"
ON storage.objects FOR UPDATE
USING (bucket_id = 'dog-photos');

-- Allow authenticated users to delete dog photos
CREATE POLICY "Authenticated users can delete dog photos"
ON storage.objects FOR DELETE
USING (bucket_id = 'dog-photos');
</file>

<file path="supabase/migrations/006_user_subscriptions.sql">
-- User subscriptions table for Stripe integration
-- Run this SQL in your Supabase SQL Editor

CREATE TABLE IF NOT EXISTS user_subscriptions (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,
  stripe_customer_id TEXT UNIQUE,
  stripe_subscription_id TEXT UNIQUE,
  stripe_price_id TEXT,
  status TEXT DEFAULT 'inactive' CHECK (status IN ('active', 'canceled', 'incomplete', 'incomplete_expired', 'past_due', 'trialing', 'unpaid', 'inactive')),
  current_period_start TIMESTAMPTZ,
  current_period_end TIMESTAMPTZ,
  cancel_at_period_end BOOLEAN DEFAULT false,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Create indexes for common queries
CREATE INDEX IF NOT EXISTS idx_user_subscriptions_user_id ON user_subscriptions(user_id);
CREATE INDEX IF NOT EXISTS idx_user_subscriptions_stripe_customer_id ON user_subscriptions(stripe_customer_id);
CREATE INDEX IF NOT EXISTS idx_user_subscriptions_stripe_subscription_id ON user_subscriptions(stripe_subscription_id);
CREATE INDEX IF NOT EXISTS idx_user_subscriptions_status ON user_subscriptions(status);

-- RLS for user_subscriptions
ALTER TABLE user_subscriptions ENABLE ROW LEVEL SECURITY;

-- Users can only see their own subscriptions
CREATE POLICY "Users can view own subscriptions" ON user_subscriptions
  FOR SELECT USING (auth.uid() = user_id);

-- Only service role can insert/update/delete (handled by webhooks)
CREATE POLICY "Service role can manage subscriptions" ON user_subscriptions
  FOR ALL USING (auth.jwt() ->> 'role' = 'service_role');

-- Add is_pro field to auth.users metadata (optional, can be derived from subscriptions table)
-- This comment is for reference: you can also store pro status in auth.users raw_user_meta_data
-- or use the subscriptions table as source of truth.
</file>

<file path="supabase/migrations/007_add_in_progress_status.sql">
-- Add 'in_progress' status to appointments table
ALTER TABLE appointments 
DROP CONSTRAINT IF EXISTS appointments_status_check;

ALTER TABLE appointments 
ADD CONSTRAINT appointments_status_check 
CHECK (status IN ('pending_confirmation', 'confirmed', 'cancelled', 'completed', 'in_progress'));

-- Update any existing appointments that might need the new status
-- (Optional: if you have logic that requires this)
</file>

<file path="supabase/migrations/008_groomers_table.sql">
-- Create groomers table for team members
CREATE TABLE IF NOT EXISTS groomers (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users(id) ON DELETE SET NULL,
  name TEXT NOT NULL,
  email TEXT,
  phone TEXT,
  role TEXT NOT NULL DEFAULT 'Groomer',
  color TEXT DEFAULT '#3B82F6', -- Blue default for calendar
  avatar_url TEXT,
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Enable RLS
ALTER TABLE groomers ENABLE ROW LEVEL SECURITY;

-- Policy: Users can view all groomers in their organization
-- For now, all authenticated users can see all groomers
CREATE POLICY "Authenticated users can view groomers"
  ON groomers FOR SELECT
  TO authenticated
  USING (true);

-- Policy: Only admins/owners can insert/update/delete groomers
-- For simplicity, allow all authenticated users for now
CREATE POLICY "Authenticated users can manage groomers"
  ON groomers FOR ALL
  TO authenticated
  USING (true)
  WITH CHECK (true);

-- Create index for faster lookups
CREATE INDEX idx_groomers_user_id ON groomers(user_id);
CREATE INDEX idx_groomers_is_active ON groomers(is_active);

-- Insert a default groomer (the owner)
-- This will be linked to the first user who signs up
INSERT INTO groomers (name, role, color)
VALUES ('Mark', 'Owner', '#8B5CF6')
ON CONFLICT DO NOTHING;
</file>

<file path="supabase/migrations/009_business_settings_table.sql">
-- Create business_settings table for storing business profile information
CREATE TABLE IF NOT EXISTS business_settings (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE NOT NULL UNIQUE,
  business_name TEXT,
  email TEXT,
  phone TEXT,
  address TEXT,
  website TEXT,
  email_notifications BOOLEAN DEFAULT true,
  sms_reminders BOOLEAN DEFAULT false,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Enable RLS
ALTER TABLE business_settings ENABLE ROW LEVEL SECURITY;

-- Policy: Users can only view their own settings
CREATE POLICY "Users can view own settings"
  ON business_settings FOR SELECT
  TO authenticated
  USING (auth.uid() = user_id);

-- Policy: Users can insert their own settings
CREATE POLICY "Users can insert own settings"
  ON business_settings FOR INSERT
  TO authenticated
  WITH CHECK (auth.uid() = user_id);

-- Policy: Users can update their own settings
CREATE POLICY "Users can update own settings"
  ON business_settings FOR UPDATE
  TO authenticated
  USING (auth.uid() = user_id)
  WITH CHECK (auth.uid() = user_id);

-- Create index for faster lookups
CREATE INDEX idx_business_settings_user_id ON business_settings(user_id);
</file>

<file path="supabase/migrations/010_groomers_on_duty.sql">
-- Add on_duty column to groomers table for attendance tracking
ALTER TABLE groomers ADD COLUMN IF NOT EXISTS on_duty BOOLEAN DEFAULT false;

-- Create index for faster on_duty queries
CREATE INDEX IF NOT EXISTS idx_groomers_on_duty ON groomers(on_duty);
</file>

<file path="supabase/migrations/011_add_currency_to_settings.sql">
-- Add currency column to business_settings table
ALTER TABLE business_settings ADD COLUMN IF NOT EXISTS currency TEXT DEFAULT '$';
</file>

<file path="utils/supabase/client.ts">
import { createBrowserClient } from '@supabase/ssr'

export function createClient() {
  return createBrowserClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
  )
}
</file>

<file path=".gitignore">
# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# dependencies
/node_modules
/.pnp
.pnp.*
.yarn/*
!.yarn/patches
!.yarn/plugins
!.yarn/releases
!.yarn/versions

# testing
/coverage

# next.js
/.next/
/out/

# production
/build

# misc
.DS_Store
*.pem

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*
.pnpm-debug.log*

# env files (can opt-in for committing if needed)
.env*

# vercel
.vercel

# typescript
*.tsbuildinfo
next-env.d.ts
.aider*
</file>

<file path="package-lock 2.json">
{
  "name": "groom-groove",
  "version": "0.1.0",
  "lockfileVersion": 3,
  "requires": true,
  "packages": {
    "": {
      "name": "groom-groove",
      "version": "0.1.0",
      "dependencies": {
        "@supabase/ssr": "^0.5.2",
        "@supabase/supabase-js": "^2.45.6",
        "class-variance-authority": "^0.7.1",
        "clsx": "^2.1.1",
        "date-fns": "^4.1.0",
        "lucide-react": "^0.468.0",
        "next": "^15.1.6",
        "react": "19.0.0",
        "react-dom": "19.0.0",
        "stripe": "^17.5.0",
        "tailwind-merge": "^3.4.0"
      },
      "devDependencies": {
        "@tailwindcss/postcss": "^4",
        "@types/node": "^20",
        "@types/react": "^19",
        "@types/react-dom": "^19",
        "eslint": "^9",
        "eslint-config-next": "15.5.9",
        "tailwindcss": "^4",
        "typescript": "^5"
      }
    },
    "node_modules/@alloc/quick-lru": {
      "version": "5.2.0",
      "resolved": "https://registry.npmjs.org/@alloc/quick-lru/-/quick-lru-5.2.0.tgz",
      "integrity": "sha512-UrcABB+4bUrFABwbluTIBErXwvbsU/V7TZWfmbgJfbkwiBuziS9gxdODUyuiecfdGQ85jglMW6juS3+z5TsKLw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/@emnapi/core": {
      "version": "1.8.1",
      "resolved": "https://registry.npmjs.org/@emnapi/core/-/core-1.8.1.tgz",
      "integrity": "sha512-AvT9QFpxK0Zd8J0jopedNm+w/2fIzvtPKPjqyw9jwvBaReTTqPBk9Hixaz7KbjimP+QNz605/XnjFcDAL2pqBg==",
      "dev": true,
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "@emnapi/wasi-threads": "1.1.0",
        "tslib": "^2.4.0"
      }
    },
    "node_modules/@emnapi/runtime": {
      "version": "1.8.1",
      "resolved": "https://registry.npmjs.org/@emnapi/runtime/-/runtime-1.8.1.tgz",
      "integrity": "sha512-mehfKSMWjjNol8659Z8KxEMrdSJDDot5SXMq00dM8BN4o+CLNXQ0xH2V7EchNHV4RmbZLmmPdEaXZc5H2FXmDg==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "tslib": "^2.4.0"
      }
    },
    "node_modules/@emnapi/wasi-threads": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@emnapi/wasi-threads/-/wasi-threads-1.1.0.tgz",
      "integrity": "sha512-WI0DdZ8xFSbgMjR1sFsKABJ/C5OnRrjT06JXbZKexJGrDuPTzZdDYfFlsgcCXCyf+suG5QU2e/y1Wo2V/OapLQ==",
      "dev": true,
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "tslib": "^2.4.0"
      }
    },
    "node_modules/@eslint-community/eslint-utils": {
      "version": "4.9.1",
      "resolved": "https://registry.npmjs.org/@eslint-community/eslint-utils/-/eslint-utils-4.9.1.tgz",
      "integrity": "sha512-phrYmNiYppR7znFEdqgfWHXR6NCkZEK7hwWDHZUjit/2/U0r6XvkDl0SYnoM51Hq7FhCGdLDT6zxCCOY1hexsQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "eslint-visitor-keys": "^3.4.3"
      },
      "engines": {
        "node": "^12.22.0 || ^14.17.0 || >=16.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/eslint"
      },
      "peerDependencies": {
        "eslint": "^6.0.0 || ^7.0.0 || >=8.0.0"
      }
    },
    "node_modules/@eslint-community/eslint-utils/node_modules/eslint-visitor-keys": {
      "version": "3.4.3",
      "resolved": "https://registry.npmjs.org/eslint-visitor-keys/-/eslint-visitor-keys-3.4.3.tgz",
      "integrity": "sha512-wpc+LXeiyiisxPlEkUzU6svyS1frIO3Mgxj1fdy7Pm8Ygzguax2N3Fa/D/ag1WqbOprdI+uY6wMUl8/a2G+iag==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": "^12.22.0 || ^14.17.0 || >=16.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/eslint"
      }
    },
    "node_modules/@eslint-community/regexpp": {
      "version": "4.12.2",
      "resolved": "https://registry.npmjs.org/@eslint-community/regexpp/-/regexpp-4.12.2.tgz",
      "integrity": "sha512-EriSTlt5OC9/7SXkRSCAhfSxxoSUgBm33OH+IkwbdpgoqsSsUg7y3uh+IICI/Qg4BBWr3U2i39RpmycbxMq4ew==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": "^12.0.0 || ^14.0.0 || >=16.0.0"
      }
    },
    "node_modules/@eslint/config-array": {
      "version": "0.21.1",
      "resolved": "https://registry.npmjs.org/@eslint/config-array/-/config-array-0.21.1.tgz",
      "integrity": "sha512-aw1gNayWpdI/jSYVgzN5pL0cfzU02GT3NBpeT/DXbx1/1x7ZKxFPd9bwrzygx/qiwIQiJ1sw/zD8qY/kRvlGHA==",
      "dev": true,
      "license": "Apache-2.0",
      "dependencies": {
        "@eslint/object-schema": "^2.1.7",
        "debug": "^4.3.1",
        "minimatch": "^3.1.2"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      }
    },
    "node_modules/@eslint/config-helpers": {
      "version": "0.4.2",
      "resolved": "https://registry.npmjs.org/@eslint/config-helpers/-/config-helpers-0.4.2.tgz",
      "integrity": "sha512-gBrxN88gOIf3R7ja5K9slwNayVcZgK6SOUORm2uBzTeIEfeVaIhOpCtTox3P6R7o2jLFwLFTLnC7kU/RGcYEgw==",
      "dev": true,
      "license": "Apache-2.0",
      "dependencies": {
        "@eslint/core": "^0.17.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      }
    },
    "node_modules/@eslint/core": {
      "version": "0.17.0",
      "resolved": "https://registry.npmjs.org/@eslint/core/-/core-0.17.0.tgz",
      "integrity": "sha512-yL/sLrpmtDaFEiUj1osRP4TI2MDz1AddJL+jZ7KSqvBuliN4xqYY54IfdN8qD8Toa6g1iloph1fxQNkjOxrrpQ==",
      "dev": true,
      "license": "Apache-2.0",
      "dependencies": {
        "@types/json-schema": "^7.0.15"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      }
    },
    "node_modules/@eslint/eslintrc": {
      "version": "3.3.3",
      "resolved": "https://registry.npmjs.org/@eslint/eslintrc/-/eslintrc-3.3.3.tgz",
      "integrity": "sha512-Kr+LPIUVKz2qkx1HAMH8q1q6azbqBAsXJUxBl/ODDuVPX45Z9DfwB8tPjTi6nNZ8BuM3nbJxC5zCAg5elnBUTQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "ajv": "^6.12.4",
        "debug": "^4.3.2",
        "espree": "^10.0.1",
        "globals": "^14.0.0",
        "ignore": "^5.2.0",
        "import-fresh": "^3.2.1",
        "js-yaml": "^4.1.1",
        "minimatch": "^3.1.2",
        "strip-json-comments": "^3.1.1"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "url": "https://opencollective.com/eslint"
      }
    },
    "node_modules/@eslint/js": {
      "version": "9.39.2",
      "resolved": "https://registry.npmjs.org/@eslint/js/-/js-9.39.2.tgz",
      "integrity": "sha512-q1mjIoW1VX4IvSocvM/vbTiveKC4k9eLrajNEuSsmjymSDEbpGddtpfOoN7YGAqBK3NG+uqo8ia4PDTt8buCYA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "url": "https://eslint.org/donate"
      }
    },
    "node_modules/@eslint/object-schema": {
      "version": "2.1.7",
      "resolved": "https://registry.npmjs.org/@eslint/object-schema/-/object-schema-2.1.7.tgz",
      "integrity": "sha512-VtAOaymWVfZcmZbp6E2mympDIHvyjXs/12LqWYjVw6qjrfF+VK+fyG33kChz3nnK+SU5/NeHOqrTEHS8sXO3OA==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      }
    },
    "node_modules/@eslint/plugin-kit": {
      "version": "0.4.1",
      "resolved": "https://registry.npmjs.org/@eslint/plugin-kit/-/plugin-kit-0.4.1.tgz",
      "integrity": "sha512-43/qtrDUokr7LJqoF2c3+RInu/t4zfrpYdoSDfYyhg52rwLV6TnOvdG4FXm7IkSB3wErkcmJS9iEhjVtOSEjjA==",
      "dev": true,
      "license": "Apache-2.0",
      "dependencies": {
        "@eslint/core": "^0.17.0",
        "levn": "^0.4.1"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      }
    },
    "node_modules/@humanfs/core": {
      "version": "0.19.1",
      "resolved": "https://registry.npmjs.org/@humanfs/core/-/core-0.19.1.tgz",
      "integrity": "sha512-5DyQ4+1JEUzejeK1JGICcideyfUbGixgS9jNgex5nqkW+cY7WZhxBigmieN5Qnw9ZosSNVC9KQKyb+GUaGyKUA==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": ">=18.18.0"
      }
    },
    "node_modules/@humanfs/node": {
      "version": "0.16.7",
      "resolved": "https://registry.npmjs.org/@humanfs/node/-/node-0.16.7.tgz",
      "integrity": "sha512-/zUx+yOsIrG4Y43Eh2peDeKCxlRt/gET6aHfaKpuq267qXdYDFViVHfMaLyygZOnl0kGWxFIgsBy8QFuTLUXEQ==",
      "dev": true,
      "license": "Apache-2.0",
      "dependencies": {
        "@humanfs/core": "^0.19.1",
        "@humanwhocodes/retry": "^0.4.0"
      },
      "engines": {
        "node": ">=18.18.0"
      }
    },
    "node_modules/@humanwhocodes/module-importer": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/@humanwhocodes/module-importer/-/module-importer-1.0.1.tgz",
      "integrity": "sha512-bxveV4V8v5Yb4ncFTT3rPSgZBOpCkjfK0y4oVVVJwIuDVBRMDXrPyXRL988i5ap9m9bnyEEjWfm5WkBmtffLfA==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": ">=12.22"
      },
      "funding": {
        "type": "github",
        "url": "https://github.com/sponsors/nzakas"
      }
    },
    "node_modules/@humanwhocodes/retry": {
      "version": "0.4.3",
      "resolved": "https://registry.npmjs.org/@humanwhocodes/retry/-/retry-0.4.3.tgz",
      "integrity": "sha512-bV0Tgo9K4hfPCek+aMAn81RppFKv2ySDQeMoSZuvTASywNTnVJCArCZE2FWqpvIatKu7VMRLWlR1EazvVhDyhQ==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": ">=18.18"
      },
      "funding": {
        "type": "github",
        "url": "https://github.com/sponsors/nzakas"
      }
    },
    "node_modules/@img/sharp-darwin-arm64": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-darwin-arm64/-/sharp-darwin-arm64-0.33.5.tgz",
      "integrity": "sha512-UT4p+iz/2H4twwAoLCqfA9UH5pI6DggwKEGuaPy7nCVQ8ZsiY5PIcrRvD1DzuY3qYL07NtIQcWnBSY/heikIFQ==",
      "cpu": [
        "arm64"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-darwin-arm64": "1.0.4"
      }
    },
    "node_modules/@img/sharp-darwin-x64": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-darwin-x64/-/sharp-darwin-x64-0.33.5.tgz",
      "integrity": "sha512-fyHac4jIc1ANYGRDxtiqelIbdWkIuQaI84Mv45KvGRRxSAa7o7d1ZKAOBaYbnepLC1WqxfpimdeWfvqqSGwR2Q==",
      "cpu": [
        "x64"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-darwin-x64": "1.0.4"
      }
    },
    "node_modules/@img/sharp-libvips-darwin-arm64": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-darwin-arm64/-/sharp-libvips-darwin-arm64-1.0.4.tgz",
      "integrity": "sha512-XblONe153h0O2zuFfTAbQYAX2JhYmDHeWikp1LM9Hul9gVPjFY427k6dFEcOL72O01QxQsWi761svJ/ev9xEDg==",
      "cpu": [
        "arm64"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "darwin"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-darwin-x64": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-darwin-x64/-/sharp-libvips-darwin-x64-1.0.4.tgz",
      "integrity": "sha512-xnGR8YuZYfJGmWPvmlunFaWJsb9T/AO2ykoP3Fz/0X5XV2aoYBPkX6xqCQvUTKKiLddarLaxpzNe+b1hjeWHAQ==",
      "cpu": [
        "x64"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "darwin"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-linux-arm": {
      "version": "1.0.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linux-arm/-/sharp-libvips-linux-arm-1.0.5.tgz",
      "integrity": "sha512-gvcC4ACAOPRNATg/ov8/MnbxFDJqf/pDePbBnuBDcjsI8PssmjoKMAz4LtLaVi+OnSb5FK/yIOamqDwGmXW32g==",
      "cpu": [
        "arm"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "linux"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-linux-arm64": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linux-arm64/-/sharp-libvips-linux-arm64-1.0.4.tgz",
      "integrity": "sha512-9B+taZ8DlyyqzZQnoeIvDVR/2F4EbMepXMc/NdVbkzsJbzkUjhXv/70GQJ7tdLA4YJgNP25zukcxpX2/SueNrA==",
      "cpu": [
        "arm64"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "linux"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-linux-s390x": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linux-s390x/-/sharp-libvips-linux-s390x-1.0.4.tgz",
      "integrity": "sha512-u7Wz6ntiSSgGSGcjZ55im6uvTrOxSIS8/dgoVMoiGE9I6JAfU50yH5BoDlYA1tcuGS7g/QNtetJnxA6QEsCVTA==",
      "cpu": [
        "s390x"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "linux"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-linux-x64": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linux-x64/-/sharp-libvips-linux-x64-1.0.4.tgz",
      "integrity": "sha512-MmWmQ3iPFZr0Iev+BAgVMb3ZyC4KeFc3jFxnNbEPas60e1cIfevbtuyf9nDGIzOaW9PdnDciJm+wFFaTlj5xYw==",
      "cpu": [
        "x64"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "linux"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-linuxmusl-arm64": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linuxmusl-arm64/-/sharp-libvips-linuxmusl-arm64-1.0.4.tgz",
      "integrity": "sha512-9Ti+BbTYDcsbp4wfYib8Ctm1ilkugkA/uscUn6UXK1ldpC1JjiXbLfFZtRlBhjPZ5o1NCLiDbg8fhUPKStHoTA==",
      "cpu": [
        "arm64"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "linux"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-libvips-linuxmusl-x64": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/@img/sharp-libvips-linuxmusl-x64/-/sharp-libvips-linuxmusl-x64-1.0.4.tgz",
      "integrity": "sha512-viYN1KX9m+/hGkJtvYYp+CCLgnJXwiQB39damAO7WMdKWlIhmYTfHjwSbQeUK/20vY154mwezd9HflVFM1wVSw==",
      "cpu": [
        "x64"
      ],
      "license": "LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "linux"
      ],
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-linux-arm": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-linux-arm/-/sharp-linux-arm-0.33.5.tgz",
      "integrity": "sha512-JTS1eldqZbJxjvKaAkxhZmBqPRGmxgu+qFKSInv8moZ2AmT5Yib3EQ1c6gp493HvrvV8QgdOXdyaIBrhvFhBMQ==",
      "cpu": [
        "arm"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-linux-arm": "1.0.5"
      }
    },
    "node_modules/@img/sharp-linux-arm64": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-linux-arm64/-/sharp-linux-arm64-0.33.5.tgz",
      "integrity": "sha512-JMVv+AMRyGOHtO1RFBiJy/MBsgz0x4AWrT6QoEVVTyh1E39TrCUpTRI7mx9VksGX4awWASxqCYLCV4wBZHAYxA==",
      "cpu": [
        "arm64"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-linux-arm64": "1.0.4"
      }
    },
    "node_modules/@img/sharp-linux-s390x": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-linux-s390x/-/sharp-linux-s390x-0.33.5.tgz",
      "integrity": "sha512-y/5PCd+mP4CA/sPDKl2961b+C9d+vPAveS33s6Z3zfASk2j5upL6fXVPZi7ztePZ5CuH+1kW8JtvxgbuXHRa4Q==",
      "cpu": [
        "s390x"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-linux-s390x": "1.0.4"
      }
    },
    "node_modules/@img/sharp-linux-x64": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-linux-x64/-/sharp-linux-x64-0.33.5.tgz",
      "integrity": "sha512-opC+Ok5pRNAzuvq1AG0ar+1owsu842/Ab+4qvU879ippJBHvyY5n2mxF1izXqkPYlGuP/M556uh53jRLJmzTWA==",
      "cpu": [
        "x64"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-linux-x64": "1.0.4"
      }
    },
    "node_modules/@img/sharp-linuxmusl-arm64": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-linuxmusl-arm64/-/sharp-linuxmusl-arm64-0.33.5.tgz",
      "integrity": "sha512-XrHMZwGQGvJg2V/oRSUfSAfjfPxO+4DkiRh6p2AFjLQztWUuY/o8Mq0eMQVIY7HJ1CDQUJlxGGZRw1a5bqmd1g==",
      "cpu": [
        "arm64"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-linuxmusl-arm64": "1.0.4"
      }
    },
    "node_modules/@img/sharp-linuxmusl-x64": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-linuxmusl-x64/-/sharp-linuxmusl-x64-0.33.5.tgz",
      "integrity": "sha512-WT+d/cgqKkkKySYmqoZ8y3pxx7lx9vVejxW/W4DOFMYVSkErR+w7mf2u8m/y4+xHe7yY9DAXQMWQhpnMuFfScw==",
      "cpu": [
        "x64"
      ],
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-libvips-linuxmusl-x64": "1.0.4"
      }
    },
    "node_modules/@img/sharp-wasm32": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-wasm32/-/sharp-wasm32-0.33.5.tgz",
      "integrity": "sha512-ykUW4LVGaMcU9lu9thv85CbRMAwfeadCJHRsg2GmeRa/cJxsVY9Rbd57JcMxBkKHag5U/x7TSBpScF4U8ElVzg==",
      "cpu": [
        "wasm32"
      ],
      "license": "Apache-2.0 AND LGPL-3.0-or-later AND MIT",
      "optional": true,
      "dependencies": {
        "@emnapi/runtime": "^1.2.0"
      },
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-win32-ia32": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-win32-ia32/-/sharp-win32-ia32-0.33.5.tgz",
      "integrity": "sha512-T36PblLaTwuVJ/zw/LaH0PdZkRz5rd3SmMHX8GSmR7vtNSP5Z6bQkExdSK7xGWyxLw4sUknBuugTelgw2faBbQ==",
      "cpu": [
        "ia32"
      ],
      "license": "Apache-2.0 AND LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@img/sharp-win32-x64": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/@img/sharp-win32-x64/-/sharp-win32-x64-0.33.5.tgz",
      "integrity": "sha512-MpY/o8/8kj+EcnxwvrP4aTJSWw/aZ7JIGR4aBeZkZw5B7/Jn+tY9/VNwtcoGmdT7GfggGIU4kygOMSbYnOrAbg==",
      "cpu": [
        "x64"
      ],
      "license": "Apache-2.0 AND LGPL-3.0-or-later",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      }
    },
    "node_modules/@jridgewell/gen-mapping": {
      "version": "0.3.13",
      "resolved": "https://registry.npmjs.org/@jridgewell/gen-mapping/-/gen-mapping-0.3.13.tgz",
      "integrity": "sha512-2kkt/7niJ6MgEPxF0bYdQ6etZaA+fQvDcLKckhy1yIQOzaoKjBBjSj63/aLVjYE3qhRt5dvM+uUyfCg6UKCBbA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/sourcemap-codec": "^1.5.0",
        "@jridgewell/trace-mapping": "^0.3.24"
      }
    },
    "node_modules/@jridgewell/remapping": {
      "version": "2.3.5",
      "resolved": "https://registry.npmjs.org/@jridgewell/remapping/-/remapping-2.3.5.tgz",
      "integrity": "sha512-LI9u/+laYG4Ds1TDKSJW2YPrIlcVYOwi2fUC6xB43lueCjgxV4lffOCZCtYFiH6TNOX+tQKXx97T4IKHbhyHEQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/gen-mapping": "^0.3.5",
        "@jridgewell/trace-mapping": "^0.3.24"
      }
    },
    "node_modules/@jridgewell/resolve-uri": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.2.tgz",
      "integrity": "sha512-bRISgCIjP20/tbWSPWMEi54QVPRZExkuD9lJL+UIxUKtwVJA8wW1Trb1jMs1RFXo1CBTNZ/5hpC9QvmKWdopKw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@jridgewell/sourcemap-codec": {
      "version": "1.5.5",
      "resolved": "https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.5.5.tgz",
      "integrity": "sha512-cYQ9310grqxueWbl+WuIUIaiUaDcj7WOq5fVhEljNVgRfOUhY9fy2zTvfoqWsnebh8Sl70VScFbICvJnLKB0Og==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@jridgewell/trace-mapping": {
      "version": "0.3.31",
      "resolved": "https://registry.npmjs.org/@jridgewell/trace-mapping/-/trace-mapping-0.3.31.tgz",
      "integrity": "sha512-zzNR+SdQSDJzc8joaeP8QQoCQr8NuYx2dIIytl1QeBEZHJ9uW6hebsrYgbz8hJwUQao3TWCMtmfV8Nu1twOLAw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/resolve-uri": "^3.1.0",
        "@jridgewell/sourcemap-codec": "^1.4.14"
      }
    },
    "node_modules/@napi-rs/wasm-runtime": {
      "version": "0.2.12",
      "resolved": "https://registry.npmjs.org/@napi-rs/wasm-runtime/-/wasm-runtime-0.2.12.tgz",
      "integrity": "sha512-ZVWUcfwY4E/yPitQJl481FjFo3K22D6qF0DuFH6Y/nbnE11GY5uguDxZMGXPQ8WQ0128MXQD7TnfHyK4oWoIJQ==",
      "dev": true,
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "@emnapi/core": "^1.4.3",
        "@emnapi/runtime": "^1.4.3",
        "@tybys/wasm-util": "^0.10.0"
      }
    },
    "node_modules/@next/env": {
      "version": "15.1.6",
      "resolved": "https://registry.npmjs.org/@next/env/-/env-15.1.6.tgz",
      "integrity": "sha512-d9AFQVPEYNr+aqokIiPLNK/MTyt3DWa/dpKveiAaVccUadFbhFEvY6FXYX2LJO2Hv7PHnLBu2oWwB4uBuHjr/w==",
      "license": "MIT"
    },
    "node_modules/@next/eslint-plugin-next": {
      "version": "15.5.9",
      "resolved": "https://registry.npmjs.org/@next/eslint-plugin-next/-/eslint-plugin-next-15.5.9.tgz",
      "integrity": "sha512-kUzXx0iFiXw27cQAViE1yKWnz/nF8JzRmwgMRTMh8qMY90crNsdXJRh2e+R0vBpFR3kk1yvAR7wev7+fCCb79Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "fast-glob": "3.3.1"
      }
    },
    "node_modules/@next/swc-darwin-arm64": {
      "version": "15.1.6",
      "resolved": "https://registry.npmjs.org/@next/swc-darwin-arm64/-/swc-darwin-arm64-15.1.6.tgz",
      "integrity": "sha512-u7lg4Mpl9qWpKgy6NzEkz/w0/keEHtOybmIl0ykgItBxEM5mYotS5PmqTpo+Rhg8FiOiWgwr8USxmKQkqLBCrw==",
      "cpu": [
        "arm64"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@next/swc-darwin-x64": {
      "version": "15.1.6",
      "resolved": "https://registry.npmjs.org/@next/swc-darwin-x64/-/swc-darwin-x64-15.1.6.tgz",
      "integrity": "sha512-x1jGpbHbZoZ69nRuogGL2MYPLqohlhnT9OCU6E6QFewwup+z+M6r8oU47BTeJcWsF2sdBahp5cKiAcDbwwK/lg==",
      "cpu": [
        "x64"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@next/swc-linux-arm64-gnu": {
      "version": "15.1.6",
      "resolved": "https://registry.npmjs.org/@next/swc-linux-arm64-gnu/-/swc-linux-arm64-gnu-15.1.6.tgz",
      "integrity": "sha512-jar9sFw0XewXsBzPf9runGzoivajeWJUc/JkfbLTC4it9EhU8v7tCRLH7l5Y1ReTMN6zKJO0kKAGqDk8YSO2bg==",
      "cpu": [
        "arm64"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@next/swc-linux-arm64-musl": {
      "version": "15.1.6",
      "resolved": "https://registry.npmjs.org/@next/swc-linux-arm64-musl/-/swc-linux-arm64-musl-15.1.6.tgz",
      "integrity": "sha512-+n3u//bfsrIaZch4cgOJ3tXCTbSxz0s6brJtU3SzLOvkJlPQMJ+eHVRi6qM2kKKKLuMY+tcau8XD9CJ1OjeSQQ==",
      "cpu": [
        "arm64"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@next/swc-linux-x64-gnu": {
      "version": "15.1.6",
      "resolved": "https://registry.npmjs.org/@next/swc-linux-x64-gnu/-/swc-linux-x64-gnu-15.1.6.tgz",
      "integrity": "sha512-SpuDEXixM3PycniL4iVCLyUyvcl6Lt0mtv3am08sucskpG0tYkW1KlRhTgj4LI5ehyxriVVcfdoxuuP8csi3kQ==",
      "cpu": [
        "x64"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@next/swc-linux-x64-musl": {
      "version": "15.1.6",
      "resolved": "https://registry.npmjs.org/@next/swc-linux-x64-musl/-/swc-linux-x64-musl-15.1.6.tgz",
      "integrity": "sha512-L4druWmdFSZIIRhF+G60API5sFB7suTbDRhYWSjiw0RbE+15igQvE2g2+S973pMGvwN3guw7cJUjA/TmbPWTHQ==",
      "cpu": [
        "x64"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@next/swc-win32-arm64-msvc": {
      "version": "15.1.6",
      "resolved": "https://registry.npmjs.org/@next/swc-win32-arm64-msvc/-/swc-win32-arm64-msvc-15.1.6.tgz",
      "integrity": "sha512-s8w6EeqNmi6gdvM19tqKKWbCyOBvXFbndkGHl+c9YrzsLARRdCHsD9S1fMj8gsXm9v8vhC8s3N8rjuC/XrtkEg==",
      "cpu": [
        "arm64"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@next/swc-win32-x64-msvc": {
      "version": "15.1.6",
      "resolved": "https://registry.npmjs.org/@next/swc-win32-x64-msvc/-/swc-win32-x64-msvc-15.1.6.tgz",
      "integrity": "sha512-6xomMuu54FAFxttYr5PJbEfu96godcxBTRk1OhAvJq0/EnmFU/Ybiax30Snis4vdWZ9LGpf7Roy5fSs7v/5ROQ==",
      "cpu": [
        "x64"
      ],
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@nodelib/fs.scandir": {
      "version": "2.1.5",
      "resolved": "https://registry.npmjs.org/@nodelib/fs.scandir/-/fs.scandir-2.1.5.tgz",
      "integrity": "sha512-vq24Bq3ym5HEQm2NKCr3yXDwjc7vTsEThRDnkp2DK9p1uqLR+DHurm/NOTo0KG7HYHU7eppKZj3MyqYuMBf62g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@nodelib/fs.stat": "2.0.5",
        "run-parallel": "^1.1.9"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/@nodelib/fs.stat": {
      "version": "2.0.5",
      "resolved": "https://registry.npmjs.org/@nodelib/fs.stat/-/fs.stat-2.0.5.tgz",
      "integrity": "sha512-RkhPPp2zrqDAQA/2jNhnztcPAlv64XdhIp7a7454A5ovI7Bukxgt7MX7udwAu3zg1DcpPU0rz3VV1SeaqvY4+A==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/@nodelib/fs.walk": {
      "version": "1.2.8",
      "resolved": "https://registry.npmjs.org/@nodelib/fs.walk/-/fs.walk-1.2.8.tgz",
      "integrity": "sha512-oGB+UxlgWcgQkgwo8GcEGwemoTFt3FIO9ababBmaGwXIoBKZ+GTy0pP185beGg7Llih/NSHSV2XAs1lnznocSg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@nodelib/fs.scandir": "2.1.5",
        "fastq": "^1.6.0"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/@nolyfill/is-core-module": {
      "version": "1.0.39",
      "resolved": "https://registry.npmjs.org/@nolyfill/is-core-module/-/is-core-module-1.0.39.tgz",
      "integrity": "sha512-nn5ozdjYQpUCZlWGuxcJY/KpxkWQs4DcbMCmKojjyrYDEAGy4Ce19NN4v5MduafTwJlbKc99UA8YhSVqq9yPZA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=12.4.0"
      }
    },
    "node_modules/@rtsao/scc": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@rtsao/scc/-/scc-1.1.0.tgz",
      "integrity": "sha512-zt6OdqaDoOnJ1ZYsCYGt9YmWzDXl4vQdKTyJev62gFhRGKdx7mcT54V9KIjg+d2wi9EXsPvAPKe7i7WjfVWB8g==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@rushstack/eslint-patch": {
      "version": "1.15.0",
      "resolved": "https://registry.npmjs.org/@rushstack/eslint-patch/-/eslint-patch-1.15.0.tgz",
      "integrity": "sha512-ojSshQPKwVvSMR8yT2L/QtUkV5SXi/IfDiJ4/8d6UbTPjiHVmxZzUAzGD8Tzks1b9+qQkZa0isUOvYObedITaw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@supabase/auth-js": {
      "version": "2.90.1",
      "resolved": "https://registry.npmjs.org/@supabase/auth-js/-/auth-js-2.90.1.tgz",
      "integrity": "sha512-vxb66dgo6h3yyPbR06735Ps+dK3hj0JwS8w9fdQPVZQmocSTlKUW5MfxSy99mN0XqCCuLMQ3jCEiIIUU23e9ng==",
      "license": "MIT",
      "dependencies": {
        "tslib": "2.8.1"
      },
      "engines": {
        "node": ">=20.0.0"
      }
    },
    "node_modules/@supabase/functions-js": {
      "version": "2.90.1",
      "resolved": "https://registry.npmjs.org/@supabase/functions-js/-/functions-js-2.90.1.tgz",
      "integrity": "sha512-x9mV9dF1Lam9qL3zlpP6mSM5C9iqMPtF5B/tU1Jj/F0ufX5mjDf9ghVBaErVxmrQJRL4+iMKWKY2GnODkpS8tw==",
      "license": "MIT",
      "dependencies": {
        "tslib": "2.8.1"
      },
      "engines": {
        "node": ">=20.0.0"
      }
    },
    "node_modules/@supabase/postgrest-js": {
      "version": "2.90.1",
      "resolved": "https://registry.npmjs.org/@supabase/postgrest-js/-/postgrest-js-2.90.1.tgz",
      "integrity": "sha512-jh6vqzaYzoFn3raaC0hcFt9h+Bt+uxNRBSdc7PfToQeRGk7PDPoweHsbdiPWREtDVTGKfu+PyPW9e2jbK+BCgQ==",
      "license": "MIT",
      "dependencies": {
        "tslib": "2.8.1"
      },
      "engines": {
        "node": ">=20.0.0"
      }
    },
    "node_modules/@supabase/realtime-js": {
      "version": "2.90.1",
      "resolved": "https://registry.npmjs.org/@supabase/realtime-js/-/realtime-js-2.90.1.tgz",
      "integrity": "sha512-PWbnEMkcQRuor8jhObp4+Snufkq8C6fBp+MchVp2qBPY1NXk/c3Iv3YyiFYVzo0Dzuw4nAlT4+ahuPggy4r32w==",
      "license": "MIT",
      "dependencies": {
        "@types/phoenix": "^1.6.6",
        "@types/ws": "^8.18.1",
        "tslib": "2.8.1",
        "ws": "^8.18.2"
      },
      "engines": {
        "node": ">=20.0.0"
      }
    },
    "node_modules/@supabase/ssr": {
      "version": "0.5.2",
      "resolved": "https://registry.npmjs.org/@supabase/ssr/-/ssr-0.5.2.tgz",
      "integrity": "sha512-n3plRhr2Bs8Xun1o4S3k1CDv17iH5QY9YcoEvXX3bxV1/5XSasA0mNXYycFmADIdtdE6BG9MRjP5CGIs8qxC8A==",
      "license": "MIT",
      "dependencies": {
        "@types/cookie": "^0.6.0",
        "cookie": "^0.7.0"
      },
      "peerDependencies": {
        "@supabase/supabase-js": "^2.43.4"
      }
    },
    "node_modules/@supabase/storage-js": {
      "version": "2.90.1",
      "resolved": "https://registry.npmjs.org/@supabase/storage-js/-/storage-js-2.90.1.tgz",
      "integrity": "sha512-GHY+Ps/K/RBfRj7kwx+iVf2HIdqOS43rM2iDOIDpapyUnGA9CCBFzFV/XvfzznGykd//z2dkGZhlZZprsVFqGg==",
      "license": "MIT",
      "dependencies": {
        "iceberg-js": "^0.8.1",
        "tslib": "2.8.1"
      },
      "engines": {
        "node": ">=20.0.0"
      }
    },
    "node_modules/@supabase/supabase-js": {
      "version": "2.90.1",
      "resolved": "https://registry.npmjs.org/@supabase/supabase-js/-/supabase-js-2.90.1.tgz",
      "integrity": "sha512-U8KaKGLUgTIFHtwEW1dgw1gK7XrdpvvYo7nzzqPx721GqPe8WZbAiLh/hmyKLGBYQ/mmQNr20vU9tWSDZpii3w==",
      "license": "MIT",
      "dependencies": {
        "@supabase/auth-js": "2.90.1",
        "@supabase/functions-js": "2.90.1",
        "@supabase/postgrest-js": "2.90.1",
        "@supabase/realtime-js": "2.90.1",
        "@supabase/storage-js": "2.90.1"
      },
      "engines": {
        "node": ">=20.0.0"
      }
    },
    "node_modules/@swc/counter": {
      "version": "0.1.3",
      "resolved": "https://registry.npmjs.org/@swc/counter/-/counter-0.1.3.tgz",
      "integrity": "sha512-e2BR4lsJkkRlKZ/qCHPw9ZaSxc0MVUd7gtbtaB7aMvHeJVYe8sOB8DBZkP2DtISHGSku9sCK6T6cnY0CtXrOCQ==",
      "license": "Apache-2.0"
    },
    "node_modules/@swc/helpers": {
      "version": "0.5.15",
      "resolved": "https://registry.npmjs.org/@swc/helpers/-/helpers-0.5.15.tgz",
      "integrity": "sha512-JQ5TuMi45Owi4/BIMAJBoSQoOJu12oOk/gADqlcUL9JEdHB8vyjUSsxqeNXnmXHjYKMi2WcYtezGEEhqUI/E2g==",
      "license": "Apache-2.0",
      "dependencies": {
        "tslib": "^2.8.0"
      }
    },
    "node_modules/@tailwindcss/node": {
      "version": "4.1.18",
      "resolved": "https://registry.npmjs.org/@tailwindcss/node/-/node-4.1.18.tgz",
      "integrity": "sha512-DoR7U1P7iYhw16qJ49fgXUlry1t4CpXeErJHnQ44JgTSKMaZUdf17cfn5mHchfJ4KRBZRFA/Coo+MUF5+gOaCQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/remapping": "^2.3.4",
        "enhanced-resolve": "^5.18.3",
        "jiti": "^2.6.1",
        "lightningcss": "1.30.2",
        "magic-string": "^0.30.21",
        "source-map-js": "^1.2.1",
        "tailwindcss": "4.1.18"
      }
    },
    "node_modules/@tailwindcss/oxide": {
      "version": "4.1.18",
      "resolved": "https://registry.npmjs.org/@tailwindcss/oxide/-/oxide-4.1.18.tgz",
      "integrity": "sha512-EgCR5tTS5bUSKQgzeMClT6iCY3ToqE1y+ZB0AKldj809QXk1Y+3jB0upOYZrn9aGIzPtUsP7sX4QQ4XtjBB95A==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 10"
      },
      "optionalDependencies": {
        "@tailwindcss/oxide-android-arm64": "4.1.18",
        "@tailwindcss/oxide-darwin-arm64": "4.1.18",
        "@tailwindcss/oxide-darwin-x64": "4.1.18",
        "@tailwindcss/oxide-freebsd-x64": "4.1.18",
        "@tailwindcss/oxide-linux-arm-gnueabihf": "4.1.18",
        "@tailwindcss/oxide-linux-arm64-gnu": "4.1.18",
        "@tailwindcss/oxide-linux-arm64-musl": "4.1.18",
        "@tailwindcss/oxide-linux-x64-gnu": "4.1.18",
        "@tailwindcss/oxide-linux-x64-musl": "4.1.18",
        "@tailwindcss/oxide-wasm32-wasi": "4.1.18",
        "@tailwindcss/oxide-win32-arm64-msvc": "4.1.18",
        "@tailwindcss/oxide-win32-x64-msvc": "4.1.18"
      }
    },
    "node_modules/@tailwindcss/oxide-android-arm64": {
      "version": "4.1.18",
      "resolved": "https://registry.npmjs.org/@tailwindcss/oxide-android-arm64/-/oxide-android-arm64-4.1.18.tgz",
      "integrity": "sha512-dJHz7+Ugr9U/diKJA0W6N/6/cjI+ZTAoxPf9Iz9BFRF2GzEX8IvXxFIi/dZBloVJX/MZGvRuFA9rqwdiIEZQ0Q==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@tailwindcss/oxide-darwin-arm64": {
      "version": "4.1.18",
      "resolved": "https://registry.npmjs.org/@tailwindcss/oxide-darwin-arm64/-/oxide-darwin-arm64-4.1.18.tgz",
      "integrity": "sha512-Gc2q4Qhs660bhjyBSKgq6BYvwDz4G+BuyJ5H1xfhmDR3D8HnHCmT/BSkvSL0vQLy/nkMLY20PQ2OoYMO15Jd0A==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@tailwindcss/oxide-darwin-x64": {
      "version": "4.1.18",
      "resolved": "https://registry.npmjs.org/@tailwindcss/oxide-darwin-x64/-/oxide-darwin-x64-4.1.18.tgz",
      "integrity": "sha512-FL5oxr2xQsFrc3X9o1fjHKBYBMD1QZNyc1Xzw/h5Qu4XnEBi3dZn96HcHm41c/euGV+GRiXFfh2hUCyKi/e+yw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@tailwindcss/oxide-freebsd-x64": {
      "version": "4.1.18",
      "resolved": "https://registry.npmjs.org/@tailwindcss/oxide-freebsd-x64/-/oxide-freebsd-x64-4.1.18.tgz",
      "integrity": "sha512-Fj+RHgu5bDodmV1dM9yAxlfJwkkWvLiRjbhuO2LEtwtlYlBgiAT4x/j5wQr1tC3SANAgD+0YcmWVrj8R9trVMA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@tailwindcss/oxide-linux-arm-gnueabihf": {
      "version": "4.1.18",
      "resolved": "https://registry.npmjs.org/@tailwindcss/oxide-linux-arm-gnueabihf/-/oxide-linux-arm-gnueabihf-4.1.18.tgz",
      "integrity": "sha512-Fp+Wzk/Ws4dZn+LV2Nqx3IilnhH51YZoRaYHQsVq3RQvEl+71VGKFpkfHrLM/Li+kt5c0DJe/bHXK1eHgDmdiA==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@tailwindcss/oxide-linux-arm64-gnu": {
      "version": "4.1.18",
      "resolved": "https://registry.npmjs.org/@tailwindcss/oxide-linux-arm64-gnu/-/oxide-linux-arm64-gnu-4.1.18.tgz",
      "integrity": "sha512-S0n3jboLysNbh55Vrt7pk9wgpyTTPD0fdQeh7wQfMqLPM/Hrxi+dVsLsPrycQjGKEQk85Kgbx+6+QnYNiHalnw==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@tailwindcss/oxide-linux-arm64-musl": {
      "version": "4.1.18",
      "resolved": "https://registry.npmjs.org/@tailwindcss/oxide-linux-arm64-musl/-/oxide-linux-arm64-musl-4.1.18.tgz",
      "integrity": "sha512-1px92582HkPQlaaCkdRcio71p8bc8i/ap5807tPRDK/uw953cauQBT8c5tVGkOwrHMfc2Yh6UuxaH4vtTjGvHg==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@tailwindcss/oxide-linux-x64-gnu": {
      "version": "4.1.18",
      "resolved": "https://registry.npmjs.org/@tailwindcss/oxide-linux-x64-gnu/-/oxide-linux-x64-gnu-4.1.18.tgz",
      "integrity": "sha512-v3gyT0ivkfBLoZGF9LyHmts0Isc8jHZyVcbzio6Wpzifg/+5ZJpDiRiUhDLkcr7f/r38SWNe7ucxmGW3j3Kb/g==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@tailwindcss/oxide-linux-x64-musl": {
      "version": "4.1.18",
      "resolved": "https://registry.npmjs.org/@tailwindcss/oxide-linux-x64-musl/-/oxide-linux-x64-musl-4.1.18.tgz",
      "integrity": "sha512-bhJ2y2OQNlcRwwgOAGMY0xTFStt4/wyU6pvI6LSuZpRgKQwxTec0/3Scu91O8ir7qCR3AuepQKLU/kX99FouqQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@tailwindcss/oxide-wasm32-wasi": {
      "version": "4.1.18",
      "resolved": "https://registry.npmjs.org/@tailwindcss/oxide-wasm32-wasi/-/oxide-wasm32-wasi-4.1.18.tgz",
      "integrity": "sha512-LffYTvPjODiP6PT16oNeUQJzNVyJl1cjIebq/rWWBF+3eDst5JGEFSc5cWxyRCJ0Mxl+KyIkqRxk1XPEs9x8TA==",
      "bundleDependencies": [
        "@napi-rs/wasm-runtime",
        "@emnapi/core",
        "@emnapi/runtime",
        "@tybys/wasm-util",
        "@emnapi/wasi-threads",
        "tslib"
      ],
      "cpu": [
        "wasm32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "@emnapi/core": "^1.7.1",
        "@emnapi/runtime": "^1.7.1",
        "@emnapi/wasi-threads": "^1.1.0",
        "@napi-rs/wasm-runtime": "^1.1.0",
        "@tybys/wasm-util": "^0.10.1",
        "tslib": "^2.4.0"
      },
      "engines": {
        "node": ">=14.0.0"
      }
    },
    "node_modules/@tailwindcss/oxide-win32-arm64-msvc": {
      "version": "4.1.18",
      "resolved": "https://registry.npmjs.org/@tailwindcss/oxide-win32-arm64-msvc/-/oxide-win32-arm64-msvc-4.1.18.tgz",
      "integrity": "sha512-HjSA7mr9HmC8fu6bdsZvZ+dhjyGCLdotjVOgLA2vEqxEBZaQo9YTX4kwgEvPCpRh8o4uWc4J/wEoFzhEmjvPbA==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@tailwindcss/oxide-win32-x64-msvc": {
      "version": "4.1.18",
      "resolved": "https://registry.npmjs.org/@tailwindcss/oxide-win32-x64-msvc/-/oxide-win32-x64-msvc-4.1.18.tgz",
      "integrity": "sha512-bJWbyYpUlqamC8dpR7pfjA0I7vdF6t5VpUGMWRkXVE3AXgIZjYUYAK7II1GNaxR8J1SSrSrppRar8G++JekE3Q==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/@tailwindcss/postcss": {
      "version": "4.1.18",
      "resolved": "https://registry.npmjs.org/@tailwindcss/postcss/-/postcss-4.1.18.tgz",
      "integrity": "sha512-Ce0GFnzAOuPyfV5SxjXGn0CubwGcuDB0zcdaPuCSzAa/2vII24JTkH+I6jcbXLb1ctjZMZZI6OjDaLPJQL1S0g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@alloc/quick-lru": "^5.2.0",
        "@tailwindcss/node": "4.1.18",
        "@tailwindcss/oxide": "4.1.18",
        "postcss": "^8.4.41",
        "tailwindcss": "4.1.18"
      }
    },
    "node_modules/@tybys/wasm-util": {
      "version": "0.10.1",
      "resolved": "https://registry.npmjs.org/@tybys/wasm-util/-/wasm-util-0.10.1.tgz",
      "integrity": "sha512-9tTaPJLSiejZKx+Bmog4uSubteqTvFrVrURwkmHixBo0G4seD0zUxp98E1DzUBJxLQ3NPwXrGKDiVjwx/DpPsg==",
      "dev": true,
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "tslib": "^2.4.0"
      }
    },
    "node_modules/@types/cookie": {
      "version": "0.6.0",
      "resolved": "https://registry.npmjs.org/@types/cookie/-/cookie-0.6.0.tgz",
      "integrity": "sha512-4Kh9a6B2bQciAhf7FSuMRRkUWecJgJu9nPnx3yzpsfXX/c50REIqpHY4C82bXP90qrLtXtkDxTZosYO3UpOwlA==",
      "license": "MIT"
    },
    "node_modules/@types/estree": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/@types/estree/-/estree-1.0.8.tgz",
      "integrity": "sha512-dWHzHa2WqEXI/O1E9OjrocMTKJl2mSrEolh1Iomrv6U+JuNwaHXsXx9bLu5gG7BUWFIN0skIQJQ/L1rIex4X6w==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@types/json-schema": {
      "version": "7.0.15",
      "resolved": "https://registry.npmjs.org/@types/json-schema/-/json-schema-7.0.15.tgz",
      "integrity": "sha512-5+fP8P8MFNC+AyZCDxrB2pkZFPGzqQWUzpSeuuVLvm8VMcorNYavBqoFcxK8bQz4Qsbn4oUEEem4wDLfcysGHA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@types/json5": {
      "version": "0.0.29",
      "resolved": "https://registry.npmjs.org/@types/json5/-/json5-0.0.29.tgz",
      "integrity": "sha512-dRLjCWHYg4oaA77cxO64oO+7JwCwnIzkZPdrrC71jQmQtlhM556pwKo5bUzqvZndkVbeFLIIi+9TC40JNF5hNQ==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@types/node": {
      "version": "20.19.30",
      "resolved": "https://registry.npmjs.org/@types/node/-/node-20.19.30.tgz",
      "integrity": "sha512-WJtwWJu7UdlvzEAUm484QNg5eAoq5QR08KDNx7g45Usrs2NtOPiX8ugDqmKdXkyL03rBqU5dYNYVQetEpBHq2g==",
      "license": "MIT",
      "dependencies": {
        "undici-types": "~6.21.0"
      }
    },
    "node_modules/@types/phoenix": {
      "version": "1.6.7",
      "resolved": "https://registry.npmjs.org/@types/phoenix/-/phoenix-1.6.7.tgz",
      "integrity": "sha512-oN9ive//QSBkf19rfDv45M7eZPi0eEXylht2OLEXicu5b4KoQ1OzXIw+xDSGWxSxe1JmepRR/ZH283vsu518/Q==",
      "license": "MIT"
    },
    "node_modules/@types/react": {
      "version": "19.2.8",
      "resolved": "https://registry.npmjs.org/@types/react/-/react-19.2.8.tgz",
      "integrity": "sha512-3MbSL37jEchWZz2p2mjntRZtPt837ij10ApxKfgmXCTuHWagYg7iA5bqPw6C8BMPfwidlvfPI/fxOc42HLhcyg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "csstype": "^3.2.2"
      }
    },
    "node_modules/@types/react-dom": {
      "version": "19.2.3",
      "resolved": "https://registry.npmjs.org/@types/react-dom/-/react-dom-19.2.3.tgz",
      "integrity": "sha512-jp2L/eY6fn+KgVVQAOqYItbF0VY/YApe5Mz2F0aykSO8gx31bYCZyvSeYxCHKvzHG5eZjc+zyaS5BrBWya2+kQ==",
      "dev": true,
      "license": "MIT",
      "peerDependencies": {
        "@types/react": "^19.2.0"
      }
    },
    "node_modules/@types/ws": {
      "version": "8.18.1",
      "resolved": "https://registry.npmjs.org/@types/ws/-/ws-8.18.1.tgz",
      "integrity": "sha512-ThVF6DCVhA8kUGy+aazFQ4kXQ7E1Ty7A3ypFOe0IcJV8O/M511G99AW24irKrW56Wt44yG9+ij8FaqoBGkuBXg==",
      "license": "MIT",
      "dependencies": {
        "@types/node": "*"
      }
    },
    "node_modules/@typescript-eslint/eslint-plugin": {
      "version": "8.53.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/eslint-plugin/-/eslint-plugin-8.53.0.tgz",
      "integrity": "sha512-eEXsVvLPu8Z4PkFibtuFJLJOTAV/nPdgtSjkGoPpddpFk3/ym2oy97jynY6ic2m6+nc5M8SE1e9v/mHKsulcJg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@eslint-community/regexpp": "^4.12.2",
        "@typescript-eslint/scope-manager": "8.53.0",
        "@typescript-eslint/type-utils": "8.53.0",
        "@typescript-eslint/utils": "8.53.0",
        "@typescript-eslint/visitor-keys": "8.53.0",
        "ignore": "^7.0.5",
        "natural-compare": "^1.4.0",
        "ts-api-utils": "^2.4.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      },
      "peerDependencies": {
        "@typescript-eslint/parser": "^8.53.0",
        "eslint": "^8.57.0 || ^9.0.0",
        "typescript": ">=4.8.4 <6.0.0"
      }
    },
    "node_modules/@typescript-eslint/eslint-plugin/node_modules/ignore": {
      "version": "7.0.5",
      "resolved": "https://registry.npmjs.org/ignore/-/ignore-7.0.5.tgz",
      "integrity": "sha512-Hs59xBNfUIunMFgWAbGX5cq6893IbWg4KnrjbYwX3tx0ztorVgTDA6B2sxf8ejHJ4wz8BqGUMYlnzNBer5NvGg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 4"
      }
    },
    "node_modules/@typescript-eslint/parser": {
      "version": "8.53.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/parser/-/parser-8.53.0.tgz",
      "integrity": "sha512-npiaib8XzbjtzS2N4HlqPvlpxpmZ14FjSJrteZpPxGUaYPlvhzlzUZ4mZyABo0EFrOWnvyd0Xxroq//hKhtAWg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@typescript-eslint/scope-manager": "8.53.0",
        "@typescript-eslint/types": "8.53.0",
        "@typescript-eslint/typescript-estree": "8.53.0",
        "@typescript-eslint/visitor-keys": "8.53.0",
        "debug": "^4.4.3"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      },
      "peerDependencies": {
        "eslint": "^8.57.0 || ^9.0.0",
        "typescript": ">=4.8.4 <6.0.0"
      }
    },
    "node_modules/@typescript-eslint/project-service": {
      "version": "8.53.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/project-service/-/project-service-8.53.0.tgz",
      "integrity": "sha512-Bl6Gdr7NqkqIP5yP9z1JU///Nmes4Eose6L1HwpuVHwScgDPPuEWbUVhvlZmb8hy0vX9syLk5EGNL700WcBlbg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@typescript-eslint/tsconfig-utils": "^8.53.0",
        "@typescript-eslint/types": "^8.53.0",
        "debug": "^4.4.3"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      },
      "peerDependencies": {
        "typescript": ">=4.8.4 <6.0.0"
      }
    },
    "node_modules/@typescript-eslint/scope-manager": {
      "version": "8.53.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/scope-manager/-/scope-manager-8.53.0.tgz",
      "integrity": "sha512-kWNj3l01eOGSdVBnfAF2K1BTh06WS0Yet6JUgb9Cmkqaz3Jlu0fdVUjj9UI8gPidBWSMqDIglmEXifSgDT/D0g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@typescript-eslint/types": "8.53.0",
        "@typescript-eslint/visitor-keys": "8.53.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      }
    },
    "node_modules/@typescript-eslint/tsconfig-utils": {
      "version": "8.53.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/tsconfig-utils/-/tsconfig-utils-8.53.0.tgz",
      "integrity": "sha512-K6Sc0R5GIG6dNoPdOooQ+KtvT5KCKAvTcY8h2rIuul19vxH5OTQk7ArKkd4yTzkw66WnNY0kPPzzcmWA+XRmiA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      },
      "peerDependencies": {
        "typescript": ">=4.8.4 <6.0.0"
      }
    },
    "node_modules/@typescript-eslint/type-utils": {
      "version": "8.53.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/type-utils/-/type-utils-8.53.0.tgz",
      "integrity": "sha512-BBAUhlx7g4SmcLhn8cnbxoxtmS7hcq39xKCgiutL3oNx1TaIp+cny51s8ewnKMpVUKQUGb41RAUWZ9kxYdovuw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@typescript-eslint/types": "8.53.0",
        "@typescript-eslint/typescript-estree": "8.53.0",
        "@typescript-eslint/utils": "8.53.0",
        "debug": "^4.4.3",
        "ts-api-utils": "^2.4.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      },
      "peerDependencies": {
        "eslint": "^8.57.0 || ^9.0.0",
        "typescript": ">=4.8.4 <6.0.0"
      }
    },
    "node_modules/@typescript-eslint/types": {
      "version": "8.53.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/types/-/types-8.53.0.tgz",
      "integrity": "sha512-Bmh9KX31Vlxa13+PqPvt4RzKRN1XORYSLlAE+sO1i28NkisGbTtSLFVB3l7PWdHtR3E0mVMuC7JilWJ99m2HxQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      }
    },
    "node_modules/@typescript-eslint/typescript-estree": {
      "version": "8.53.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/typescript-estree/-/typescript-estree-8.53.0.tgz",
      "integrity": "sha512-pw0c0Gdo7Z4xOG987u3nJ8akL9093yEEKv8QTJ+Bhkghj1xyj8cgPaavlr9rq8h7+s6plUJ4QJYw2gCZodqmGw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@typescript-eslint/project-service": "8.53.0",
        "@typescript-eslint/tsconfig-utils": "8.53.0",
        "@typescript-eslint/types": "8.53.0",
        "@typescript-eslint/visitor-keys": "8.53.0",
        "debug": "^4.4.3",
        "minimatch": "^9.0.5",
        "semver": "^7.7.3",
        "tinyglobby": "^0.2.15",
        "ts-api-utils": "^2.4.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      },
      "peerDependencies": {
        "typescript": ">=4.8.4 <6.0.0"
      }
    },
    "node_modules/@typescript-eslint/typescript-estree/node_modules/brace-expansion": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-2.0.2.tgz",
      "integrity": "sha512-Jt0vHyM+jmUBqojB7E1NIYadt0vI0Qxjxd2TErW94wDz+E2LAm5vKMXXwg6ZZBTHPuUlDgQHKXvjGBdfcF1ZDQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "balanced-match": "^1.0.0"
      }
    },
    "node_modules/@typescript-eslint/typescript-estree/node_modules/minimatch": {
      "version": "9.0.5",
      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-9.0.5.tgz",
      "integrity": "sha512-G6T0ZX48xgozx7587koeX9Ys2NYy6Gmv//P89sEte9V9whIapMNF4idKxnW2QtCcLiTWlb/wfCabAtAFWhhBow==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "brace-expansion": "^2.0.1"
      },
      "engines": {
        "node": ">=16 || 14 >=14.17"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/@typescript-eslint/utils": {
      "version": "8.53.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/utils/-/utils-8.53.0.tgz",
      "integrity": "sha512-XDY4mXTez3Z1iRDI5mbRhH4DFSt46oaIFsLg+Zn97+sYrXACziXSQcSelMybnVZ5pa1P6xYkPr5cMJyunM1ZDA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@eslint-community/eslint-utils": "^4.9.1",
        "@typescript-eslint/scope-manager": "8.53.0",
        "@typescript-eslint/types": "8.53.0",
        "@typescript-eslint/typescript-estree": "8.53.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      },
      "peerDependencies": {
        "eslint": "^8.57.0 || ^9.0.0",
        "typescript": ">=4.8.4 <6.0.0"
      }
    },
    "node_modules/@typescript-eslint/visitor-keys": {
      "version": "8.53.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/visitor-keys/-/visitor-keys-8.53.0.tgz",
      "integrity": "sha512-LZ2NqIHFhvFwxG0qZeLL9DvdNAHPGCY5dIRwBhyYeU+LfLhcStE1ImjsuTG/WaVh3XysGaeLW8Rqq7cGkPCFvw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@typescript-eslint/types": "8.53.0",
        "eslint-visitor-keys": "^4.2.1"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      }
    },
    "node_modules/@unrs/resolver-binding-android-arm-eabi": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-android-arm-eabi/-/resolver-binding-android-arm-eabi-1.11.1.tgz",
      "integrity": "sha512-ppLRUgHVaGRWUx0R0Ut06Mjo9gBaBkg3v/8AxusGLhsIotbBLuRk51rAzqLC8gq6NyyAojEXglNjzf6R948DNw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ]
    },
    "node_modules/@unrs/resolver-binding-android-arm64": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-android-arm64/-/resolver-binding-android-arm64-1.11.1.tgz",
      "integrity": "sha512-lCxkVtb4wp1v+EoN+HjIG9cIIzPkX5OtM03pQYkG+U5O/wL53LC4QbIeazgiKqluGeVEeBlZahHalCaBvU1a2g==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ]
    },
    "node_modules/@unrs/resolver-binding-darwin-arm64": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-darwin-arm64/-/resolver-binding-darwin-arm64-1.11.1.tgz",
      "integrity": "sha512-gPVA1UjRu1Y/IsB/dQEsp2V1pm44Of6+LWvbLc9SDk1c2KhhDRDBUkQCYVWe6f26uJb3FOK8saWMgtX8IrMk3g==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ]
    },
    "node_modules/@unrs/resolver-binding-darwin-x64": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-darwin-x64/-/resolver-binding-darwin-x64-1.11.1.tgz",
      "integrity": "sha512-cFzP7rWKd3lZaCsDze07QX1SC24lO8mPty9vdP+YVa3MGdVgPmFc59317b2ioXtgCMKGiCLxJ4HQs62oz6GfRQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ]
    },
    "node_modules/@unrs/resolver-binding-freebsd-x64": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-freebsd-x64/-/resolver-binding-freebsd-x64-1.11.1.tgz",
      "integrity": "sha512-fqtGgak3zX4DCB6PFpsH5+Kmt/8CIi4Bry4rb1ho6Av2QHTREM+47y282Uqiu3ZRF5IQioJQ5qWRV6jduA+iGw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ]
    },
    "node_modules/@unrs/resolver-binding-linux-arm-gnueabihf": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-arm-gnueabihf/-/resolver-binding-linux-arm-gnueabihf-1.11.1.tgz",
      "integrity": "sha512-u92mvlcYtp9MRKmP+ZvMmtPN34+/3lMHlyMj7wXJDeXxuM0Vgzz0+PPJNsro1m3IZPYChIkn944wW8TYgGKFHw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@unrs/resolver-binding-linux-arm-musleabihf": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-arm-musleabihf/-/resolver-binding-linux-arm-musleabihf-1.11.1.tgz",
      "integrity": "sha512-cINaoY2z7LVCrfHkIcmvj7osTOtm6VVT16b5oQdS4beibX2SYBwgYLmqhBjA1t51CarSaBuX5YNsWLjsqfW5Cw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@unrs/resolver-binding-linux-arm64-gnu": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-arm64-gnu/-/resolver-binding-linux-arm64-gnu-1.11.1.tgz",
      "integrity": "sha512-34gw7PjDGB9JgePJEmhEqBhWvCiiWCuXsL9hYphDF7crW7UgI05gyBAi6MF58uGcMOiOqSJ2ybEeCvHcq0BCmQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@unrs/resolver-binding-linux-arm64-musl": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-arm64-musl/-/resolver-binding-linux-arm64-musl-1.11.1.tgz",
      "integrity": "sha512-RyMIx6Uf53hhOtJDIamSbTskA99sPHS96wxVE/bJtePJJtpdKGXO1wY90oRdXuYOGOTuqjT8ACccMc4K6QmT3w==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@unrs/resolver-binding-linux-ppc64-gnu": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-ppc64-gnu/-/resolver-binding-linux-ppc64-gnu-1.11.1.tgz",
      "integrity": "sha512-D8Vae74A4/a+mZH0FbOkFJL9DSK2R6TFPC9M+jCWYia/q2einCubX10pecpDiTmkJVUH+y8K3BZClycD8nCShA==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@unrs/resolver-binding-linux-riscv64-gnu": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-riscv64-gnu/-/resolver-binding-linux-riscv64-gnu-1.11.1.tgz",
      "integrity": "sha512-frxL4OrzOWVVsOc96+V3aqTIQl1O2TjgExV4EKgRY09AJ9leZpEg8Ak9phadbuX0BA4k8U5qtvMSQQGGmaJqcQ==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@unrs/resolver-binding-linux-riscv64-musl": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-riscv64-musl/-/resolver-binding-linux-riscv64-musl-1.11.1.tgz",
      "integrity": "sha512-mJ5vuDaIZ+l/acv01sHoXfpnyrNKOk/3aDoEdLO/Xtn9HuZlDD6jKxHlkN8ZhWyLJsRBxfv9GYM2utQ1SChKew==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@unrs/resolver-binding-linux-s390x-gnu": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-s390x-gnu/-/resolver-binding-linux-s390x-gnu-1.11.1.tgz",
      "integrity": "sha512-kELo8ebBVtb9sA7rMe1Cph4QHreByhaZ2QEADd9NzIQsYNQpt9UkM9iqr2lhGr5afh885d/cB5QeTXSbZHTYPg==",
      "cpu": [
        "s390x"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@unrs/resolver-binding-linux-x64-gnu": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-x64-gnu/-/resolver-binding-linux-x64-gnu-1.11.1.tgz",
      "integrity": "sha512-C3ZAHugKgovV5YvAMsxhq0gtXuwESUKc5MhEtjBpLoHPLYM+iuwSj3lflFwK3DPm68660rZ7G8BMcwSro7hD5w==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@unrs/resolver-binding-linux-x64-musl": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-linux-x64-musl/-/resolver-binding-linux-x64-musl-1.11.1.tgz",
      "integrity": "sha512-rV0YSoyhK2nZ4vEswT/QwqzqQXw5I6CjoaYMOX0TqBlWhojUf8P94mvI7nuJTeaCkkds3QE4+zS8Ko+GdXuZtA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@unrs/resolver-binding-wasm32-wasi": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-wasm32-wasi/-/resolver-binding-wasm32-wasi-1.11.1.tgz",
      "integrity": "sha512-5u4RkfxJm+Ng7IWgkzi3qrFOvLvQYnPBmjmZQ8+szTK/b31fQCnleNl1GgEt7nIsZRIf5PLhPwT0WM+q45x/UQ==",
      "cpu": [
        "wasm32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "@napi-rs/wasm-runtime": "^0.2.11"
      },
      "engines": {
        "node": ">=14.0.0"
      }
    },
    "node_modules/@unrs/resolver-binding-win32-arm64-msvc": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-win32-arm64-msvc/-/resolver-binding-win32-arm64-msvc-1.11.1.tgz",
      "integrity": "sha512-nRcz5Il4ln0kMhfL8S3hLkxI85BXs3o8EYoattsJNdsX4YUU89iOkVn7g0VHSRxFuVMdM4Q1jEpIId1Ihim/Uw==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@unrs/resolver-binding-win32-ia32-msvc": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-win32-ia32-msvc/-/resolver-binding-win32-ia32-msvc-1.11.1.tgz",
      "integrity": "sha512-DCEI6t5i1NmAZp6pFonpD5m7i6aFrpofcp4LA2i8IIq60Jyo28hamKBxNrZcyOwVOZkgsRp9O2sXWBWP8MnvIQ==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@unrs/resolver-binding-win32-x64-msvc": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/@unrs/resolver-binding-win32-x64-msvc/-/resolver-binding-win32-x64-msvc-1.11.1.tgz",
      "integrity": "sha512-lrW200hZdbfRtztbygyaq/6jP6AKE8qQN2KvPcJ+x7wiD038YtnYtZ82IMNJ69GJibV7bwL3y9FgK+5w/pYt6g==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/acorn": {
      "version": "8.15.0",
      "resolved": "https://registry.npmjs.org/acorn/-/acorn-8.15.0.tgz",
      "integrity": "sha512-NZyJarBfL7nWwIq+FDL6Zp/yHEhePMNnnJ0y3qfieCrmNvYct8uvtiV41UvlSe6apAfk0fY1FbWx+NwfmpvtTg==",
      "dev": true,
      "license": "MIT",
      "bin": {
        "acorn": "bin/acorn"
      },
      "engines": {
        "node": ">=0.4.0"
      }
    },
    "node_modules/acorn-jsx": {
      "version": "5.3.2",
      "resolved": "https://registry.npmjs.org/acorn-jsx/-/acorn-jsx-5.3.2.tgz",
      "integrity": "sha512-rq9s+JNhf0IChjtDXxllJ7g41oZk5SlXtp0LHwyA5cejwn7vKmKp4pPri6YEePv2PU65sAsegbXtIinmDFDXgQ==",
      "dev": true,
      "license": "MIT",
      "peerDependencies": {
        "acorn": "^6.0.0 || ^7.0.0 || ^8.0.0"
      }
    },
    "node_modules/ajv": {
      "version": "6.12.6",
      "resolved": "https://registry.npmjs.org/ajv/-/ajv-6.12.6.tgz",
      "integrity": "sha512-j3FVLgvTo527anyYyJOGTYJbG+vnnQYvE0m5mmkc1TK+nxAppkCLMIL0aZ4dblVCNoGShhm+kzE4ZUykBoMg4g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "fast-deep-equal": "^3.1.1",
        "fast-json-stable-stringify": "^2.0.0",
        "json-schema-traverse": "^0.4.1",
        "uri-js": "^4.2.2"
      },
      "funding": {
        "type": "github",
        "url": "https://github.com/sponsors/epoberezkin"
      }
    },
    "node_modules/ansi-styles": {
      "version": "4.3.0",
      "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-4.3.0.tgz",
      "integrity": "sha512-zbB9rCJAT1rbjiVDb2hqKFHNYLxgtk8NURxZ3IZwD3F6NtxbXZQCnnSi1Lkx+IDohdPlFp222wVALIheZJQSEg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "color-convert": "^2.0.1"
      },
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/chalk/ansi-styles?sponsor=1"
      }
    },
    "node_modules/argparse": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/argparse/-/argparse-2.0.1.tgz",
      "integrity": "sha512-8+9WqebbFzpX9OR+Wa6O29asIogeRMzcGtAINdpMHHyAg10f05aSFVBbcEqGf/PXw1EjAZ+q2/bEBg3DvurK3Q==",
      "dev": true,
      "license": "Python-2.0"
    },
    "node_modules/aria-query": {
      "version": "5.3.2",
      "resolved": "https://registry.npmjs.org/aria-query/-/aria-query-5.3.2.tgz",
      "integrity": "sha512-COROpnaoap1E2F000S62r6A60uHZnmlvomhfyT2DlTcrY1OrBKn2UhH7qn5wTC9zMvD0AY7csdPSNwKP+7WiQw==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/array-buffer-byte-length": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/array-buffer-byte-length/-/array-buffer-byte-length-1.0.2.tgz",
      "integrity": "sha512-LHE+8BuR7RYGDKvnrmcuSq3tDcKv9OFEXQt/HpbZhY7V6h0zlUXutnAD82GiFx9rdieCMjkvtcsPqBwgUl1Iiw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3",
        "is-array-buffer": "^3.0.5"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/array-includes": {
      "version": "3.1.9",
      "resolved": "https://registry.npmjs.org/array-includes/-/array-includes-3.1.9.tgz",
      "integrity": "sha512-FmeCCAenzH0KH381SPT5FZmiA/TmpndpcaShhfgEN9eCVjnFBqq3l1xrI42y8+PPLI6hypzou4GXw00WHmPBLQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.4",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.24.0",
        "es-object-atoms": "^1.1.1",
        "get-intrinsic": "^1.3.0",
        "is-string": "^1.1.1",
        "math-intrinsics": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/array.prototype.findlast": {
      "version": "1.2.5",
      "resolved": "https://registry.npmjs.org/array.prototype.findlast/-/array.prototype.findlast-1.2.5.tgz",
      "integrity": "sha512-CVvd6FHg1Z3POpBLxO6E6zr+rSKEQ9L6rZHAaY7lLfhKsWYUBBOuMs0e9o24oopj6H+geRCX0YJ+TJLBK2eHyQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.7",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.2",
        "es-errors": "^1.3.0",
        "es-object-atoms": "^1.0.0",
        "es-shim-unscopables": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/array.prototype.findlastindex": {
      "version": "1.2.6",
      "resolved": "https://registry.npmjs.org/array.prototype.findlastindex/-/array.prototype.findlastindex-1.2.6.tgz",
      "integrity": "sha512-F/TKATkzseUExPlfvmwQKGITM3DGTK+vkAsCZoDc5daVygbJBnjEUCbgkAvVFsgfXfX4YIqZ/27G3k3tdXrTxQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.4",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.9",
        "es-errors": "^1.3.0",
        "es-object-atoms": "^1.1.1",
        "es-shim-unscopables": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/array.prototype.flat": {
      "version": "1.3.3",
      "resolved": "https://registry.npmjs.org/array.prototype.flat/-/array.prototype.flat-1.3.3.tgz",
      "integrity": "sha512-rwG/ja1neyLqCuGZ5YYrznA62D4mZXg0i1cIskIUKSiqF3Cje9/wXAls9B9s1Wa2fomMsIv8czB8jZcPmxCXFg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.5",
        "es-shim-unscopables": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/array.prototype.flatmap": {
      "version": "1.3.3",
      "resolved": "https://registry.npmjs.org/array.prototype.flatmap/-/array.prototype.flatmap-1.3.3.tgz",
      "integrity": "sha512-Y7Wt51eKJSyi80hFrJCePGGNo5ktJCslFuboqJsbf57CCPcm5zztluPlc4/aD8sWsKvlwatezpV4U1efk8kpjg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.5",
        "es-shim-unscopables": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/array.prototype.tosorted": {
      "version": "1.1.4",
      "resolved": "https://registry.npmjs.org/array.prototype.tosorted/-/array.prototype.tosorted-1.1.4.tgz",
      "integrity": "sha512-p6Fx8B7b7ZhL/gmUsAy0D15WhvDccw3mnGNbZpi3pmeJdxtWsj2jEaI4Y6oo3XiHfzuSgPwKc04MYt6KgvC/wA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.7",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.3",
        "es-errors": "^1.3.0",
        "es-shim-unscopables": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/arraybuffer.prototype.slice": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/arraybuffer.prototype.slice/-/arraybuffer.prototype.slice-1.0.4.tgz",
      "integrity": "sha512-BNoCY6SXXPQ7gF2opIP4GBE+Xw7U+pHMYKuzjgCN3GwiaIR09UUeKfheyIry77QtrCBlC0KK0q5/TER/tYh3PQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "array-buffer-byte-length": "^1.0.1",
        "call-bind": "^1.0.8",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.5",
        "es-errors": "^1.3.0",
        "get-intrinsic": "^1.2.6",
        "is-array-buffer": "^3.0.4"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/ast-types-flow": {
      "version": "0.0.8",
      "resolved": "https://registry.npmjs.org/ast-types-flow/-/ast-types-flow-0.0.8.tgz",
      "integrity": "sha512-OH/2E5Fg20h2aPrbe+QL8JZQFko0YZaF+j4mnQ7BGhfavO7OpSLa8a0y9sBwomHdSbkhTS8TQNayBfnW5DwbvQ==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/async-function": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/async-function/-/async-function-1.0.0.tgz",
      "integrity": "sha512-hsU18Ae8CDTR6Kgu9DYf0EbCr/a5iGL0rytQDobUcdpYOKokk8LEjVphnXkDkgpi0wYVsqrXuP0bZxJaTqdgoA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/available-typed-arrays": {
      "version": "1.0.7",
      "resolved": "https://registry.npmjs.org/available-typed-arrays/-/available-typed-arrays-1.0.7.tgz",
      "integrity": "sha512-wvUjBtSGN7+7SjNpq/9M2Tg350UZD3q62IFZLbRAR1bSMlCo1ZaeW+BJ+D090e4hIIZLBcTDWe4Mh4jvUDajzQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "possible-typed-array-names": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/axe-core": {
      "version": "4.11.1",
      "resolved": "https://registry.npmjs.org/axe-core/-/axe-core-4.11.1.tgz",
      "integrity": "sha512-BASOg+YwO2C+346x3LZOeoovTIoTrRqEsqMa6fmfAV0P+U9mFr9NsyOEpiYvFjbc64NMrSswhV50WdXzdb/Z5A==",
      "dev": true,
      "license": "MPL-2.0",
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/axobject-query": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/axobject-query/-/axobject-query-4.1.0.tgz",
      "integrity": "sha512-qIj0G9wZbMGNLjLmg1PT6v2mE9AH2zlnADJD/2tC6E00hgmhUOfEB6greHPAfLRSufHqROIUTkw6E+M3lH0PTQ==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/balanced-match": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/balanced-match/-/balanced-match-1.0.2.tgz",
      "integrity": "sha512-3oSeUO0TMV67hN1AmbXsK4yaqU7tjiHlbxRDZOpH0KW9+CeX4bRAaX0Anxt0tx2MrpRpWwQaPwIlISEJhYU5Pw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/brace-expansion": {
      "version": "1.1.12",
      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-1.1.12.tgz",
      "integrity": "sha512-9T9UjW3r0UW5c1Q7GTwllptXwhvYmEzFhzMfZ9H7FQWt+uZePjZPjBP/W1ZEyZ1twGWom5/56TF4lPcqjnDHcg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "balanced-match": "^1.0.0",
        "concat-map": "0.0.1"
      }
    },
    "node_modules/braces": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/braces/-/braces-3.0.3.tgz",
      "integrity": "sha512-yQbXgO/OSZVD2IsiLlro+7Hf6Q18EJrKSEsdoMzKePKXct3gvD8oLcOQdIzGupr5Fj+EDe8gO/lxc1BzfMpxvA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "fill-range": "^7.1.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/busboy": {
      "version": "1.6.0",
      "resolved": "https://registry.npmjs.org/busboy/-/busboy-1.6.0.tgz",
      "integrity": "sha512-8SFQbg/0hQ9xy3UNTB0YEnsNBbWfhf7RtnzpL7TkBiTBRfrQ9Fxcnz7VJsleJpyp6rVLvXiuORqjlHi5q+PYuA==",
      "dependencies": {
        "streamsearch": "^1.1.0"
      },
      "engines": {
        "node": ">=10.16.0"
      }
    },
    "node_modules/call-bind": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/call-bind/-/call-bind-1.0.8.tgz",
      "integrity": "sha512-oKlSFMcMwpUg2ednkhQ454wfWiU/ul3CkJe/PEHcTKuiX6RpbehUiFMXu13HalGZxfUwCQzZG747YXBn1im9ww==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.0",
        "es-define-property": "^1.0.0",
        "get-intrinsic": "^1.2.4",
        "set-function-length": "^1.2.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/call-bind-apply-helpers": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/call-bind-apply-helpers/-/call-bind-apply-helpers-1.0.2.tgz",
      "integrity": "sha512-Sp1ablJ0ivDkSzjcaJdxEunN5/XvksFJ2sMBFfq6x0ryhQV/2b/KwFe21cMpmHtPOSij8K99/wSfoEuTObmuMQ==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "function-bind": "^1.1.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/call-bound": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/call-bound/-/call-bound-1.0.4.tgz",
      "integrity": "sha512-+ys997U96po4Kx/ABpBCqhA9EuxJaQWDQg7295H4hBphv3IZg0boBKuwYpt4YXp6MZ5AmZQnU/tyMTlRpaSejg==",
      "license": "MIT",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.2",
        "get-intrinsic": "^1.3.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/callsites": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/callsites/-/callsites-3.1.0.tgz",
      "integrity": "sha512-P8BjAsXvZS+VIDUI11hHCQEv74YT67YUi5JJFNWIqL235sBmjX4+qx9Muvls5ivyNENctx46xQLQ3aTuE7ssaQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/caniuse-lite": {
      "version": "1.0.30001764",
      "resolved": "https://registry.npmjs.org/caniuse-lite/-/caniuse-lite-1.0.30001764.tgz",
      "integrity": "sha512-9JGuzl2M+vPL+pz70gtMF9sHdMFbY9FJaQBi186cHKH3pSzDvzoUJUPV6fqiKIMyXbud9ZLg4F3Yza1vJ1+93g==",
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/caniuse-lite"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "CC-BY-4.0"
    },
    "node_modules/chalk": {
      "version": "4.1.2",
      "resolved": "https://registry.npmjs.org/chalk/-/chalk-4.1.2.tgz",
      "integrity": "sha512-oKnbhFyRIXpUuez8iBMmyEa4nbj4IOQyuhc/wy9kY7/WVPcwIO9VA668Pu8RkO7+0G76SLROeyw9CpQ061i4mA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "ansi-styles": "^4.1.0",
        "supports-color": "^7.1.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/chalk/chalk?sponsor=1"
      }
    },
    "node_modules/class-variance-authority": {
      "version": "0.7.1",
      "resolved": "https://registry.npmjs.org/class-variance-authority/-/class-variance-authority-0.7.1.tgz",
      "integrity": "sha512-Ka+9Trutv7G8M6WT6SeiRWz792K5qEqIGEGzXKhAE6xOWAY6pPH8U+9IY3oCMv6kqTmLsv7Xh/2w2RigkePMsg==",
      "license": "Apache-2.0",
      "dependencies": {
        "clsx": "^2.1.1"
      },
      "funding": {
        "url": "https://polar.sh/cva"
      }
    },
    "node_modules/client-only": {
      "version": "0.0.1",
      "resolved": "https://registry.npmjs.org/client-only/-/client-only-0.0.1.tgz",
      "integrity": "sha512-IV3Ou0jSMzZrd3pZ48nLkT9DA7Ag1pnPzaiQhpW7c3RbcqqzvzzVu+L8gfqMp/8IM2MQtSiqaCxrrcfu8I8rMA==",
      "license": "MIT"
    },
    "node_modules/clsx": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/clsx/-/clsx-2.1.1.tgz",
      "integrity": "sha512-eYm0QWBtUrBWZWG0d386OGAw16Z995PiOVo2B7bjWSbHedGl5e0ZWaq65kOGgUSNesEIDkB9ISbTg/JK9dhCZA==",
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/color": {
      "version": "4.2.3",
      "resolved": "https://registry.npmjs.org/color/-/color-4.2.3.tgz",
      "integrity": "sha512-1rXeuUUiGGrykh+CeBdu5Ie7OJwinCgQY0bc7GCRxy5xVHy+moaqkpL/jqQq0MtQOeYcrqEz4abc5f0KtU7W4A==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "color-convert": "^2.0.1",
        "color-string": "^1.9.0"
      },
      "engines": {
        "node": ">=12.5.0"
      }
    },
    "node_modules/color-convert": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/color-convert/-/color-convert-2.0.1.tgz",
      "integrity": "sha512-RRECPsj7iu/xb5oKYcsFHSppFNnsj/52OVTRKb4zP5onXwVF3zVmmToNcOfGC+CRDpfK/U584FMg38ZHCaElKQ==",
      "devOptional": true,
      "license": "MIT",
      "dependencies": {
        "color-name": "~1.1.4"
      },
      "engines": {
        "node": ">=7.0.0"
      }
    },
    "node_modules/color-name": {
      "version": "1.1.4",
      "resolved": "https://registry.npmjs.org/color-name/-/color-name-1.1.4.tgz",
      "integrity": "sha512-dOy+3AuW3a2wNbZHIuMZpTcgjGuLU/uBL/ubcZF9OXbDo8ff4O8yVp5Bf0efS8uEoYo5q4Fx7dY9OgQGXgAsQA==",
      "devOptional": true,
      "license": "MIT"
    },
    "node_modules/color-string": {
      "version": "1.9.1",
      "resolved": "https://registry.npmjs.org/color-string/-/color-string-1.9.1.tgz",
      "integrity": "sha512-shrVawQFojnZv6xM40anx4CkoDP+fZsw/ZerEMsW/pyzsRbElpsL/DBVW7q3ExxwusdNXI3lXpuhEZkzs8p5Eg==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "color-name": "^1.0.0",
        "simple-swizzle": "^0.2.2"
      }
    },
    "node_modules/concat-map": {
      "version": "0.0.1",
      "resolved": "https://registry.npmjs.org/concat-map/-/concat-map-0.0.1.tgz",
      "integrity": "sha512-/Srv4dswyQNBfohGpz9o6Yb3Gz3SrUDqBH5rTuhGR7ahtlbYKnVxw2bCFMRljaA7EXHaXZ8wsHdodFvbkhKmqg==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/cookie": {
      "version": "0.7.2",
      "resolved": "https://registry.npmjs.org/cookie/-/cookie-0.7.2.tgz",
      "integrity": "sha512-yki5XnKuf750l50uGTllt6kKILY4nQ1eNIQatoXEByZ5dWgnKqbnqmTrBE5B4N7lrMJKQ2ytWMiTO2o0v6Ew/w==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/cross-spawn": {
      "version": "7.0.6",
      "resolved": "https://registry.npmjs.org/cross-spawn/-/cross-spawn-7.0.6.tgz",
      "integrity": "sha512-uV2QOWP2nWzsy2aMp8aRibhi9dlzF5Hgh5SHaB9OiTGEyDTiJJyx0uy51QXdyWbtAHNua4XJzUKca3OzKUd3vA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "path-key": "^3.1.0",
        "shebang-command": "^2.0.0",
        "which": "^2.0.1"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/csstype": {
      "version": "3.2.3",
      "resolved": "https://registry.npmjs.org/csstype/-/csstype-3.2.3.tgz",
      "integrity": "sha512-z1HGKcYy2xA8AGQfwrn0PAy+PB7X/GSj3UVJW9qKyn43xWa+gl5nXmU4qqLMRzWVLFC8KusUX8T/0kCiOYpAIQ==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/damerau-levenshtein": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/damerau-levenshtein/-/damerau-levenshtein-1.0.8.tgz",
      "integrity": "sha512-sdQSFB7+llfUcQHUQO3+B8ERRj0Oa4w9POWMI/puGtuf7gFywGmkaLCElnudfTiKZV+NvHqL0ifzdrI8Ro7ESA==",
      "dev": true,
      "license": "BSD-2-Clause"
    },
    "node_modules/data-view-buffer": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/data-view-buffer/-/data-view-buffer-1.0.2.tgz",
      "integrity": "sha512-EmKO5V3OLXh1rtK2wgXRansaK1/mtVdTUEiEI0W8RkvgT05kfxaH29PliLnpLP73yYO6142Q72QNa8Wx/A5CqQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3",
        "es-errors": "^1.3.0",
        "is-data-view": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/data-view-byte-length": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/data-view-byte-length/-/data-view-byte-length-1.0.2.tgz",
      "integrity": "sha512-tuhGbE6CfTM9+5ANGf+oQb72Ky/0+s3xKUpHvShfiz2RxMFgFPjsXuRLBVMtvMs15awe45SRb83D6wH4ew6wlQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3",
        "es-errors": "^1.3.0",
        "is-data-view": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/inspect-js"
      }
    },
    "node_modules/data-view-byte-offset": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/data-view-byte-offset/-/data-view-byte-offset-1.0.1.tgz",
      "integrity": "sha512-BS8PfmtDGnrgYdOonGZQdLZslWIeCGFP9tpan0hi1Co2Zr2NKADsvGYA8XxuG/4UWgJ6Cjtv+YJnB6MM69QGlQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.2",
        "es-errors": "^1.3.0",
        "is-data-view": "^1.0.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/date-fns": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/date-fns/-/date-fns-4.1.0.tgz",
      "integrity": "sha512-Ukq0owbQXxa/U3EGtsdVBkR1w7KOQ5gIBqdH2hkvknzZPYvBxb/aa6E8L7tmjFtkwZBu3UXBbjIgPo/Ez4xaNg==",
      "license": "MIT",
      "funding": {
        "type": "github",
        "url": "https://github.com/sponsors/kossnocorp"
      }
    },
    "node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/deep-is": {
      "version": "0.1.4",
      "resolved": "https://registry.npmjs.org/deep-is/-/deep-is-0.1.4.tgz",
      "integrity": "sha512-oIPzksmTg4/MriiaYGO+okXDT7ztn/w3Eptv/+gSIdMdKsJo0u4CfYNFJPy+4SKMuCqGw2wxnA+URMg3t8a/bQ==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/define-data-property": {
      "version": "1.1.4",
      "resolved": "https://registry.npmjs.org/define-data-property/-/define-data-property-1.1.4.tgz",
      "integrity": "sha512-rBMvIzlpA8v6E+SJZoo++HAYqsLrkg7MSfIinMPFhmkorw7X+dOXVJQs+QT69zGkzMyfDnIMN2Wid1+NbL3T+A==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "es-define-property": "^1.0.0",
        "es-errors": "^1.3.0",
        "gopd": "^1.0.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/define-properties": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/define-properties/-/define-properties-1.2.1.tgz",
      "integrity": "sha512-8QmQKqEASLd5nx0U1B1okLElbUuuttJ/AnYmRXbbbGDWh6uS208EjD4Xqq/I9wK7u0v6O08XhTWnt5XtEbR6Dg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "define-data-property": "^1.0.1",
        "has-property-descriptors": "^1.0.0",
        "object-keys": "^1.1.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/detect-libc": {
      "version": "2.1.2",
      "resolved": "https://registry.npmjs.org/detect-libc/-/detect-libc-2.1.2.tgz",
      "integrity": "sha512-Btj2BOOO83o3WyH59e8MgXsxEQVcarkUOpEYrubB0urwnN10yQ364rsiByU11nZlqWYZm05i/of7io4mzihBtQ==",
      "devOptional": true,
      "license": "Apache-2.0",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/doctrine": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/doctrine/-/doctrine-2.1.0.tgz",
      "integrity": "sha512-35mSku4ZXK0vfCuHEDAwt55dg2jNajHZ1odvF+8SSr82EsZY4QmXfuWso8oEd8zRhVObSN18aM0CjSdoBX7zIw==",
      "dev": true,
      "license": "Apache-2.0",
      "dependencies": {
        "esutils": "^2.0.2"
      },
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/dunder-proto": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/dunder-proto/-/dunder-proto-1.0.1.tgz",
      "integrity": "sha512-KIN/nDJBQRcXw0MLVhZE9iQHmG68qAVIBg9CqmUYjmQIhgij9U5MFvrqkUL5FbtyyzZuOeOt0zdeRe4UY7ct+A==",
      "license": "MIT",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.1",
        "es-errors": "^1.3.0",
        "gopd": "^1.2.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/emoji-regex": {
      "version": "9.2.2",
      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-9.2.2.tgz",
      "integrity": "sha512-L18DaJsXSUk2+42pv8mLs5jJT2hqFkFE4j21wOmgbUqsZ2hL72NsUU785g9RXgo3s0ZNgVl42TiHp3ZtOv/Vyg==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/enhanced-resolve": {
      "version": "5.18.4",
      "resolved": "https://registry.npmjs.org/enhanced-resolve/-/enhanced-resolve-5.18.4.tgz",
      "integrity": "sha512-LgQMM4WXU3QI+SYgEc2liRgznaD5ojbmY3sb8LxyguVkIg5FxdpTkvk72te2R38/TGKxH634oLxXRGY6d7AP+Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "graceful-fs": "^4.2.4",
        "tapable": "^2.2.0"
      },
      "engines": {
        "node": ">=10.13.0"
      }
    },
    "node_modules/es-abstract": {
      "version": "1.24.1",
      "resolved": "https://registry.npmjs.org/es-abstract/-/es-abstract-1.24.1.tgz",
      "integrity": "sha512-zHXBLhP+QehSSbsS9Pt23Gg964240DPd6QCf8WpkqEXxQ7fhdZzYsocOr5u7apWonsS5EjZDmTF+/slGMyasvw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "array-buffer-byte-length": "^1.0.2",
        "arraybuffer.prototype.slice": "^1.0.4",
        "available-typed-arrays": "^1.0.7",
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.4",
        "data-view-buffer": "^1.0.2",
        "data-view-byte-length": "^1.0.2",
        "data-view-byte-offset": "^1.0.1",
        "es-define-property": "^1.0.1",
        "es-errors": "^1.3.0",
        "es-object-atoms": "^1.1.1",
        "es-set-tostringtag": "^2.1.0",
        "es-to-primitive": "^1.3.0",
        "function.prototype.name": "^1.1.8",
        "get-intrinsic": "^1.3.0",
        "get-proto": "^1.0.1",
        "get-symbol-description": "^1.1.0",
        "globalthis": "^1.0.4",
        "gopd": "^1.2.0",
        "has-property-descriptors": "^1.0.2",
        "has-proto": "^1.2.0",
        "has-symbols": "^1.1.0",
        "hasown": "^2.0.2",
        "internal-slot": "^1.1.0",
        "is-array-buffer": "^3.0.5",
        "is-callable": "^1.2.7",
        "is-data-view": "^1.0.2",
        "is-negative-zero": "^2.0.3",
        "is-regex": "^1.2.1",
        "is-set": "^2.0.3",
        "is-shared-array-buffer": "^1.0.4",
        "is-string": "^1.1.1",
        "is-typed-array": "^1.1.15",
        "is-weakref": "^1.1.1",
        "math-intrinsics": "^1.1.0",
        "object-inspect": "^1.13.4",
        "object-keys": "^1.1.1",
        "object.assign": "^4.1.7",
        "own-keys": "^1.0.1",
        "regexp.prototype.flags": "^1.5.4",
        "safe-array-concat": "^1.1.3",
        "safe-push-apply": "^1.0.0",
        "safe-regex-test": "^1.1.0",
        "set-proto": "^1.0.0",
        "stop-iteration-iterator": "^1.1.0",
        "string.prototype.trim": "^1.2.10",
        "string.prototype.trimend": "^1.0.9",
        "string.prototype.trimstart": "^1.0.8",
        "typed-array-buffer": "^1.0.3",
        "typed-array-byte-length": "^1.0.3",
        "typed-array-byte-offset": "^1.0.4",
        "typed-array-length": "^1.0.7",
        "unbox-primitive": "^1.1.0",
        "which-typed-array": "^1.1.19"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/es-define-property": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/es-define-property/-/es-define-property-1.0.1.tgz",
      "integrity": "sha512-e3nRfgfUZ4rNGL232gUgX06QNyyez04KdjFrF+LTRoOXmrOgFKDg4BCdsjW8EnT69eqdYGmRpJwiPVYNrCaW3g==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-errors": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/es-errors/-/es-errors-1.3.0.tgz",
      "integrity": "sha512-Zf5H2Kxt2xjTvbJvP2ZWLEICxA6j+hAmMzIlypy4xcBg1vKVnx89Wy0GbS+kf5cwCVFFzdCFh2XSCFNULS6csw==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-iterator-helpers": {
      "version": "1.2.2",
      "resolved": "https://registry.npmjs.org/es-iterator-helpers/-/es-iterator-helpers-1.2.2.tgz",
      "integrity": "sha512-BrUQ0cPTB/IwXj23HtwHjS9n7O4h9FX94b4xc5zlTHxeLgTAdzYUDyy6KdExAl9lbN5rtfe44xpjpmj9grxs5w==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.4",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.24.1",
        "es-errors": "^1.3.0",
        "es-set-tostringtag": "^2.1.0",
        "function-bind": "^1.1.2",
        "get-intrinsic": "^1.3.0",
        "globalthis": "^1.0.4",
        "gopd": "^1.2.0",
        "has-property-descriptors": "^1.0.2",
        "has-proto": "^1.2.0",
        "has-symbols": "^1.1.0",
        "internal-slot": "^1.1.0",
        "iterator.prototype": "^1.1.5",
        "safe-array-concat": "^1.1.3"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-object-atoms": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/es-object-atoms/-/es-object-atoms-1.1.1.tgz",
      "integrity": "sha512-FGgH2h8zKNim9ljj7dankFPcICIK9Cp5bm+c2gQSYePhpaG5+esrLODihIorn+Pe6FGJzWhXQotPv73jTaldXA==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-set-tostringtag": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/es-set-tostringtag/-/es-set-tostringtag-2.1.0.tgz",
      "integrity": "sha512-j6vWzfrGVfyXxge+O0x5sh6cvxAog0a/4Rdd2K36zCMV5eJ+/+tOAngRO8cODMNWbVRdVlmGZQL2YS3yR8bIUA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "get-intrinsic": "^1.2.6",
        "has-tostringtag": "^1.0.2",
        "hasown": "^2.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-shim-unscopables": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/es-shim-unscopables/-/es-shim-unscopables-1.1.0.tgz",
      "integrity": "sha512-d9T8ucsEhh8Bi1woXCf+TIKDIROLG5WCkxg8geBCbvk22kzwC5G2OnXVMO6FUsvQlgUUXQ2itephWDLqDzbeCw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "hasown": "^2.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-to-primitive": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/es-to-primitive/-/es-to-primitive-1.3.0.tgz",
      "integrity": "sha512-w+5mJ3GuFL+NjVtJlvydShqE1eN3h3PbI7/5LAsYJP/2qtuMXjfL2LpHSRqo4b4eSF5K/DH1JXKUAHSB2UW50g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "is-callable": "^1.2.7",
        "is-date-object": "^1.0.5",
        "is-symbol": "^1.0.4"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/escape-string-regexp": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/escape-string-regexp/-/escape-string-regexp-4.0.0.tgz",
      "integrity": "sha512-TtpcNJ3XAzx3Gq8sWRzJaVajRs0uVxA2YAkdb1jm2YkPz4G6egUFAyA3n5vtEIZefPk5Wa4UXbKuS5fKkJWdgA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/eslint": {
      "version": "9.39.2",
      "resolved": "https://registry.npmjs.org/eslint/-/eslint-9.39.2.tgz",
      "integrity": "sha512-LEyamqS7W5HB3ujJyvi0HQK/dtVINZvd5mAAp9eT5S/ujByGjiZLCzPcHVzuXbpJDJF/cxwHlfceVUDZ2lnSTw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@eslint-community/eslint-utils": "^4.8.0",
        "@eslint-community/regexpp": "^4.12.1",
        "@eslint/config-array": "^0.21.1",
        "@eslint/config-helpers": "^0.4.2",
        "@eslint/core": "^0.17.0",
        "@eslint/eslintrc": "^3.3.1",
        "@eslint/js": "9.39.2",
        "@eslint/plugin-kit": "^0.4.1",
        "@humanfs/node": "^0.16.6",
        "@humanwhocodes/module-importer": "^1.0.1",
        "@humanwhocodes/retry": "^0.4.2",
        "@types/estree": "^1.0.6",
        "ajv": "^6.12.4",
        "chalk": "^4.0.0",
        "cross-spawn": "^7.0.6",
        "debug": "^4.3.2",
        "escape-string-regexp": "^4.0.0",
        "eslint-scope": "^8.4.0",
        "eslint-visitor-keys": "^4.2.1",
        "espree": "^10.4.0",
        "esquery": "^1.5.0",
        "esutils": "^2.0.2",
        "fast-deep-equal": "^3.1.3",
        "file-entry-cache": "^8.0.0",
        "find-up": "^5.0.0",
        "glob-parent": "^6.0.2",
        "ignore": "^5.2.0",
        "imurmurhash": "^0.1.4",
        "is-glob": "^4.0.0",
        "json-stable-stringify-without-jsonify": "^1.0.1",
        "lodash.merge": "^4.6.2",
        "minimatch": "^3.1.2",
        "natural-compare": "^1.4.0",
        "optionator": "^0.9.3"
      },
      "bin": {
        "eslint": "bin/eslint.js"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "url": "https://eslint.org/donate"
      },
      "peerDependencies": {
        "jiti": "*"
      },
      "peerDependenciesMeta": {
        "jiti": {
          "optional": true
        }
      }
    },
    "node_modules/eslint-config-next": {
      "version": "15.5.9",
      "resolved": "https://registry.npmjs.org/eslint-config-next/-/eslint-config-next-15.5.9.tgz",
      "integrity": "sha512-852JYI3NkFNzW8CqsMhI0K2CDRxTObdZ2jQJj5CtpEaOkYHn13107tHpNuD/h0WRpU4FAbCdUaxQsrfBtNK9Kw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@next/eslint-plugin-next": "15.5.9",
        "@rushstack/eslint-patch": "^1.10.3",
        "@typescript-eslint/eslint-plugin": "^5.4.2 || ^6.0.0 || ^7.0.0 || ^8.0.0",
        "@typescript-eslint/parser": "^5.4.2 || ^6.0.0 || ^7.0.0 || ^8.0.0",
        "eslint-import-resolver-node": "^0.3.6",
        "eslint-import-resolver-typescript": "^3.5.2",
        "eslint-plugin-import": "^2.31.0",
        "eslint-plugin-jsx-a11y": "^6.10.0",
        "eslint-plugin-react": "^7.37.0",
        "eslint-plugin-react-hooks": "^5.0.0"
      },
      "peerDependencies": {
        "eslint": "^7.23.0 || ^8.0.0 || ^9.0.0",
        "typescript": ">=3.3.1"
      },
      "peerDependenciesMeta": {
        "typescript": {
          "optional": true
        }
      }
    },
    "node_modules/eslint-import-resolver-node": {
      "version": "0.3.9",
      "resolved": "https://registry.npmjs.org/eslint-import-resolver-node/-/eslint-import-resolver-node-0.3.9.tgz",
      "integrity": "sha512-WFj2isz22JahUv+B788TlO3N6zL3nNJGU8CcZbPZvVEkBPaJdCV4vy5wyghty5ROFbCRnm132v8BScu5/1BQ8g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "debug": "^3.2.7",
        "is-core-module": "^2.13.0",
        "resolve": "^1.22.4"
      }
    },
    "node_modules/eslint-import-resolver-node/node_modules/debug": {
      "version": "3.2.7",
      "resolved": "https://registry.npmjs.org/debug/-/debug-3.2.7.tgz",
      "integrity": "sha512-CFjzYYAi4ThfiQvizrFQevTTXHtnCqWfe7x1AhgEscTz6ZbLbfoLRLPugTQyBth6f8ZERVUSyWHFD/7Wu4t1XQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.1"
      }
    },
    "node_modules/eslint-import-resolver-typescript": {
      "version": "3.10.1",
      "resolved": "https://registry.npmjs.org/eslint-import-resolver-typescript/-/eslint-import-resolver-typescript-3.10.1.tgz",
      "integrity": "sha512-A1rHYb06zjMGAxdLSkN2fXPBwuSaQ0iO5M/hdyS0Ajj1VBaRp0sPD3dn1FhME3c/JluGFbwSxyCfqdSbtQLAHQ==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "@nolyfill/is-core-module": "1.0.39",
        "debug": "^4.4.0",
        "get-tsconfig": "^4.10.0",
        "is-bun-module": "^2.0.0",
        "stable-hash": "^0.0.5",
        "tinyglobby": "^0.2.13",
        "unrs-resolver": "^1.6.2"
      },
      "engines": {
        "node": "^14.18.0 || >=16.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/eslint-import-resolver-typescript"
      },
      "peerDependencies": {
        "eslint": "*",
        "eslint-plugin-import": "*",
        "eslint-plugin-import-x": "*"
      },
      "peerDependenciesMeta": {
        "eslint-plugin-import": {
          "optional": true
        },
        "eslint-plugin-import-x": {
          "optional": true
        }
      }
    },
    "node_modules/eslint-module-utils": {
      "version": "2.12.1",
      "resolved": "https://registry.npmjs.org/eslint-module-utils/-/eslint-module-utils-2.12.1.tgz",
      "integrity": "sha512-L8jSWTze7K2mTg0vos/RuLRS5soomksDPoJLXIslC7c8Wmut3bx7CPpJijDcBZtxQ5lrbUdM+s0OlNbz0DCDNw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "debug": "^3.2.7"
      },
      "engines": {
        "node": ">=4"
      },
      "peerDependenciesMeta": {
        "eslint": {
          "optional": true
        }
      }
    },
    "node_modules/eslint-module-utils/node_modules/debug": {
      "version": "3.2.7",
      "resolved": "https://registry.npmjs.org/debug/-/debug-3.2.7.tgz",
      "integrity": "sha512-CFjzYYAi4ThfiQvizrFQevTTXHtnCqWfe7x1AhgEscTz6ZbLbfoLRLPugTQyBth6f8ZERVUSyWHFD/7Wu4t1XQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.1"
      }
    },
    "node_modules/eslint-plugin-import": {
      "version": "2.32.0",
      "resolved": "https://registry.npmjs.org/eslint-plugin-import/-/eslint-plugin-import-2.32.0.tgz",
      "integrity": "sha512-whOE1HFo/qJDyX4SnXzP4N6zOWn79WhnCUY/iDR0mPfQZO8wcYE4JClzI2oZrhBnnMUCBCHZhO6VQyoBU95mZA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@rtsao/scc": "^1.1.0",
        "array-includes": "^3.1.9",
        "array.prototype.findlastindex": "^1.2.6",
        "array.prototype.flat": "^1.3.3",
        "array.prototype.flatmap": "^1.3.3",
        "debug": "^3.2.7",
        "doctrine": "^2.1.0",
        "eslint-import-resolver-node": "^0.3.9",
        "eslint-module-utils": "^2.12.1",
        "hasown": "^2.0.2",
        "is-core-module": "^2.16.1",
        "is-glob": "^4.0.3",
        "minimatch": "^3.1.2",
        "object.fromentries": "^2.0.8",
        "object.groupby": "^1.0.3",
        "object.values": "^1.2.1",
        "semver": "^6.3.1",
        "string.prototype.trimend": "^1.0.9",
        "tsconfig-paths": "^3.15.0"
      },
      "engines": {
        "node": ">=4"
      },
      "peerDependencies": {
        "eslint": "^2 || ^3 || ^4 || ^5 || ^6 || ^7.2.0 || ^8 || ^9"
      }
    },
    "node_modules/eslint-plugin-import/node_modules/debug": {
      "version": "3.2.7",
      "resolved": "https://registry.npmjs.org/debug/-/debug-3.2.7.tgz",
      "integrity": "sha512-CFjzYYAi4ThfiQvizrFQevTTXHtnCqWfe7x1AhgEscTz6ZbLbfoLRLPugTQyBth6f8ZERVUSyWHFD/7Wu4t1XQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.1"
      }
    },
    "node_modules/eslint-plugin-import/node_modules/semver": {
      "version": "6.3.1",
      "resolved": "https://registry.npmjs.org/semver/-/semver-6.3.1.tgz",
      "integrity": "sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==",
      "dev": true,
      "license": "ISC",
      "bin": {
        "semver": "bin/semver.js"
      }
    },
    "node_modules/eslint-plugin-jsx-a11y": {
      "version": "6.10.2",
      "resolved": "https://registry.npmjs.org/eslint-plugin-jsx-a11y/-/eslint-plugin-jsx-a11y-6.10.2.tgz",
      "integrity": "sha512-scB3nz4WmG75pV8+3eRUQOHZlNSUhFNq37xnpgRkCCELU3XMvXAxLk1eqWWyE22Ki4Q01Fnsw9BA3cJHDPgn2Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "aria-query": "^5.3.2",
        "array-includes": "^3.1.8",
        "array.prototype.flatmap": "^1.3.2",
        "ast-types-flow": "^0.0.8",
        "axe-core": "^4.10.0",
        "axobject-query": "^4.1.0",
        "damerau-levenshtein": "^1.0.8",
        "emoji-regex": "^9.2.2",
        "hasown": "^2.0.2",
        "jsx-ast-utils": "^3.3.5",
        "language-tags": "^1.0.9",
        "minimatch": "^3.1.2",
        "object.fromentries": "^2.0.8",
        "safe-regex-test": "^1.0.3",
        "string.prototype.includes": "^2.0.1"
      },
      "engines": {
        "node": ">=4.0"
      },
      "peerDependencies": {
        "eslint": "^3 || ^4 || ^5 || ^6 || ^7 || ^8 || ^9"
      }
    },
    "node_modules/eslint-plugin-react": {
      "version": "7.37.5",
      "resolved": "https://registry.npmjs.org/eslint-plugin-react/-/eslint-plugin-react-7.37.5.tgz",
      "integrity": "sha512-Qteup0SqU15kdocexFNAJMvCJEfa2xUKNV4CC1xsVMrIIqEy3SQ/rqyxCWNzfrd3/ldy6HMlD2e0JDVpDg2qIA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "array-includes": "^3.1.8",
        "array.prototype.findlast": "^1.2.5",
        "array.prototype.flatmap": "^1.3.3",
        "array.prototype.tosorted": "^1.1.4",
        "doctrine": "^2.1.0",
        "es-iterator-helpers": "^1.2.1",
        "estraverse": "^5.3.0",
        "hasown": "^2.0.2",
        "jsx-ast-utils": "^2.4.1 || ^3.0.0",
        "minimatch": "^3.1.2",
        "object.entries": "^1.1.9",
        "object.fromentries": "^2.0.8",
        "object.values": "^1.2.1",
        "prop-types": "^15.8.1",
        "resolve": "^2.0.0-next.5",
        "semver": "^6.3.1",
        "string.prototype.matchall": "^4.0.12",
        "string.prototype.repeat": "^1.0.0"
      },
      "engines": {
        "node": ">=4"
      },
      "peerDependencies": {
        "eslint": "^3 || ^4 || ^5 || ^6 || ^7 || ^8 || ^9.7"
      }
    },
    "node_modules/eslint-plugin-react-hooks": {
      "version": "5.2.0",
      "resolved": "https://registry.npmjs.org/eslint-plugin-react-hooks/-/eslint-plugin-react-hooks-5.2.0.tgz",
      "integrity": "sha512-+f15FfK64YQwZdJNELETdn5ibXEUQmW1DZL6KXhNnc2heoy/sg9VJJeT7n8TlMWouzWqSWavFkIhHyIbIAEapg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=10"
      },
      "peerDependencies": {
        "eslint": "^3.0.0 || ^4.0.0 || ^5.0.0 || ^6.0.0 || ^7.0.0 || ^8.0.0-0 || ^9.0.0"
      }
    },
    "node_modules/eslint-plugin-react/node_modules/resolve": {
      "version": "2.0.0-next.5",
      "resolved": "https://registry.npmjs.org/resolve/-/resolve-2.0.0-next.5.tgz",
      "integrity": "sha512-U7WjGVG9sH8tvjW5SmGbQuui75FiyjAX72HX15DwBBwF9dNiQZRQAg9nnPhYy+TUnE0+VcrttuvNI8oSxZcocA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "is-core-module": "^2.13.0",
        "path-parse": "^1.0.7",
        "supports-preserve-symlinks-flag": "^1.0.0"
      },
      "bin": {
        "resolve": "bin/resolve"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/eslint-plugin-react/node_modules/semver": {
      "version": "6.3.1",
      "resolved": "https://registry.npmjs.org/semver/-/semver-6.3.1.tgz",
      "integrity": "sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==",
      "dev": true,
      "license": "ISC",
      "bin": {
        "semver": "bin/semver.js"
      }
    },
    "node_modules/eslint-scope": {
      "version": "8.4.0",
      "resolved": "https://registry.npmjs.org/eslint-scope/-/eslint-scope-8.4.0.tgz",
      "integrity": "sha512-sNXOfKCn74rt8RICKMvJS7XKV/Xk9kA7DyJr8mJik3S7Cwgy3qlkkmyS2uQB3jiJg6VNdZd/pDBJu0nvG2NlTg==",
      "dev": true,
      "license": "BSD-2-Clause",
      "dependencies": {
        "esrecurse": "^4.3.0",
        "estraverse": "^5.2.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "url": "https://opencollective.com/eslint"
      }
    },
    "node_modules/eslint-visitor-keys": {
      "version": "4.2.1",
      "resolved": "https://registry.npmjs.org/eslint-visitor-keys/-/eslint-visitor-keys-4.2.1.tgz",
      "integrity": "sha512-Uhdk5sfqcee/9H/rCOJikYz67o0a2Tw2hGRPOG2Y1R2dg7brRe1uG0yaNQDHu+TO/uQPF/5eCapvYSmHUjt7JQ==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "url": "https://opencollective.com/eslint"
      }
    },
    "node_modules/espree": {
      "version": "10.4.0",
      "resolved": "https://registry.npmjs.org/espree/-/espree-10.4.0.tgz",
      "integrity": "sha512-j6PAQ2uUr79PZhBjP5C5fhl8e39FmRnOjsD5lGnWrFU8i2G776tBK7+nP8KuQUTTyAZUwfQqXAgrVH5MbH9CYQ==",
      "dev": true,
      "license": "BSD-2-Clause",
      "dependencies": {
        "acorn": "^8.15.0",
        "acorn-jsx": "^5.3.2",
        "eslint-visitor-keys": "^4.2.1"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "url": "https://opencollective.com/eslint"
      }
    },
    "node_modules/esquery": {
      "version": "1.7.0",
      "resolved": "https://registry.npmjs.org/esquery/-/esquery-1.7.0.tgz",
      "integrity": "sha512-Ap6G0WQwcU/LHsvLwON1fAQX9Zp0A2Y6Y/cJBl9r/JbW90Zyg4/zbG6zzKa2OTALELarYHmKu0GhpM5EO+7T0g==",
      "dev": true,
      "license": "BSD-3-Clause",
      "dependencies": {
        "estraverse": "^5.1.0"
      },
      "engines": {
        "node": ">=0.10"
      }
    },
    "node_modules/esrecurse": {
      "version": "4.3.0",
      "resolved": "https://registry.npmjs.org/esrecurse/-/esrecurse-4.3.0.tgz",
      "integrity": "sha512-KmfKL3b6G+RXvP8N1vr3Tq1kL/oCFgn2NYXEtqP8/L3pKapUA4G8cFVaoF3SU323CD4XypR/ffioHmkti6/Tag==",
      "dev": true,
      "license": "BSD-2-Clause",
      "dependencies": {
        "estraverse": "^5.2.0"
      },
      "engines": {
        "node": ">=4.0"
      }
    },
    "node_modules/estraverse": {
      "version": "5.3.0",
      "resolved": "https://registry.npmjs.org/estraverse/-/estraverse-5.3.0.tgz",
      "integrity": "sha512-MMdARuVEQziNTeJD8DgMqmhwR11BRQ/cBP+pLtYdSTnf3MIO8fFeiINEbX36ZdNlfU/7A9f3gUw49B3oQsvwBA==",
      "dev": true,
      "license": "BSD-2-Clause",
      "engines": {
        "node": ">=4.0"
      }
    },
    "node_modules/esutils": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/esutils/-/esutils-2.0.3.tgz",
      "integrity": "sha512-kVscqXk4OCp68SZ0dkgEKVi6/8ij300KBWTJq32P/dYeWTSwK41WyTxalN1eRmA5Z9UU/LX9D7FWSmV9SAYx6g==",
      "dev": true,
      "license": "BSD-2-Clause",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/fast-deep-equal": {
      "version": "3.1.3",
      "resolved": "https://registry.npmjs.org/fast-deep-equal/-/fast-deep-equal-3.1.3.tgz",
      "integrity": "sha512-f3qQ9oQy9j2AhBe/H9VC91wLmKBCCU/gDOnKNAYG5hswO7BLKj09Hc5HYNz9cGI++xlpDCIgDaitVs03ATR84Q==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/fast-glob": {
      "version": "3.3.1",
      "resolved": "https://registry.npmjs.org/fast-glob/-/fast-glob-3.3.1.tgz",
      "integrity": "sha512-kNFPyjhh5cKjrUltxs+wFx+ZkbRaxxmZ+X0ZU31SOsxCEtP9VPgtq2teZw1DebupL5GmDaNQ6yKMMVcM41iqDg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@nodelib/fs.stat": "^2.0.2",
        "@nodelib/fs.walk": "^1.2.3",
        "glob-parent": "^5.1.2",
        "merge2": "^1.3.0",
        "micromatch": "^4.0.4"
      },
      "engines": {
        "node": ">=8.6.0"
      }
    },
    "node_modules/fast-glob/node_modules/glob-parent": {
      "version": "5.1.2",
      "resolved": "https://registry.npmjs.org/glob-parent/-/glob-parent-5.1.2.tgz",
      "integrity": "sha512-AOIgSQCepiJYwP3ARnGx+5VnTu2HBYdzbGP45eLw1vr3zB3vZLeyed1sC9hnbcOc9/SrMyM5RPQrkGz4aS9Zow==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "is-glob": "^4.0.1"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/fast-json-stable-stringify": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/fast-json-stable-stringify/-/fast-json-stable-stringify-2.1.0.tgz",
      "integrity": "sha512-lhd/wF+Lk98HZoTCtlVraHtfh5XYijIjalXck7saUtuanSDyLMxnHhSXEDJqHxD7msR8D0uCmqlkwjCV8xvwHw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/fast-levenshtein": {
      "version": "2.0.6",
      "resolved": "https://registry.npmjs.org/fast-levenshtein/-/fast-levenshtein-2.0.6.tgz",
      "integrity": "sha512-DCXu6Ifhqcks7TZKY3Hxp3y6qphY5SJZmrWMDrKcERSOXWQdMhU9Ig/PYrzyw/ul9jOIyh0N4M0tbC5hodg8dw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/fastq": {
      "version": "1.20.1",
      "resolved": "https://registry.npmjs.org/fastq/-/fastq-1.20.1.tgz",
      "integrity": "sha512-GGToxJ/w1x32s/D2EKND7kTil4n8OVk/9mycTc4VDza13lOvpUZTGX3mFSCtV9ksdGBVzvsyAVLM6mHFThxXxw==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "reusify": "^1.0.4"
      }
    },
    "node_modules/file-entry-cache": {
      "version": "8.0.0",
      "resolved": "https://registry.npmjs.org/file-entry-cache/-/file-entry-cache-8.0.0.tgz",
      "integrity": "sha512-XXTUwCvisa5oacNGRP9SfNtYBNAMi+RPwBFmblZEF7N7swHYQS6/Zfk7SRwx4D5j3CH211YNRco1DEMNVfZCnQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "flat-cache": "^4.0.0"
      },
      "engines": {
        "node": ">=16.0.0"
      }
    },
    "node_modules/fill-range": {
      "version": "7.1.1",
      "resolved": "https://registry.npmjs.org/fill-range/-/fill-range-7.1.1.tgz",
      "integrity": "sha512-YsGpe3WHLK8ZYi4tWDg2Jy3ebRz2rXowDxnld4bkQB00cc/1Zw9AWnC0i9ztDJitivtQvaI9KaLyKrc+hBW0yg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "to-regex-range": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/find-up": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/find-up/-/find-up-5.0.0.tgz",
      "integrity": "sha512-78/PXT1wlLLDgTzDs7sjq9hzz0vXD+zn+7wypEe4FXQxCmdmqfGsEPQxmiCSQI3ajFV91bVSsvNtrJRiW6nGng==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "locate-path": "^6.0.0",
        "path-exists": "^4.0.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/flat-cache": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/flat-cache/-/flat-cache-4.0.1.tgz",
      "integrity": "sha512-f7ccFPK3SXFHpx15UIGyRJ/FJQctuKZ0zVuN3FrBo4HnK3cay9VEW0R6yPYFHC0AgqhukPzKjq22t5DmAyqGyw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "flatted": "^3.2.9",
        "keyv": "^4.5.4"
      },
      "engines": {
        "node": ">=16"
      }
    },
    "node_modules/flatted": {
      "version": "3.3.3",
      "resolved": "https://registry.npmjs.org/flatted/-/flatted-3.3.3.tgz",
      "integrity": "sha512-GX+ysw4PBCz0PzosHDepZGANEuFCMLrnRTiEy9McGjmkCQYwRq4A/X786G/fjM/+OjsWSU1ZrY5qyARZmO/uwg==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/for-each": {
      "version": "0.3.5",
      "resolved": "https://registry.npmjs.org/for-each/-/for-each-0.3.5.tgz",
      "integrity": "sha512-dKx12eRCVIzqCxFGplyFKJMPvLEWgmNtUrpTiJIR5u97zEhRG8ySrtboPHZXx7daLxQVrl643cTzbab2tkQjxg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "is-callable": "^1.2.7"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/function-bind": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/function-bind/-/function-bind-1.1.2.tgz",
      "integrity": "sha512-7XHNxH7qX9xG5mIwxkhumTox/MIRNcOgDrxWsMt2pAr23WHp6MrRlN7FBSFpCpr+oVO0F744iUgR82nJMfG2SA==",
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/function.prototype.name": {
      "version": "1.1.8",
      "resolved": "https://registry.npmjs.org/function.prototype.name/-/function.prototype.name-1.1.8.tgz",
      "integrity": "sha512-e5iwyodOHhbMr/yNrc7fDYG4qlbIvI5gajyzPnb5TCwyhjApznQh1BMFou9b30SevY43gCJKXycoCBjMbsuW0Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.3",
        "define-properties": "^1.2.1",
        "functions-have-names": "^1.2.3",
        "hasown": "^2.0.2",
        "is-callable": "^1.2.7"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/functions-have-names": {
      "version": "1.2.3",
      "resolved": "https://registry.npmjs.org/functions-have-names/-/functions-have-names-1.2.3.tgz",
      "integrity": "sha512-xckBUXyTIqT97tq2x2AMb+g163b5JFysYk0x4qxNFwbfQkmNZoiRHb6sPzI9/QV33WeuvVYBUIiD4NzNIyqaRQ==",
      "dev": true,
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/generator-function": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/generator-function/-/generator-function-2.0.1.tgz",
      "integrity": "sha512-SFdFmIJi+ybC0vjlHN0ZGVGHc3lgE0DxPAT0djjVg+kjOnSqclqmj0KQ7ykTOLP6YxoqOvuAODGdcHJn+43q3g==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/get-intrinsic": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/get-intrinsic/-/get-intrinsic-1.3.0.tgz",
      "integrity": "sha512-9fSjSaos/fRIVIp+xSJlE6lfwhES7LNtKaCBIamHsjr2na1BiABJPo0mOjjz8GJDURarmCPGqaiVg5mfjb98CQ==",
      "license": "MIT",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.2",
        "es-define-property": "^1.0.1",
        "es-errors": "^1.3.0",
        "es-object-atoms": "^1.1.1",
        "function-bind": "^1.1.2",
        "get-proto": "^1.0.1",
        "gopd": "^1.2.0",
        "has-symbols": "^1.1.0",
        "hasown": "^2.0.2",
        "math-intrinsics": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/get-proto": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/get-proto/-/get-proto-1.0.1.tgz",
      "integrity": "sha512-sTSfBjoXBp89JvIKIefqw7U2CCebsc74kiY6awiGogKtoSGbgjYE/G/+l9sF3MWFPNc9IcoOC4ODfKHfxFmp0g==",
      "license": "MIT",
      "dependencies": {
        "dunder-proto": "^1.0.1",
        "es-object-atoms": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/get-symbol-description": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/get-symbol-description/-/get-symbol-description-1.1.0.tgz",
      "integrity": "sha512-w9UMqWwJxHNOvoNzSJ2oPF5wvYcvP7jUvYzhp67yEhTi17ZDBBC1z9pTdGuzjD+EFIqLSYRweZjqfiPzQ06Ebg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3",
        "es-errors": "^1.3.0",
        "get-intrinsic": "^1.2.6"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/get-tsconfig": {
      "version": "4.13.0",
      "resolved": "https://registry.npmjs.org/get-tsconfig/-/get-tsconfig-4.13.0.tgz",
      "integrity": "sha512-1VKTZJCwBrvbd+Wn3AOgQP/2Av+TfTCOlE4AcRJE72W1ksZXbAx8PPBR9RzgTeSPzlPMHrbANMH3LbltH73wxQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "resolve-pkg-maps": "^1.0.0"
      },
      "funding": {
        "url": "https://github.com/privatenumber/get-tsconfig?sponsor=1"
      }
    },
    "node_modules/glob-parent": {
      "version": "6.0.2",
      "resolved": "https://registry.npmjs.org/glob-parent/-/glob-parent-6.0.2.tgz",
      "integrity": "sha512-XxwI8EOhVQgWp6iDL+3b0r86f4d6AX6zSU55HfB4ydCEuXLXc5FcYeOu+nnGftS4TEju/11rt4KJPTMgbfmv4A==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "is-glob": "^4.0.3"
      },
      "engines": {
        "node": ">=10.13.0"
      }
    },
    "node_modules/globals": {
      "version": "14.0.0",
      "resolved": "https://registry.npmjs.org/globals/-/globals-14.0.0.tgz",
      "integrity": "sha512-oahGvuMGQlPw/ivIYBjVSrWAfWLBeku5tpPE2fOPLi+WHffIWbuh2tCjhyQhTBPMf5E9jDEH4FOmTYgYwbKwtQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=18"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/globalthis": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/globalthis/-/globalthis-1.0.4.tgz",
      "integrity": "sha512-DpLKbNU4WylpxJykQujfCcwYWiV/Jhm50Goo0wrVILAv5jOr9d+H+UR3PhSCD2rCCEIg0uc+G+muBTwD54JhDQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "define-properties": "^1.2.1",
        "gopd": "^1.0.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/gopd": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/gopd/-/gopd-1.2.0.tgz",
      "integrity": "sha512-ZUKRh6/kUFoAiTAtTYPZJ3hw9wNxx+BIBOijnlG9PnrJsCcSjs1wyyD6vJpaYtgnzDrKYRSqf3OO6Rfa93xsRg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/graceful-fs": {
      "version": "4.2.11",
      "resolved": "https://registry.npmjs.org/graceful-fs/-/graceful-fs-4.2.11.tgz",
      "integrity": "sha512-RbJ5/jmFcNNCcDV5o9eTnBLJ/HszWV0P73bc+Ff4nS/rJj+YaS6IGyiOL0VoBYX+l1Wrl3k63h/KrH+nhJ0XvQ==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/has-bigints": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/has-bigints/-/has-bigints-1.1.0.tgz",
      "integrity": "sha512-R3pbpkcIqv2Pm3dUwgjclDRVmWpTJW2DcMzcIhEXEx1oh/CEMObMm3KLmRJOdvhM7o4uQBnwr8pzRK2sJWIqfg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/has-flag": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/has-flag/-/has-flag-4.0.0.tgz",
      "integrity": "sha512-EykJT/Q1KjTWctppgIAgfSO0tKVuZUjhgMr17kqTumMl6Afv3EISleU7qZUzoXDFTAHTDC4NOoG/ZxU3EvlMPQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/has-property-descriptors": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/has-property-descriptors/-/has-property-descriptors-1.0.2.tgz",
      "integrity": "sha512-55JNKuIW+vq4Ke1BjOTjM2YctQIvCT7GFzHwmfZPGo5wnrgkid0YQtnAleFSqumZm4az3n2BS+erby5ipJdgrg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "es-define-property": "^1.0.0"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/has-proto": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/has-proto/-/has-proto-1.2.0.tgz",
      "integrity": "sha512-KIL7eQPfHQRC8+XluaIw7BHUwwqL19bQn4hzNgdr+1wXoU0KKj6rufu47lhY7KbJR2C6T6+PfyN0Ea7wkSS+qQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "dunder-proto": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/has-symbols": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/has-symbols/-/has-symbols-1.1.0.tgz",
      "integrity": "sha512-1cDNdwJ2Jaohmb3sg4OmKaMBwuC48sYni5HUw2DvsC8LjGTLK9h+eb1X6RyuOHe4hT0ULCW68iomhjUoKUqlPQ==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/has-tostringtag": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/has-tostringtag/-/has-tostringtag-1.0.2.tgz",
      "integrity": "sha512-NqADB8VjPFLM2V0VvHUewwwsw0ZWBaIdgo+ieHtK3hasLz4qeCRjYcqfB6AQrBggRKppKF8L52/VqdVsO47Dlw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "has-symbols": "^1.0.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/hasown": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/hasown/-/hasown-2.0.2.tgz",
      "integrity": "sha512-0hJU9SCPvmMzIBdZFqNPXWa6dqh7WdH0cII9y+CyS8rG3nL48Bclra9HmKhVVUHyPWNH5Y7xDwAB7bfgSjkUMQ==",
      "license": "MIT",
      "dependencies": {
        "function-bind": "^1.1.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/iceberg-js": {
      "version": "0.8.1",
      "resolved": "https://registry.npmjs.org/iceberg-js/-/iceberg-js-0.8.1.tgz",
      "integrity": "sha512-1dhVQZXhcHje7798IVM+xoo/1ZdVfzOMIc8/rgVSijRK38EDqOJoGula9N/8ZI5RD8QTxNQtK/Gozpr+qUqRRA==",
      "license": "MIT",
      "engines": {
        "node": ">=20.0.0"
      }
    },
    "node_modules/ignore": {
      "version": "5.3.2",
      "resolved": "https://registry.npmjs.org/ignore/-/ignore-5.3.2.tgz",
      "integrity": "sha512-hsBTNUqQTDwkWtcdYI2i06Y/nUBEsNEDJKjWdigLvegy8kDuJAS8uRlpkkcQpyEXL0Z/pjDy5HBmMjRCJ2gq+g==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 4"
      }
    },
    "node_modules/import-fresh": {
      "version": "3.3.1",
      "resolved": "https://registry.npmjs.org/import-fresh/-/import-fresh-3.3.1.tgz",
      "integrity": "sha512-TR3KfrTZTYLPB6jUjfx6MF9WcWrHL9su5TObK4ZkYgBdWKPOFoSoQIdEuTuR82pmtxH2spWG9h6etwfr1pLBqQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "parent-module": "^1.0.0",
        "resolve-from": "^4.0.0"
      },
      "engines": {
        "node": ">=6"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/imurmurhash": {
      "version": "0.1.4",
      "resolved": "https://registry.npmjs.org/imurmurhash/-/imurmurhash-0.1.4.tgz",
      "integrity": "sha512-JmXMZ6wuvDmLiHEml9ykzqO6lwFbof0GG4IkcGaENdCRDDmMVnny7s5HsIgHCbaq0w2MyPhDqkhTUgS2LU2PHA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=0.8.19"
      }
    },
    "node_modules/internal-slot": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/internal-slot/-/internal-slot-1.1.0.tgz",
      "integrity": "sha512-4gd7VpWNQNB4UKKCFFVcp1AVv+FMOgs9NKzjHKusc8jTMhd5eL1NqQqOpE0KzMds804/yHlglp3uxgluOqAPLw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "hasown": "^2.0.2",
        "side-channel": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/is-array-buffer": {
      "version": "3.0.5",
      "resolved": "https://registry.npmjs.org/is-array-buffer/-/is-array-buffer-3.0.5.tgz",
      "integrity": "sha512-DDfANUiiG2wC1qawP66qlTugJeL5HyzMpfr8lLK+jMQirGzNod0B12cFB/9q838Ru27sBwfw78/rdoU7RERz6A==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.3",
        "get-intrinsic": "^1.2.6"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-arrayish": {
      "version": "0.3.4",
      "resolved": "https://registry.npmjs.org/is-arrayish/-/is-arrayish-0.3.4.tgz",
      "integrity": "sha512-m6UrgzFVUYawGBh1dUsWR5M2Clqic9RVXC/9f8ceNlv2IcO9j9J/z8UoCLPqtsPBFNzEpfR3xftohbfqDx8EQA==",
      "license": "MIT",
      "optional": true
    },
    "node_modules/is-async-function": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/is-async-function/-/is-async-function-2.1.1.tgz",
      "integrity": "sha512-9dgM/cZBnNvjzaMYHVoxxfPj2QXt22Ev7SuuPrs+xav0ukGB0S6d4ydZdEiM48kLx5kDV+QBPrpVnFyefL8kkQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "async-function": "^1.0.0",
        "call-bound": "^1.0.3",
        "get-proto": "^1.0.1",
        "has-tostringtag": "^1.0.2",
        "safe-regex-test": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-bigint": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/is-bigint/-/is-bigint-1.1.0.tgz",
      "integrity": "sha512-n4ZT37wG78iz03xPRKJrHTdZbe3IicyucEtdRsV5yglwc3GyUfbAfpSeD0FJ41NbUNSt5wbhqfp1fS+BgnvDFQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "has-bigints": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-boolean-object": {
      "version": "1.2.2",
      "resolved": "https://registry.npmjs.org/is-boolean-object/-/is-boolean-object-1.2.2.tgz",
      "integrity": "sha512-wa56o2/ElJMYqjCjGkXri7it5FbebW5usLw/nPmCMs5DeZ7eziSYZhSmPRn0txqeW4LnAmQQU7FgqLpsEFKM4A==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3",
        "has-tostringtag": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-bun-module": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/is-bun-module/-/is-bun-module-2.0.0.tgz",
      "integrity": "sha512-gNCGbnnnnFAUGKeZ9PdbyeGYJqewpmc2aKHUEMO5nQPWU9lOmv7jcmQIv+qHD8fXW6W7qfuCwX4rY9LNRjXrkQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "semver": "^7.7.1"
      }
    },
    "node_modules/is-callable": {
      "version": "1.2.7",
      "resolved": "https://registry.npmjs.org/is-callable/-/is-callable-1.2.7.tgz",
      "integrity": "sha512-1BC0BVFhS/p0qtw6enp8e+8OD0UrK0oFLztSjNzhcKA3WDuJxxAPXzPuPtKkjEY9UUoEWlX/8fgKeu2S8i9JTA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-core-module": {
      "version": "2.16.1",
      "resolved": "https://registry.npmjs.org/is-core-module/-/is-core-module-2.16.1.tgz",
      "integrity": "sha512-UfoeMA6fIJ8wTYFEUjelnaGI67v6+N7qXJEvQuIGa99l4xsCruSYOVSQ0uPANn4dAzm8lkYPaKLrrijLq7x23w==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "hasown": "^2.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-data-view": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/is-data-view/-/is-data-view-1.0.2.tgz",
      "integrity": "sha512-RKtWF8pGmS87i2D6gqQu/l7EYRlVdfzemCJN/P3UOs//x1QE7mfhvzHIApBTRf7axvT6DMGwSwBXYCT0nfB9xw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.2",
        "get-intrinsic": "^1.2.6",
        "is-typed-array": "^1.1.13"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-date-object": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/is-date-object/-/is-date-object-1.1.0.tgz",
      "integrity": "sha512-PwwhEakHVKTdRNVOw+/Gyh0+MzlCl4R6qKvkhuvLtPMggI1WAHt9sOwZxQLSGpUaDnrdyDsomoRgNnCfKNSXXg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.2",
        "has-tostringtag": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-extglob": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/is-extglob/-/is-extglob-2.1.1.tgz",
      "integrity": "sha512-SbKbANkN603Vi4jEZv49LeVJMn4yGwsbzZworEoyEiutsN3nJYdbO36zfhGJ6QEDpOZIFkDtnq5JRxmvl3jsoQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/is-finalizationregistry": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/is-finalizationregistry/-/is-finalizationregistry-1.1.1.tgz",
      "integrity": "sha512-1pC6N8qWJbWoPtEjgcL2xyhQOP491EQjeUo3qTKcmV8YSDDJrOepfG8pcC7h/QgnQHYSv0mJ3Z/ZWxmatVrysg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-generator-function": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/is-generator-function/-/is-generator-function-1.1.2.tgz",
      "integrity": "sha512-upqt1SkGkODW9tsGNG5mtXTXtECizwtS2kA161M+gJPc1xdb/Ax629af6YrTwcOeQHbewrPNlE5Dx7kzvXTizA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.4",
        "generator-function": "^2.0.0",
        "get-proto": "^1.0.1",
        "has-tostringtag": "^1.0.2",
        "safe-regex-test": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-glob": {
      "version": "4.0.3",
      "resolved": "https://registry.npmjs.org/is-glob/-/is-glob-4.0.3.tgz",
      "integrity": "sha512-xelSayHH36ZgE7ZWhli7pW34hNbNl8Ojv5KVmkJD4hBdD3th8Tfk9vYasLM+mXWOZhFkgZfxhLSnrwRr4elSSg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "is-extglob": "^2.1.1"
      },
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/is-map": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/is-map/-/is-map-2.0.3.tgz",
      "integrity": "sha512-1Qed0/Hr2m+YqxnM09CjA2d/i6YZNfF6R2oRAOj36eUdS6qIV/huPJNSEpKbupewFs+ZsJlxsjjPbc0/afW6Lw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-negative-zero": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/is-negative-zero/-/is-negative-zero-2.0.3.tgz",
      "integrity": "sha512-5KoIu2Ngpyek75jXodFvnafB6DJgr3u8uuK0LEZJjrU19DrMD3EVERaR8sjz8CCGgpZvxPl9SuE1GMVPFHx1mw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-number": {
      "version": "7.0.0",
      "resolved": "https://registry.npmjs.org/is-number/-/is-number-7.0.0.tgz",
      "integrity": "sha512-41Cifkg6e8TylSpdtTpeLVMqvSBEVzTttHvERD741+pnZ8ANv0004MRL43QKPDlK9cGvNp6NZWZUBlbGXYxxng==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=0.12.0"
      }
    },
    "node_modules/is-number-object": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/is-number-object/-/is-number-object-1.1.1.tgz",
      "integrity": "sha512-lZhclumE1G6VYD8VHe35wFaIif+CTy5SJIi5+3y4psDgWu4wPDoBhF8NxUOinEc7pHgiTsT6MaBb92rKhhD+Xw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3",
        "has-tostringtag": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-regex": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/is-regex/-/is-regex-1.2.1.tgz",
      "integrity": "sha512-MjYsKHO5O7mCsmRGxWcLWheFqN9DJ/2TmngvjKXihe6efViPqc274+Fx/4FYj/r03+ESvBdTXK0V6tA3rgez1g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.2",
        "gopd": "^1.2.0",
        "has-tostringtag": "^1.0.2",
        "hasown": "^2.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-set": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/is-set/-/is-set-2.0.3.tgz",
      "integrity": "sha512-iPAjerrse27/ygGLxw+EBR9agv9Y6uLeYVJMu+QNCoouJ1/1ri0mGrcWpfCqFZuzzx3WjtwxG098X+n4OuRkPg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-shared-array-buffer": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/is-shared-array-buffer/-/is-shared-array-buffer-1.0.4.tgz",
      "integrity": "sha512-ISWac8drv4ZGfwKl5slpHG9OwPNty4jOWPRIhBpxOoD+hqITiwuipOQ2bNthAzwA3B4FIjO4Nln74N0S9byq8A==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-string": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/is-string/-/is-string-1.1.1.tgz",
      "integrity": "sha512-BtEeSsoaQjlSPBemMQIrY1MY0uM6vnS1g5fmufYOtnxLGUZM2178PKbhsk7Ffv58IX+ZtcvoGwccYsh0PglkAA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3",
        "has-tostringtag": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-symbol": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/is-symbol/-/is-symbol-1.1.1.tgz",
      "integrity": "sha512-9gGx6GTtCQM73BgmHQXfDmLtfjjTUDSyoxTCbp5WtoixAhfgsDirWIcVQ/IHpvI5Vgd5i/J5F7B9cN/WlVbC/w==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.2",
        "has-symbols": "^1.1.0",
        "safe-regex-test": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-typed-array": {
      "version": "1.1.15",
      "resolved": "https://registry.npmjs.org/is-typed-array/-/is-typed-array-1.1.15.tgz",
      "integrity": "sha512-p3EcsicXjit7SaskXHs1hA91QxgTw46Fv6EFKKGS5DRFLD8yKnohjF3hxoju94b/OcMZoQukzpPpBE9uLVKzgQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "which-typed-array": "^1.1.16"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-weakmap": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/is-weakmap/-/is-weakmap-2.0.2.tgz",
      "integrity": "sha512-K5pXYOm9wqY1RgjpL3YTkF39tni1XajUIkawTLUo9EZEVUFga5gSQJF8nNS7ZwJQ02y+1YCNYcMh+HIf1ZqE+w==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-weakref": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/is-weakref/-/is-weakref-1.1.1.tgz",
      "integrity": "sha512-6i9mGWSlqzNMEqpCp93KwRS1uUOodk2OJ6b+sq7ZPDSy2WuI5NFIxp/254TytR8ftefexkWn5xNiHUNpPOfSew==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-weakset": {
      "version": "2.0.4",
      "resolved": "https://registry.npmjs.org/is-weakset/-/is-weakset-2.0.4.tgz",
      "integrity": "sha512-mfcwb6IzQyOKTs84CQMrOwW4gQcaTOAWJ0zzJCl2WSPDrWk/OzDaImWFH3djXhb24g4eudZfLRozAvPGw4d9hQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3",
        "get-intrinsic": "^1.2.6"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/isarray": {
      "version": "2.0.5",
      "resolved": "https://registry.npmjs.org/isarray/-/isarray-2.0.5.tgz",
      "integrity": "sha512-xHjhDr3cNBK0BzdUJSPXZntQUx/mwMS5Rw4A7lPJ90XGAO6ISP/ePDNuo0vhqOZU+UD5JoodwCAAoZQd3FeAKw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/isexe": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/isexe/-/isexe-2.0.0.tgz",
      "integrity": "sha512-RHxMLp9lnKHGHRng9QFhRCMbYAcVpn69smSGcq3F36xjgVVWThj4qqLbTLlq7Ssj8B+fIQ1EuCEGI2lKsyQeIw==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/iterator.prototype": {
      "version": "1.1.5",
      "resolved": "https://registry.npmjs.org/iterator.prototype/-/iterator.prototype-1.1.5.tgz",
      "integrity": "sha512-H0dkQoCa3b2VEeKQBOxFph+JAbcrQdE7KC0UkqwpLmv2EC4P41QXP+rqo9wYodACiG5/WM5s9oDApTU8utwj9g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "define-data-property": "^1.1.4",
        "es-object-atoms": "^1.0.0",
        "get-intrinsic": "^1.2.6",
        "get-proto": "^1.0.0",
        "has-symbols": "^1.1.0",
        "set-function-name": "^2.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/jiti": {
      "version": "2.6.1",
      "resolved": "https://registry.npmjs.org/jiti/-/jiti-2.6.1.tgz",
      "integrity": "sha512-ekilCSN1jwRvIbgeg/57YFh8qQDNbwDb9xT/qu2DAHbFFZUicIl4ygVaAvzveMhMVr3LnpSKTNnwt8PoOfmKhQ==",
      "dev": true,
      "license": "MIT",
      "bin": {
        "jiti": "lib/jiti-cli.mjs"
      }
    },
    "node_modules/js-tokens": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/js-tokens/-/js-tokens-4.0.0.tgz",
      "integrity": "sha512-RdJUflcE3cUzKiMqQgsCu06FPu9UdIJO0beYbPhHN4k6apgJtifcoCtT9bcxOpYBtpD2kCM6Sbzg4CausW/PKQ==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/js-yaml": {
      "version": "4.1.1",
      "resolved": "https://registry.npmjs.org/js-yaml/-/js-yaml-4.1.1.tgz",
      "integrity": "sha512-qQKT4zQxXl8lLwBtHMWwaTcGfFOZviOJet3Oy/xmGk2gZH677CJM9EvtfdSkgWcATZhj/55JZ0rmy3myCT5lsA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "argparse": "^2.0.1"
      },
      "bin": {
        "js-yaml": "bin/js-yaml.js"
      }
    },
    "node_modules/json-buffer": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/json-buffer/-/json-buffer-3.0.1.tgz",
      "integrity": "sha512-4bV5BfR2mqfQTJm+V5tPPdf+ZpuhiIvTuAB5g8kcrXOZpTT/QwwVRWBywX1ozr6lEuPdbHxwaJlm9G6mI2sfSQ==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/json-schema-traverse": {
      "version": "0.4.1",
      "resolved": "https://registry.npmjs.org/json-schema-traverse/-/json-schema-traverse-0.4.1.tgz",
      "integrity": "sha512-xbbCH5dCYU5T8LcEhhuh7HJ88HXuW3qsI3Y0zOZFKfZEHcpWiHU/Jxzk629Brsab/mMiHQti9wMP+845RPe3Vg==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/json-stable-stringify-without-jsonify": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/json-stable-stringify-without-jsonify/-/json-stable-stringify-without-jsonify-1.0.1.tgz",
      "integrity": "sha512-Bdboy+l7tA3OGW6FjyFHWkP5LuByj1Tk33Ljyq0axyzdk9//JSi2u3FP1QSmd1KNwq6VOKYGlAu87CisVir6Pw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/json5": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/json5/-/json5-1.0.2.tgz",
      "integrity": "sha512-g1MWMLBiz8FKi1e4w0UyVL3w+iJceWAFBAaBnnGKOpNa5f8TLktkbre1+s6oICydWAm+HRUGTmI+//xv2hvXYA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "minimist": "^1.2.0"
      },
      "bin": {
        "json5": "lib/cli.js"
      }
    },
    "node_modules/jsx-ast-utils": {
      "version": "3.3.5",
      "resolved": "https://registry.npmjs.org/jsx-ast-utils/-/jsx-ast-utils-3.3.5.tgz",
      "integrity": "sha512-ZZow9HBI5O6EPgSJLUb8n2NKgmVWTwCvHGwFuJlMjvLFqlGG6pjirPhtdsseaLZjSibD8eegzmYpUZwoIlj2cQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "array-includes": "^3.1.6",
        "array.prototype.flat": "^1.3.1",
        "object.assign": "^4.1.4",
        "object.values": "^1.1.6"
      },
      "engines": {
        "node": ">=4.0"
      }
    },
    "node_modules/keyv": {
      "version": "4.5.4",
      "resolved": "https://registry.npmjs.org/keyv/-/keyv-4.5.4.tgz",
      "integrity": "sha512-oxVHkHR/EJf2CNXnWxRLW6mg7JyCCUcG0DtEGmL2ctUo1PNTin1PUil+r/+4r5MpVgC/fn1kjsx7mjSujKqIpw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "json-buffer": "3.0.1"
      }
    },
    "node_modules/language-subtag-registry": {
      "version": "0.3.23",
      "resolved": "https://registry.npmjs.org/language-subtag-registry/-/language-subtag-registry-0.3.23.tgz",
      "integrity": "sha512-0K65Lea881pHotoGEa5gDlMxt3pctLi2RplBb7Ezh4rRdLEOtgi7n4EwK9lamnUCkKBqaeKRVebTq6BAxSkpXQ==",
      "dev": true,
      "license": "CC0-1.0"
    },
    "node_modules/language-tags": {
      "version": "1.0.9",
      "resolved": "https://registry.npmjs.org/language-tags/-/language-tags-1.0.9.tgz",
      "integrity": "sha512-MbjN408fEndfiQXbFQ1vnd+1NoLDsnQW41410oQBXiyXDMYH5z505juWa4KUE1LqxRC7DgOgZDbKLxHIwm27hA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "language-subtag-registry": "^0.3.20"
      },
      "engines": {
        "node": ">=0.10"
      }
    },
    "node_modules/levn": {
      "version": "0.4.1",
      "resolved": "https://registry.npmjs.org/levn/-/levn-0.4.1.tgz",
      "integrity": "sha512-+bT2uH4E5LGE7h/n3evcS/sQlJXCpIp6ym8OWJ5eV6+67Dsql/LaaT7qJBAt2rzfoa/5QBGBhxDix1dMt2kQKQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "prelude-ls": "^1.2.1",
        "type-check": "~0.4.0"
      },
      "engines": {
        "node": ">= 0.8.0"
      }
    },
    "node_modules/lightningcss": {
      "version": "1.30.2",
      "resolved": "https://registry.npmjs.org/lightningcss/-/lightningcss-1.30.2.tgz",
      "integrity": "sha512-utfs7Pr5uJyyvDETitgsaqSyjCb2qNRAtuqUeWIAKztsOYdcACf2KtARYXg2pSvhkt+9NfoaNY7fxjl6nuMjIQ==",
      "dev": true,
      "license": "MPL-2.0",
      "dependencies": {
        "detect-libc": "^2.0.3"
      },
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      },
      "optionalDependencies": {
        "lightningcss-android-arm64": "1.30.2",
        "lightningcss-darwin-arm64": "1.30.2",
        "lightningcss-darwin-x64": "1.30.2",
        "lightningcss-freebsd-x64": "1.30.2",
        "lightningcss-linux-arm-gnueabihf": "1.30.2",
        "lightningcss-linux-arm64-gnu": "1.30.2",
        "lightningcss-linux-arm64-musl": "1.30.2",
        "lightningcss-linux-x64-gnu": "1.30.2",
        "lightningcss-linux-x64-musl": "1.30.2",
        "lightningcss-win32-arm64-msvc": "1.30.2",
        "lightningcss-win32-x64-msvc": "1.30.2"
      }
    },
    "node_modules/lightningcss-android-arm64": {
      "version": "1.30.2",
      "resolved": "https://registry.npmjs.org/lightningcss-android-arm64/-/lightningcss-android-arm64-1.30.2.tgz",
      "integrity": "sha512-BH9sEdOCahSgmkVhBLeU7Hc9DWeZ1Eb6wNS6Da8igvUwAe0sqROHddIlvU06q3WyXVEOYDZ6ykBZQnjTbmo4+A==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MPL-2.0",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      }
    },
    "node_modules/lightningcss-darwin-arm64": {
      "version": "1.30.2",
      "resolved": "https://registry.npmjs.org/lightningcss-darwin-arm64/-/lightningcss-darwin-arm64-1.30.2.tgz",
      "integrity": "sha512-ylTcDJBN3Hp21TdhRT5zBOIi73P6/W0qwvlFEk22fkdXchtNTOU4Qc37SkzV+EKYxLouZ6M4LG9NfZ1qkhhBWA==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MPL-2.0",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      }
    },
    "node_modules/lightningcss-darwin-x64": {
      "version": "1.30.2",
      "resolved": "https://registry.npmjs.org/lightningcss-darwin-x64/-/lightningcss-darwin-x64-1.30.2.tgz",
      "integrity": "sha512-oBZgKchomuDYxr7ilwLcyms6BCyLn0z8J0+ZZmfpjwg9fRVZIR5/GMXd7r9RH94iDhld3UmSjBM6nXWM2TfZTQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MPL-2.0",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      }
    },
    "node_modules/lightningcss-freebsd-x64": {
      "version": "1.30.2",
      "resolved": "https://registry.npmjs.org/lightningcss-freebsd-x64/-/lightningcss-freebsd-x64-1.30.2.tgz",
      "integrity": "sha512-c2bH6xTrf4BDpK8MoGG4Bd6zAMZDAXS569UxCAGcA7IKbHNMlhGQ89eRmvpIUGfKWNVdbhSbkQaWhEoMGmGslA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MPL-2.0",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      }
    },
    "node_modules/lightningcss-linux-arm-gnueabihf": {
      "version": "1.30.2",
      "resolved": "https://registry.npmjs.org/lightningcss-linux-arm-gnueabihf/-/lightningcss-linux-arm-gnueabihf-1.30.2.tgz",
      "integrity": "sha512-eVdpxh4wYcm0PofJIZVuYuLiqBIakQ9uFZmipf6LF/HRj5Bgm0eb3qL/mr1smyXIS1twwOxNWndd8z0E374hiA==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MPL-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      }
    },
    "node_modules/lightningcss-linux-arm64-gnu": {
      "version": "1.30.2",
      "resolved": "https://registry.npmjs.org/lightningcss-linux-arm64-gnu/-/lightningcss-linux-arm64-gnu-1.30.2.tgz",
      "integrity": "sha512-UK65WJAbwIJbiBFXpxrbTNArtfuznvxAJw4Q2ZGlU8kPeDIWEX1dg3rn2veBVUylA2Ezg89ktszWbaQnxD/e3A==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MPL-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      }
    },
    "node_modules/lightningcss-linux-arm64-musl": {
      "version": "1.30.2",
      "resolved": "https://registry.npmjs.org/lightningcss-linux-arm64-musl/-/lightningcss-linux-arm64-musl-1.30.2.tgz",
      "integrity": "sha512-5Vh9dGeblpTxWHpOx8iauV02popZDsCYMPIgiuw97OJ5uaDsL86cnqSFs5LZkG3ghHoX5isLgWzMs+eD1YzrnA==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MPL-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      }
    },
    "node_modules/lightningcss-linux-x64-gnu": {
      "version": "1.30.2",
      "resolved": "https://registry.npmjs.org/lightningcss-linux-x64-gnu/-/lightningcss-linux-x64-gnu-1.30.2.tgz",
      "integrity": "sha512-Cfd46gdmj1vQ+lR6VRTTadNHu6ALuw2pKR9lYq4FnhvgBc4zWY1EtZcAc6EffShbb1MFrIPfLDXD6Xprbnni4w==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MPL-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      }
    },
    "node_modules/lightningcss-linux-x64-musl": {
      "version": "1.30.2",
      "resolved": "https://registry.npmjs.org/lightningcss-linux-x64-musl/-/lightningcss-linux-x64-musl-1.30.2.tgz",
      "integrity": "sha512-XJaLUUFXb6/QG2lGIW6aIk6jKdtjtcffUT0NKvIqhSBY3hh9Ch+1LCeH80dR9q9LBjG3ewbDjnumefsLsP6aiA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MPL-2.0",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      }
    },
    "node_modules/lightningcss-win32-arm64-msvc": {
      "version": "1.30.2",
      "resolved": "https://registry.npmjs.org/lightningcss-win32-arm64-msvc/-/lightningcss-win32-arm64-msvc-1.30.2.tgz",
      "integrity": "sha512-FZn+vaj7zLv//D/192WFFVA0RgHawIcHqLX9xuWiQt7P0PtdFEVaxgF9rjM/IRYHQXNnk61/H/gb2Ei+kUQ4xQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MPL-2.0",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      }
    },
    "node_modules/lightningcss-win32-x64-msvc": {
      "version": "1.30.2",
      "resolved": "https://registry.npmjs.org/lightningcss-win32-x64-msvc/-/lightningcss-win32-x64-msvc-1.30.2.tgz",
      "integrity": "sha512-5g1yc73p+iAkid5phb4oVFMB45417DkRevRbt/El/gKXJk4jid+vPFF/AXbxn05Aky8PapwzZrdJShv5C0avjw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MPL-2.0",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">= 12.0.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/parcel"
      }
    },
    "node_modules/locate-path": {
      "version": "6.0.0",
      "resolved": "https://registry.npmjs.org/locate-path/-/locate-path-6.0.0.tgz",
      "integrity": "sha512-iPZK6eYjbxRu3uB4/WZ3EsEIMJFMqAoopl3R+zuq0UjcAm/MO6KCweDgPfP3elTztoKP3KtnVHxTn2NHBSDVUw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "p-locate": "^5.0.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/lodash.merge": {
      "version": "4.6.2",
      "resolved": "https://registry.npmjs.org/lodash.merge/-/lodash.merge-4.6.2.tgz",
      "integrity": "sha512-0KpjqXRVvrYyCsX1swR/XTK0va6VQkQM6MNo7PqW77ByjAhoARA8EfrP1N4+KlKj8YS0ZUCtRT/YUuhyYDujIQ==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/loose-envify": {
      "version": "1.4.0",
      "resolved": "https://registry.npmjs.org/loose-envify/-/loose-envify-1.4.0.tgz",
      "integrity": "sha512-lyuxPGr/Wfhrlem2CL/UcnUc1zcqKAImBDzukY7Y5F/yQiNdko6+fRLevlw1HgMySw7f611UIY408EtxRSoK3Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "js-tokens": "^3.0.0 || ^4.0.0"
      },
      "bin": {
        "loose-envify": "cli.js"
      }
    },
    "node_modules/lucide-react": {
      "version": "0.468.0",
      "resolved": "https://registry.npmjs.org/lucide-react/-/lucide-react-0.468.0.tgz",
      "integrity": "sha512-6koYRhnM2N0GGZIdXzSeiNwguv1gt/FAjZOiPl76roBi3xKEXa4WmfpxgQwTTL4KipXjefrnf3oV4IsYhi4JFA==",
      "license": "ISC",
      "peerDependencies": {
        "react": "^16.5.1 || ^17.0.0 || ^18.0.0 || ^19.0.0-rc"
      }
    },
    "node_modules/magic-string": {
      "version": "0.30.21",
      "resolved": "https://registry.npmjs.org/magic-string/-/magic-string-0.30.21.tgz",
      "integrity": "sha512-vd2F4YUyEXKGcLHoq+TEyCjxueSeHnFxyyjNp80yg0XV4vUhnDer/lvvlqM/arB5bXQN5K2/3oinyCRyx8T2CQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/sourcemap-codec": "^1.5.5"
      }
    },
    "node_modules/math-intrinsics": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/math-intrinsics/-/math-intrinsics-1.1.0.tgz",
      "integrity": "sha512-/IXtbwEk5HTPyEwyKX6hGkYXxM9nbj64B+ilVJnC/R6B0pH5G4V3b0pVbL7DBj4tkhBAppbQUlf6F6Xl9LHu1g==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/merge2": {
      "version": "1.4.1",
      "resolved": "https://registry.npmjs.org/merge2/-/merge2-1.4.1.tgz",
      "integrity": "sha512-8q7VEgMJW4J8tcfVPy8g09NcQwZdbwFEqhe/WZkoIzjn/3TGDwtOCYtXGxA3O8tPzpczCCDgv+P2P5y00ZJOOg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/micromatch": {
      "version": "4.0.8",
      "resolved": "https://registry.npmjs.org/micromatch/-/micromatch-4.0.8.tgz",
      "integrity": "sha512-PXwfBhYu0hBCPw8Dn0E+WDYb7af3dSLVWKi3HGv84IdF4TyFoC0ysxFd0Goxw7nSv4T/PzEJQxsYsEiFCKo2BA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "braces": "^3.0.3",
        "picomatch": "^2.3.1"
      },
      "engines": {
        "node": ">=8.6"
      }
    },
    "node_modules/minimatch": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-3.1.2.tgz",
      "integrity": "sha512-J7p63hRiAjw1NDEww1W7i37+ByIrOWO5XQQAzZ3VOcL0PNybwpfmV/N05zFAzwQ9USyEcX6t3UO+K5aqBQOIHw==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "brace-expansion": "^1.1.7"
      },
      "engines": {
        "node": "*"
      }
    },
    "node_modules/minimist": {
      "version": "1.2.8",
      "resolved": "https://registry.npmjs.org/minimist/-/minimist-1.2.8.tgz",
      "integrity": "sha512-2yyAR8qBkN3YuheJanUpWC5U3bb5osDywNB8RzDVlDwDHbocAJveqqj1u8+SVD7jkWT4yvsHCpWqqWqAxb0zCA==",
      "dev": true,
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/nanoid": {
      "version": "3.3.11",
      "resolved": "https://registry.npmjs.org/nanoid/-/nanoid-3.3.11.tgz",
      "integrity": "sha512-N8SpfPUnUp1bK+PMYW8qSWdl9U+wwNWI4QKxOYDy9JAro3WMX7p2OeVRF9v+347pnakNevPmiHhNmZ2HbFA76w==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "bin": {
        "nanoid": "bin/nanoid.cjs"
      },
      "engines": {
        "node": "^10 || ^12 || ^13.7 || ^14 || >=15.0.1"
      }
    },
    "node_modules/napi-postinstall": {
      "version": "0.3.4",
      "resolved": "https://registry.npmjs.org/napi-postinstall/-/napi-postinstall-0.3.4.tgz",
      "integrity": "sha512-PHI5f1O0EP5xJ9gQmFGMS6IZcrVvTjpXjz7Na41gTE7eE2hK11lg04CECCYEEjdc17EV4DO+fkGEtt7TpTaTiQ==",
      "dev": true,
      "license": "MIT",
      "bin": {
        "napi-postinstall": "lib/cli.js"
      },
      "engines": {
        "node": "^12.20.0 || ^14.18.0 || >=16.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/napi-postinstall"
      }
    },
    "node_modules/natural-compare": {
      "version": "1.4.0",
      "resolved": "https://registry.npmjs.org/natural-compare/-/natural-compare-1.4.0.tgz",
      "integrity": "sha512-OWND8ei3VtNC9h7V60qff3SVobHr996CTwgxubgyQYEpg290h9J0buyECNNJexkFm5sOajh5G116RYA1c8ZMSw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/next": {
      "version": "15.1.6",
      "resolved": "https://registry.npmjs.org/next/-/next-15.1.6.tgz",
      "integrity": "sha512-Hch4wzbaX0vKQtalpXvUiw5sYivBy4cm5rzUKrBnUB/y436LGrvOUqYvlSeNVCWFO/770gDlltR9gqZH62ct4Q==",
      "deprecated": "This version has a security vulnerability. Please upgrade to a patched version. See https://nextjs.org/blog/CVE-2025-66478 for more details.",
      "license": "MIT",
      "dependencies": {
        "@next/env": "15.1.6",
        "@swc/counter": "0.1.3",
        "@swc/helpers": "0.5.15",
        "busboy": "1.6.0",
        "caniuse-lite": "^1.0.30001579",
        "postcss": "8.4.31",
        "styled-jsx": "5.1.6"
      },
      "bin": {
        "next": "dist/bin/next"
      },
      "engines": {
        "node": "^18.18.0 || ^19.8.0 || >= 20.0.0"
      },
      "optionalDependencies": {
        "@next/swc-darwin-arm64": "15.1.6",
        "@next/swc-darwin-x64": "15.1.6",
        "@next/swc-linux-arm64-gnu": "15.1.6",
        "@next/swc-linux-arm64-musl": "15.1.6",
        "@next/swc-linux-x64-gnu": "15.1.6",
        "@next/swc-linux-x64-musl": "15.1.6",
        "@next/swc-win32-arm64-msvc": "15.1.6",
        "@next/swc-win32-x64-msvc": "15.1.6",
        "sharp": "^0.33.5"
      },
      "peerDependencies": {
        "@opentelemetry/api": "^1.1.0",
        "@playwright/test": "^1.41.2",
        "babel-plugin-react-compiler": "*",
        "react": "^18.2.0 || 19.0.0-rc-de68d2f4-20241204 || ^19.0.0",
        "react-dom": "^18.2.0 || 19.0.0-rc-de68d2f4-20241204 || ^19.0.0",
        "sass": "^1.3.0"
      },
      "peerDependenciesMeta": {
        "@opentelemetry/api": {
          "optional": true
        },
        "@playwright/test": {
          "optional": true
        },
        "babel-plugin-react-compiler": {
          "optional": true
        },
        "sass": {
          "optional": true
        }
      }
    },
    "node_modules/next/node_modules/postcss": {
      "version": "8.4.31",
      "resolved": "https://registry.npmjs.org/postcss/-/postcss-8.4.31.tgz",
      "integrity": "sha512-PS08Iboia9mts/2ygV3eLpY5ghnUcfLV/EXTOW1E2qYxJKGGBUtNjN76FYHnMs36RmARn41bC0AZmn+rR0OVpQ==",
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/postcss"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "nanoid": "^3.3.6",
        "picocolors": "^1.0.0",
        "source-map-js": "^1.0.2"
      },
      "engines": {
        "node": "^10 || ^12 || >=14"
      }
    },
    "node_modules/object-assign": {
      "version": "4.1.1",
      "resolved": "https://registry.npmjs.org/object-assign/-/object-assign-4.1.1.tgz",
      "integrity": "sha512-rJgTQnkUnH1sFw8yT6VSU3zD3sWmu6sZhIseY8VX+GRu3P6F7Fu+JNDoXfklElbLJSnc3FUQHVe4cU5hj+BcUg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/object-inspect": {
      "version": "1.13.4",
      "resolved": "https://registry.npmjs.org/object-inspect/-/object-inspect-1.13.4.tgz",
      "integrity": "sha512-W67iLl4J2EXEGTbfeHCffrjDfitvLANg0UlX3wFUUSTx92KXRFegMHUVgSqE+wvhAbi4WqjGg9czysTV2Epbew==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/object-keys": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/object-keys/-/object-keys-1.1.1.tgz",
      "integrity": "sha512-NuAESUOUMrlIXOfHKzD6bpPu3tYt3xvjNdRIQ+FeT0lNb4K8WR70CaDxhuNguS2XG+GjkyMwOzsN5ZktImfhLA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/object.assign": {
      "version": "4.1.7",
      "resolved": "https://registry.npmjs.org/object.assign/-/object.assign-4.1.7.tgz",
      "integrity": "sha512-nK28WOo+QIjBkDduTINE4JkF/UJJKyf2EJxvJKfblDpyg0Q+pkOHNTL0Qwy6NP6FhE/EnzV73BxxqcJaXY9anw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.3",
        "define-properties": "^1.2.1",
        "es-object-atoms": "^1.0.0",
        "has-symbols": "^1.1.0",
        "object-keys": "^1.1.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/object.entries": {
      "version": "1.1.9",
      "resolved": "https://registry.npmjs.org/object.entries/-/object.entries-1.1.9.tgz",
      "integrity": "sha512-8u/hfXFRBD1O0hPUjioLhoWFHRmt6tKA4/vZPyckBr18l1KE9uHrFaFaUi8MDRTpi4uak2goyPTSNJLXX2k2Hw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.4",
        "define-properties": "^1.2.1",
        "es-object-atoms": "^1.1.1"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/object.fromentries": {
      "version": "2.0.8",
      "resolved": "https://registry.npmjs.org/object.fromentries/-/object.fromentries-2.0.8.tgz",
      "integrity": "sha512-k6E21FzySsSK5a21KRADBd/NGneRegFO5pLHfdQLpRDETUNJueLXs3WCzyQ3tFRDYgbq3KHGXfTbi2bs8WQ6rQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.7",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.2",
        "es-object-atoms": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/object.groupby": {
      "version": "1.0.3",
      "resolved": "https://registry.npmjs.org/object.groupby/-/object.groupby-1.0.3.tgz",
      "integrity": "sha512-+Lhy3TQTuzXI5hevh8sBGqbmurHbbIjAi0Z4S63nthVLmLxfbj4T54a4CfZrXIrt9iP4mVAPYMo/v99taj3wjQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.7",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/object.values": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/object.values/-/object.values-1.2.1.tgz",
      "integrity": "sha512-gXah6aZrcUxjWg2zR2MwouP2eHlCBzdV4pygudehaKXSGW4v2AsRQUK+lwwXhii6KFZcunEnmSUoYp5CXibxtA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.3",
        "define-properties": "^1.2.1",
        "es-object-atoms": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/optionator": {
      "version": "0.9.4",
      "resolved": "https://registry.npmjs.org/optionator/-/optionator-0.9.4.tgz",
      "integrity": "sha512-6IpQ7mKUxRcZNLIObR0hz7lxsapSSIYNZJwXPGeF0mTVqGKFIXj1DQcMoT22S3ROcLyY/rz0PWaWZ9ayWmad9g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "deep-is": "^0.1.3",
        "fast-levenshtein": "^2.0.6",
        "levn": "^0.4.1",
        "prelude-ls": "^1.2.1",
        "type-check": "^0.4.0",
        "word-wrap": "^1.2.5"
      },
      "engines": {
        "node": ">= 0.8.0"
      }
    },
    "node_modules/own-keys": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/own-keys/-/own-keys-1.0.1.tgz",
      "integrity": "sha512-qFOyK5PjiWZd+QQIh+1jhdb9LpxTF0qs7Pm8o5QHYZ0M3vKqSqzsZaEB6oWlxZ+q2sJBMI/Ktgd2N5ZwQoRHfg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "get-intrinsic": "^1.2.6",
        "object-keys": "^1.1.1",
        "safe-push-apply": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/p-limit": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/p-limit/-/p-limit-3.1.0.tgz",
      "integrity": "sha512-TYOanM3wGwNGsZN2cVTYPArw454xnXj5qmWF1bEoAc4+cU/ol7GVh7odevjp1FNHduHc3KZMcFduxU5Xc6uJRQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "yocto-queue": "^0.1.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/p-locate": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/p-locate/-/p-locate-5.0.0.tgz",
      "integrity": "sha512-LaNjtRWUBY++zB5nE/NwcaoMylSPk+S+ZHNB1TzdbMJMny6dynpAGt7X/tl/QYq3TIeE6nxHppbo2LGymrG5Pw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "p-limit": "^3.0.2"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/parent-module": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/parent-module/-/parent-module-1.0.1.tgz",
      "integrity": "sha512-GQ2EWRpQV8/o+Aw8YqtfZZPfNRWZYkbidE9k5rpl/hC3vtHHBfGm2Ifi6qWV+coDGkrUKZAxE3Lot5kcsRlh+g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "callsites": "^3.0.0"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/path-exists": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/path-exists/-/path-exists-4.0.0.tgz",
      "integrity": "sha512-ak9Qy5Q7jYb2Wwcey5Fpvg2KoAc/ZIhLSLOSBmRmygPsGwkVVt0fZa0qrtMz+m6tJTAHfZQ8FnmB4MG4LWy7/w==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/path-key": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/path-key/-/path-key-3.1.1.tgz",
      "integrity": "sha512-ojmeN0qd+y0jszEtoY48r0Peq5dwMEkIlCOu6Q5f41lfkswXuKtYrhgoTpLnyIcHm24Uhqx+5Tqm2InSwLhE6Q==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/path-parse": {
      "version": "1.0.7",
      "resolved": "https://registry.npmjs.org/path-parse/-/path-parse-1.0.7.tgz",
      "integrity": "sha512-LDJzPVEEEPR+y48z93A0Ed0yXb8pAByGWo/k5YYdYgpY2/2EsOsksJrq7lOHxryrVOn1ejG6oAp8ahvOIQD8sw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/picocolors": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/picocolors/-/picocolors-1.1.1.tgz",
      "integrity": "sha512-xceH2snhtb5M9liqDsmEw56le376mTZkEX/jEb/RxNFyegNul7eNslCXP9FDj/Lcu0X8KEyMceP2ntpaHrDEVA==",
      "license": "ISC"
    },
    "node_modules/picomatch": {
      "version": "2.3.1",
      "resolved": "https://registry.npmjs.org/picomatch/-/picomatch-2.3.1.tgz",
      "integrity": "sha512-JU3teHTNjmE2VCGFzuY8EXzCDVwEqB2a8fsIvwaStHhAWJEeVd1o1QD80CU6+ZdEXXSLbSsuLwJjkCBWqRQUVA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=8.6"
      },
      "funding": {
        "url": "https://github.com/sponsors/jonschlinkert"
      }
    },
    "node_modules/possible-typed-array-names": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/possible-typed-array-names/-/possible-typed-array-names-1.1.0.tgz",
      "integrity": "sha512-/+5VFTchJDoVj3bhoqi6UeymcD00DAwb1nJwamzPvHEszJ4FpF6SNNbUbOS8yI56qHzdV8eK0qEfOSiodkTdxg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/postcss": {
      "version": "8.5.6",
      "resolved": "https://registry.npmjs.org/postcss/-/postcss-8.5.6.tgz",
      "integrity": "sha512-3Ybi1tAuwAP9s0r1UQ2J4n5Y0G05bJkpUIO0/bI9MhwmD70S5aTWbXGBwxHrelT+XM1k6dM0pk+SwNkpTRN7Pg==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/postcss"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "nanoid": "^3.3.11",
        "picocolors": "^1.1.1",
        "source-map-js": "^1.2.1"
      },
      "engines": {
        "node": "^10 || ^12 || >=14"
      }
    },
    "node_modules/prelude-ls": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/prelude-ls/-/prelude-ls-1.2.1.tgz",
      "integrity": "sha512-vkcDPrRZo1QZLbn5RLGPpg/WmIQ65qoWWhcGKf/b5eplkkarX0m9z8ppCat4mlOqUsWpyNuYgO3VRyrYHSzX5g==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.8.0"
      }
    },
    "node_modules/prop-types": {
      "version": "15.8.1",
      "resolved": "https://registry.npmjs.org/prop-types/-/prop-types-15.8.1.tgz",
      "integrity": "sha512-oj87CgZICdulUohogVAR7AjlC0327U4el4L6eAvOqCeudMDVU0NThNaV+b9Df4dXgSP1gXMTnPdhfe/2qDH5cg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "loose-envify": "^1.4.0",
        "object-assign": "^4.1.1",
        "react-is": "^16.13.1"
      }
    },
    "node_modules/punycode": {
      "version": "2.3.1",
      "resolved": "https://registry.npmjs.org/punycode/-/punycode-2.3.1.tgz",
      "integrity": "sha512-vYt7UD1U9Wg6138shLtLOvdAu+8DsC/ilFtEVHcH+wydcSpNE20AfSOduf6MkRFahL5FY7X1oU7nKVZFtfq8Fg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/qs": {
      "version": "6.14.1",
      "resolved": "https://registry.npmjs.org/qs/-/qs-6.14.1.tgz",
      "integrity": "sha512-4EK3+xJl8Ts67nLYNwqw/dsFVnCf+qR7RgXSK9jEEm9unao3njwMDdmsdvoKBKHzxd7tCYz5e5M+SnMjdtXGQQ==",
      "license": "BSD-3-Clause",
      "dependencies": {
        "side-channel": "^1.1.0"
      },
      "engines": {
        "node": ">=0.6"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/queue-microtask": {
      "version": "1.2.3",
      "resolved": "https://registry.npmjs.org/queue-microtask/-/queue-microtask-1.2.3.tgz",
      "integrity": "sha512-NuaNSa6flKT5JaSYQzJok04JzTL1CA6aGhv5rfLW3PgqA+M2ChpZQnAC8h8i4ZFkBS8X5RqkDBHA7r4hej3K9A==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "MIT"
    },
    "node_modules/react": {
      "version": "19.0.0",
      "resolved": "https://registry.npmjs.org/react/-/react-19.0.0.tgz",
      "integrity": "sha512-V8AVnmPIICiWpGfm6GLzCR/W5FXLchHop40W4nXBmdlEceh16rCN8O8LNWm5bh5XUX91fh7KpA+W0TgMKmgTpQ==",
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/react-dom": {
      "version": "19.0.0",
      "resolved": "https://registry.npmjs.org/react-dom/-/react-dom-19.0.0.tgz",
      "integrity": "sha512-4GV5sHFG0e/0AD4X+ySy6UJd3jVl1iNsNHdpad0qhABJ11twS3TTBnseqsKurKcsNqCEFeGL3uLpVChpIO3QfQ==",
      "license": "MIT",
      "dependencies": {
        "scheduler": "^0.25.0"
      },
      "peerDependencies": {
        "react": "^19.0.0"
      }
    },
    "node_modules/react-is": {
      "version": "16.13.1",
      "resolved": "https://registry.npmjs.org/react-is/-/react-is-16.13.1.tgz",
      "integrity": "sha512-24e6ynE2H+OKt4kqsOvNd8kBpV65zoxbA4BVsEOB3ARVWQki/DHzaUoC5KuON/BiccDaCCTZBuOcfZs70kR8bQ==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/reflect.getprototypeof": {
      "version": "1.0.10",
      "resolved": "https://registry.npmjs.org/reflect.getprototypeof/-/reflect.getprototypeof-1.0.10.tgz",
      "integrity": "sha512-00o4I+DVrefhv+nX0ulyi3biSHCPDe+yLv5o/p6d/UVlirijB8E16FtfwSAi4g3tcqrQ4lRAqQSoFEZJehYEcw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.9",
        "es-errors": "^1.3.0",
        "es-object-atoms": "^1.0.0",
        "get-intrinsic": "^1.2.7",
        "get-proto": "^1.0.1",
        "which-builtin-type": "^1.2.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/regexp.prototype.flags": {
      "version": "1.5.4",
      "resolved": "https://registry.npmjs.org/regexp.prototype.flags/-/regexp.prototype.flags-1.5.4.tgz",
      "integrity": "sha512-dYqgNSZbDwkaJ2ceRd9ojCGjBq+mOm9LmtXnAnEGyHhN/5R7iDW2TRw3h+o/jCFxus3P2LfWIIiwowAjANm7IA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "define-properties": "^1.2.1",
        "es-errors": "^1.3.0",
        "get-proto": "^1.0.1",
        "gopd": "^1.2.0",
        "set-function-name": "^2.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/resolve": {
      "version": "1.22.11",
      "resolved": "https://registry.npmjs.org/resolve/-/resolve-1.22.11.tgz",
      "integrity": "sha512-RfqAvLnMl313r7c9oclB1HhUEAezcpLjz95wFH4LVuhk9JF/r22qmVP9AMmOU4vMX7Q8pN8jwNg/CSpdFnMjTQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "is-core-module": "^2.16.1",
        "path-parse": "^1.0.7",
        "supports-preserve-symlinks-flag": "^1.0.0"
      },
      "bin": {
        "resolve": "bin/resolve"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/resolve-from": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/resolve-from/-/resolve-from-4.0.0.tgz",
      "integrity": "sha512-pb/MYmXstAkysRFx8piNI1tGFNQIFA3vkE3Gq4EuA1dF6gHp/+vgZqsCGJapvy8N3Q+4o7FwvquPJcnZ7RYy4g==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/resolve-pkg-maps": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/resolve-pkg-maps/-/resolve-pkg-maps-1.0.0.tgz",
      "integrity": "sha512-seS2Tj26TBVOC2NIc2rOe2y2ZO7efxITtLZcGSOnHHNOQ7CkiUBfw0Iw2ck6xkIhPwLhKNLS8BO+hEpngQlqzw==",
      "dev": true,
      "license": "MIT",
      "funding": {
        "url": "https://github.com/privatenumber/resolve-pkg-maps?sponsor=1"
      }
    },
    "node_modules/reusify": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/reusify/-/reusify-1.1.0.tgz",
      "integrity": "sha512-g6QUff04oZpHs0eG5p83rFLhHeV00ug/Yf9nZM6fLeUrPguBTkTQOdpAWWspMh55TZfVQDPaN3NQJfbVRAxdIw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "iojs": ">=1.0.0",
        "node": ">=0.10.0"
      }
    },
    "node_modules/run-parallel": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/run-parallel/-/run-parallel-1.2.0.tgz",
      "integrity": "sha512-5l4VyZR86LZ/lDxZTR6jqL8AFE2S0IFLMP26AbjsLVADxHdhB/c0GUsH+y39UfCi3dzz8OlQuPmnaJOMoDHQBA==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "queue-microtask": "^1.2.2"
      }
    },
    "node_modules/safe-array-concat": {
      "version": "1.1.3",
      "resolved": "https://registry.npmjs.org/safe-array-concat/-/safe-array-concat-1.1.3.tgz",
      "integrity": "sha512-AURm5f0jYEOydBj7VQlVvDrjeFgthDdEF5H1dP+6mNpoXOMo1quQqJ4wvJDyRZ9+pO3kGWoOdmV08cSv2aJV6Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.2",
        "get-intrinsic": "^1.2.6",
        "has-symbols": "^1.1.0",
        "isarray": "^2.0.5"
      },
      "engines": {
        "node": ">=0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/safe-push-apply": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/safe-push-apply/-/safe-push-apply-1.0.0.tgz",
      "integrity": "sha512-iKE9w/Z7xCzUMIZqdBsp6pEQvwuEebH4vdpjcDWnyzaI6yl6O9FHvVpmGelvEHNsoY6wGblkxR6Zty/h00WiSA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "isarray": "^2.0.5"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/safe-regex-test": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/safe-regex-test/-/safe-regex-test-1.1.0.tgz",
      "integrity": "sha512-x/+Cz4YrimQxQccJf5mKEbIa1NzeCRNI5Ecl/ekmlYaampdNLPalVyIcCZNNH3MvmqBugV5TMYZXv0ljslUlaw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.2",
        "es-errors": "^1.3.0",
        "is-regex": "^1.2.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/scheduler": {
      "version": "0.25.0",
      "resolved": "https://registry.npmjs.org/scheduler/-/scheduler-0.25.0.tgz",
      "integrity": "sha512-xFVuu11jh+xcO7JOAGJNOXld8/TcEHK/4CituBUeUb5hqxJLj9YuemAEuvm9gQ/+pgXYfbQuqAkiYu+u7YEsNA==",
      "license": "MIT"
    },
    "node_modules/semver": {
      "version": "7.7.3",
      "resolved": "https://registry.npmjs.org/semver/-/semver-7.7.3.tgz",
      "integrity": "sha512-SdsKMrI9TdgjdweUSR9MweHA4EJ8YxHn8DFaDisvhVlUOe4BF1tLD7GAj0lIqWVl+dPb/rExr0Btby5loQm20Q==",
      "devOptional": true,
      "license": "ISC",
      "bin": {
        "semver": "bin/semver.js"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/set-function-length": {
      "version": "1.2.2",
      "resolved": "https://registry.npmjs.org/set-function-length/-/set-function-length-1.2.2.tgz",
      "integrity": "sha512-pgRc4hJ4/sNjWCSS9AmnS40x3bNMDTknHgL5UaMBTMyJnU90EgWh1Rz+MC9eFu4BuN/UwZjKQuY/1v3rM7HMfg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "define-data-property": "^1.1.4",
        "es-errors": "^1.3.0",
        "function-bind": "^1.1.2",
        "get-intrinsic": "^1.2.4",
        "gopd": "^1.0.1",
        "has-property-descriptors": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/set-function-name": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/set-function-name/-/set-function-name-2.0.2.tgz",
      "integrity": "sha512-7PGFlmtwsEADb0WYyvCMa1t+yke6daIG4Wirafur5kcf+MhUnPms1UeR0CKQdTZD81yESwMHbtn+TR+dMviakQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "define-data-property": "^1.1.4",
        "es-errors": "^1.3.0",
        "functions-have-names": "^1.2.3",
        "has-property-descriptors": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/set-proto": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/set-proto/-/set-proto-1.0.0.tgz",
      "integrity": "sha512-RJRdvCo6IAnPdsvP/7m6bsQqNnn1FCBX5ZNtFL98MmFF/4xAIJTIg1YbHW5DC2W5SKZanrC6i4HsJqlajw/dZw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "dunder-proto": "^1.0.1",
        "es-errors": "^1.3.0",
        "es-object-atoms": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/sharp": {
      "version": "0.33.5",
      "resolved": "https://registry.npmjs.org/sharp/-/sharp-0.33.5.tgz",
      "integrity": "sha512-haPVm1EkS9pgvHrQ/F3Xy+hgcuMV0Wm9vfIBSiwZ05k+xgb0PkBQpGsAA/oWdDobNaZTH5ppvHtzCFbnSEwHVw==",
      "hasInstallScript": true,
      "license": "Apache-2.0",
      "optional": true,
      "dependencies": {
        "color": "^4.2.3",
        "detect-libc": "^2.0.3",
        "semver": "^7.6.3"
      },
      "engines": {
        "node": "^18.17.0 || ^20.3.0 || >=21.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/libvips"
      },
      "optionalDependencies": {
        "@img/sharp-darwin-arm64": "0.33.5",
        "@img/sharp-darwin-x64": "0.33.5",
        "@img/sharp-libvips-darwin-arm64": "1.0.4",
        "@img/sharp-libvips-darwin-x64": "1.0.4",
        "@img/sharp-libvips-linux-arm": "1.0.5",
        "@img/sharp-libvips-linux-arm64": "1.0.4",
        "@img/sharp-libvips-linux-s390x": "1.0.4",
        "@img/sharp-libvips-linux-x64": "1.0.4",
        "@img/sharp-libvips-linuxmusl-arm64": "1.0.4",
        "@img/sharp-libvips-linuxmusl-x64": "1.0.4",
        "@img/sharp-linux-arm": "0.33.5",
        "@img/sharp-linux-arm64": "0.33.5",
        "@img/sharp-linux-s390x": "0.33.5",
        "@img/sharp-linux-x64": "0.33.5",
        "@img/sharp-linuxmusl-arm64": "0.33.5",
        "@img/sharp-linuxmusl-x64": "0.33.5",
        "@img/sharp-wasm32": "0.33.5",
        "@img/sharp-win32-ia32": "0.33.5",
        "@img/sharp-win32-x64": "0.33.5"
      }
    },
    "node_modules/shebang-command": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/shebang-command/-/shebang-command-2.0.0.tgz",
      "integrity": "sha512-kHxr2zZpYtdmrN1qDjrrX/Z1rR1kG8Dx+gkpK1G4eXmvXswmcE1hTWBWYUzlraYw1/yZp6YuDY77YtvbN0dmDA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "shebang-regex": "^3.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/shebang-regex": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/shebang-regex/-/shebang-regex-3.0.0.tgz",
      "integrity": "sha512-7++dFhtcx3353uBaq8DDR4NuxBetBzC7ZQOhmTQInHEd6bSrXdiEyzCvG07Z44UYdLShWUyXt5M/yhz8ekcb1A==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/side-channel": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/side-channel/-/side-channel-1.1.0.tgz",
      "integrity": "sha512-ZX99e6tRweoUXqR+VBrslhda51Nh5MTQwou5tnUDgbtyM0dBgmhEDtWGP/xbKn6hqfPRHujUNwz5fy/wbbhnpw==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "object-inspect": "^1.13.3",
        "side-channel-list": "^1.0.0",
        "side-channel-map": "^1.0.1",
        "side-channel-weakmap": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/side-channel-list": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/side-channel-list/-/side-channel-list-1.0.0.tgz",
      "integrity": "sha512-FCLHtRD/gnpCiCHEiJLOwdmFP+wzCmDEkc9y7NsYxeF4u7Btsn1ZuwgwJGxImImHicJArLP4R0yX4c2KCrMrTA==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "object-inspect": "^1.13.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/side-channel-map": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/side-channel-map/-/side-channel-map-1.0.1.tgz",
      "integrity": "sha512-VCjCNfgMsby3tTdo02nbjtM/ewra6jPHmpThenkTYh8pG9ucZ/1P8So4u4FGBek/BjpOVsDCMoLA/iuBKIFXRA==",
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.2",
        "es-errors": "^1.3.0",
        "get-intrinsic": "^1.2.5",
        "object-inspect": "^1.13.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/side-channel-weakmap": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/side-channel-weakmap/-/side-channel-weakmap-1.0.2.tgz",
      "integrity": "sha512-WPS/HvHQTYnHisLo9McqBHOJk2FkHO/tlpvldyrnem4aeQp4hai3gythswg6p01oSoTl58rcpiFAjF2br2Ak2A==",
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.2",
        "es-errors": "^1.3.0",
        "get-intrinsic": "^1.2.5",
        "object-inspect": "^1.13.3",
        "side-channel-map": "^1.0.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/simple-swizzle": {
      "version": "0.2.4",
      "resolved": "https://registry.npmjs.org/simple-swizzle/-/simple-swizzle-0.2.4.tgz",
      "integrity": "sha512-nAu1WFPQSMNr2Zn9PGSZK9AGn4t/y97lEm+MXTtUDwfP0ksAIX4nO+6ruD9Jwut4C49SB1Ws+fbXsm/yScWOHw==",
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "is-arrayish": "^0.3.1"
      }
    },
    "node_modules/source-map-js": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/source-map-js/-/source-map-js-1.2.1.tgz",
      "integrity": "sha512-UXWMKhLOwVKb728IUtQPXxfYU+usdybtUrK/8uGE8CQMvrhOpwvzDBwj0QhSL7MQc7vIsISBG8VQ8+IDQxpfQA==",
      "license": "BSD-3-Clause",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/stable-hash": {
      "version": "0.0.5",
      "resolved": "https://registry.npmjs.org/stable-hash/-/stable-hash-0.0.5.tgz",
      "integrity": "sha512-+L3ccpzibovGXFK+Ap/f8LOS0ahMrHTf3xu7mMLSpEGU0EO9ucaysSylKo9eRDFNhWve/y275iPmIZ4z39a9iA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/stop-iteration-iterator": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/stop-iteration-iterator/-/stop-iteration-iterator-1.1.0.tgz",
      "integrity": "sha512-eLoXW/DHyl62zxY4SCaIgnRhuMr6ri4juEYARS8E6sCEqzKpOiE521Ucofdx+KnDZl5xmvGYaaKCk5FEOxJCoQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "internal-slot": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/streamsearch": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/streamsearch/-/streamsearch-1.1.0.tgz",
      "integrity": "sha512-Mcc5wHehp9aXz1ax6bZUyY5afg9u2rv5cqQI3mRrYkGC8rW2hM02jWuwjtL++LS5qinSyhj2QfLyNsuc+VsExg==",
      "engines": {
        "node": ">=10.0.0"
      }
    },
    "node_modules/string.prototype.includes": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/string.prototype.includes/-/string.prototype.includes-2.0.1.tgz",
      "integrity": "sha512-o7+c9bW6zpAdJHTtujeePODAhkuicdAryFsfVKwA+wGw89wJ4GTY484WTucM9hLtDEOpOvI+aHnzqnC5lHp4Rg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.7",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.3"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/string.prototype.matchall": {
      "version": "4.0.12",
      "resolved": "https://registry.npmjs.org/string.prototype.matchall/-/string.prototype.matchall-4.0.12.tgz",
      "integrity": "sha512-6CC9uyBL+/48dYizRf7H7VAYCMCNTBeM78x/VTUe9bFEaxBepPJDa1Ow99LqI/1yF7kuy7Q3cQsYMrcjGUcskA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.3",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.6",
        "es-errors": "^1.3.0",
        "es-object-atoms": "^1.0.0",
        "get-intrinsic": "^1.2.6",
        "gopd": "^1.2.0",
        "has-symbols": "^1.1.0",
        "internal-slot": "^1.1.0",
        "regexp.prototype.flags": "^1.5.3",
        "set-function-name": "^2.0.2",
        "side-channel": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/string.prototype.repeat": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/string.prototype.repeat/-/string.prototype.repeat-1.0.0.tgz",
      "integrity": "sha512-0u/TldDbKD8bFCQ/4F5+mNRrXwZ8hg2w7ZR8wa16e8z9XpePWl3eGEcUD0OXpEH/VJH/2G3gjUtR3ZOiBe2S/w==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "define-properties": "^1.1.3",
        "es-abstract": "^1.17.5"
      }
    },
    "node_modules/string.prototype.trim": {
      "version": "1.2.10",
      "resolved": "https://registry.npmjs.org/string.prototype.trim/-/string.prototype.trim-1.2.10.tgz",
      "integrity": "sha512-Rs66F0P/1kedk5lyYyH9uBzuiI/kNRmwJAR9quK6VOtIpZ2G+hMZd+HQbbv25MgCA6gEffoMZYxlTod4WcdrKA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.2",
        "define-data-property": "^1.1.4",
        "define-properties": "^1.2.1",
        "es-abstract": "^1.23.5",
        "es-object-atoms": "^1.0.0",
        "has-property-descriptors": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/string.prototype.trimend": {
      "version": "1.0.9",
      "resolved": "https://registry.npmjs.org/string.prototype.trimend/-/string.prototype.trimend-1.0.9.tgz",
      "integrity": "sha512-G7Ok5C6E/j4SGfyLCloXTrngQIQU3PWtXGst3yM7Bea9FRURf1S42ZHlZZtsNque2FN2PoUhfZXYLNWwEr4dLQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.2",
        "define-properties": "^1.2.1",
        "es-object-atoms": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/string.prototype.trimstart": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/string.prototype.trimstart/-/string.prototype.trimstart-1.0.8.tgz",
      "integrity": "sha512-UXSH262CSZY1tfu3G3Secr6uGLCFVPMhIqHjlgCUtCCcgihYc/xKs9djMTMUOb2j1mVSeU8EU6NWc/iQKU6Gfg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.7",
        "define-properties": "^1.2.1",
        "es-object-atoms": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/strip-bom": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/strip-bom/-/strip-bom-3.0.0.tgz",
      "integrity": "sha512-vavAMRXOgBVNF6nyEEmL3DBK19iRpDcoIwW+swQ+CbGiu7lju6t+JklA1MHweoWtadgt4ISVUsXLyDq34ddcwA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/strip-json-comments": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/strip-json-comments/-/strip-json-comments-3.1.1.tgz",
      "integrity": "sha512-6fPc+R4ihwqP6N/aIv2f1gMH8lOVtWQHoqC4yK6oSDVVocumAsfCqjkXnqiYMhmMwS/mEHLp7Vehlt3ql6lEig==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/stripe": {
      "version": "17.7.0",
      "resolved": "https://registry.npmjs.org/stripe/-/stripe-17.7.0.tgz",
      "integrity": "sha512-aT2BU9KkizY9SATf14WhhYVv2uOapBWX0OFWF4xvcj1mPaNotlSc2CsxpS4DS46ZueSppmCF5BX1sNYBtwBvfw==",
      "license": "MIT",
      "dependencies": {
        "@types/node": ">=8.1.0",
        "qs": "^6.11.0"
      },
      "engines": {
        "node": ">=12.*"
      }
    },
    "node_modules/styled-jsx": {
      "version": "5.1.6",
      "resolved": "https://registry.npmjs.org/styled-jsx/-/styled-jsx-5.1.6.tgz",
      "integrity": "sha512-qSVyDTeMotdvQYoHWLNGwRFJHC+i+ZvdBRYosOFgC+Wg1vx4FrN2/RG/NA7SYqqvKNLf39P2LSRA2pu6n0XYZA==",
      "license": "MIT",
      "dependencies": {
        "client-only": "0.0.1"
      },
      "engines": {
        "node": ">= 12.0.0"
      },
      "peerDependencies": {
        "react": ">= 16.8.0 || 17.x.x || ^18.0.0-0 || ^19.0.0-0"
      },
      "peerDependenciesMeta": {
        "@babel/core": {
          "optional": true
        },
        "babel-plugin-macros": {
          "optional": true
        }
      }
    },
    "node_modules/supports-color": {
      "version": "7.2.0",
      "resolved": "https://registry.npmjs.org/supports-color/-/supports-color-7.2.0.tgz",
      "integrity": "sha512-qpCAvRl9stuOHveKsn7HncJRvv501qIacKzQlO/+Lwxc9+0q2wLyv4Dfvt80/DPn2pqOBsJdDiogXGR9+OvwRw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "has-flag": "^4.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/supports-preserve-symlinks-flag": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/supports-preserve-symlinks-flag/-/supports-preserve-symlinks-flag-1.0.0.tgz",
      "integrity": "sha512-ot0WnXS9fgdkgIcePe6RHNk1WA8+muPa6cSjeR3V8K27q9BB1rTE3R1p7Hv0z1ZyAc8s6Vvv8DIyWf681MAt0w==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/tailwind-merge": {
      "version": "3.4.0",
      "resolved": "https://registry.npmjs.org/tailwind-merge/-/tailwind-merge-3.4.0.tgz",
      "integrity": "sha512-uSaO4gnW+b3Y2aWoWfFpX62vn2sR3skfhbjsEnaBI81WD1wBLlHZe5sWf0AqjksNdYTbGBEd0UasQMT3SNV15g==",
      "license": "MIT",
      "funding": {
        "type": "github",
        "url": "https://github.com/sponsors/dcastil"
      }
    },
    "node_modules/tailwindcss": {
      "version": "4.1.18",
      "resolved": "https://registry.npmjs.org/tailwindcss/-/tailwindcss-4.1.18.tgz",
      "integrity": "sha512-4+Z+0yiYyEtUVCScyfHCxOYP06L5Ne+JiHhY2IjR2KWMIWhJOYZKLSGZaP5HkZ8+bY0cxfzwDE5uOmzFXyIwxw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/tapable": {
      "version": "2.3.0",
      "resolved": "https://registry.npmjs.org/tapable/-/tapable-2.3.0.tgz",
      "integrity": "sha512-g9ljZiwki/LfxmQADO3dEY1CbpmXT5Hm2fJ+QaGKwSXUylMybePR7/67YW7jOrrvjEgL1Fmz5kzyAjWVWLlucg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/webpack"
      }
    },
    "node_modules/tinyglobby": {
      "version": "0.2.15",
      "resolved": "https://registry.npmjs.org/tinyglobby/-/tinyglobby-0.2.15.tgz",
      "integrity": "sha512-j2Zq4NyQYG5XMST4cbs02Ak8iJUdxRM0XI5QyxXuZOzKOINmWurp3smXu3y5wDcJrptwpSjgXHzIQxR0omXljQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "fdir": "^6.5.0",
        "picomatch": "^4.0.3"
      },
      "engines": {
        "node": ">=12.0.0"
      },
      "funding": {
        "url": "https://github.com/sponsors/SuperchupuDev"
      }
    },
    "node_modules/tinyglobby/node_modules/fdir": {
      "version": "6.5.0",
      "resolved": "https://registry.npmjs.org/fdir/-/fdir-6.5.0.tgz",
      "integrity": "sha512-tIbYtZbucOs0BRGqPJkshJUYdL+SDH7dVM8gjy+ERp3WAUjLEFJE+02kanyHtwjWOnwrKYBiwAmM0p4kLJAnXg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=12.0.0"
      },
      "peerDependencies": {
        "picomatch": "^3 || ^4"
      },
      "peerDependenciesMeta": {
        "picomatch": {
          "optional": true
        }
      }
    },
    "node_modules/tinyglobby/node_modules/picomatch": {
      "version": "4.0.3",
      "resolved": "https://registry.npmjs.org/picomatch/-/picomatch-4.0.3.tgz",
      "integrity": "sha512-5gTmgEY/sqK6gFXLIsQNH19lWb4ebPDLA4SdLP7dsWkIXHWlG66oPuVvXSGFPppYZz8ZDZq0dYYrbHfBCVUb1Q==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/sponsors/jonschlinkert"
      }
    },
    "node_modules/to-regex-range": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/to-regex-range/-/to-regex-range-5.0.1.tgz",
      "integrity": "sha512-65P7iz6X5yEr1cwcgvQxbbIw7Uk3gOy5dIdtZ4rDveLqhrdJP+Li/Hx6tyK0NEb+2GCyneCMJiGqrADCSNk8sQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "is-number": "^7.0.0"
      },
      "engines": {
        "node": ">=8.0"
      }
    },
    "node_modules/ts-api-utils": {
      "version": "2.4.0",
      "resolved": "https://registry.npmjs.org/ts-api-utils/-/ts-api-utils-2.4.0.tgz",
      "integrity": "sha512-3TaVTaAv2gTiMB35i3FiGJaRfwb3Pyn/j3m/bfAvGe8FB7CF6u+LMYqYlDh7reQf7UNvoTvdfAqHGmPGOSsPmA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=18.12"
      },
      "peerDependencies": {
        "typescript": ">=4.8.4"
      }
    },
    "node_modules/tsconfig-paths": {
      "version": "3.15.0",
      "resolved": "https://registry.npmjs.org/tsconfig-paths/-/tsconfig-paths-3.15.0.tgz",
      "integrity": "sha512-2Ac2RgzDe/cn48GvOe3M+o82pEFewD3UPbyoUHHdKasHwJKjds4FLXWf/Ux5kATBKN20oaFGu+jbElp1pos0mg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@types/json5": "^0.0.29",
        "json5": "^1.0.2",
        "minimist": "^1.2.6",
        "strip-bom": "^3.0.0"
      }
    },
    "node_modules/tslib": {
      "version": "2.8.1",
      "resolved": "https://registry.npmjs.org/tslib/-/tslib-2.8.1.tgz",
      "integrity": "sha512-oJFu94HQb+KVduSUQL7wnpmqnfmLsOA/nAh6b6EH0wCEoK0/mPeXU6c3wKDV83MkOuHPRHtSXKKU99IBazS/2w==",
      "license": "0BSD"
    },
    "node_modules/type-check": {
      "version": "0.4.0",
      "resolved": "https://registry.npmjs.org/type-check/-/type-check-0.4.0.tgz",
      "integrity": "sha512-XleUoc9uwGXqjWwXaUTZAmzMcFZ5858QA2vvx1Ur5xIcixXIP+8LnFDgRplU30us6teqdlskFfu+ae4K79Ooew==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "prelude-ls": "^1.2.1"
      },
      "engines": {
        "node": ">= 0.8.0"
      }
    },
    "node_modules/typed-array-buffer": {
      "version": "1.0.3",
      "resolved": "https://registry.npmjs.org/typed-array-buffer/-/typed-array-buffer-1.0.3.tgz",
      "integrity": "sha512-nAYYwfY3qnzX30IkA6AQZjVbtK6duGontcQm1WSG1MD94YLqK0515GNApXkoxKOWMusVssAHWLh9SeaoefYFGw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3",
        "es-errors": "^1.3.0",
        "is-typed-array": "^1.1.14"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/typed-array-byte-length": {
      "version": "1.0.3",
      "resolved": "https://registry.npmjs.org/typed-array-byte-length/-/typed-array-byte-length-1.0.3.tgz",
      "integrity": "sha512-BaXgOuIxz8n8pIq3e7Atg/7s+DpiYrxn4vdot3w9KbnBhcRQq6o3xemQdIfynqSeXeDrF32x+WvfzmOjPiY9lg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.8",
        "for-each": "^0.3.3",
        "gopd": "^1.2.0",
        "has-proto": "^1.2.0",
        "is-typed-array": "^1.1.14"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/typed-array-byte-offset": {
      "version": "1.0.4",
      "resolved": "https://registry.npmjs.org/typed-array-byte-offset/-/typed-array-byte-offset-1.0.4.tgz",
      "integrity": "sha512-bTlAFB/FBYMcuX81gbL4OcpH5PmlFHqlCCpAl8AlEzMz5k53oNDvN8p1PNOWLEmI2x4orp3raOFB51tv9X+MFQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "available-typed-arrays": "^1.0.7",
        "call-bind": "^1.0.8",
        "for-each": "^0.3.3",
        "gopd": "^1.2.0",
        "has-proto": "^1.2.0",
        "is-typed-array": "^1.1.15",
        "reflect.getprototypeof": "^1.0.9"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/typed-array-length": {
      "version": "1.0.7",
      "resolved": "https://registry.npmjs.org/typed-array-length/-/typed-array-length-1.0.7.tgz",
      "integrity": "sha512-3KS2b+kL7fsuk/eJZ7EQdnEmQoaho/r6KUef7hxvltNA5DR8NAUM+8wJMbJyZ4G9/7i3v5zPBIMN5aybAh2/Jg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bind": "^1.0.7",
        "for-each": "^0.3.3",
        "gopd": "^1.0.1",
        "is-typed-array": "^1.1.13",
        "possible-typed-array-names": "^1.0.0",
        "reflect.getprototypeof": "^1.0.6"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/typescript": {
      "version": "5.9.3",
      "resolved": "https://registry.npmjs.org/typescript/-/typescript-5.9.3.tgz",
      "integrity": "sha512-jl1vZzPDinLr9eUt3J/t7V6FgNEw9QjvBPdysz9KfQDD41fQrC2Y4vKQdiaUpFT4bXlb1RHhLpp8wtm6M5TgSw==",
      "dev": true,
      "license": "Apache-2.0",
      "bin": {
        "tsc": "bin/tsc",
        "tsserver": "bin/tsserver"
      },
      "engines": {
        "node": ">=14.17"
      }
    },
    "node_modules/unbox-primitive": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/unbox-primitive/-/unbox-primitive-1.1.0.tgz",
      "integrity": "sha512-nWJ91DjeOkej/TA8pXQ3myruKpKEYgqvpw9lz4OPHj/NWFNluYrjbz9j01CJ8yKQd2g4jFoOkINCTW2I5LEEyw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.3",
        "has-bigints": "^1.0.2",
        "has-symbols": "^1.1.0",
        "which-boxed-primitive": "^1.1.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/undici-types": {
      "version": "6.21.0",
      "resolved": "https://registry.npmjs.org/undici-types/-/undici-types-6.21.0.tgz",
      "integrity": "sha512-iwDZqg0QAGrg9Rav5H4n0M64c3mkR59cJ6wQp+7C4nI0gsmExaedaYLNO44eT4AtBBwjbTiGPMlt2Md0T9H9JQ==",
      "license": "MIT"
    },
    "node_modules/unrs-resolver": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/unrs-resolver/-/unrs-resolver-1.11.1.tgz",
      "integrity": "sha512-bSjt9pjaEBnNiGgc9rUiHGKv5l4/TGzDmYw3RhnkJGtLhbnnA/5qJj7x3dNDCRx/PJxu774LlH8lCOlB4hEfKg==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "dependencies": {
        "napi-postinstall": "^0.3.0"
      },
      "funding": {
        "url": "https://opencollective.com/unrs-resolver"
      },
      "optionalDependencies": {
        "@unrs/resolver-binding-android-arm-eabi": "1.11.1",
        "@unrs/resolver-binding-android-arm64": "1.11.1",
        "@unrs/resolver-binding-darwin-arm64": "1.11.1",
        "@unrs/resolver-binding-darwin-x64": "1.11.1",
        "@unrs/resolver-binding-freebsd-x64": "1.11.1",
        "@unrs/resolver-binding-linux-arm-gnueabihf": "1.11.1",
        "@unrs/resolver-binding-linux-arm-musleabihf": "1.11.1",
        "@unrs/resolver-binding-linux-arm64-gnu": "1.11.1",
        "@unrs/resolver-binding-linux-arm64-musl": "1.11.1",
        "@unrs/resolver-binding-linux-ppc64-gnu": "1.11.1",
        "@unrs/resolver-binding-linux-riscv64-gnu": "1.11.1",
        "@unrs/resolver-binding-linux-riscv64-musl": "1.11.1",
        "@unrs/resolver-binding-linux-s390x-gnu": "1.11.1",
        "@unrs/resolver-binding-linux-x64-gnu": "1.11.1",
        "@unrs/resolver-binding-linux-x64-musl": "1.11.1",
        "@unrs/resolver-binding-wasm32-wasi": "1.11.1",
        "@unrs/resolver-binding-win32-arm64-msvc": "1.11.1",
        "@unrs/resolver-binding-win32-ia32-msvc": "1.11.1",
        "@unrs/resolver-binding-win32-x64-msvc": "1.11.1"
      }
    },
    "node_modules/uri-js": {
      "version": "4.4.1",
      "resolved": "https://registry.npmjs.org/uri-js/-/uri-js-4.4.1.tgz",
      "integrity": "sha512-7rKUyy33Q1yc98pQ1DAmLtwX109F7TIfWlW1Ydo8Wl1ii1SeHieeh0HHfPeL2fMXK6z0s8ecKs9frCuLJvndBg==",
      "dev": true,
      "license": "BSD-2-Clause",
      "dependencies": {
        "punycode": "^2.1.0"
      }
    },
    "node_modules/which": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/which/-/which-2.0.2.tgz",
      "integrity": "sha512-BLI3Tl1TW3Pvl70l3yq3Y64i+awpwXqsGBYWkkqMtnbXgrMD+yj7rhW0kuEDxzJaYXGjEW5ogapKNMEKNMjibA==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "isexe": "^2.0.0"
      },
      "bin": {
        "node-which": "bin/node-which"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/which-boxed-primitive": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/which-boxed-primitive/-/which-boxed-primitive-1.1.1.tgz",
      "integrity": "sha512-TbX3mj8n0odCBFVlY8AxkqcHASw3L60jIuF8jFP78az3C2YhmGvqbHBpAjTRH2/xqYunrJ9g1jSyjCjpoWzIAA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "is-bigint": "^1.1.0",
        "is-boolean-object": "^1.2.1",
        "is-number-object": "^1.1.1",
        "is-string": "^1.1.1",
        "is-symbol": "^1.1.1"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/which-builtin-type": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/which-builtin-type/-/which-builtin-type-1.2.1.tgz",
      "integrity": "sha512-6iBczoX+kDQ7a3+YJBnh3T+KZRxM/iYNPXicqk66/Qfm1b93iu+yOImkg0zHbj5LNOcNv1TEADiZ0xa34B4q6Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "call-bound": "^1.0.2",
        "function.prototype.name": "^1.1.6",
        "has-tostringtag": "^1.0.2",
        "is-async-function": "^2.0.0",
        "is-date-object": "^1.1.0",
        "is-finalizationregistry": "^1.1.0",
        "is-generator-function": "^1.0.10",
        "is-regex": "^1.2.1",
        "is-weakref": "^1.0.2",
        "isarray": "^2.0.5",
        "which-boxed-primitive": "^1.1.0",
        "which-collection": "^1.0.2",
        "which-typed-array": "^1.1.16"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/which-collection": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/which-collection/-/which-collection-1.0.2.tgz",
      "integrity": "sha512-K4jVyjnBdgvc86Y6BkaLZEN933SwYOuBFkdmBu9ZfkcAbdVbpITnDmjvZ/aQjRXQrv5EPkTnD1s39GiiqbngCw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "is-map": "^2.0.3",
        "is-set": "^2.0.3",
        "is-weakmap": "^2.0.2",
        "is-weakset": "^2.0.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/which-typed-array": {
      "version": "1.1.20",
      "resolved": "https://registry.npmjs.org/which-typed-array/-/which-typed-array-1.1.20.tgz",
      "integrity": "sha512-LYfpUkmqwl0h9A2HL09Mms427Q1RZWuOHsukfVcKRq9q95iQxdw0ix1JQrqbcDR9PH1QDwf5Qo8OZb5lksZ8Xg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "available-typed-arrays": "^1.0.7",
        "call-bind": "^1.0.8",
        "call-bound": "^1.0.4",
        "for-each": "^0.3.5",
        "get-proto": "^1.0.1",
        "gopd": "^1.2.0",
        "has-tostringtag": "^1.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/word-wrap": {
      "version": "1.2.5",
      "resolved": "https://registry.npmjs.org/word-wrap/-/word-wrap-1.2.5.tgz",
      "integrity": "sha512-BN22B5eaMMI9UMtjrGd5g5eCYPpCPDUy0FJXbYsaT5zYxjFOckS53SQDE3pWkVoWpHXVb3BrYcEN4Twa55B5cA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/ws": {
      "version": "8.19.0",
      "resolved": "https://registry.npmjs.org/ws/-/ws-8.19.0.tgz",
      "integrity": "sha512-blAT2mjOEIi0ZzruJfIhb3nps74PRWTCz1IjglWEEpQl5XS/UNama6u2/rjFkDDouqr4L67ry+1aGIALViWjDg==",
      "license": "MIT",
      "engines": {
        "node": ">=10.0.0"
      },
      "peerDependencies": {
        "bufferutil": "^4.0.1",
        "utf-8-validate": ">=5.0.2"
      },
      "peerDependenciesMeta": {
        "bufferutil": {
          "optional": true
        },
        "utf-8-validate": {
          "optional": true
        }
      }
    },
    "node_modules/yocto-queue": {
      "version": "0.1.0",
      "resolved": "https://registry.npmjs.org/yocto-queue/-/yocto-queue-0.1.0.tgz",
      "integrity": "sha512-rVksvsnNCdJ/ohGc6xgPwyN8eheCxsiLM8mxuE/t/mOVqJewPuO1miLpTHQiRgTKCLexL4MeAFVagts7HmNZ2Q==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    }
  }
}
</file>

<file path="postcss.config.mjs">
const config = {
  plugins: {
    "@tailwindcss/postcss": {},
  },
};

export default config;
</file>

<file path="PRD.md">
# GroomGroove PRD
## Tasmania's Dog Grooming Salon Software

**Version:** 2.0  
**Date:** 12 January 2025  
**Status:** Ready for Development

---

## Overview

### Vision
The go-to booking and management platform for dog groomers in Tasmania ‚Äî simpler, cheaper, and more personal than global alternatives like TapGroom.

### Target Market
- Solo dog groomers in Tasmania
- Small grooming salons (1-5 staff)
- Mobile groomers

### Competitive Position
| Competitor | Price | Weakness |
|------------|-------|----------|
| TapGroom | $22 AUD/mo | Global/generic, native app only, dated UI |
| Gingr | $99+ USD/mo | Enterprise pricing, overkill for small salons |
| Pen & paper | Free | No reminders, no client portal, messy |

**GroomGroove:** Free for solo, $15 AUD/mo for full ‚Äî web-first, local support, modern UX.

---

## Current State

### Existing Features ‚úÖ
- Authentication (login/signup)
- Customer management
- Dog profiles (breed, grooming notes, clipper sizes)
- Appointment calendar
- Basic checkout/payments
- SMS reminders (cron job)
- Appointment history
- Basic reports

### Tech Stack
- **Frontend:** Next.js 16, React 19, Tailwind CSS 4
- **Backend:** Supabase (Postgres, Auth, Real-time)
- **Deployment:** Vercel
- **SMS:** Twilio (via API routes)

---

## Phase 1: Core Improvements (Week 1-2)

### 1.1 Client Self-Booking Portal
**Priority:** üî¥ Critical  
**Why:** #1 differentiator vs TapGroom

**Requirements:**
- Public booking page: `groomgroove.com.au/book/[salon-slug]`
- No login required for clients
- Show available time slots (pulled from calendar)
- Select dog (existing) or add new dog
- Select services from salon's menu
- Confirm booking ‚Üí SMS/email confirmation
- Salon receives notification of new booking

**Acceptance Criteria:**
- [ ] Client can book in under 2 minutes
- [ ] Works perfectly on mobile
- [ ] Salon can share link on Facebook/Instagram
- [ ] Booking syncs to calendar in real-time

### 1.2 Photo Management
**Priority:** üü† High  
**Why:** Groomers love before/after photos, clients share them

**Requirements:**
- Upload photos to dog profile
- Before/after photo pairs on appointments
- Gallery view on dog detail page
- Optional: Share photo to client via SMS/email

**Technical:**
- Use Supabase Storage
- Compress images client-side before upload
- Generate thumbnails

### 1.3 Quick Repeat Booking
**Priority:** üü† High  
**Why:** 80% of appointments are repeats

**Requirements:**
- "Book again" button on completed appointments
- Pre-fills: same dog, same services, same time slot
- Suggests date 4/6/8 weeks out (configurable)
- One-click confirm

---

## Phase 2: Business Features (Week 3-4)

### 2.1 Service Menu Management
**Priority:** üü† High

**Requirements:**
- CRUD for services (name, duration, price)
- Service categories (wash, cut, full groom, add-ons)
- Per-service duration for calendar blocking
- Display on client booking portal

**Schema:**
```sql
CREATE TABLE services (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  salon_id UUID REFERENCES salons(id),
  name TEXT NOT NULL,
  category TEXT,
  duration_minutes INTEGER DEFAULT 60,
  price_cents INTEGER NOT NULL,
  is_active BOOLEAN DEFAULT true,
  sort_order INTEGER,
  created_at TIMESTAMPTZ DEFAULT NOW()
);
```

### 2.2 Invoices & Receipts
**Priority:** üü† High  
**Why:** Aussie groomers need GST-compliant receipts

**Requirements:**
- Generate PDF receipt after checkout
- Include: ABN, GST breakdown, receipt number
- Send via email or SMS link
- Receipt history per customer

### 2.3 Automated Reminders
**Priority:** üü† High

**Requirements:**
- Appointment reminder: 24hrs before (SMS)
- Booking confirmation: immediate (SMS/email)
- "Time for a groom" reminder: X weeks after last appointment
- Configurable timing per salon

**Technical:**
- Vercel Cron or Supabase Edge Functions
- Queue system for reliability
- Australian SMS provider (MessageMedia or Twilio AU)

---

## Phase 3: Growth Features (Week 5-6)

### 3.1 Multi-Staff Support
**Priority:** üü° Medium

**Requirements:**
- Add staff members to salon
- Staff have their own calendar column
- Assign appointments to specific staff
- Staff-level permissions (view only, edit, admin)

### 3.2 Basic Reporting Dashboard
**Priority:** üü° Medium

**Requirements:**
- Revenue this week/month/year
- Appointments count
- Top services by revenue
- Client retention (repeat bookings)
- Export to CSV

### 3.3 Xero Integration
**Priority:** üü° Medium  
**Why:** Most Aussie small businesses use Xero

**Requirements:**
- Connect Xero account (OAuth)
- Auto-create invoice in Xero on checkout
- Sync customers to Xero contacts

---

## Phase 4: Differentiation (Week 7-8)

### 4.1 Vaccination Tracking
**Priority:** üü° Medium

**Requirements:**
- Record vaccination dates on dog profile
- Alert when vaccination expiring
- Block booking if vaccination expired (optional)

### 4.2 Client Portal
**Priority:** üü° Medium

**Requirements:**
- Client login (magic link, no password)
- View upcoming appointments
- View past appointments + photos
- Book new appointment
- Update contact details

### 4.3 Waitlist
**Priority:** üü¢ Low

**Requirements:**
- "Join waitlist" if no slots available
- Auto-notify when slot opens
- First-come-first-served or manual selection

---

## Technical Requirements

### Performance
- Page load < 2 seconds
- Mobile-first responsive design
- Works offline (show cached data, queue actions)

### Security
- Row Level Security on all tables
- Salon data isolation (multi-tenant)
- HTTPS only
- Australian data residency (Supabase Sydney region)

### Reliability
- 99.9% uptime target
- SMS delivery confirmation
- Failed job retry with backoff

---

## Pricing Model

| Tier | Price | Limits |
|------|-------|--------|
| Free | $0 | 1 user, 50 appointments/month, no client portal |
| Pro | $15 AUD/mo | Unlimited appointments, client portal, 3 staff |
| Business | $29 AUD/mo | Unlimited everything, Xero integration, priority support |

---

## Success Metrics

| Metric | Target (3 months) |
|--------|-------------------|
| Active salons in Tasmania | 20 |
| Monthly appointments booked | 500 |
| Client portal adoption | 50% of salons |
| Churn rate | < 5%/month |

---

## Timeline

| Week | Focus | Deliverables |
|------|-------|--------------|
| 1 | Client booking portal | Public booking page live |
| 2 | Photos + repeat booking | Upload flow, "book again" button |
| 3 | Services + invoices | Service menu, PDF receipts |
| 4 | Reminders polish | Reliable SMS, configurable timing |
| 5 | Multi-staff | Staff management, calendar columns |
| 6 | Reporting | Dashboard with key metrics |
| 7 | Xero integration | OAuth flow, invoice sync |
| 8 | Polish + launch | Bug fixes, Tassie launch campaign |

---

## Out of Scope (v2.0)

- Native mobile app (web PWA is sufficient)
- POS hardware integration
- Inventory management
- Multi-location support
- White-labeling

---

## Appendix: Competitor Feature Matrix

| Feature | GroomGroove | TapGroom | Gingr |
|---------|-------------|----------|-------|
| Web app | ‚úÖ | ‚ùå | ‚úÖ |
| Mobile app | PWA | ‚úÖ | ‚úÖ |
| Client self-booking | ‚úÖ | ‚úÖ | ‚úÖ |
| Photo management | ‚úÖ | ‚úÖ | ‚úÖ |
| SMS reminders | ‚úÖ | ‚úÖ | ‚úÖ |
| Offline mode | Partial | ‚úÖ | ‚ùå |
| Xero integration | ‚úÖ | ‚ùå | ‚ùå |
| Australian support | ‚úÖ Local | Email only | US hours |
| Price (AUD/mo) | $0-29 | $22 | $150+ |
</file>

<file path="README.md">
This is a [Next.js](https://nextjs.org) project bootstrapped with [`create-next-app`](https://nextjs.org/docs/app/api-reference/cli/create-next-app).

## Getting Started

First, run the development server:

```bash
npm run dev
# or
yarn dev
# or
pnpm dev
# or
bun dev
```

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

You can start editing the page by modifying `app/page.tsx`. The page auto-updates as you edit the file.

This project uses [`next/font`](https://nextjs.org/docs/app/building-your-application/optimizing/fonts) to automatically optimize and load [Geist](https://vercel.com/font), a new font family for Vercel.

## Learn More

To learn more about Next.js, take a look at the following resources:

- [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API.
- [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial.

You can check out [the Next.js GitHub repository](https://github.com/vercel/next.js) - your feedback and contributions are welcome!

## Deploy on Vercel

The easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme) from the creators of Next.js.

Check out our [Next.js deployment documentation](https://nextjs.org/docs/app/building-your-application/deploying) for more details.
</file>

<file path="SETUP_GUIDE.md">
# GroomGroove Setup Guide

## Quick Start (5 minutes)

---

### Step 1: Open the App

Open your browser and go to:

```
http://localhost:3000
```

---

### Step 2: Create Your Account

1. Click **"Sign up"**
2. Enter your email address
3. Enter a password (at least 6 characters)
4. Click **"Sign up"**

You'll be taken straight to the Dashboard.

---

### Step 3: Add Your First Client

1. Click **"Clients"** in the left sidebar
2. Click **"Add New Client"** button
3. Fill in the form:
   - **First Name**: e.g., Sarah
   - **Surname**: e.g., Johnson
   - **Email**: e.g., sarah@email.com
   - **Phone**: e.g., 0412 345 678
4. Click **"Create Client"**

---

### Step 4: Add a Dog to the Client

1. Click on the client you just created
2. In the side panel, you'll see their details
3. Click **"View Dog"** or navigate to add a dog
4. Fill in dog details:
   - **Name**: e.g., Milo
   - **Breed**: e.g., Golden Retriever
   - **Weight**: e.g., 30kg

---

### Step 5: Book an Appointment

1. Click **"Calendar"** in the left sidebar
2. Click **"New Appointment"** button (or use the + button)
3. Select:
   - **Client**: Choose from dropdown
   - **Dog**: Choose from dropdown
   - **Date & Time**: Pick a slot
   - **Services**: Select what you'll do (Full Groom, Bath & Brush, etc.)
4. Click **"Create Appointment"**

The appointment now appears on your Calendar and Dashboard.

---

### Step 6: Complete an Appointment

When the client arrives and you finish grooming:

1. Go to **Dashboard**
2. Find the appointment in "Today's Appointments"
3. Click the green **"Complete"** button
4. Review the services and total
5. Click **"Mark Service Complete"**
6. Choose payment method (Card or Cash)
7. Optionally schedule their next appointment
8. Click **"Complete Payment"**
9. Print or email the receipt

---

## Daily Workflow

### Morning
1. Open Dashboard to see today's appointments
2. Check which dogs are coming in
3. Note any special concerns (anxious dogs, first visits)

### During the Day
1. When a client arrives, their appointment shows on Dashboard
2. After grooming, click **"Complete"** to checkout
3. Collect payment and print receipt

### Automatic Reminders
- SMS reminders are sent automatically 1 hour before each appointment
- No action needed from you!
- Check **"Notifications"** page to see reminder status

---

## Navigation Guide

| Icon | Page | What it does |
|------|------|--------------|
| üè† | Dashboard | Today's overview |
| üë• | Clients | Manage clients & dogs |
| üìÖ | Calendar | View/book appointments |
| üîî | Notifications | SMS reminder status |
| ‚è∞ | History | Past appointments |
| ‚öôÔ∏è | Settings | App settings |

---

## Keyboard Shortcuts

Hold **Cmd + Option** (Mac) or **Ctrl + Alt** (Windows) and press:

| Key | Goes to |
|-----|---------|
| 1 | Dashboard |
| 2 | Clients |
| 3 | Calendar |
| 4 | Notifications |
| 5 | History |
| 6 | Settings |
| N | New Appointment |

---

## Troubleshooting

### "Page not loading"
- Refresh the page (Cmd + R)
- Check the terminal is still running `npm run dev`

### "Can't log in"
- Make sure email confirmation is disabled in Supabase
- Check your password is at least 6 characters

### "Appointment not showing"
- Check you selected the correct date on the calendar
- Refresh the page

---

## Need Help?

Contact support or check the GitHub repo for updates.

---

*GroomGroove - Making dog grooming simple*
</file>

<file path="Small-AI_CORRECTED_Subscriptions.md">
# SMALL-AI.COM - CORRECTED ACTUAL SUBSCRIPTIONS
Date: January 12, 2026

## YOUR ACTUAL CURRENT MONTHLY SPEND

Based on your corrections and recent receipts:

### CONFIRMED ACTIVE SUBSCRIPTIONS:

1. **Claude Pro (Anthropic)** - ~$25-30 USD/month
   - Evidence: 5 receipts in January 2026
   - Includes: Claude Desktop + Claude Code
   - Status: KEEP - Essential

2. **Apple iCloud Storage** - **~$5/month** (as you confirmed)
   - Note: The $341 in July-Sept was multiple Apple charges including apps, not just iCloud
   - Status: KEEP - Essential for Mac backup

3. **Apple TV** - $15.99/month
   - Evidence: Receipt Dec 24, 2025
   - Status: Personal - not business expense

4. **GoDaddy (small-ai.com)** - Need to verify if $80/month or annual
   - Evidence: $79.99 charge in August 2025
   - Question: Is this MONTHLY or was it an ANNUAL renewal?
   - Status: KEEP either way - essential domain

5. **AWS (Airsyne)** - ~$33/month
   - Evidence: July-Sept charges
   - Status: KEEP - confirmed active for Airsyne

### CANCELLED (You were right!):
- ‚úÖ **Adobe Acrobat DC** - No receipts since October - CANCELLED
- ‚úÖ **XAI, METAGPT X, Hedra** - No recent charges - not active

### FREE ESSENTIAL TOOLS:
- Claude Desktop, Claude Code, Littlebird
- VS Code, GitHub, Figma, Supabase
- Vercel

---

## ESTIMATED MONTHLY SPEND:

**Conservative estimate:**
- Claude Pro: $30
- iCloud Storage: $5
- GoDaddy: $80 (if monthly) OR $7 (if annual divided by 12)
- AWS: $33
- Apple TV: $16 (personal, not business)

**Business Total: $68-141/month** (depending on GoDaddy frequency)

---

## CRITICAL QUESTION TO RESOLVE:

**Is your GoDaddy charge of $79.99 MONTHLY or ANNUAL?**

This makes a huge difference:
- If monthly: ~$141/month business spend
- If annual: ~$68/month business spend

Can you check your GoDaddy account or last receipt to confirm?

---

## BOTTOM LINE:

You were absolutely right to question my numbers! Your actual spend is:
- ‚úÖ Adobe CANCELLED (saved ~$97/month)
- ‚úÖ iCloud is $5, not $28 (I was wrong)
- ‚ùì GoDaddy needs verification ($80/mo or $80/year?)

**Your subscription management is EXCELLENT.** 

You're running lean - this is a well-optimized stack!
</file>

<file path="STRIPE_SETUP.md">
# Stripe Integration Setup for GroomGroove

## Environment Variables

Add the following environment variables to your `.env.local` file:

```bash
# Stripe Keys (from Stripe Dashboard)
STRIPE_SECRET_KEY=sk_live_...  # or sk_test_... for testing
STRIPE_WEBHOOK_SECRET=whsec_...  # Webhook signing secret
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_live_...  # or pk_test_...

# Existing Supabase variables (should already be set)
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
```

## Stripe Dashboard Setup

1. **Create Products and Prices:**
   - Go to Stripe Dashboard ‚Üí Products
   - Create a product for your SaaS subscription (e.g., "GroomGroove Pro")
   - Add pricing (monthly/annual)

2. **Configure Webhooks:**
   - Go to Stripe Dashboard ‚Üí Developers ‚Üí Webhooks
   - Add endpoint URL: `https://yourdomain.com/api/stripe/webhook`
   - Select events to listen for:
     - `checkout.session.completed`
     - `invoice.payment_succeeded`
     - `customer.subscription.updated`
     - `customer.subscription.deleted`
   - Copy the "Signing secret"

3. **Test Mode:**
   - Use test keys (`sk_test_...`, `pk_test_...`) for development
   - Use Stripe's test cards (e.g., `4242 4242 4242 4242`)

## Database Migration

Run the SQL migration to create the `user_subscriptions` table:

```sql
-- The migration file is at: supabase/migrations/006_user_subscriptions.sql
-- Run this in your Supabase SQL Editor
```

## API Endpoints

### 1. Create Checkout Session
**POST** `/api/stripe/checkout`

Request body:
```json
{
  "priceId": "price_...",
  "successUrl": "https://yourdomain.com/success",
  "cancelUrl": "https://yourdomain.com/pricing"
}
```

Response:
```json
{
  "sessionId": "cs_test_...",
  "url": "https://checkout.stripe.com/c/pay/..."
}
```

### 2. Webhook Endpoint
**POST** `/api/stripe/webhook`
- Handles Stripe events and updates user subscriptions
- Requires `STRIPE_WEBHOOK_SECRET` for signature verification

## Client-Side Integration

### Starting a Checkout Session
```typescript
async function startCheckout(priceId: string) {
  const response = await fetch('/api/stripe/checkout', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ priceId }),
  });
  
  const { url } = await response.json();
  window.location.href = url;
}
```

### Checking Subscription Status
```typescript
import { isUserPro } from '@/lib/stripe/utils';

const isPro = await isUserPro(userId);
```

### Customer Portal
```typescript
import { getCustomerPortalUrl } from '@/lib/stripe/utils';

const portalUrl = await getCustomerPortalUrl(userId, 'https://yourdomain.com/account');
window.location.href = portalUrl;
```

## Testing

1. **Local Testing:**
   - Use Stripe CLI: `stripe listen --forward-to localhost:3000/api/stripe/webhook`
   - This provides a webhook signing secret for local development

2. **Test Cards:**
   - Success: `4242 4242 4242 4242`
   - Requires authentication: `4000 0025 0000 3155`
   - Decline: `4000 0000 0000 0002`

## Security Notes

1. **Never expose secret keys in client-side code**
2. **Always verify webhook signatures**
3. **Use Row Level Security (RLS) in Supabase**
4. **Validate user authentication in API endpoints**
5. **Log webhook events for debugging**

## Troubleshooting

- **Webhook errors:** Check Stripe Dashboard ‚Üí Developers ‚Üí Webhooks for event logs
- **Database issues:** Verify RLS policies allow service role operations
- **Type errors:** Ensure Stripe SDK types are installed (`@types/stripe`)
- **Build errors:** Check environment variables are set correctly
</file>

<file path="Subscription_Cancellation_Checklist.md">
# SUBSCRIPTION CANCELLATION CHECKLIST
Date: January 12, 2026

## IMMEDIATE CANCELLATIONS - $145.50/month savings

### ‚úÖ CHECKLIST

---

## 1. XAI (Grok) - $49/month
**Website:** https://x.ai or https://grok.x.ai
**Status:** [ ] NOT STARTED  [ ] IN PROGRESS  [ ] ‚úÖ CANCELLED

**Steps:**
1. Log in to your X.AI/Grok account
2. Navigate to Account Settings or Billing
3. Click "Manage Subscription" or "Cancel Subscription"
4. Confirm cancellation
5. Save confirmation email

**Cancellation Confirmed:** _________________ (date/time)
**Confirmation #:** _________________________

---

## 2. METAGPT X - $32/month
**Website:** https://metagpt.com
**Status:** [ ] NOT STARTED  [ ] IN PROGRESS  [ ] ‚úÖ CANCELLED

**Steps:**
1. Log in to MetaGPT account
2. Go to Settings > Billing or Subscription
3. Click "Cancel Subscription"
4. Confirm cancellation
5. Save confirmation email

**Cancellation Confirmed:** _________________ (date/time)
**Confirmation #:** _________________________

---

## 3. Hedra - $64.50/month
**Website:** https://hedra.com or https://app.hedra.com
**Status:** [ ] NOT STARTED  [ ] IN PROGRESS  [ ] ‚úÖ CANCELLED

**Steps:**
1. Log in to Hedra account
2. Navigate to Account/Billing settings
3. Click "Cancel Subscription" or "Manage Plan"
4. Confirm cancellation
5. Save confirmation email

**Cancellation Confirmed:** _________________ (date/time)
**Confirmation #:** _________________________

---

## TOTAL MONTHLY SAVINGS: $145.50
## TOTAL ANNUAL SAVINGS: $1,746.00

---

## IMPORTANT NOTES:

### Cancellation Best Practices:
- Most services allow you to use the subscription until the current billing period ends
- Save all confirmation emails
- Check your credit card/bank statement next month to verify charges stopped
- Some services may offer a discount to keep you - decline if you don't need it

### If You Can't Find Cancellation:
1. Check your email for the original subscription confirmation
2. Look for "manage subscription" links in billing emails
3. Contact support directly (usually faster than searching)
4. If paid through PayPal or App Store, cancel through those platforms

---

## VERIFICATION CHECKLIST (Do in 30 days):

[ ] Check Jan/Feb bank statement - verify XAI charge stopped
[ ] Check Jan/Feb bank statement - verify METAGPT charge stopped  
[ ] Check Jan/Feb bank statement - verify Hedra charge stopped
[ ] Update your Small-AI Technology Audit spreadsheet
[ ] Celebrate saving $145.50/month! üéâ

---

## NEXT STEPS AFTER CANCELLATION:

Once these are cancelled, review the 5 subscriptions marked for review:
1. Abacus.AI ($31.19/mo)
2. Manus AI ($62/mo)
3. Bubble.io ($52/mo)
4. DHI Subscription ($40.14/mo)
5. Emergent ($16/mo)

Potential additional savings: $201.33/month

---

Need help? I can:
- Search your emails for original subscription confirmations
- Help you draft cancellation emails to support teams
- Track when charges should stop appearing
</file>

<file path="app/(app)/calendar/new/page.tsx">
import { NewAppointmentForm } from './NewAppointmentForm'

export default function NewAppointmentPage() {
  return <NewAppointmentForm />
}
</file>

<file path="app/(app)/calendar/CalendarGrid.tsx">
'use client'

import { useState, useMemo } from 'react'
import { useRouter } from 'next/navigation'
import { Card } from '@/components/ui/Card'
import { Button } from '@/components/ui/Button'
import { ChevronLeft, ChevronRight } from 'lucide-react'

interface CalendarGridProps {
  selectedDate: string | null
  datesWithAppointments: string[]
  onDateSelect?: (date: string) => void
}

export default function CalendarGrid({ selectedDate, datesWithAppointments, onDateSelect }: CalendarGridProps) {
  const router = useRouter()
  const today = new Date()
  const [currentMonth, setCurrentMonth] = useState(today.getMonth())
  const [currentYear, setCurrentYear] = useState(today.getFullYear())

  const calendarDays = useMemo(() => {
    const firstDay = new Date(currentYear, currentMonth, 1)
    const lastDay = new Date(currentYear, currentMonth + 1, 0)
    const daysInMonth = lastDay.getDate()
    const startDayOfWeek = firstDay.getDay()

    const days: (number | null)[] = []
    for (let i = 0; i < startDayOfWeek; i++) {
      days.push(null)
    }
    for (let i = 1; i <= daysInMonth; i++) {
      days.push(i)
    }
    return days
  }, [currentMonth, currentYear])

  const monthName = new Date(currentYear, currentMonth).toLocaleString('default', {
    month: 'long',
    year: 'numeric'
  })

  const handleDayClick = (day: number) => {
    const dateStr = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`
    if (onDateSelect) {
      onDateSelect(dateStr)
    } else {
      router.push(`/calendar?date=${dateStr}`)
    }
  }

  const goToPreviousMonth = () => {
    if (currentMonth === 0) {
      setCurrentMonth(11)
      setCurrentYear(currentYear - 1)
    } else {
      setCurrentMonth(currentMonth - 1)
    }
  }

  const goToNextMonth = () => {
    if (currentMonth === 11) {
      setCurrentMonth(0)
      setCurrentYear(currentYear + 1)
    } else {
      setCurrentMonth(currentMonth + 1)
    }
  }

  const hasAppointments = (day: number) => {
    const dateStr = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`
    return datesWithAppointments.includes(dateStr)
  }

  const isToday = (day: number) => {
    return (
      day === today.getDate() &&
      currentMonth === today.getMonth() &&
      currentYear === today.getFullYear()
    )
  }

  const isSelected = (day: number) => {
    if (!selectedDate) return false
    const dateStr = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`
    return dateStr === selectedDate
  }

  const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']

  return (
    <Card>
      <div className="flex items-center justify-between mb-6">
        <Button variant="ghost" size="sm" onClick={goToPreviousMonth}>
          <ChevronLeft className="w-5 h-5" />
        </Button>
        <h2 className="text-lg font-semibold">{monthName}</h2>
        <Button variant="ghost" size="sm" onClick={goToNextMonth}>
          <ChevronRight className="w-5 h-5" />
        </Button>
      </div>

      <div className="grid grid-cols-7 gap-1">
        {dayNames.map((day) => (
          <div key={day} className="text-center text-sm font-medium text-gray-500 py-2">
            {day}
          </div>
        ))}
        {calendarDays.map((day, index) => {
          if (day === null) {
            return <div key={`empty-${index}`} className="aspect-square" />
          }

          const selected = isSelected(day)
          const todayDate = isToday(day)
          const hasAppts = hasAppointments(day)

          return (
            <button
              key={day}
              onClick={() => handleDayClick(day)}
              className={`
                aspect-square p-2 text-sm rounded-lg transition-all relative
                ${todayDate && !selected
                  ? 'bg-blue-600 text-white font-semibold hover:bg-blue-700'
                  : selected
                  ? 'ring-2 ring-blue-500 bg-blue-50 text-blue-900 font-semibold'
                  : 'hover:bg-gray-100 text-gray-700'
                }
              `}
            >
              {day}
              {hasAppts && !todayDate && !selected && (
                <div className="absolute bottom-1 left-1/2 transform -translate-x-1/2 w-1 h-1 bg-blue-500 rounded-full" />
              )}
              {hasAppts && (todayDate || selected) && (
                <div className="absolute bottom-1 left-1/2 transform -translate-x-1/2 w-1 h-1 bg-current rounded-full opacity-60" />
              )}
            </button>
          )
        })}
      </div>
    </Card>
  )
}
</file>

<file path="app/(app)/groomers/GroomersPageClient.tsx">
'use client'

import { useState } from 'react'
import { Smile, UserPlus, Mail, Phone, Trash2 } from 'lucide-react'
import Image from 'next/image'
import { Button } from '@/components/ui/Button'
import { deleteGroomer, type Groomer } from '@/lib/actions/groomers'

interface GroomersPageClientProps {
  initialGroomers: Groomer[]
}

// Generate initials from name
const getInitials = (name: string) => {
  return name
    .split(' ')
    .map(n => n[0])
    .join('')
    .toUpperCase()
    .slice(0, 2)
}

// Get role badge color
const getRoleBadgeClass = (role: string) => {
  switch (role.toLowerCase()) {
    case 'owner':
      return 'bg-purple-100 text-purple-800'
    case 'senior groomer':
      return 'bg-blue-100 text-blue-800'
    case 'groomer':
      return 'bg-green-100 text-green-800'
    case 'trainee':
      return 'bg-yellow-100 text-yellow-800'
    default:
      return 'bg-gray-100 text-gray-800'
  }
}

export function GroomersPageClient({ initialGroomers }: GroomersPageClientProps) {
  const [groomers, setGroomers] = useState<Groomer[]>(initialGroomers)
  const [deletingId, setDeletingId] = useState<string | null>(null)

  const handleDelete = async (groomer: Groomer) => {
    const confirmed = confirm(`Are you sure you want to delete ${groomer.name}? This action cannot be undone.`)
    if (!confirmed) return

    setDeletingId(groomer.id)

    try {
      const result = await deleteGroomer(groomer.id)
      if (result.success) {
        // Remove from local state immediately
        setGroomers(prev => prev.filter(g => g.id !== groomer.id))
      } else {
        alert(`Failed to delete groomer: ${result.error}`)
      }
    } catch (error) {
      console.error('Error deleting groomer:', error)
      alert('An unexpected error occurred while deleting the groomer.')
    } finally {
      setDeletingId(null)
    }
  }

  const totalGroomers = groomers.length
  const activeGroomers = groomers.filter(m => m.role.toLowerCase().includes('groomer')).length
  const ownersAdmins = groomers.filter(m => m.role.toLowerCase() === 'owner' || m.role.toLowerCase() === 'admin').length

  return (
    <div className="p-6 max-w-6xl mx-auto">
      {/* Header */}
      <div className="flex items-center justify-between mb-8">
        <div className="flex items-center gap-3">
          <div className="p-3 bg-yellow-100 rounded-xl">
            <Smile className="h-8 w-8 text-yellow-600" />
          </div>
          <div>
            <h1 className="text-3xl font-bold text-gray-900">Groomers</h1>
            <p className="text-gray-500">Manage your grooming team</p>
          </div>
        </div>
        <Button
          href="/groomers/new"
          className="bg-blue-600 hover:bg-blue-700 text-white"
        >
          <UserPlus className="h-4 w-4 mr-2" />
          Add Groomer
        </Button>
      </div>

      {/* Groomer Stats */}
      <div className="grid grid-cols-3 gap-4 mb-8">
        <div className="bg-white rounded-xl border border-gray-100 p-4">
          <p className="text-sm text-gray-500">Total Groomers</p>
          <p className="text-2xl font-bold text-gray-900">{totalGroomers}</p>
        </div>
        <div className="bg-white rounded-xl border border-gray-100 p-4">
          <p className="text-sm text-gray-500">Active Groomers</p>
          <p className="text-2xl font-bold text-gray-900">{activeGroomers}</p>
        </div>
        <div className="bg-white rounded-xl border border-gray-100 p-4">
          <p className="text-sm text-gray-500">Owners/Admins</p>
          <p className="text-2xl font-bold text-gray-900">{ownersAdmins}</p>
        </div>
      </div>

      {/* Groomers List */}
      <div className="bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden">
        {groomers.length === 0 ? (
          <div className="p-12 text-center">
            <div className="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6">
              <Smile className="h-10 w-10 text-gray-400" />
            </div>
            <h2 className="text-xl font-bold text-gray-900 mb-2">No groomers yet</h2>
            <p className="text-gray-500 mb-6">Add your first groomer to get started.</p>
            <Button
              href="/groomers/new"
              className="bg-blue-600 hover:bg-blue-700 text-white"
            >
              <UserPlus className="h-4 w-4 mr-2" />
              Add First Groomer
            </Button>
          </div>
        ) : (
          <table className="w-full">
            <thead className="bg-gray-50 border-b border-gray-100">
              <tr>
                <th className="text-left py-4 px-6 text-xs font-semibold text-gray-500 uppercase tracking-wider">
                  Groomer
                </th>
                <th className="text-left py-4 px-6 text-xs font-semibold text-gray-500 uppercase tracking-wider">
                  Contact
                </th>
                <th className="text-left py-4 px-6 text-xs font-semibold text-gray-500 uppercase tracking-wider">
                  Role
                </th>
                <th className="text-left py-4 px-6 text-xs font-semibold text-gray-500 uppercase tracking-wider">
                  Calendar Color
                </th>
                <th className="text-right py-4 px-6 text-xs font-semibold text-gray-500 uppercase tracking-wider">
                  Actions
                </th>
              </tr>
            </thead>
            <tbody className="divide-y divide-gray-100">
              {groomers.map((groomer) => (
                <tr key={groomer.id} className="hover:bg-gray-50 transition-colors">
                  <td className="py-4 px-6">
                    <div className="flex items-center gap-3">
                      {groomer.avatar_url ? (
                        <div className="relative w-10 h-10 rounded-full overflow-hidden">
                          <Image
                            src={groomer.avatar_url}
                            alt={groomer.name}
                            fill
                            className="object-cover"
                          />
                        </div>
                      ) : (
                        <div
                          className="w-10 h-10 rounded-full flex items-center justify-center text-white font-bold text-sm"
                          style={{ backgroundColor: groomer.color || '#3B82F6' }}
                        >
                          {getInitials(groomer.name)}
                        </div>
                      )}
                      <div>
                        <p className="font-semibold text-gray-900">{groomer.name}</p>
                      </div>
                    </div>
                  </td>
                  <td className="py-4 px-6">
                    <div className="space-y-1">
                      {groomer.email ? (
                        <div className="flex items-center gap-2 text-gray-600 text-sm">
                          <Mail className="h-3.5 w-3.5 text-gray-400" />
                          <span>{groomer.email}</span>
                        </div>
                      ) : null}
                      {groomer.phone ? (
                        <div className="flex items-center gap-2 text-gray-600 text-sm">
                          <Phone className="h-3.5 w-3.5 text-gray-400" />
                          <span>{groomer.phone}</span>
                        </div>
                      ) : null}
                      {!groomer.email && !groomer.phone && (
                        <span className="text-gray-400 italic text-sm">No contact info</span>
                      )}
                    </div>
                  </td>
                  <td className="py-4 px-6">
                    <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getRoleBadgeClass(groomer.role)}`}>
                      {groomer.role}
                    </span>
                  </td>
                  <td className="py-4 px-6">
                    <div className="flex items-center gap-2">
                      <div
                        className="w-6 h-6 rounded-full border-2 border-white shadow-sm"
                        style={{ backgroundColor: groomer.color || '#3B82F6' }}
                      />
                      <span className="text-sm text-gray-500">{groomer.color || '#3B82F6'}</span>
                    </div>
                  </td>
                  <td className="py-4 px-6">
                    <div className="flex justify-end">
                      <button
                        onClick={() => handleDelete(groomer)}
                        disabled={deletingId === groomer.id}
                        className="p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                        title={`Delete ${groomer.name}`}
                      >
                        <Trash2 className="h-4 w-4" />
                      </button>
                    </div>
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        )}
      </div>

      {/* Info note */}
      <div className="mt-6 p-4 bg-blue-50 rounded-xl border border-blue-100">
        <p className="text-sm text-blue-700">
          <strong>Tip:</strong> Groomers will appear in the calendar with their assigned color.
          You can manage groomers in the Settings page.
        </p>
      </div>
    </div>
  )
}
</file>

<file path="app/(app)/groomers/page.tsx">
import { getGroomers } from '@/lib/actions/groomers'
import { GroomersPageClient } from './GroomersPageClient'

export default async function GroomersPage() {
  const groomers = await getGroomers()

  return <GroomersPageClient initialGroomers={groomers} />
}
</file>

<file path="app/(app)/history/HistoryPageClient.tsx">
import Link from 'next/link'
import Image from 'next/image'
import { Card } from '@/components/ui/Card'
import { Badge } from '@/components/ui/Badge'
import { CheckCircle, Clock, XCircle } from 'lucide-react'

interface HistoryAppointment {
  id: string
  dogId: string | null
  dogName: string
  dogBreed: string | null
  dogPhotoUrl: string | null
  ownerName: string
  services: string[]
  notes: string | null
  status: string
  time: string
  date: string
}

interface HistoryPageClientProps {
  appointments: HistoryAppointment[]
}

function StatusIcon({ status }: { status: string }) {
  if (status === 'completed') {
    return (
      <div className="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
        <CheckCircle className="w-5 h-5 text-green-600" />
      </div>
    )
  }
  if (status === 'cancelled') {
    return (
      <div className="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center">
        <XCircle className="w-5 h-5 text-red-600" />
      </div>
    )
  }
  return (
    <div className="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
      <Clock className="w-5 h-5 text-blue-600" />
    </div>
  )
}

type BadgeVariant = 'default' | 'info' | 'success'

function StatusBadge({ status }: { status: string }) {
  const variants: Record<string, BadgeVariant> = {
    pending_confirmation: 'default',
    confirmed: 'info',
    completed: 'success',
    cancelled: 'default'
  }
  const labels: Record<string, string> = {
    pending_confirmation: 'Pending',
    confirmed: 'Confirmed',
    completed: 'Completed',
    cancelled: 'Cancelled'
  }
  return <Badge variant={variants[status] || 'default'}>{labels[status] || status}</Badge>
}

export function HistoryPageClient({ appointments }: HistoryPageClientProps) {
  return (
    <Card>
      <h3 className="font-semibold text-gray-900 mb-4">All Sessions</h3>
      {appointments.length > 0 ? (
        <div className="space-y-3">
          {appointments.map((appt) => (
            <div
              key={appt.id}
              className="flex items-center gap-4 p-4 bg-gray-50 rounded-xl"
            >
              {/* Dog Photo */}
              {appt.dogPhotoUrl ? (
                <div className="relative w-12 h-12 rounded-full overflow-hidden flex-shrink-0">
                  <Image
                    src={appt.dogPhotoUrl}
                    alt={appt.dogName}
                    fill
                    className="object-cover"
                  />
                </div>
              ) : (
                <div className="w-12 h-12 bg-rose-100 rounded-full flex items-center justify-center flex-shrink-0">
                  <span className="text-xl">üêï</span>
                </div>
              )}
              <div className="flex-1">
                <div className="flex items-center gap-2">
                  {appt.dogId ? (
                    <Link
                      href={`/dogs/${appt.dogId}`}
                      className="font-medium text-blue-600 hover:text-blue-800 hover:underline"
                    >
                      {appt.dogName}
                    </Link>
                  ) : (
                    <span className="font-medium text-gray-900">
                      {appt.dogName}
                    </span>
                  )}
                  {appt.dogBreed && (
                    <span className="text-sm text-gray-500">({appt.dogBreed})</span>
                  )}
                  <StatusBadge status={appt.status} />
                </div>
                <p className="text-sm text-gray-500">{appt.ownerName}</p>
                <p className="text-xs text-gray-400">
                  {appt.services?.join(', ') || 'No services'}
                </p>
                {appt.notes && (
                  <p className="text-xs text-gray-400 italic mt-1">{appt.notes}</p>
                )}
              </div>
              <div className="text-right">
                <p className="font-medium text-gray-900">{appt.time}</p>
                <p className="text-xs text-gray-500">{appt.date}</p>
              </div>
            </div>
          ))}
        </div>
      ) : (
        <div className="text-center py-12 text-gray-500">
          <p>No sessions recorded yet</p>
          <p className="text-sm mt-1">Sessions will appear here after appointments are completed</p>
        </div>
      )}
    </Card>
  )
}
</file>

<file path="app/(app)/notifications/page.tsx">
import { getTodaysAppointments, getTodayStats, getRecentActivity } from '@/lib/actions/notifications'
import { NotificationsPageClient } from './NotificationsPageClient'

/**
 * Notifications Page (Server Component)
 * Fetches today's appointments, stats, and recent activity
 * Passes data to client component for interactive features
 */
export default async function NotificationsPage() {
  const [appointments, stats, activity] = await Promise.all([
    getTodaysAppointments(),
    getTodayStats(),
    getRecentActivity(5),
  ])

  return (
    <NotificationsPageClient
      initialAppointments={appointments}
      initialStats={stats}
      initialActivity={activity}
    />
  )
}
</file>

<file path="app/(app)/onboarding/page.tsx">
'use client'

import { useState } from "react";
import { Button } from "@/components/ui/Button";
import { Input } from "@/components/ui/Input";
import { setupBusiness } from "@/lib/actions/onboarding";
import { Rocket, AlertCircle } from "lucide-react";

export default function OnboardingPage() {
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const handleSubmit = async (formData: FormData) => {
    setIsLoading(true);
    setError(null);

    // Call the server
    const result = await setupBusiness(formData);

    // If server sent back an error, show it!
    if (result?.error) {
      setError(result.error);
      setIsLoading(false);
    }
    // If success, the server will redirect us.
  };

  return (
    <div className="min-h-screen bg-gray-50 flex items-center justify-center p-4">
      <div className="max-w-md w-full bg-white rounded-2xl shadow-xl p-8 border border-gray-100">
        <div className="text-center mb-8">
          <div className="bg-rose-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
            <Rocket className="w-8 h-8 text-rose-600" />
          </div>
          <h1 className="text-2xl font-bold text-gray-900">Welcome to GroomGroove!</h1>
          <p className="text-gray-500 mt-2">Let's get your salon set up in 30 seconds.</p>
        </div>

        {/* ERROR MESSAGE DISPLAY */}
        {error && (
          <div className="mb-6 bg-red-50 text-red-600 p-3 rounded-lg flex items-center gap-2 text-sm">
            <AlertCircle className="w-4 h-4" />
            {error}
          </div>
        )}

        <form action={handleSubmit} className="space-y-6">
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">Business Name *</label>
            <Input name="businessName" placeholder="e.g. Paws & Claws" required className="text-lg" />
          </div>

          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">Salon Phone</label>
            <Input name="phone" placeholder="e.g. 0400 000 000" />
          </div>

          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">Currency Symbol</label>
            <Input name="currency" defaultValue="$" className="w-20 text-center font-bold" />
          </div>

          <Button
            type="submit"
            className="w-full bg-rose-500 hover:bg-rose-600 text-white py-6 text-lg rounded-xl"
            disabled={isLoading}
          >
            {isLoading ? "Setting up..." : "Start Grooming üöÄ"}
          </Button>
        </form>
      </div>
    </div>
  );
}
</file>

<file path="app/(app)/photos/page.tsx">
import Link from 'next/link'
import Image from 'next/image'
import { Card } from '@/components/ui/Card'
import { getDogsWithPhotos, getAllDogsForUpload } from '@/lib/actions/photos'
import { Camera } from 'lucide-react'
import PhotoUploader from '@/components/PhotoUploader'

export default async function PhotosPage() {
  const [dogsWithPhotos, allDogs] = await Promise.all([
    getDogsWithPhotos(),
    getAllDogsForUpload()
  ])

  return (
    <div className="space-y-6">
      <div className="flex items-center justify-between">
        <div>
          <h1 className="text-2xl font-bold text-gray-900">Photo Pin Board</h1>
          <p className="text-gray-500 mt-1">Your furry clients gallery</p>
        </div>
        <div className="text-sm text-gray-500">
          {dogsWithPhotos.length} {dogsWithPhotos.length === 1 ? 'photo' : 'photos'}
        </div>
      </div>

      {/* Photo Uploader */}
      <PhotoUploader dogs={allDogs} />

      {dogsWithPhotos.length > 0 ? (
        <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4">
          {dogsWithPhotos.map((dog) => (
            <Link key={dog.id} href={`/dogs/${dog.id}`}>
              <Card className="overflow-hidden group cursor-pointer hover:shadow-lg transition-shadow">
                <div className="aspect-square relative">
                  <Image
                    src={dog.photo_url}
                    alt={dog.name}
                    fill
                    className="object-cover group-hover:scale-105 transition-transform duration-300"
                  />
                  <div className="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity" />
                  <div className="absolute bottom-0 left-0 right-0 p-3 translate-y-full group-hover:translate-y-0 transition-transform">
                    <p className="font-semibold text-white text-sm truncate">{dog.name}</p>
                    {dog.breed && (
                      <p className="text-white/80 text-xs truncate">{dog.breed}</p>
                    )}
                    {dog.customer_name && (
                      <p className="text-white/60 text-xs truncate mt-0.5">{dog.customer_name}</p>
                    )}
                  </div>
                </div>
                <div className="p-3 bg-white">
                  <p className="font-medium text-gray-900 text-sm truncate">{dog.name}</p>
                  <p className="text-gray-500 text-xs truncate">{dog.breed || 'Mixed breed'}</p>
                </div>
              </Card>
            </Link>
          ))}
        </div>
      ) : (
        <Card>
          <div className="p-12 text-center">
            <div className="w-16 h-16 bg-rose-100 rounded-full flex items-center justify-center mx-auto mb-4">
              <Camera className="w-8 h-8 text-rose-500" />
            </div>
            <h3 className="text-lg font-semibold text-gray-900 mb-2">No photos yet</h3>
            <p className="text-gray-500 mb-4 max-w-md mx-auto">
              Start building your gallery by adding photos to your furry clients.
              Visit any dog&apos;s profile to upload their photo.
            </p>
            <Link
              href="/dogs"
              className="inline-flex items-center justify-center px-4 py-2 bg-rose-500 text-white rounded-xl hover:bg-rose-600 transition-colors text-sm font-medium"
            >
              Browse Dogs
            </Link>
          </div>
        </Card>
      )}
    </div>
  )
}
</file>

<file path="app/(app)/reports/page.tsx">
import { Card } from '@/components/ui/Card'
import { StatCard } from '@/components/dashboard/StatCard'
import { BarChart3, TrendingUp, DollarSign, Calendar, Users, Dog } from 'lucide-react'

const mockReportData = {
  totalRevenue: 12450,
  monthlyGrowth: 15,
  totalAppointments: 156,
  avgPerAppointment: 79.81,
  topServices: [
    { name: 'Full Groom', count: 67, revenue: 5695 },
    { name: 'Bath & Brush', count: 45, revenue: 2025 },
    { name: 'Nail Trim', count: 32, revenue: 800 },
    { name: 'De-shedding', count: 12, revenue: 780 },
  ],
  monthlyData: [
    { month: 'Jan', revenue: 8200 },
    { month: 'Feb', revenue: 9100 },
    { month: 'Mar', revenue: 10500 },
    { month: 'Apr', revenue: 12450 },
  ],
}

export default function ReportsPage() {
  return (
    <div className="space-y-6">
      <div>
        <h1 className="text-2xl font-bold text-gray-900">Reports</h1>
        <p className="text-gray-500">Business analytics and performance metrics</p>
      </div>

      {/* KPI Cards */}
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        <StatCard
          title="Total Revenue"
          value={`$${mockReportData.totalRevenue.toLocaleString()}`}
          icon={DollarSign}
          color="green"
          trend={{ value: mockReportData.monthlyGrowth, label: 'vs last month' }}
        />
        <StatCard
          title="Appointments"
          value={mockReportData.totalAppointments}
          icon={Calendar}
          color="blue"
        />
        <StatCard
          title="Avg per Visit"
          value={`$${mockReportData.avgPerAppointment}`}
          icon={TrendingUp}
          color="rose"
        />
        <StatCard
          title="Active Humans"
          value={42}
          icon={Users}
          color="amber"
        />
      </div>

      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
        {/* Revenue Chart Placeholder */}
        <Card>
          <h3 className="font-semibold text-gray-900 mb-4 flex items-center gap-2">
            <BarChart3 className="w-5 h-5 text-blue-600" />
            Monthly Revenue
          </h3>
          <div className="space-y-3">
            {mockReportData.monthlyData.map((item) => (
              <div key={item.month} className="flex items-center gap-4">
                <span className="w-10 text-sm text-gray-500">{item.month}</span>
                <div className="flex-1 bg-gray-100 rounded-full h-6 overflow-hidden">
                  <div
                    className="bg-blue-600 h-full rounded-full flex items-center justify-end pr-2"
                    style={{ width: `${(item.revenue / 15000) * 100}%` }}
                  >
                    <span className="text-xs text-white font-medium">${item.revenue.toLocaleString()}</span>
                  </div>
                </div>
              </div>
            ))}
          </div>
        </Card>

        {/* Top Services */}
        <Card>
          <h3 className="font-semibold text-gray-900 mb-4 flex items-center gap-2">
            <Dog className="w-5 h-5 text-rose-600" />
            Top Services
          </h3>
          <div className="space-y-3">
            {mockReportData.topServices.map((service, index) => (
              <div key={service.name} className="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                <div className="flex items-center gap-3">
                  <span className="w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium">
                    {index + 1}
                  </span>
                  <div>
                    <p className="font-medium text-gray-900">{service.name}</p>
                    <p className="text-xs text-gray-500">{service.count} appointments</p>
                  </div>
                </div>
                <span className="font-semibold text-gray-900">${service.revenue.toLocaleString()}</span>
              </div>
            ))}
          </div>
        </Card>
      </div>

      {/* Additional Stats */}
      <Card>
        <h3 className="font-semibold text-gray-900 mb-4">Quick Stats</h3>
        <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
          <div className="text-center p-4 bg-gray-50 rounded-lg">
            <p className="text-2xl font-bold text-gray-900">89%</p>
            <p className="text-sm text-gray-500">Retention Rate</p>
          </div>
          <div className="text-center p-4 bg-gray-50 rounded-lg">
            <p className="text-2xl font-bold text-gray-900">4.8</p>
            <p className="text-sm text-gray-500">Avg Rating</p>
          </div>
          <div className="text-center p-4 bg-gray-50 rounded-lg">
            <p className="text-2xl font-bold text-gray-900">23</p>
            <p className="text-sm text-gray-500">New Humans</p>
          </div>
          <div className="text-center p-4 bg-gray-50 rounded-lg">
            <p className="text-2xl font-bold text-gray-900">1.2h</p>
            <p className="text-sm text-gray-500">Avg Service Time</p>
          </div>
        </div>
      </Card>
    </div>
  )
}
</file>

<file path="app/(app)/settings/page.tsx">
"use client"

import { useState, useEffect } from "react"
import { createClient } from "@/utils/supabase/client"
import { Button } from "@/components/ui/Button"
import { Input } from "@/components/ui/Input"
import { Label } from "@/components/ui/Label"

export default function SettingsPage() {
  const supabase = createClient()
  const [loading, setLoading] = useState(true)
  const [saving, setSaving] = useState(false)
  
  // Form State
  const [businessName, setBusinessName] = useState("")
  const [email, setEmail] = useState("")
  const [phone, setPhone] = useState("")
  const [address, setAddress] = useState("")

  useEffect(() => {
    async function loadSettings() {
      const { data: { user } } = await supabase.auth.getUser()
      if (!user) return

      const { data } = await supabase
        .from("business_settings")
        .select("*")
        .eq("user_id", user.id)
        .single()

      if (data) {
        setBusinessName(data.business_name || "")
        setEmail(data.contact_email || "")
        setPhone(data.phone || "")
        setAddress(data.address || "")
      }
      setLoading(false)
    }
    loadSettings()
  }, [])

  async function handleSave(e: React.FormEvent) {
    e.preventDefault()
    setSaving(true)
    
    const { data: { user } } = await supabase.auth.getUser()
    if (!user) return

    const { error } = await supabase
      .from("business_settings")
      .upsert({
        user_id: user.id,
        business_name: businessName,
        contact_email: email,
        phone: phone,
        address: address,
        updated_at: new Date().toISOString()
      })

    setSaving(false)
    if (error) {
      alert("Error saving settings: " + error.message)
    } else {
      alert("Settings saved!")
    }
  }

  if (loading) return <div className="p-8">Loading settings...</div>

  return (
    <div className="max-w-2xl mx-auto p-6">
      <h1 className="text-2xl font-bold mb-6">Business Settings</h1>
      
      <form onSubmit={handleSave} className="space-y-6 bg-white p-6 rounded-xl border border-gray-200">
        <div className="space-y-2">
          <Label>Business Name</Label>
          <Input 
            value={businessName} 
            onChange={(e) => setBusinessName(e.target.value)} 
            placeholder="My Grooming Salon" 
          />
        </div>

        <div className="space-y-2">
          <Label>Contact Email</Label>
          <Input 
            value={email} 
            onChange={(e) => setEmail(e.target.value)} 
            placeholder="hello@salon.com" 
          />
        </div>

        <div className="space-y-2">
          <Label>Phone Number</Label>
          <Input 
            value={phone} 
            onChange={(e) => setPhone(e.target.value)} 
            placeholder="(555) 123-4567" 
          />
        </div>

        <div className="space-y-2">
          <Label>Address</Label>
          <Input 
            value={address} 
            onChange={(e) => setAddress(e.target.value)} 
            placeholder="123 Dog St..." 
          />
        </div>

        <Button type="submit" disabled={saving} className="w-full bg-purple-600 hover:bg-purple-700 text-white">
          {saving ? "Saving..." : "Save Changes"}
        </Button>
      </form>
    </div>
  )
}
</file>

<file path="app/(app)/DashboardClient.tsx">
'use client'

import { useState, useMemo } from 'react'
import TodayAppointments from '@/components/dashboard/TodayAppointments'
import { TodayAtAGlance } from '@/components/dashboard/TodayAtAGlance'
import { TodaysWatchlist } from '@/components/dashboard/TodaysWatchlist'
import { QuickActions } from '@/components/dashboard/QuickActions'
import type { DashboardData } from '@/lib/actions/dashboard'

interface DashboardClientProps {
  initialData: DashboardData
}

export default function DashboardClient({ initialData }: DashboardClientProps) {
  const [activeFilter, setActiveFilter] = useState<string | null>(null)

  // Transform appointments for TodayAppointments component with filtering
  const appointmentsForDisplay = useMemo(() => {
    let filteredAppointments = initialData.appointments.filter(a => a.status !== 'cancelled')

    // Apply filters based on activeFilter
    if (activeFilter === 'special-handling') {
      filteredAppointments = filteredAppointments.filter(a => {
        const prefs = a.dog?.grooming_preferences
        return prefs?.behavior_notes && (
          prefs.behavior_notes.toLowerCase().includes('anxious') ||
          prefs.behavior_notes.toLowerCase().includes('nervous') ||
          prefs.behavior_notes.toLowerCase().includes('nail') ||
          prefs.behavior_notes.toLowerCase().includes('paw') ||
          prefs.behavior_notes.toLowerCase().includes('shed')
        )
      })
    } else if (activeFilter === 'appointments-remaining') {
      filteredAppointments = filteredAppointments.filter(a => a.status !== 'completed')
    } else if (activeFilter === 'first-time-dogs') {
      filteredAppointments = filteredAppointments.filter(a => a.is_first_visit)
    }

    return filteredAppointments.map(a => ({
      id: a.id,
      scheduled_at: a.scheduled_at,
      status: a.status,
      dog: a.dog,
      customer: a.customer
    }))
  }, [initialData.appointments, activeFilter])

  // Handle missing settings or user gracefully
  if (!initialData.settings || !initialData.user) {
    return (
      <div className="space-y-6">
        <h1 className="text-2xl font-bold text-gray-900">Dashboard</h1>
        <p className="text-gray-500">Welcome back! Here's what's happening today.</p>
        {/* Main dashboard content */}
        <TodayAtAGlance
          data={initialData.glance}
          activeFilter={activeFilter}
          onFilterChange={setActiveFilter}
        />
        <TodayAppointments appointments={appointmentsForDisplay} />
      </div>
    )
  }

  return (
    <div className="space-y-6">
      <div>
        <h1 className="text-2xl font-bold text-gray-900">Dashboard</h1>
        <p className="text-gray-500">Welcome back! Here's what's happening today.</p>
        {activeFilter && (
          <div className="mt-2 text-sm text-blue-600">
            Filtering by: <span className="font-medium">{activeFilter.replace(/-/g, ' ')}</span>
            <button
              onClick={() => setActiveFilter(null)}
              className="ml-2 text-gray-500 hover:text-gray-700"
            >
              ‚úï Clear filter
            </button>
          </div>
        )}
      </div>

      {/* MAIN LAYOUT - iPad-first 2-column grid (768px+) */}
      <div className="grid grid-cols-1 md:grid-cols-12 gap-6">

        {/* LEFT COLUMN (8 cols) - Main Operations */}
        <div className="md:col-span-8 space-y-6">
          {/* 1. At a Glance (High Impact) */}
          <TodayAtAGlance
            data={initialData.glance}
            activeFilter={activeFilter}
            onFilterChange={setActiveFilter}
          />

          {/* 2. Today's Schedule */}
          <TodayAppointments appointments={appointmentsForDisplay} />
        </div>

        {/* RIGHT COLUMN (4 cols) - Alerts & Quick Actions */}
        <div className="md:col-span-4 space-y-6">
          {/* 1. Watchlist (Critical Alerts) */}
          <TodaysWatchlist items={initialData.watchlist} />

          {/* 2. Quick Actions */}
          <QuickActions />
        </div>
      </div>
    </div>
  )
}
</file>

<file path="app/globals.css">
@import "tailwindcss";

:root {
  /* GroomGroove Brand Colors */
  --brand-coral: #F43F5E;
  --brand-coral-dark: #E11D48;
  --brand-coral-light: #FFF1F2;

  /* Backgrounds */
  --background: #F9FAFB;
  --surface: #FFFFFF;

  /* Text */
  --foreground: #111827;
  --foreground-muted: #6B7280;
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-brand: var(--brand-coral);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

body {
  background: var(--background);
  color: var(--foreground);
  font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Smooth transitions for interactive elements */
button, a, input, select, textarea {
  transition: all 0.2s ease;
}

/* Focus ring styling */
*:focus-visible {
  outline: 2px solid var(--brand-coral);
  outline-offset: 2px;
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: #F3F4F6;
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: #D1D5DB;
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: #9CA3AF;
}
</file>

<file path="app/layout.tsx">
import type { Metadata } from "next";
import { Montserrat } from "next/font/google";
import { Analytics } from "@vercel/analytics/react";
import "./globals.css";

const montserrat = Montserrat({
  subsets: ["latin"],
  weight: ["400", "600", "700", "800", "900"],
  variable: "--font-montserrat",
});

export const metadata: Metadata = {
  title: "Groom Groove",
  description: "The modern app for dog groomers.",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en">
      <body className={`${montserrat.className} antialiased`}>
        {children}
        <Analytics />
      </body>
    </html>
  );
}
</file>

<file path="components/booking/NewDogForm.tsx">
'use client'

import { useState } from 'react'
import { Button } from '@/components/ui/Button'
import { Input } from '@/components/ui/Input'
import { Textarea } from '@/components/ui/Textarea'
import { Dog as DogIcon, User, Clock } from 'lucide-react'
import { createDogWithOwner, createDogWithOwnerAndBook } from '@/lib/actions/booking'

interface NewDogFormProps {
  // For booking flow
  selectedDate?: string
  selectedTime?: string
  selectedService?: string
  bookImmediately?: boolean
  onBookingComplete?: () => void
  // For standalone use
  onSuccess: (dogId: string, customerId: string, dogName: string) => void
  onCancel: () => void
}

const SERVICE_OPTIONS = [
  'Full Groom',
  'Bath and tidy',
  'Bath and dry',
  'Bath/tidy/de-shed',
  'Nail trim',
  'Puppy Groom',
]

const TIME_OPTIONS = [
  '08:00', '09:00', '10:00', '11:00', '12:00',
  '13:00', '14:00', '15:00', '16:00', '17:00',
]

export default function NewDogForm({
  selectedDate,
  selectedTime: initialTime = '09:00',
  selectedService: initialService = 'Full Groom',
  bookImmediately = false,
  onBookingComplete,
  onSuccess,
  onCancel,
}: NewDogFormProps) {
  // Dog fields
  const [dogName, setDogName] = useState('')
  const [breed, setBreed] = useState('')
  const [weight, setWeight] = useState('')
  const [notes, setNotes] = useState('')

  // Owner fields
  const [ownerName, setOwnerName] = useState('')
  const [ownerPhone, setOwnerPhone] = useState('')
  const [ownerEmail, setOwnerEmail] = useState('')

  // Booking fields (only used if bookImmediately is true)
  const [selectedService, setSelectedService] = useState(initialService)
  const [selectedTime, setSelectedTime] = useState(initialTime)

  const [isSubmitting, setIsSubmitting] = useState(false)
  const [error, setError] = useState<string | null>(null)

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault()
    setError(null)

    // Validation
    if (!dogName.trim()) {
      setError('Dog name is required')
      return
    }
    if (!ownerName.trim()) {
      setError('Owner name is required')
      return
    }

    setIsSubmitting(true)

    if (bookImmediately && selectedDate) {
      // Create dog with owner AND book appointment
      const scheduledAt = `${selectedDate}T${selectedTime}:00`

      const result = await createDogWithOwnerAndBook({
        dog: {
          name: dogName.trim(),
          breed: breed.trim() || undefined,
          weight: weight || undefined,
          notes: notes.trim() || undefined,
        },
        owner: {
          name: ownerName.trim(),
          phone: ownerPhone.trim() || undefined,
          email: ownerEmail.trim() || undefined,
        },
        appointment: {
          scheduledAt,
          services: [selectedService],
        },
      })

      if (result.success && result.dogId) {
        onBookingComplete?.()
      } else {
        setError(result.error || 'Failed to create dog and booking')
      }
    } else {
      // Just create dog with owner
      const result = await createDogWithOwner({
        dog: {
          name: dogName.trim(),
          breed: breed.trim() || undefined,
          weight: weight || undefined,
          notes: notes.trim() || undefined,
        },
        owner: {
          name: ownerName.trim(),
          phone: ownerPhone.trim() || undefined,
          email: ownerEmail.trim() || undefined,
        },
      })

      if (result.success && result.dogId && result.customerId) {
        onSuccess(result.dogId, result.customerId, dogName.trim())
      } else {
        setError(result.error || 'Failed to create dog')
      }
    }

    setIsSubmitting(false)
  }

  return (
    <form onSubmit={handleSubmit} className="space-y-6">
      {error && (
        <div className="p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm">
          {error}
        </div>
      )}

      {/* Dog Details - Top Section */}
      <div className="space-y-4">
        <h3 className="font-semibold text-gray-900 flex items-center gap-2">
          <DogIcon className="w-5 h-5 text-rose-600" />
          Dog Details
        </h3>

        <div className="space-y-3">
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">
              Dog Name <span className="text-red-500">*</span>
            </label>
            <Input
              value={dogName}
              onChange={(e) => setDogName(e.target.value)}
              placeholder="e.g. Luna"
              autoFocus
            />
          </div>

          <div className="grid grid-cols-2 gap-3">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Breed
              </label>
              <Input
                value={breed}
                onChange={(e) => setBreed(e.target.value)}
                placeholder="e.g. Golden Retriever"
              />
            </div>
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Weight (kg)
              </label>
              <Input
                type="number"
                value={weight}
                onChange={(e) => setWeight(e.target.value)}
                placeholder="e.g. 25"
              />
            </div>
          </div>

          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">
              Notes
            </label>
            <Textarea
              value={notes}
              onChange={(e) => setNotes(e.target.value)}
              placeholder="Any notes about the dog..."
              rows={2}
            />
          </div>
        </div>
      </div>

      {/* Owner Details - Bottom Section */}
      <div className="space-y-4 pt-4 border-t border-gray-100">
        <h3 className="font-semibold text-gray-900 flex items-center gap-2">
          <User className="w-5 h-5 text-gray-600" />
          Owner Details
        </h3>

        <div className="space-y-3">
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">
              Owner Name <span className="text-red-500">*</span>
            </label>
            <Input
              value={ownerName}
              onChange={(e) => setOwnerName(e.target.value)}
              placeholder="e.g. Sarah Johnson"
            />
          </div>

          <div className="grid grid-cols-2 gap-3">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Phone
              </label>
              <Input
                value={ownerPhone}
                onChange={(e) => setOwnerPhone(e.target.value)}
                placeholder="e.g. 0400 000 000"
              />
            </div>
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Email
              </label>
              <Input
                type="email"
                value={ownerEmail}
                onChange={(e) => setOwnerEmail(e.target.value)}
                placeholder="e.g. sarah@email.com"
              />
            </div>
          </div>
        </div>
      </div>

      {/* Appointment Details - Only shown if booking immediately */}
      {bookImmediately && selectedDate && (
        <div className="space-y-4 pt-4 border-t border-gray-100">
          <h3 className="font-semibold text-gray-900 flex items-center gap-2">
            <Clock className="w-5 h-5 text-green-600" />
            Appointment
          </h3>

          <div className="grid grid-cols-2 gap-3">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Time
              </label>
              <select
                value={selectedTime}
                onChange={(e) => setSelectedTime(e.target.value)}
                className="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-rose-500"
              >
                {TIME_OPTIONS.map((time) => (
                  <option key={time} value={time}>
                    {time}
                  </option>
                ))}
              </select>
            </div>
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Service
              </label>
              <select
                value={selectedService}
                onChange={(e) => setSelectedService(e.target.value)}
                className="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-rose-500"
              >
                {SERVICE_OPTIONS.map((service) => (
                  <option key={service} value={service}>
                    {service}
                  </option>
                ))}
              </select>
            </div>
          </div>
        </div>
      )}

      {/* Action buttons */}
      <div className="flex gap-3 pt-4">
        <Button type="button" variant="secondary" onClick={onCancel} className="flex-1">
          Cancel
        </Button>
        <Button
          type="submit"
          disabled={isSubmitting}
          className="flex-1 bg-rose-600 hover:bg-rose-700"
        >
          {isSubmitting
            ? 'Saving...'
            : bookImmediately
            ? 'Save & Book'
            : 'Save Dog'}
        </Button>
      </div>
    </form>
  )
}
</file>

<file path="components/booking/QuickBookModal.tsx">
'use client'

import { useState, useEffect, useCallback } from 'react'
import { Modal } from '@/components/ui/Modal'
import { Button } from '@/components/ui/Button'
import { Input } from '@/components/ui/Input'
import { Search, Dog as DogIcon, Clock, ArrowLeft, Plus } from 'lucide-react'
import { searchDogs, createBooking } from '@/lib/actions/booking'
import NewDogForm from './NewDogForm'

interface Dog {
  id: string
  name: string
  breed: string | null
  customer: {
    id: string
    name: string
    phone: string | null
  } | null
}

interface QuickBookModalProps {
  isOpen: boolean
  onClose: () => void
  selectedDate: string
  onSuccess: () => void
}

type Step = 'search' | 'new-dog' | 'select-service'

const SERVICE_OPTIONS = [
  'Full Groom',
  'Bath and tidy',
  'Bath and dry',
  'Bath/tidy/de-shed',
  'Nail trim',
  'Puppy Groom',
]

const TIME_OPTIONS = [
  '08:00', '09:00', '10:00', '11:00', '12:00',
  '13:00', '14:00', '15:00', '16:00', '17:00',
]

export default function QuickBookModal({
  isOpen,
  onClose,
  selectedDate,
  onSuccess,
}: QuickBookModalProps) {
  const [step, setStep] = useState<Step>('search')
  const [searchQuery, setSearchQuery] = useState('')
  const [searchResults, setSearchResults] = useState<Dog[]>([])
  const [isSearching, setIsSearching] = useState(false)
  const [selectedDog, setSelectedDog] = useState<Dog | null>(null)
  const [selectedService, setSelectedService] = useState('Full Groom')
  const [selectedTime, setSelectedTime] = useState('09:00')
  const [isSubmitting, setIsSubmitting] = useState(false)
  const [error, setError] = useState<string | null>(null)

  // Reset state when modal closes
  useEffect(() => {
    if (!isOpen) {
      setStep('search')
      setSearchQuery('')
      setSearchResults([])
      setSelectedDog(null)
      setSelectedService('Full Groom')
      setSelectedTime('09:00')
      setError(null)
    }
  }, [isOpen])

  // Debounced search
  useEffect(() => {
    if (searchQuery.length < 2) {
      setSearchResults([])
      return
    }

    const timer = setTimeout(async () => {
      setIsSearching(true)
      const results = await searchDogs(searchQuery)
      setSearchResults(results)
      setIsSearching(false)
    }, 300)

    return () => clearTimeout(timer)
  }, [searchQuery])

  const handleDogSelect = (dog: Dog) => {
    setSelectedDog(dog)
    setStep('select-service')
    setError(null)
  }

  const handleAddNewDog = () => {
    setStep('new-dog')
    setError(null)
  }

  const handleNewDogCreated = (dogId: string, customerId: string, dogName: string) => {
    // After creating dog, go to service selection
    setSelectedDog({
      id: dogId,
      name: dogName,
      breed: null,
      customer: { id: customerId, name: '', phone: null },
    })
    setStep('select-service')
  }

  const handleBookAppointment = async () => {
    if (!selectedDog || !selectedDog.customer) {
      setError('No dog selected')
      return
    }

    setIsSubmitting(true)
    setError(null)

    const scheduledAt = `${selectedDate}T${selectedTime}:00`

    const result = await createBooking({
      dogId: selectedDog.id,
      customerId: selectedDog.customer.id,
      scheduledAt,
      services: [selectedService],
    })

    if (result.success) {
      onSuccess()
      onClose()
    } else {
      setError(result.error || 'Failed to book appointment')
    }

    setIsSubmitting(false)
  }

  const handleBack = () => {
    if (step === 'select-service') {
      setSelectedDog(null)
      setStep('search')
    } else if (step === 'new-dog') {
      setStep('search')
    }
    setError(null)
  }

  const formatDate = (dateStr: string) => {
    const date = new Date(dateStr + 'T12:00:00')
    return date.toLocaleDateString('en-US', {
      weekday: 'long',
      month: 'long',
      day: 'numeric',
    })
  }

  return (
    <Modal isOpen={isOpen} onClose={onClose} title="Book Appointment" size="md">
      <div className="p-6">
        {/* Date display */}
        <div className="mb-6 pb-4 border-b border-gray-100">
          <p className="text-sm text-gray-500">Booking for</p>
          <p className="text-lg font-semibold text-gray-900">{formatDate(selectedDate)}</p>
        </div>

        {error && (
          <div className="mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm">
            {error}
          </div>
        )}

        {/* Step 1: Search for dog */}
        {step === 'search' && (
          <div className="space-y-4">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Search for Dog
              </label>
              <div className="relative">
                <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" />
                <Input
                  value={searchQuery}
                  onChange={(e) => setSearchQuery(e.target.value)}
                  placeholder="Type dog name..."
                  className="pl-10"
                  autoFocus
                />
              </div>
            </div>

            {/* Search results */}
            {searchQuery.length >= 2 && (
              <div className="space-y-2">
                {isSearching ? (
                  <p className="text-sm text-gray-500 py-4 text-center">Searching...</p>
                ) : searchResults.length > 0 ? (
                  <div className="max-h-64 overflow-y-auto space-y-2">
                    {searchResults.map((dog) => (
                      <button
                        key={dog.id}
                        onClick={() => handleDogSelect(dog)}
                        className="w-full p-3 text-left border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-rose-300 transition-colors"
                      >
                        <div className="flex items-center gap-3">
                          <div className="w-10 h-10 bg-rose-100 rounded-full flex items-center justify-center">
                            <DogIcon className="w-5 h-5 text-rose-600" />
                          </div>
                          <div>
                            <p className="font-medium text-gray-900">{dog.name}</p>
                            <p className="text-sm text-gray-500">
                              {dog.breed || 'Unknown breed'}
                              {dog.customer && ` ‚Ä¢ ${dog.customer.name}`}
                            </p>
                          </div>
                        </div>
                      </button>
                    ))}
                  </div>
                ) : (
                  <div className="py-6 text-center">
                    <p className="text-gray-500 mb-4">No dogs found matching "{searchQuery}"</p>
                    <Button onClick={handleAddNewDog} className="bg-rose-600 hover:bg-rose-700">
                      <Plus className="w-4 h-4 mr-2" />
                      Add New Dog
                    </Button>
                  </div>
                )}
              </div>
            )}

            {/* Add new dog prompt when no search */}
            {searchQuery.length < 2 && (
              <div className="pt-4 border-t border-gray-100">
                <p className="text-sm text-gray-500 mb-3">
                  Or add a new dog to the system
                </p>
                <Button onClick={handleAddNewDog} variant="secondary" className="w-full">
                  <Plus className="w-4 h-4 mr-2" />
                  Add New Dog
                </Button>
              </div>
            )}
          </div>
        )}

        {/* Step 2: New dog form */}
        {step === 'new-dog' && (
          <div>
            <button
              onClick={handleBack}
              className="flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900 mb-4"
            >
              <ArrowLeft className="w-4 h-4" />
              Back to search
            </button>
            <NewDogForm
              selectedDate={selectedDate}
              selectedTime={selectedTime}
              selectedService={selectedService}
              onSuccess={(dogId, customerId, dogName) => handleNewDogCreated(dogId, customerId, dogName)}
              onCancel={handleBack}
              bookImmediately={true}
              onBookingComplete={() => {
                onSuccess()
                onClose()
              }}
            />
          </div>
        )}

        {/* Step 3: Select service and time */}
        {step === 'select-service' && selectedDog && (
          <div className="space-y-6">
            <button
              onClick={handleBack}
              className="flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900"
            >
              <ArrowLeft className="w-4 h-4" />
              Back to search
            </button>

            {/* Selected dog */}
            <div className="p-4 bg-rose-50 rounded-lg border border-rose-100">
              <div className="flex items-center gap-3">
                <div className="w-12 h-12 bg-rose-100 rounded-full flex items-center justify-center">
                  <DogIcon className="w-6 h-6 text-rose-600" />
                </div>
                <div>
                  <p className="font-semibold text-gray-900">{selectedDog.name}</p>
                  <p className="text-sm text-gray-600">
                    {selectedDog.breed || 'Unknown breed'}
                    {selectedDog.customer?.name && ` ‚Ä¢ ${selectedDog.customer.name}`}
                  </p>
                </div>
              </div>
            </div>

            {/* Time selection */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                <Clock className="w-4 h-4 inline mr-1" />
                Time
              </label>
              <select
                value={selectedTime}
                onChange={(e) => setSelectedTime(e.target.value)}
                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-rose-500"
              >
                {TIME_OPTIONS.map((time) => (
                  <option key={time} value={time}>
                    {time}
                  </option>
                ))}
              </select>
            </div>

            {/* Service selection */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Service
              </label>
              <div className="grid grid-cols-2 gap-2">
                {SERVICE_OPTIONS.map((service) => (
                  <button
                    key={service}
                    onClick={() => setSelectedService(service)}
                    className={`p-3 text-sm rounded-lg border transition-colors ${
                      selectedService === service
                        ? 'bg-rose-50 border-rose-500 text-rose-700'
                        : 'border-gray-200 text-gray-700 hover:bg-gray-50'
                    }`}
                  >
                    {service}
                  </button>
                ))}
              </div>
            </div>

            {/* Confirm button */}
            <div className="flex gap-3 pt-4">
              <Button variant="secondary" onClick={onClose} className="flex-1">
                Cancel
              </Button>
              <Button
                onClick={handleBookAppointment}
                disabled={isSubmitting}
                className="flex-1 bg-rose-600 hover:bg-rose-700"
              >
                {isSubmitting ? 'Booking...' : 'Confirm Booking'}
              </Button>
            </div>
          </div>
        )}
      </div>
    </Modal>
  )
}
</file>

<file path="components/dashboard/TodayAtAGlance.tsx">
'use client'

import { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card'
import { Calendar, AlertTriangle, Sparkles, Clock } from 'lucide-react'
import type { TodayAtAGlance as TodayAtAGlanceData } from '@/lib/actions/dashboard'
import { cn } from '@/lib/utils'

interface TodayAtAGlanceProps {
  data: TodayAtAGlanceData
  activeFilter?: string | null
  onFilterChange?: (filter: string | null) => void
}

export function TodayAtAGlance({ data, activeFilter, onFilterChange }: TodayAtAGlanceProps) {
  // Build items array, filtering out zero-value entries except "Remaining"
  const items = [
    {
      label: 'Appointments Remaining',
      value: data.remainingAppointments,
      icon: Calendar,
      color: 'text-blue-600 bg-blue-50',
      show: true // Always show remaining count
    },
    {
      label: 'Special Handling',
      value: data.specialHandlingCount,
      icon: AlertTriangle,
      color: 'text-amber-600 bg-amber-50',
      show: data.specialHandlingCount > 0
    },
    {
      label: 'First-Time Dogs',
      value: data.firstTimeVisits,
      icon: Sparkles,
      color: 'text-purple-600 bg-purple-50',
      show: data.firstTimeVisits > 0
    },
    {
      label: 'Last Appointment',
      value: data.finalAppointmentTime || '‚Äî',
      icon: Clock,
      color: 'text-green-600 bg-green-50',
      show: !!data.finalAppointmentTime
    }
  ].filter(item => item.show)

  const handleCardClick = (filterType: string) => {
    if (onFilterChange) {
      // Toggle filter - if already active, clear it
      if (activeFilter === filterType) {
        onFilterChange(null)
      } else {
        onFilterChange(filterType)
      }
    }
  }

  return (
    <Card>
      <CardHeader>
        <CardTitle className="flex items-center gap-2">
          <span>üìÖ</span> Today at a Glance
        </CardTitle>
      </CardHeader>
      <CardContent>
        <div className="flex flex-col md:flex-row gap-4">
          {items.map((item) => {
            const filterType = item.label.toLowerCase().replace(/\s+/g, '-')
            const isActive = activeFilter === filterType
            
            return (
              <button
                key={item.label}
                type="button"
                onClick={() => handleCardClick(filterType)}
                className={cn(
                  "flex-1 flex items-center gap-3 p-4 rounded-xl border transition-all duration-200 text-left",
                  "bg-gray-50 border-gray-100 hover:bg-gray-100 hover:border-gray-200",
                  isActive && "ring-2 ring-blue-500 bg-blue-50 border-blue-200"
                )}
              >
                <div className={`p-3 rounded-lg ${item.color}`}>
                  <item.icon className="w-5 h-5" />
                </div>
                <div>
                  <p className="text-2xl font-bold text-gray-900 leading-none mb-1">{item.value}</p>
                  <p className="text-sm text-gray-500 font-medium">{item.label}</p>
                </div>
              </button>
            )
          })}
        </div>
      </CardContent>
    </Card>
  )
}
</file>

<file path="components/ui/Input.tsx">
import * as React from 'react'
import { cn } from '@/lib/utils'

export interface InputProps extends React.InputHTMLAttributes<HTMLInputElement> {}

const Input = React.forwardRef<HTMLInputElement, InputProps>(
  ({ className, type, ...props }, ref) => {
    return (
      <input
        type={type}
        className={cn(
          'flex h-10 w-full rounded-xl border border-gray-200 bg-white px-4 py-2 text-sm',
          'placeholder:text-gray-400',
          'focus:outline-none focus:ring-2 focus:ring-rose-500/20 focus:border-rose-300',
          'disabled:cursor-not-allowed disabled:opacity-50 disabled:bg-gray-100',
          'transition-colors',
          className
        )}
        ref={ref}
        {...props}
      />
    )
  }
)
Input.displayName = 'Input'

export { Input }
</file>

<file path="components/ui/Modal.tsx">
'use client'

import { useEffect, useRef, useCallback } from 'react'
import { X } from 'lucide-react'

interface ModalProps {
  isOpen: boolean
  onClose: () => void
  title?: string
  children: React.ReactNode
  size?: 'sm' | 'md' | 'lg' | 'xl'
}

/**
 * Accessible Modal Component
 * - Traps focus within modal when open
 * - Closes on ESC key or overlay click
 * - Prevents body scroll when open
 */
export function Modal({ isOpen, onClose, title, children, size = 'lg' }: ModalProps) {
  const modalRef = useRef<HTMLDivElement>(null)
  const previousActiveElement = useRef<HTMLElement | null>(null)

  // Size classes
  const sizeClasses = {
    sm: 'max-w-md',
    md: 'max-w-xl',
    lg: 'max-w-2xl',
    xl: 'max-w-4xl',
  }

  // Handle ESC key
  const handleKeyDown = useCallback((e: KeyboardEvent) => {
    if (e.key === 'Escape') {
      onClose()
    }
  }, [onClose])

  // Handle click outside
  const handleOverlayClick = useCallback((e: React.MouseEvent<HTMLDivElement>) => {
    if (e.target === e.currentTarget) {
      onClose()
    }
  }, [onClose])

  // Focus trap and body scroll lock
  useEffect(() => {
    if (isOpen) {
      // Store currently focused element
      previousActiveElement.current = document.activeElement as HTMLElement

      // Lock body scroll
      document.body.style.overflow = 'hidden'

      // Add ESC listener
      document.addEventListener('keydown', handleKeyDown)

      return () => {
        // Restore body scroll
        document.body.style.overflow = ''

        // Remove ESC listener
        document.removeEventListener('keydown', handleKeyDown)

        // Restore focus to previous element
        previousActiveElement.current?.focus()
      }
    }
  }, [isOpen, handleKeyDown])

  if (!isOpen) return null

  return (
    <div
      className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm"
      onClick={handleOverlayClick}
      role="dialog"
      aria-modal="true"
      aria-labelledby={title ? 'modal-title' : undefined}
    >
      <div
        ref={modalRef}
        tabIndex={-1}
        className={`
          ${sizeClasses[size]} w-full bg-white rounded-2xl shadow-xl
          max-h-[90vh] flex flex-col
          animate-in fade-in zoom-in-95 duration-200
        `}
      >
        {/* Header */}
        {title && (
          <div className="flex items-center justify-between px-6 py-4 border-b border-gray-100">
            <h2 id="modal-title" className="text-lg font-semibold text-gray-900">
              {title}
            </h2>
            <button
              onClick={onClose}
              className="p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors"
              aria-label="Close modal"
            >
              <X className="w-5 h-5" />
            </button>
          </div>
        )}

        {/* Content - scrollable */}
        <div className="flex-1 overflow-y-auto">
          {children}
        </div>

        {/* Close button if no title */}
        {!title && (
          <button
            onClick={onClose}
            className="absolute top-4 right-4 p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors"
            aria-label="Close modal"
          >
            <X className="w-5 h-5" />
          </button>
        )}
      </div>
    </div>
  )
}
</file>

<file path="components/ui/Textarea.tsx">
import * as React from 'react'
import { cn } from '@/lib/utils'

export interface TextareaProps extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {}

const Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(
  ({ className, ...props }, ref) => {
    return (
      <textarea
        className={cn(
          'flex min-h-[80px] w-full rounded-xl border border-gray-200 bg-white px-4 py-3 text-sm',
          'placeholder:text-gray-400',
          'focus:outline-none focus:ring-2 focus:ring-rose-500/20 focus:border-rose-300',
          'disabled:cursor-not-allowed disabled:opacity-50 disabled:bg-gray-100',
          'resize-none transition-colors',
          className
        )}
        ref={ref}
        {...props}
      />
    )
  }
)
Textarea.displayName = 'Textarea'

export { Textarea }
</file>

<file path="lib/actions/appointments.ts">
'use server'

// Staff Appointment Actions
// Handles reschedule, cancel, and other staff-initiated changes

import { createClient } from '@/utils/supabase/server'
import { sendRescheduleSMS, sendCancelledSMS } from '@/lib/sms/send'

interface CreateAppointmentInput {
  customerId: string
  dogId: string
  scheduledAt: string // ISO datetime
  services: string[]
  notes?: string
}

/**
 * Create a new appointment
 */
export async function createAppointment(input: CreateAppointmentInput) {
  const supabase = await createClient()

  const { data: appointment, error } = await supabase
    .from('appointments')
    .insert({
      customer_id: input.customerId,
      dog_id: input.dogId,
      scheduled_at: input.scheduledAt,
      services: input.services,
      notes: input.notes,
      status: 'pending_confirmation',
      created_at: new Date().toISOString(),
      updated_at: new Date().toISOString(),
    })
    .select()
    .single()

  if (error) {
    console.error('[Appointments] Create failed:', error)
    // Provide more specific error message based on error code
    if (error.code === '42P01') {
      return { success: false, error: 'Database table not found. Please run migrations.' }
    }
    if (error.code === '42501' || error.message?.includes('RLS')) {
      return { success: false, error: 'Permission denied. Check Row Level Security policies.' }
    }
    if (error.code === '23503') {
      return { success: false, error: 'Invalid customer or dog ID.' }
    }
    return { success: false, error: `Database error: ${error.message}` }
  }

  console.log("APPOINTMENT CREATED:", appointment);

  return { success: true, appointment }
}

interface UpdateAppointmentInput {
  appointmentId: string
  scheduledAt?: string // ISO datetime (for reschedule)
  services?: string[]
  notes?: string
}

interface UpdateResult {
  success: boolean
  rescheduled?: boolean
  error?: string
}

/**
 * Update appointment (staff action)
 * If time changes on a confirmed appointment:
 * - Reset status to pending_confirmation
 * - Send new confirmation SMS
 */
export async function updateAppointment(input: UpdateAppointmentInput): Promise<UpdateResult> {
  const supabase = await createClient()

  // Fetch current appointment
  const { data: current, error: fetchError } = await supabase
    .from('appointments')
    .select('status, scheduled_at, customer_id')
    .eq('id', input.appointmentId)
    .single()

  if (fetchError || !current) {
    return { success: false, error: 'Appointment not found' }
  }

  const now = new Date()
  const timeChanged = input.scheduledAt && input.scheduledAt !== current.scheduled_at

  // Build update payload
  const updates: Record<string, any> = {
    updated_at: now.toISOString(),
  }

  if (input.scheduledAt) updates.scheduled_at = input.scheduledAt
  if (input.services) updates.services = input.services
  if (input.notes !== undefined) updates.notes = input.notes

  // RULE: If staff reschedules a confirmed appointment, reset to pending
  if (current.status === 'confirmed' && timeChanged) {
    updates.status = 'pending_confirmation'
    updates.confirmed_at = null
  }

  // Update appointment
  const { error: updateError } = await supabase
    .from('appointments')
    .update(updates)
    .eq('id', input.appointmentId)

  if (updateError) {
    console.error('[Appointments] Update failed:', updateError)
    return { success: false, error: 'Failed to update appointment' }
  }

  // Send reschedule SMS if time changed on confirmed appointment
  if (current.status === 'confirmed' && timeChanged) {
    await sendRescheduleSMS(input.appointmentId)
    return { success: true, rescheduled: true }
  }

  return { success: true, rescheduled: false }
}

/**
 * Cancel appointment (staff action)
 * - Updates status to cancelled
 * - Sends cancellation SMS to customer
 */
export async function cancelAppointment(
  appointmentId: string,
  reason?: string
): Promise<{ success: boolean; error?: string }> {
  const supabase = await createClient()

  // Fetch appointment with customer info
  const { data: appointment, error: fetchError } = await supabase
    .from('appointments')
    .select(`
      id,
      scheduled_at,
      status,
      customer:customers(phone, sms_consent)
    `)
    .eq('id', appointmentId)
    .single()

  if (fetchError || !appointment) {
    return { success: false, error: 'Appointment not found' }
  }

  // Already cancelled - no action needed
  if (appointment.status === 'cancelled') {
    return { success: true }
  }

  const now = new Date()

  // Update status
  const { error: updateError } = await supabase
    .from('appointments')
    .update({
      status: 'cancelled',
      cancelled_at: now.toISOString(),
      updated_at: now.toISOString(),
      notes: reason ? `Cancelled: ${reason}` : undefined,
    })
    .eq('id', appointmentId)

  if (updateError) {
    console.error('[Appointments] Cancel failed:', updateError)
    return { success: false, error: 'Failed to cancel appointment' }
  }

  // Send cancellation SMS if customer has consent
  const customer = Array.isArray(appointment.customer)
    ? appointment.customer[0]
    : appointment.customer

  if (customer?.sms_consent && customer?.phone) {
    await sendCancelledSMS(customer.phone, appointment.scheduled_at)
  }

  return { success: true }
}

/**
 * Get appointments by status
 * Useful for dashboard widgets (e.g., pending confirmations count)
 */
export async function getAppointmentsByStatus(
  status: 'pending_confirmation' | 'confirmed' | 'cancelled'
) {
  const supabase = await createClient()

  const { data, error } = await supabase
    .from('appointments')
    .select(`
      *,
      customer:customers(name, phone),
      dog:dogs(name)
    `)
    .eq('status', status)
    .order('scheduled_at', { ascending: true })

  if (error) {
    console.error('[Appointments] Fetch failed:', error)
    return []
  }

  return data || []
}

/**
 * Get pending confirmations count
 * For dashboard stat card
 */
export async function getPendingConfirmationsCount(): Promise<number> {
  const supabase = await createClient()

  const { count, error } = await supabase
    .from('appointments')
    .select('*', { count: 'exact', head: true })
    .eq('status', 'pending_confirmation')
    .gte('scheduled_at', new Date().toISOString()) // Only future appointments

  if (error) {
    console.error('[Appointments] Count failed:', error)
    return 0
  }

  return count || 0
}

/**
 * Get upcoming confirmed appointments
 * For calendar/schedule views
 */
export async function getUpcomingAppointments(days: number = 7) {
  const supabase = await createClient()

  const now = new Date()
  const futureDate = new Date(now.getTime() + days * 24 * 60 * 60 * 1000)

  const { data, error } = await supabase
    .from('appointments')
    .select(`
      *,
      customer:customers(name, phone, email),
      dog:dogs(name, breed)
    `)
    .eq('status', 'confirmed')
    .gte('scheduled_at', now.toISOString())
    .lte('scheduled_at', futureDate.toISOString())
    .order('scheduled_at', { ascending: true })

  if (error) {
    console.error('[Appointments] Fetch failed:', error)
    return []
  }

  return data || []
}

/**
 * Get appointment data for checkout page
 */
export async function getAppointmentForCheckout(appointmentId: string) {
  const supabase = await createClient()

  const { data, error } = await supabase
    .from('appointments')
    .select(`
      id,
      scheduled_at,
      services,
      notes,
      status,
      customer:customers(id, name, email, phone),
      dog:dogs(id, name, breed)
    `)
    .eq('id', appointmentId)
    .single()

  if (error || !data) {
    console.error('[Appointments] Fetch for checkout failed:', error)
    return null
  }

  return {
    ...data,
    customer: Array.isArray(data.customer) ? data.customer[0] : data.customer,
    dog: Array.isArray(data.dog) ? data.dog[0] : data.dog
  }
}

/**
 * Mark appointment as in progress
 */
export async function markAppointmentInProgress(
  appointmentId: string
): Promise<{ success: boolean; error?: string }> {
  const supabase = await createClient()

  const { error } = await supabase
    .from('appointments')
    .update({
      status: 'in_progress',
      updated_at: new Date().toISOString()
    })
    .eq('id', appointmentId)

  if (error) {
    console.error('[Appointments] Mark in-progress failed:', error)
    return { success: false, error: error.message }
  }

  return { success: true }
}

/**
 * Mark appointment as completed
 */
export async function markAppointmentCompleted(
  appointmentId: string
): Promise<{ success: boolean; error?: string }> {
  const supabase = await createClient()

  const { error } = await supabase
    .from('appointments')
    .update({
      status: 'completed',
      updated_at: new Date().toISOString()
    })
    .eq('id', appointmentId)

  if (error) {
    console.error('[Appointments] Mark completed failed:', error)
    return { success: false, error: error.message }
  }

  return { success: true }
}

/**
 * Confirm appointment (update status from pending_confirmation to confirmed)
 */
export async function confirmAppointment(
  appointmentId: string
): Promise<{ success: boolean; error?: string }> {
  const supabase = await createClient()

  const { error } = await supabase
    .from('appointments')
    .update({
      status: 'confirmed',
      confirmed_at: new Date().toISOString(),
      updated_at: new Date().toISOString()
    })
    .eq('id', appointmentId)
    .eq('status', 'pending_confirmation') // Only allow confirming pending appointments

  if (error) {
    console.error('[Appointments] Confirm failed:', error)
    return { success: false, error: error.message }
  }

  return { success: true }
}
</file>

<file path="lib/actions/booking.ts">
'use server'

import { createClient } from '@/utils/supabase/server'
import { revalidatePath } from 'next/cache'

export interface DogWithOwnerInput {
  dog: {
    name: string
    breed?: string
    weight?: string
    notes?: string
  }
  owner: {
    name: string
    phone?: string
    email?: string
  }
}

export interface BookingInput {
  dogId: string
  customerId: string
  scheduledAt: string
  services: string[]
  notes?: string
}

/**
 * Search for dogs by name (partial match)
 */
export async function searchDogs(query: string) {
  if (!query || query.length < 2) {
    return []
  }

  const supabase = await createClient()

  const { data: dogs, error } = await supabase
    .from('dogs')
    .select(`
      id,
      name,
      breed,
      customer:customers(id, name, phone)
    `)
    .ilike('name', `%${query}%`)
    .order('name', { ascending: true })
    .limit(10)

  if (error) {
    console.error('[Booking] Search dogs failed:', error)
    return []
  }

  return (dogs || []).map(dog => ({
    ...dog,
    customer: Array.isArray(dog.customer) ? dog.customer[0] : dog.customer
  }))
}

/**
 * Create a new dog with owner information
 * Dog-first approach: creates owner first, then dog
 */
export async function createDogWithOwner(
  input: DogWithOwnerInput
): Promise<{ success: boolean; error?: string; dogId?: string; customerId?: string }> {
  const supabase = await createClient()

  const {
    data: { user },
  } = await supabase.auth.getUser()

  if (!user) {
    return { success: false, error: 'Unauthorized' }
  }

  // Create the customer (owner) first
  const { data: customer, error: customerError } = await supabase
    .from('customers')
    .insert({
      name: input.owner.name.trim(),
      phone: input.owner.phone?.trim() || null,
      email: input.owner.email?.trim() || null,
      user_id: user.id,
    })
    .select('id')
    .single()

  if (customerError) {
    console.error('[Booking] Create customer failed:', customerError)
    return { success: false, error: customerError.message }
  }

  // Create the dog linked to the customer
  const { data: dog, error: dogError } = await supabase
    .from('dogs')
    .insert({
      name: input.dog.name.trim(),
      breed: input.dog.breed?.trim() || null,
      weight: input.dog.weight ? Number(input.dog.weight) : null,
      notes: input.dog.notes?.trim() || null,
      customer_id: customer.id,
      user_id: user.id,
    })
    .select('id')
    .single()

  if (dogError) {
    console.error('[Booking] Create dog failed:', dogError)
    return { success: false, error: dogError.message }
  }

  revalidatePath('/dogs')
  revalidatePath('/calendar')

  return { success: true, dogId: dog.id, customerId: customer.id }
}

/**
 * Create a new appointment (booking)
 */
export async function createBooking(
  input: BookingInput
): Promise<{ success: boolean; error?: string; appointmentId?: string }> {
  const supabase = await createClient()

  const {
    data: { user },
  } = await supabase.auth.getUser()

  if (!user) {
    return { success: false, error: 'Unauthorized' }
  }

  const { data: appointment, error } = await supabase
    .from('appointments')
    .insert({
      customer_id: input.customerId,
      dog_id: input.dogId,
      scheduled_at: input.scheduledAt,
      services: input.services,
      notes: input.notes || null,
      status: 'confirmed',
      user_id: user.id,
      created_at: new Date().toISOString(),
      updated_at: new Date().toISOString(),
    })
    .select('id')
    .single()

  if (error) {
    console.error('[Booking] Create appointment failed:', error)
    return { success: false, error: error.message }
  }

  revalidatePath('/calendar')

  return { success: true, appointmentId: appointment.id }
}

/**
 * Create dog with owner AND immediately book an appointment
 * All-in-one action for the "Add New Dog" flow when booking
 */
export async function createDogWithOwnerAndBook(
  input: DogWithOwnerInput & {
    appointment: {
      scheduledAt: string
      services: string[]
      notes?: string
    }
  }
): Promise<{ success: boolean; error?: string; dogId?: string; appointmentId?: string }> {
  // First create the dog with owner
  const dogResult = await createDogWithOwner({
    dog: input.dog,
    owner: input.owner,
  })

  if (!dogResult.success || !dogResult.dogId || !dogResult.customerId) {
    return { success: false, error: dogResult.error || 'Failed to create dog' }
  }

  // Then create the booking
  const bookingResult = await createBooking({
    dogId: dogResult.dogId,
    customerId: dogResult.customerId,
    scheduledAt: input.appointment.scheduledAt,
    services: input.appointment.services,
    notes: input.appointment.notes,
  })

  if (!bookingResult.success) {
    return { success: false, error: bookingResult.error || 'Failed to create appointment' }
  }

  return {
    success: true,
    dogId: dogResult.dogId,
    appointmentId: bookingResult.appointmentId,
  }
}
</file>

<file path="lib/actions/customers.ts">
'use server'

import { createClient } from '@/utils/supabase/server'
import { revalidatePath } from 'next/cache'

export interface CustomerInput {
  name: string
  email?: string
  phone?: string
}

/**
 * Create a new customer
 */
export async function createCustomer(
  customerData: CustomerInput
): Promise<{ success: boolean; error?: string; customerId?: string }> {
  const supabase = await createClient()

  const {
    data: { user },
  } = await supabase.auth.getUser()

  if (!user) {
    return { success: false, error: 'Unauthorized' }
  }

  const { data: customer, error } = await supabase
    .from('customers')
    .insert({
      name: customerData.name.trim(),
      email: customerData.email?.trim() || null,
      phone: customerData.phone?.trim() || null,
      user_id: user.id,
    })
    .select('id')
    .single()

  if (error) {
    console.error('[Customers] Create customer failed:', error)
    return { success: false, error: error.message }
  }

  // Revalidate paths that use customers
  revalidatePath('/dogs')
  revalidatePath('/clients')

  return { success: true, customerId: customer.id }
}

/**
 * Get all customers for dropdown
 */
export async function getAllCustomers() {
  const supabase = await createClient()

  const { data: customers, error } = await supabase
    .from('customers')
    .select('id, name, email, phone')
    .order('name', { ascending: true })

  if (error) {
    console.error('[Customers] Fetch all failed:', error)
    return []
  }

  return customers || []
}
</file>

<file path="lib/actions/notifications.ts">
'use server'

import { createClient } from '@/utils/supabase/server'
import { sendReminderSMS } from '@/lib/sms/send'
import { revalidatePath } from 'next/cache'
import { safeParseDate } from '@/lib/utils/date'

export interface TodayAppointment {
  id: string
  scheduledAt: string
  clientName: string
  clientPhone: string | null
  dogName: string
  services: string[]
  status: string
  reminderSent: boolean
  hasConsent: boolean
  isPast: boolean
}

/**
 * Get today's appointments with reminder status
 */
export async function getTodaysAppointments(): Promise<TodayAppointment[]> {
  const supabase = await createClient()

  // Get today's date range
  const now = new Date()
  const todayStart = new Date(now)
  todayStart.setHours(0, 0, 0, 0)

  const todayEnd = new Date(now)
  todayEnd.setHours(23, 59, 59, 999)

  // Fetch today's appointments
  const { data: appointments, error } = await supabase
    .from('appointments')
    .select(`
      id,
      scheduled_at,
      status,
      services,
      customer:customers(id, name, phone, sms_consent),
      dog:dogs(id, name)
    `)
    .gte('scheduled_at', todayStart.toISOString())
    .lte('scheduled_at', todayEnd.toISOString())
    .neq('status', 'cancelled')
    .order('scheduled_at', { ascending: true })

  if (error) {
    console.error('[Notifications] Failed to fetch today\'s appointments:', error)
    return []
  }

  if (!appointments || appointments.length === 0) {
    return []
  }

  // Get which appointments already have reminders sent
  const appointmentIds = appointments.map(a => a.id)
  const { data: sentReminders } = await supabase
    .from('sms_notifications')
    .select('appointment_id')
    .in('appointment_id', appointmentIds)
    .eq('type', 'reminder')

  const sentSet = new Set(sentReminders?.map(r => r.appointment_id) || [])

  // Transform to our interface
  return appointments.map(appt => {
    const customer = Array.isArray(appt.customer) ? appt.customer[0] : appt.customer
    const dog = Array.isArray(appt.dog) ? appt.dog[0] : appt.dog
    const appointmentTime = safeParseDate(appt.scheduled_at)

    return {
      id: appt.id,
      scheduledAt: appt.scheduled_at,
      clientName: customer?.name || 'Unknown Client',
      clientPhone: customer?.phone || null,
      dogName: dog?.name || 'Unknown Dog',
      services: appt.services || [],
      status: appt.status,
      reminderSent: sentSet.has(appt.id),
      hasConsent: customer?.sms_consent || false,
      isPast: appointmentTime ? appointmentTime < now : false,
    }
  })
}

/**
 * Manually send a reminder for a specific appointment
 */
export async function sendManualReminder(appointmentId: string): Promise<{
  success: boolean
  error?: string
}> {
  const result = await sendReminderSMS(appointmentId)

  if (result.sent) {
    revalidatePath('/notifications')
    return { success: true }
  }

  return { success: false, error: 'Failed to send reminder' }
}

/**
 * Get stats for today's reminders
 */
export async function getTodayStats(): Promise<{
  totalAppointments: number
  remindersSent: number
  upcoming: number
  completed: number
}> {
  const appointments = await getTodaysAppointments()

  const now = new Date()
  const remindersSent = appointments.filter(a => a.reminderSent).length
  const upcoming = appointments.filter(a => {
    const aptTime = safeParseDate(a.scheduledAt)
    return aptTime && aptTime > now && a.status !== 'completed'
  }).length
  const completed = appointments.filter(a => a.status === 'completed').length

  return {
    totalAppointments: appointments.length,
    remindersSent,
    upcoming,
    completed,
  }
}

/**
 * Get recent SMS activity
 */
export async function getRecentActivity(limit = 5): Promise<{
  id: string
  type: string
  clientName: string
  dogName: string
  createdAt: string
  delivered: boolean
}[]> {
  const supabase = await createClient()

  const { data: notifications, error } = await supabase
    .from('sms_notifications')
    .select('id, type, appointment_id, delivered, created_at')
    .order('created_at', { ascending: false })
    .limit(limit)

  if (error || !notifications || notifications.length === 0) {
    return []
  }

  // Get appointment details
  const appointmentIds = notifications.map(n => n.appointment_id)
  const { data: appointments } = await supabase
    .from('appointments')
    .select(`id, customer:customers(name), dog:dogs(name)`)
    .in('id', appointmentIds)

  const apptMap = new Map<string, { clientName: string; dogName: string }>()
  if (appointments) {
    for (const appt of appointments) {
      const customer = Array.isArray(appt.customer) ? appt.customer[0] : appt.customer
      const dog = Array.isArray(appt.dog) ? appt.dog[0] : appt.dog
      apptMap.set(appt.id, {
        clientName: (customer as { name?: string })?.name || 'Unknown',
        dogName: (dog as { name?: string })?.name || 'Unknown',
      })
    }
  }

  return notifications.map(n => {
    const info = apptMap.get(n.appointment_id) || { clientName: 'Unknown', dogName: 'Unknown' }
    return {
      id: n.id,
      type: n.type,
      clientName: info.clientName,
      dogName: info.dogName,
      createdAt: n.created_at,
      delivered: n.delivered ?? true,
    }
  })
}
</file>

<file path="lib/sms/send.ts">
// SMS Sending Functions
// Handles confirmation requests and reminders

import { createClient } from '@/utils/supabase/server'
import { smsProvider } from './provider'
import { format } from 'date-fns'

interface SendConfirmationParams {
  appointmentId: string
  customerId: string
}

/**
 * Send confirmation request SMS after checkout
 * Only sends if customer has SMS consent and phone number
 */
export async function sendConfirmationSMS({
  appointmentId,
  customerId
}: SendConfirmationParams): Promise<{ sent: boolean; reason?: string }> {
  const supabase = await createClient()

  // Get the current user
  const { data: { user } } = await supabase.auth.getUser()

  if (!user) {
    console.error('[SMS] User not authenticated')
    return { sent: false, reason: 'not_authenticated' }
  }

  // Fetch appointment with customer and dog data
  const { data: appointment, error } = await supabase
    .from('appointments')
    .select(`
      *,
      customer:customers(*),
      dog:dogs(*)
    `)
    .eq('id', appointmentId)
    .single()

  if (error || !appointment) {
    console.error('[SMS] Failed to fetch appointment:', error)
    return { sent: false, reason: 'appointment_not_found' }
  }

  // Check SMS consent
  if (!appointment.customer.sms_consent) {
    console.log('[SMS] Customer has not consented to SMS')
    return { sent: false, reason: 'no_consent' }
  }

  // Check phone number
  if (!appointment.customer.phone) {
    console.log('[SMS] Customer has no phone number')
    return { sent: false, reason: 'no_phone' }
  }

  // Format appointment date/time
  const dateStr = format(new Date(appointment.scheduled_at), 'EEE, MMM d')
  const timeStr = format(new Date(appointment.scheduled_at), 'h:mm a')
  const customerFirstName = appointment.customer.name.split(' ')[0]

  // Compose message
  const message = `GroomGroove: Hi ${customerFirstName}! Your next appointment for ${appointment.dog.name} is proposed for:

üìÖ ${dateStr} at ${timeStr}
‚úÇÔ∏è ${appointment.services.join(', ')}

Reply YES to confirm or NO to cancel.

Questions? Call (555) 123-4567`

  // Send SMS
  const result = await smsProvider.send({
    to: appointment.customer.phone,
    body: message,
  })

  // Log notification in database
  await supabase.from('sms_notifications').insert({
    appointment_id: appointmentId,
    type: 'confirmation_request',
    delivered: result.success,
    user_id: user.id,
  })

  return { sent: result.success }
}

/**
 * Send reminder SMS 24 hours before confirmed appointment
 */
export async function sendReminderSMS(appointmentId: string): Promise<{ sent: boolean }> {
  const supabase = await createClient()

  // Get the current user
  const { data: { user } } = await supabase.auth.getUser()

  if (!user) {
    console.error('[SMS] User not authenticated')
    return { sent: false }
  }

  const { data: appointment, error } = await supabase
    .from('appointments')
    .select(`
      *,
      customer:customers(*),
      dog:dogs(*)
    `)
    .eq('id', appointmentId)
    .single()

  if (error || !appointment) {
    return { sent: false }
  }

  if (!appointment.customer.sms_consent || !appointment.customer.phone) {
    return { sent: false }
  }

  const dateStr = format(new Date(appointment.scheduled_at), 'EEEE, MMMM d')
  const timeStr = format(new Date(appointment.scheduled_at), 'h:mm a')

  const message = `GroomGroove: Reminder! ${appointment.dog.name}'s appointment is tomorrow:

üìÖ ${dateStr}
‚è∞ ${timeStr}
‚úÇÔ∏è ${appointment.services.join(', ')}

See you soon! Questions? Call (555) 123-4567`

  const result = await smsProvider.send({
    to: appointment.customer.phone,
    body: message,
  })

  // Log reminder notification
  await supabase.from('sms_notifications').insert({
    appointment_id: appointmentId,
    type: 'reminder',
    delivered: result.success,
    user_id: user.id,
  })

  return { sent: result.success }
}

/**
 * Send confirmation success SMS
 */
export async function sendConfirmedSMS(
  phone: string,
  dogName: string,
  scheduledAt: string
): Promise<void> {
  const dateStr = format(new Date(scheduledAt), 'EEE, MMM d')
  const timeStr = format(new Date(scheduledAt), 'h:mm a')

  await smsProvider.send({
    to: phone,
    body: `GroomGroove: ‚úÖ Confirmed! ${dogName}'s appointment is set for ${dateStr} at ${timeStr}.

We'll send a reminder 24 hours before. See you soon!`,
  })
}

/**
 * Send cancellation SMS
 */
export async function sendCancelledSMS(
  phone: string,
  scheduledAt: string
): Promise<void> {
  const dateStr = format(new Date(scheduledAt), 'EEE, MMM d')

  await smsProvider.send({
    to: phone,
    body: `GroomGroove: Your appointment for ${dateStr} has been cancelled.

To reschedule, call us at (555) 123-4567 or book online.`,
  })
}

/**
 * Send reschedule notification (when staff changes time)
 */
export async function sendRescheduleSMS(appointmentId: string): Promise<void> {
  const supabase = await createClient()

  // Get the current user
  const { data: { user } } = await supabase.auth.getUser()

  if (!user) {
    console.error('[SMS] User not authenticated')
    return
  }

  const { data: appointment } = await supabase
    .from('appointments')
    .select(`*, customer:customers(*), dog:dogs(*)`)
    .eq('id', appointmentId)
    .single()

  if (!appointment?.customer.phone || !appointment.customer.sms_consent) {
    return
  }

  const dateStr = format(new Date(appointment.scheduled_at), 'EEE, MMM d')
  const timeStr = format(new Date(appointment.scheduled_at), 'h:mm a')

  await smsProvider.send({
    to: appointment.customer.phone,
    body: `GroomGroove: Your appointment for ${appointment.dog.name} has been rescheduled to:

üìÖ ${dateStr} at ${timeStr}

Reply YES to confirm or NO to cancel.`,
  })

  // Log as new confirmation request
  await supabase.from('sms_notifications').insert({
    appointment_id: appointmentId,
    type: 'confirmation_request',
    user_id: user.id,
  })
}
</file>

<file path="utils/supabase/server.ts">
import { createServerClient } from '@supabase/ssr'
import { cookies } from 'next/headers'

export async function createClient() {
  const cookieStore = await cookies()

  return createServerClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
    {
      cookies: {
        getAll() {
          return cookieStore.getAll()
        },
        setAll(cookiesToSet: { name: string; value: string; options?: Record<string, unknown> }[]) {
          try {
            cookiesToSet.forEach(({ name, value, options }) =>
              cookieStore.set(name, value, options)
            )
          } catch {
            // Server component - ignore
          }
        },
      },
    }
  )
}
</file>

<file path="eslint.config.mjs">
import { dirname } from "path";
import { fileURLToPath } from "url";
import { FlatCompat } from "@eslint/eslintrc";

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

const compat = new FlatCompat({
  baseDirectory: __dirname,
});

const eslintConfig = [
  ...compat.extends("next/core-web-vitals"),
  {
    ignores: [".next/**", "out/**", "build/**", "next-env.d.ts"],
  },
];

export default eslintConfig;
</file>

<file path="next.config.ts">
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  images: {
    remotePatterns: [
      {
        protocol: 'https',
        hostname: 'ptljswaeqqiytrciwbdi.supabase.co',
        port: '',
        pathname: '/storage/v1/object/public/dog-photos/**',
      },
    ],
  },
  experimental: {
    serverActions: {
      bodySizeLimit: '5mb',
    },
  },
};

export default nextConfig;
</file>

<file path="vercel.json">
{
  "crons": [
    {
      "path": "/api/cron/reminders",
      "schedule": "0 12 * * *"
    }
  ]
}
</file>

<file path="app/(app)/clients/new/page.tsx">
'use client'

import NewClientForm from '@/components/clients/NewClientForm'
import Link from 'next/link'
import { Button } from '@/components/ui/Button'
import { ArrowLeft } from 'lucide-react'

export default function CreateClientPage() {
  return (
    <div className="space-y-6">
      <div className="flex items-center gap-4">
        <Link href="/clients">
          <Button variant="ghost" size="sm">
            <ArrowLeft className="w-4 h-4 mr-2" />
            Back to Clients
          </Button>
        </Link>
      </div>
      <NewClientForm />
    </div>
  )
}
</file>

<file path="app/(app)/clients/ClientsTable.tsx">
'use client'

import { useState } from 'react'
import Link from 'next/link'
import { useRouter } from 'next/navigation'
import { Card } from '@/components/ui/Card'
import { Button } from '@/components/ui/Button'
import { Badge } from '@/components/ui/Badge'
import { Modal } from '@/components/ui/Modal'
import { Mail, Phone, Calendar, Dog, MessageSquare, History, X, Trash2 } from 'lucide-react'
import { deleteClient } from '@/lib/actions/clients'

interface ClientDog {
  id: string
  name: string
  breed: string | null
  notes: string | null
}

interface Client {
  id: string
  surname: string
  firstName: string
  email: string
  phone: string
  dogs: ClientDog[]
  lastVisit: string | null
  concerns: string | null
  status: 'active' | 'vip' | 'inactive'
}

interface ClientsTableProps {
  clients: Client[]
}

function StatusBadge({ status }: { status: 'active' | 'vip' | 'inactive' }) {
  const styles = {
    active: 'bg-green-100 text-green-700',
    vip: 'bg-purple-100 text-purple-700',
    inactive: 'bg-gray-100 text-gray-600',
  }
  const labels = {
    active: 'Active',
    vip: 'VIP',
    inactive: 'Inactive',
  }
  return (
    <span className={`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${styles[status]}`}>
      {labels[status]}
    </span>
  )
}

function ClientDetailPanel({ client, onClose }: { client: Client; onClose: () => void }) {
  const router = useRouter()
  const [showDeleteModal, setShowDeleteModal] = useState(false)
  const [deleting, setDeleting] = useState(false)

  const handleDeleteClient = async () => {
    setDeleting(true)
    const result = await deleteClient(client.id)
    
    if (result.success) {
      router.refresh()
      onClose()
    } else {
      alert(result.error || 'Failed to delete client')
      setDeleting(false)
    }
  }

  return (
    <>
    <div className="fixed inset-y-0 right-0 w-96 bg-white shadow-xl border-l border-gray-200 z-50 overflow-y-auto">
      <div className="p-6">
        <div className="flex items-center justify-between mb-6">
          <h2 className="text-lg font-semibold text-gray-900">Human Overview</h2>
          <button onClick={onClose} className="p-1 hover:bg-gray-100 rounded">
            <X className="w-5 h-5 text-gray-500" />
          </button>
        </div>

        <div className="space-y-6">
          {/* Client Info */}
          <div>
            <h3 className="text-xl font-semibold text-gray-900">
              {client.surname}, {client.firstName}
            </h3>
            <div className="mt-2 space-y-1 text-sm text-gray-600">
              {client.phone && (
                <p className="flex items-center gap-2">
                  <Phone className="w-4 h-4" />
                  {client.phone}
                </p>
              )}
              {client.email && (
                <p className="flex items-center gap-2">
                  <Mail className="w-4 h-4" />
                  {client.email}
                </p>
              )}
            </div>
          </div>

          {/* Dogs */}
          <div>
            <h4 className="font-medium text-gray-900 mb-3 flex items-center gap-2">
              <Dog className="w-4 h-4" />
              Dogs ({client.dogs.length})
            </h4>
            <div className="space-y-2">
              {client.dogs.map((dog) => (
                <Link
                  key={dog.id}
                  href={`/dogs/${dog.id}`}
                  className="flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors"
                >
                  <div>
                    <p className="font-medium text-gray-900">{dog.name}</p>
                    <p className="text-sm text-gray-500">{dog.breed || 'Unknown breed'}</p>
                    {dog.notes && (
                      <p className="text-xs text-amber-600 mt-1">{dog.notes}</p>
                    )}
                  </div>
                  <Badge variant="default">View</Badge>
                </Link>
              ))}
            </div>
          </div>

          {/* Actions */}
          <div className="pt-4 border-t border-gray-200">
            <h4 className="font-medium text-gray-900 mb-3">Quick Actions</h4>
            <div className="grid grid-cols-2 gap-3">
              {client.phone && (
                <a href={`sms:${client.phone}`}>
                  <Button variant="secondary" className="justify-start w-full">
                    <MessageSquare className="w-4 h-4 mr-2" />
                    Send Message
                  </Button>
                </a>
              )}
              {!client.phone && (
                <Button variant="secondary" className="justify-start" disabled>
                  <MessageSquare className="w-4 h-4 mr-2" />
                  Send Message
                </Button>
              )}
              <Link href="/calendar/new" onClick={onClose}>
                <Button variant="secondary" className="justify-start w-full">
                  <Calendar className="w-4 h-4 mr-2" />
                  Book Appointment
                </Button>
              </Link>
              <Link href="/history" onClick={onClose}>
                <Button variant="secondary" className="justify-start w-full">
                  <History className="w-4 h-4 mr-2" />
                  View History
                </Button>
              </Link>
              {client.dogs.length > 0 && (
                <Link href={`/dogs/${client.dogs[0].id}`} onClick={onClose}>
                  <Button variant="secondary" className="justify-start w-full">
                    <Dog className="w-4 h-4 mr-2" />
                    View Dog
                  </Button>
                </Link>
              )}
              {client.dogs.length === 0 && (
                <Button variant="secondary" className="justify-start" disabled>
                  <Dog className="w-4 h-4 mr-2" />
                  No Dogs
                </Button>
              )}
            </div>
          </div>

          {/* Delete Section */}
          <div className="pt-4 border-t border-gray-200">
            <Button 
              variant="ghost" 
              className="w-full justify-start text-red-600 hover:text-red-700 hover:bg-red-50"
              onClick={() => setShowDeleteModal(true)}
            >
              <Trash2 className="w-4 h-4 mr-2" />
              Delete Human
            </Button>
          </div>
        </div>
      </div>

      {/* Delete Confirmation Modal */}
      <Modal
        isOpen={showDeleteModal}
        onClose={() => setShowDeleteModal(false)}
        title="Delete Human?"
        size="sm"
      >
        <div className="p-6">
          <p className="text-gray-700 mb-4">
            Are you sure you want to delete <span className="font-semibold">{client.firstName} {client.surname}</span>? 
            This will also delete:
          </p>
          <ul className="list-disc list-inside text-sm text-gray-600 mb-4 space-y-1">
            <li>All {client.dogs.length} dog(s)</li>
            <li>All grooming history and appointments</li>
            <li>All associated records</li>
          </ul>
          <p className="text-sm text-red-600 mb-6">
            This action cannot be undone.
          </p>
          <div className="flex justify-end gap-3">
            <Button
              variant="ghost"
              onClick={() => setShowDeleteModal(false)}
              disabled={deleting}
            >
              Cancel
            </Button>
            <Button
              variant="primary"
              onClick={handleDeleteClient}
              disabled={deleting}
              className="bg-red-600 hover:bg-red-700"
            >
              {deleting ? 'Deleting...' : 'Delete Human'}
            </Button>
          </div>
        </div>
      </Modal>
    </div>
    </>
  )
}

export function ClientsTable({ clients }: ClientsTableProps) {
  const [selectedClient, setSelectedClient] = useState<Client | null>(null)

  return (
    <>
      <Card className="overflow-hidden">
        <div className="overflow-x-auto">
          <table className="w-full">
            <thead className="bg-gray-50 border-b border-gray-200">
              <tr>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Surname</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">First Name</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Dog(s)</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contact</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Concerns</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Last Visit</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
              </tr>
            </thead>
            <tbody className="bg-white divide-y divide-gray-200">
              {clients.map((client) => (
                <tr
                  key={client.id}
                  onClick={() => setSelectedClient(client)}
                  className="hover:bg-gray-50 cursor-pointer transition-colors"
                >
                  <td className="px-6 py-4 whitespace-nowrap">
                    <span className="font-medium text-gray-900">{client.surname || '‚Äî'}</span>
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap text-gray-900">
                    {client.firstName || '‚Äî'}
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap">
                    <div className="text-sm text-gray-900">
                      {client.dogs.length > 0 ? (
                        client.dogs.map((dog, i) => (
                          <span key={dog.id}>
                            {i > 0 && ', '}
                            <Link
                              href={`/dogs/${dog.id}`}
                              onClick={(e) => e.stopPropagation()}
                              className="text-blue-600 hover:text-blue-800 hover:underline"
                            >
                              {dog.name}
                            </Link>
                          </span>
                        ))
                      ) : (
                        <span className="text-gray-400">No dogs</span>
                      )}
                    </div>
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap">
                    <div className="text-sm text-gray-900">{client.phone || '‚Äî'}</div>
                    {client.email && <div className="text-sm text-gray-400">{client.email}</div>}
                  </td>
                  <td className="px-6 py-4">
                    {client.concerns ? (
                      <span className="text-sm text-amber-700">{client.concerns}</span>
                    ) : (
                      <span className="text-sm text-gray-400">‚Äî</span>
                    )}
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                    {client.lastVisit || '‚Äî'}
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap">
                    <StatusBadge status={client.status} />
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </Card>

      {selectedClient && (
        <>
          <div
            className="fixed inset-0 bg-black/20 z-40"
            onClick={() => setSelectedClient(null)}
          />
          <ClientDetailPanel
            client={selectedClient}
            onClose={() => setSelectedClient(null)}
          />
        </>
      )}
    </>
  )
}
</file>

<file path="app/(app)/clients/page.tsx">
import { StatCard } from '@/components/dashboard/StatCard'
import { Card } from '@/components/ui/Card'
import { Button } from '@/components/ui/Button'
import { Users, UserCheck, Plus } from 'lucide-react'
import { getAllClients } from '@/lib/actions/clients'
import { ClientsTable } from './ClientsTable'

export default async function ClientsPage() {
  const clients = await getAllClients()

  const totalClients = clients.length
  const activeThisMonth = clients.filter(c => c.lastVisit !== null).length

  return (
    <div className="space-y-6">
      <div className="flex items-center justify-between">
        <div>
          <h1 className="text-2xl font-bold text-gray-900">Humans</h1>
          <p className="text-gray-500">Manage pet parents and their dogs.</p>
        </div>
        <Button href="/clients/new">
          <Plus className="w-4 h-4 mr-2" />
          New Client
        </Button>
      </div>

      {/* Stats Row */}
      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
        <StatCard
          title="Total Humans"
          value={totalClients}
          icon={Users}
          color="blue"
        />
        <StatCard
          title="Active This Month"
          value={activeThisMonth}
          icon={UserCheck}
          color="green"
        />
      </div>

      {/* Clients Table */}
      {clients.length > 0 ? (
        <ClientsTable clients={clients} />
      ) : (
        <Card className="p-12 text-center">
          <Users className="w-12 h-12 mx-auto mb-4 text-gray-300" />
          <h3 className="font-medium text-gray-900 mb-2">No humans yet</h3>
          <p className="text-gray-500 mb-4">Add your first client to get started.</p>
          <Button href="/clients/new">
            <Plus className="w-4 h-4 mr-2" />
            New Client
          </Button>
        </Card>
      )}
    </div>
  )
}
</file>

<file path="app/(app)/dogs/new/page.tsx">
'use client'

import { useState, useEffect } from 'react'
import { useRouter } from 'next/navigation'
import { createClient } from '@/utils/supabase/client'
import { Card } from '@/components/ui/Card'
import { Button } from '@/components/ui/Button'
import { Modal } from '@/components/ui/Modal'
import { ArrowLeft, Plus, Loader2 } from 'lucide-react'
import Link from 'next/link'

interface Owner {
  id: string
  name: string
  phone: string | null
  email: string | null
}

export default function NewDogPage() {
  const router = useRouter()
  const supabase = createClient()

  // Form state
  const [isSubmitting, setIsSubmitting] = useState(false)
  const [owners, setOwners] = useState<Owner[]>([])
  const [loadingOwners, setLoadingOwners] = useState(true)
  const [userId, setUserId] = useState<string | null>(null)

  // Form data
  const [formData, setFormData] = useState({
    name: '',
    breed: '',
    customer_id: '',
    weight: '',
    notes: ''
  })

  // New Owner Modal state
  const [showNewOwnerModal, setShowNewOwnerModal] = useState(false)
  const [newOwnerLoading, setNewOwnerLoading] = useState(false)
  const [newOwner, setNewOwner] = useState({
    name: '',
    phone: '',
    email: ''
  })

  // Load owners and get user on mount
  useEffect(() => {
    async function loadData() {
      // Get current user
      const { data: { user } } = await supabase.auth.getUser()
      if (user) {
        setUserId(user.id)
      }

      // Load owners
      const { data, error } = await supabase
        .from('customers')
        .select('id, name, phone, email')
        .order('name')

      if (error) {
        console.error('Failed to load owners:', error)
      } else {
        setOwners(data || [])
      }
      setLoadingOwners(false)
    }
    loadData()
  }, []) // eslint-disable-line react-hooks/exhaustive-deps

  // üîß FIX: Explicit handlers for new owner form
  const handleNewOwnerNameChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const value = e.target.value
    setNewOwner(prev => ({ ...prev, name: value }))
  }

  const handleNewOwnerPhoneChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const value = e.target.value
    setNewOwner(prev => ({ ...prev, phone: value }))
  }

  const handleNewOwnerEmailChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const value = e.target.value
    setNewOwner(prev => ({ ...prev, email: value }))
  }

  // Handle creating a new owner
  const handleCreateOwner = async () => {
    if (!newOwner.name.trim()) {
      alert('Owner name is required')
      return
    }

    if (!userId) {
      alert('You must be logged in')
      return
    }

    setNewOwnerLoading(true)

    try {
      // Convert empty strings to null to avoid duplicate key violations
      const emailValue = newOwner.email.trim() === '' ? null : newOwner.email.trim()
      const phoneValue = newOwner.phone.trim() === '' ? null : newOwner.phone.trim()

      const { data, error } = await supabase
        .from('customers')
        .insert({
          name: newOwner.name.trim(),
          phone: phoneValue,
          email: emailValue,
          user_id: userId
        })
        .select()
        .single()

      if (error) throw error

      // Add to owners list and select the new owner
      setOwners(prev => [...prev, data].sort((a, b) => a.name.localeCompare(b.name)))
      setFormData(prev => ({ ...prev, customer_id: data.id }))

      // Reset and close modal
      setNewOwner({
        name: '',
        phone: '',
        email: ''
      })
      setShowNewOwnerModal(false)
    } catch (error: any) {
      alert('Failed to create owner: ' + error.message)
    } finally {
      setNewOwnerLoading(false)
    }
  }

  // Handle form submission
  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault()

    if (!formData.name.trim()) {
      alert('Dog name is required')
      return
    }
    if (!formData.customer_id) {
      alert('Please select an owner')
      return
    }
    if (!userId) {
      alert('You must be logged in')
      return
    }

    setIsSubmitting(true)

    try {
      const { error } = await supabase
        .from('dogs')
        .insert({
          name: formData.name.trim(),
          breed: formData.breed || null,
          customer_id: formData.customer_id,
          weight: formData.weight ? parseFloat(formData.weight) : null,
          notes: formData.notes || null,
          user_id: userId
        })

      if (error) throw error

      router.push('/dogs')
      router.refresh()
    } catch (error: any) {
      alert('Failed to add dog: ' + error.message)
    } finally {
      setIsSubmitting(false)
    }
  }

  const inputClass = "w-full px-3 py-2 border border-gray-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-300"

  return (
    <div className="space-y-6 max-w-2xl">
      {/* Back button */}
      <div className="flex items-center gap-4">
        <Link href="/dogs">
          <Button variant="ghost" size="sm">
            <ArrowLeft className="w-4 h-4 mr-2" />
            Back to Dogs
          </Button>
        </Link>
      </div>

      {/* Header */}
      <div>
        <h1 className="text-2xl font-bold text-gray-900">Add New Dog</h1>
        <p className="text-gray-500">Register a new furry client</p>
      </div>

      {/* Form */}
      <Card>
        <form onSubmit={handleSubmit} className="p-6 space-y-6">
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            {/* Dog Name */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Dog Name *
              </label>
              <input
                type="text"
                required
                placeholder="e.g., Bella"
                value={formData.name}
                onChange={(e) => setFormData({ ...formData, name: e.target.value })}
                className={inputClass}
              />
            </div>

            {/* Breed */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">Breed</label>
              <input
                type="text"
                placeholder="e.g., Golden Retriever"
                value={formData.breed}
                onChange={(e) => setFormData({ ...formData, breed: e.target.value })}
                className={inputClass}
              />
            </div>

            {/* Owner - with Add New button */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Owner *
              </label>
              <div className="flex gap-2">
                <select
                  required
                  value={formData.customer_id}
                  onChange={(e) => setFormData({ ...formData, customer_id: e.target.value })}
                  className={`${inputClass} flex-1`}
                  disabled={loadingOwners}
                >
                  <option value="">
                    {loadingOwners ? 'Loading...' : 'Select owner...'}
                  </option>
                  {owners.map((owner) => (
                    <option key={owner.id} value={owner.id}>
                      {owner.name}
                    </option>
                  ))}
                </select>
                <Button
                  type="button"
                  variant="secondary"
                  onClick={() => setShowNewOwnerModal(true)}
                  className="px-3"
                >
                  <Plus className="w-4 h-4" />
                </Button>
              </div>
            </div>

            {/* Weight */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">Weight (lbs)</label>
              <input
                type="number"
                placeholder="e.g., 45"
                value={formData.weight}
                onChange={(e) => setFormData({ ...formData, weight: e.target.value })}
                className={inputClass}
              />
            </div>
          </div>

          {/* Notes */}
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">
              Notes
            </label>
            <textarea
              rows={3}
              placeholder="Any special care instructions, allergies, or behavioral notes..."
              value={formData.notes}
              onChange={(e) => setFormData({ ...formData, notes: e.target.value })}
              className={inputClass}
            />
          </div>

          {/* Submit buttons */}
          <div className="flex gap-3 pt-4">
            <Button type="submit" disabled={isSubmitting} className="flex-1">
              {isSubmitting ? (
                <>
                  <Loader2 className="w-4 h-4 mr-2 animate-spin" />
                  Adding...
                </>
              ) : (
                'Add Dog'
              )}
            </Button>
            <Link href="/dogs">
              <Button type="button" variant="secondary">
                Cancel
              </Button>
            </Link>
          </div>
        </form>
      </Card>

      {/* New Owner Modal */}
      <Modal
        isOpen={showNewOwnerModal}
        onClose={() => setShowNewOwnerModal(false)}
        title="Add New Owner"
        size="sm"
      >
        <div className="p-6 space-y-4">
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">
              Full Name *
            </label>
            <input
              type="text"
              placeholder="e.g., John Smith"
              value={newOwner.name}
              onChange={handleNewOwnerNameChange}
              className={inputClass}
              autoComplete="off"
            />
          </div>

          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">
              Phone
            </label>
            <input
              type="tel"
              placeholder="e.g., (555) 123-4567"
              value={newOwner.phone}
              onChange={handleNewOwnerPhoneChange}
              className={inputClass}
              autoComplete="off"
            />
          </div>

          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">
              Email
            </label>
            <input
              type="email"
              placeholder="e.g., john@example.com"
              value={newOwner.email}
              onChange={handleNewOwnerEmailChange}
              className={inputClass}
              autoComplete="off"
            />
          </div>

          <div className="flex gap-3 pt-2">
            <Button
              onClick={handleCreateOwner}
              disabled={newOwnerLoading}
              className="flex-1"
            >
              {newOwnerLoading ? (
                <>
                  <Loader2 className="w-4 h-4 mr-2 animate-spin" />
                  Creating...
                </>
              ) : (
                'Create Owner'
              )}
            </Button>
            <Button
              type="button"
              variant="secondary"
              onClick={() => setShowNewOwnerModal(false)}
            >
              Cancel
            </Button>
          </div>
        </div>
      </Modal>
    </div>
  )
}
</file>

<file path="app/(app)/history/page.tsx">
import { createClient } from '@/utils/supabase/server'
import { Card } from '@/components/ui/Card'
import { HistoryPageClient } from './HistoryPageClient'
import { formatTime as safeFormatTime, formatDate as safeFormatDate } from '@/lib/utils/date'

interface AppointmentHistory {
  id: string
  scheduled_at: string
  services: string[]
  notes: string | null
  status: string
  customer: { name: string } | null
  dog: { id: string; name: string; breed: string; photo_url: string | null } | null
}

function formatDate(isoString: string): string {
  return safeFormatDate(isoString)
}

function formatTime(isoString: string): string {
  return safeFormatTime(isoString)
}

export default async function HistoryPage() {
  const supabase = await createClient()

  // Fetch all appointments (past and present)
  const { data: appointments, error } = await supabase
    .from('appointments')
    .select(`
      id,
      scheduled_at,
      services,
      notes,
      status,
      customer:customers(name),
      dog:dogs(id, name, breed, photo_url)
    `)
    .order('scheduled_at', { ascending: false })

  if (error) {
    console.error('Failed to fetch appointments:', error)
  }

  const allAppointments: AppointmentHistory[] = (appointments || []).map(appt => ({
    ...appt,
    customer: Array.isArray(appt.customer) ? appt.customer[0] : appt.customer,
    dog: Array.isArray(appt.dog) ? appt.dog[0] : appt.dog
  }))

  // Calculate stats
  const completedAppointments = allAppointments.filter(a => a.status === 'completed')
  const totalSessions = allAppointments.length
  const completedSessions = completedAppointments.length

  // Get unique dogs served
  const uniqueDogs = new Set(allAppointments.map(a => a.dog?.name).filter(Boolean))

  // Transform for client component
  const appointmentsForClient = allAppointments.map(appt => ({
    id: appt.id,
    dogId: appt.dog?.id || null,
    dogName: appt.dog?.name || 'Unknown Dog',
    dogBreed: appt.dog?.breed || null,
    dogPhotoUrl: appt.dog?.photo_url || null,
    ownerName: appt.customer?.name || 'Unknown Client',
    services: appt.services || [],
    notes: appt.notes,
    status: appt.status,
    time: formatTime(appt.scheduled_at),
    date: formatDate(appt.scheduled_at)
  }))

  return (
    <div className="space-y-6">
      <div>
        <h1 className="text-2xl font-bold text-gray-900">Session History</h1>
        <p className="text-gray-500">Complete record of all grooming sessions</p>
      </div>

      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
        <Card>
          <p className="text-sm text-gray-500">Total Sessions</p>
          <p className="text-2xl font-bold text-gray-900">{totalSessions}</p>
        </Card>
        <Card>
          <p className="text-sm text-gray-500">Completed</p>
          <p className="text-2xl font-bold text-green-600">{completedSessions}</p>
        </Card>
        <Card>
          <p className="text-sm text-gray-500">Dogs Served</p>
          <p className="text-2xl font-bold text-gray-900">{uniqueDogs.size}</p>
        </Card>
      </div>

      <HistoryPageClient appointments={appointmentsForClient} />
    </div>
  )
}
</file>

<file path="app/(app)/messages/page.tsx">
import { MessageSquare } from 'lucide-react'

export default function MessagesPage() {
  return (
    <div className="p-6 max-w-4xl mx-auto">
      <div className="flex items-center gap-3 mb-8">
        <div className="p-3 bg-green-100 rounded-xl">
          <MessageSquare className="h-8 w-8 text-green-600" />
        </div>
        <div>
          <h1 className="text-3xl font-bold text-gray-900">Messages</h1>
          <p className="text-gray-500">Client communication center</p>
        </div>
      </div>

      <div className="bg-white rounded-2xl border border-gray-100 shadow-sm p-12 text-center">
        <div className="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6">
          <MessageSquare className="h-10 w-10 text-gray-400" />
        </div>
        <h2 className="text-2xl font-bold text-gray-900 mb-2">Coming Soon</h2>
        <p className="text-gray-500 max-w-md mx-auto">
          We're building a messaging feature so you can communicate with clients directly from the app. Stay tuned!
        </p>
      </div>
    </div>
  )
}
</file>

<file path="app/(app)/notifications/NotificationsPageClient.tsx">
'use client'

import { useState, useOptimistic, startTransition } from 'react'
import { confirmAppointment } from '@/lib/actions/appointments'
import { getDogDetail } from '@/lib/actions/dogs'
import { Card } from '@/components/ui/Card'
import { Modal } from '@/components/ui/Modal'
import { Bell, Clock, CheckCircle, MessageSquare, AlertCircle, X, Dog as DogIcon, User, Phone, FileText, Tag } from 'lucide-react'
import { format, formatDistanceToNow, isValid } from 'date-fns'
import { safeParseDate } from '@/lib/utils/date'

interface Appointment {
  id: string
  scheduledAt: string
  clientName: string
  clientPhone: string | null
  dogName: string
  services: string[]
  status: string
  reminderSent: boolean
  hasConsent: boolean
  isPast: boolean
}

interface Stats {
  totalAppointments: number
  remindersSent: number
  upcoming: number
  completed: number
}

interface Activity {
  id: string
  type: string
  clientName: string
  dogName: string
  createdAt: string
  delivered: boolean
}

interface DogDetail {
  id: string
  name: string
  breed: string | null
  weight: number | null
  notes: string | null
  photo_url: string | null
  grooming_preferences: {
    clipping_length?: string
    clipping_notes?: string
    nail_clipper_size?: 'small' | 'medium' | 'large'
    nail_tool?: 'clipper' | 'grinder'
    coat_notes?: string
    behavior_notes?: string
    special_instructions?: string
  }
  created_at: string
  customer: {
    id: string
    name: string
    phone: string | null
    email: string | null
  } | null
  history: Array<{
    id: string
    scheduled_at: string
    services: string[]
    notes: string | null
    status: string
  }>
}

export function NotificationsPageClient({
  initialAppointments,
  initialStats,
  initialActivity
}: {
  initialAppointments: Appointment[]
  initialStats: Stats
  initialActivity: Activity[]
}) {
  const [appointments, setAppointments] = useState<Appointment[]>(initialAppointments)
  const [stats, setStats] = useState<Stats>(initialStats)
  const [recentActivity] = useState<Activity[]>(initialActivity)
  const [optimisticAppointments, setOptimisticAppointments] = useOptimistic<Appointment[]>(appointments)
  const [filter, setFilter] = useState<'today' | 'reminders' | 'upcoming' | 'completed'>('today')
  const [isDrawerOpen, setIsDrawerOpen] = useState(false)
  const [selectedDog, setSelectedDog] = useState<DogDetail | null>(null)
  const [loadingDog, setLoadingDog] = useState(false)

  const now = new Date()

  const handleAppointmentRowClick = async (dogName: string, clientName: string) => {
    setLoadingDog(true)
    setIsDrawerOpen(true)
    
    try {
      // In a real implementation, we would need to get the dog ID from the appointment
      // For now, we'll use a mock or fetch based on dog name
      // Since we don't have the dog ID in the appointment data, we'll use a demo approach
      const dogDetail = await getDogDetail('demo-dog-1') // Using demo dog for now
      setSelectedDog(dogDetail)
    } catch (error) {
      console.error('Error fetching dog details:', error)
      // Create a mock dog detail for demonstration
      setSelectedDog({
        id: 'temp-id',
        name: dogName,
        breed: 'Mixed Breed',
        weight: 50,
        notes: 'Regular customer, well-behaved during grooming.',
        photo_url: null,
        grooming_preferences: {
          clipping_length: '#4 blade',
          behavior_notes: 'Calm and cooperative',
          special_instructions: 'Use gentle shampoo'
        },
        created_at: new Date().toISOString(),
        customer: {
          id: 'temp-cust',
          name: clientName,
          phone: '(555) 123-4567',
          email: 'owner@example.com'
        },
        history: []
      })
    } finally {
      setLoadingDog(false)
    }
  }

  const closeDrawer = () => {
    setIsDrawerOpen(false)
    setSelectedDog(null)
  }

  // Filter appointments based on selected filter
  const filteredAppointments = optimisticAppointments.filter(apt => {
    const aptTime = safeParseDate(apt.scheduledAt)
    if (!aptTime) return false
    
    switch (filter) {
      case 'today':
        return true // Show all appointments
      case 'reminders':
        return apt.reminderSent
      case 'upcoming':
        return apt.status !== 'completed' && aptTime > now
      case 'completed':
        return apt.status === 'completed'
      default:
        return true
    }
  })

  const handleConfirmAppointment = async (appointmentId: string) => {
    startTransition(() => {
      // Optimistically update the appointment status
      setOptimisticAppointments(currentAppointments =>
        currentAppointments.map(apt =>
          apt.id === appointmentId
            ? { ...apt, status: 'confirmed' }
            : apt
        )
      )
    })

    try {
      const result = await confirmAppointment(appointmentId)
      if (result.success) {
        // Update the actual state with the confirmed appointment
        setAppointments(currentAppointments =>
          currentAppointments.map(apt =>
            apt.id === appointmentId
              ? { ...apt, status: 'confirmed' }
              : apt
          )
        )
        // Update stats
        setStats(currentStats => ({
          ...currentStats,
          upcoming: currentStats.upcoming - 1
        }))
      } else {
        // If failed, revert the optimistic update
        console.error('Failed to confirm appointment:', result.error)
        setOptimisticAppointments(appointments) // Revert to original
      }
    } catch (error) {
      console.error('Error confirming appointment:', error)
      setOptimisticAppointments(appointments) // Revert to original
    }
  }

  return (
    <div className="space-y-6">
      <div>
        <h1 className="text-2xl font-bold text-gray-900">Notifications</h1>
        <p className="text-gray-500">Automatic SMS reminders are sent 1 hour before each appointment</p>
      </div>

      {/* Stats Cards - Now clickable filters */}
      <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
        <div 
          className={`cursor-pointer transition-all duration-200 hover:scale-[1.02] ${filter === 'today' ? 'ring-2 ring-blue-500 rounded-2xl' : ''}`}
          onClick={() => setFilter('today')}
        >
          <Card className="h-full">
            <div className="flex items-center gap-3">
              <div className="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                <Clock className="w-5 h-5 text-blue-600" />
              </div>
              <div>
                <p className="text-2xl font-bold text-gray-900">{stats.totalAppointments}</p>
                <p className="text-sm text-gray-500">Today</p>
              </div>
            </div>
          </Card>
        </div>
        <div 
          className={`cursor-pointer transition-all duration-200 hover:scale-[1.02] ${filter === 'reminders' ? 'ring-2 ring-blue-500 rounded-2xl' : ''}`}
          onClick={() => setFilter('reminders')}
        >
          <Card className="h-full">
            <div className="flex items-center gap-3">
              <div className="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
                <MessageSquare className="w-5 h-5 text-green-600" />
              </div>
              <div>
                <p className="text-2xl font-bold text-gray-900">{stats.remindersSent}</p>
                <p className="text-sm text-gray-500">Reminders Sent</p>
              </div>
            </div>
          </Card>
        </div>
        <div 
          className={`cursor-pointer transition-all duration-200 hover:scale-[1.02] ${filter === 'upcoming' ? 'ring-2 ring-blue-500 rounded-2xl' : ''}`}
          onClick={() => setFilter('upcoming')}
        >
          <Card className="h-full">
            <div className="flex items-center gap-3">
              <div className="w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center">
                <Bell className="w-5 h-5 text-amber-600" />
              </div>
              <div>
                <p className="text-2xl font-bold text-gray-900">{stats.upcoming}</p>
                <p className="text-sm text-gray-500">Upcoming</p>
              </div>
            </div>
          </Card>
        </div>
        <div 
          className={`cursor-pointer transition-all duration-200 hover:scale-[1.02] ${filter === 'completed' ? 'ring-2 ring-blue-500 rounded-2xl' : ''}`}
          onClick={() => setFilter('completed')}
        >
          <Card className="h-full">
            <div className="flex items-center gap-3">
              <div className="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center">
                <CheckCircle className="w-5 h-5 text-gray-600" />
              </div>
              <div>
                <p className="text-2xl font-bold text-gray-900">{stats.completed}</p>
                <p className="text-sm text-gray-500">Completed</p>
              </div>
            </div>
          </Card>
        </div>
      </div>

      {/* Today's Schedule */}
      <Card>
        <h3 className="font-semibold text-gray-900 mb-4 flex items-center gap-2">
          <Clock className="w-5 h-5 text-blue-600" />
          Today&apos;s Schedule {filter !== 'today' && `(${filteredAppointments.length} ${filter} appointments)`}
        </h3>

        {optimisticAppointments.length === 0 ? (
          <div className="text-center py-8 text-gray-500">
            <Bell className="w-12 h-12 mx-auto mb-3 text-gray-300" />
            <p className="font-medium">No appointments today</p>
            <p className="text-sm mt-1">Reminders will be sent automatically when appointments are scheduled</p>
          </div>
        ) : filteredAppointments.length === 0 ? (
          <div className="text-center py-8 text-gray-500">
            <Bell className="w-12 h-12 mx-auto mb-3 text-gray-300" />
            <p className="font-medium">No {filter} appointments</p>
            <p className="text-sm mt-1">Try selecting a different filter</p>
          </div>
        ) : (
          <div className="space-y-3">
            {filteredAppointments.map((apt) => {
              const aptTime = safeParseDate(apt.scheduledAt)
              if (!aptTime || !isValid(aptTime)) return null
              const isPast = aptTime < now
              const isCompleted = apt.status === 'completed'

              return (
                <div
                  key={apt.id}
                  className={`flex items-center justify-between p-4 rounded-lg cursor-pointer transition-all duration-200 hover:scale-[1.01] ${
                    isCompleted ? 'bg-gray-50 opacity-60 hover:bg-gray-100' : 
                    isPast ? 'bg-amber-50 hover:bg-amber-100' : 
                    'bg-blue-50 hover:bg-blue-100'
                  }`}
                  onClick={(e) => {
                    // Only open drawer if click is not on the status badge area
                    const target = e.target as HTMLElement
                    if (!target.closest('.status-badge-area') && !target.closest('.sms-link')) {
                      handleAppointmentRowClick(apt.dogName, apt.clientName)
                    }
                  }}
                >
                  <div className="flex items-center gap-4">
                    <div className="text-center min-w-[60px]">
                      <p className={`text-lg font-bold ${isCompleted ? 'text-gray-400' : 'text-gray-900'}`}>
                        {format(aptTime, 'h:mm')}
                      </p>
                      <p className="text-xs text-gray-500">{format(aptTime, 'a')}</p>
                    </div>
                    <div>
                      <p className={`font-medium ${isCompleted ? 'text-gray-400' : 'text-gray-900'}`}>
                        {apt.dogName}
                      </p>
                      <p className="text-sm text-gray-500">{apt.clientName}</p>
                      <p className="text-xs text-gray-400">{apt.services.join(', ') || 'No services listed'}</p>
                    </div>
                  </div>

                  <div className="flex items-center gap-3 status-badge-area">
                    {/* Reminder Status */}
                    {apt.reminderSent ? (
                      <span className="flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full">
                        <CheckCircle className="w-3 h-3" />
                        Reminded
                      </span>
                    ) : !apt.clientPhone ? (
                      <span className="flex items-center gap-1 px-2 py-1 bg-gray-100 text-gray-500 text-xs rounded-full">
                        <AlertCircle className="w-3 h-3" />
                        No SMS
                      </span>
                    ) : !apt.hasConsent ? (
                      <button
                        onClick={(e) => {
                          e.stopPropagation()
                          if (apt.clientPhone) {
                            window.open(`sms:${apt.clientPhone}&body=Hi ${apt.clientName}, reminder for ${apt.dogName}.`)
                          }
                        }}
                        className="flex items-center gap-1 px-2 py-1 bg-gray-100 text-blue-600 hover:text-blue-800 hover:underline text-xs rounded-full sms-link cursor-pointer transition-colors"
                        title="Send manual SMS reminder (no consent on file)"
                      >
                        <AlertCircle className="w-3 h-3" />
                        No Consent
                      </button>
                    ) : isPast ? (
                      <button
                        onClick={(e) => {
                          e.stopPropagation()
                          if (apt.clientPhone) {
                            window.open(`sms:${apt.clientPhone}&body=Hi ${apt.clientName}, reminder for ${apt.dogName}.`)
                          }
                        }}
                        className="px-2 py-1 bg-amber-100 text-blue-600 hover:text-blue-800 hover:underline text-xs rounded-full sms-link cursor-pointer transition-colors"
                        title="Send manual SMS reminder"
                      >
                        Missed
                      </button>
                    ) : (
                      <button
                        onClick={(e) => {
                          e.stopPropagation()
                          if (apt.clientPhone) {
                            window.open(`sms:${apt.clientPhone}&body=Hi ${apt.clientName}, reminder for ${apt.dogName}.`)
                          }
                        }}
                        className="px-2 py-1 bg-blue-100 text-blue-600 hover:text-blue-800 hover:underline text-xs rounded-full sms-link cursor-pointer transition-colors"
                        title="Send manual SMS reminder"
                      >
                        Pending
                      </button>
                    )}

                    {/* Appointment Status */}
                    {apt.status === 'pending_confirmation' ? (
                      <button
                        onClick={(e) => {
                          e.stopPropagation()
                          handleConfirmAppointment(apt.id)
                        }}
                        className="px-2 py-1 bg-amber-100 text-amber-700 rounded-full text-xs font-medium capitalize hover:bg-amber-200 transition-colors cursor-pointer focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2"
                        title="Click to confirm appointment"
                      >
                        {apt.status.replace('_', ' ')}
                      </button>
                    ) : (
                      <span className={`px-2 py-1 rounded-full text-xs font-medium capitalize ${
                        isCompleted ? 'bg-gray-200 text-gray-600' :
                        apt.status === 'confirmed' ? 'bg-green-100 text-green-700' :
                        'bg-amber-100 text-amber-700'
                      }`}>
                        {apt.status.replace('_', ' ')}
                      </span>
                    )}
                  </div>
                </div>
              )
            })}
          </div>
        )}
      </Card>

      {/* Recent Activity */}
      {recentActivity.length > 0 && (
        <Card>
          <h3 className="font-semibold text-gray-900 mb-4 flex items-center gap-2">
            <MessageSquare className="w-5 h-5 text-green-600" />
            Recent SMS Activity
          </h3>
          <div className="space-y-3">
            {recentActivity.map((activity) => (
              <div key={activity.id} className="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                <div className="flex items-center gap-3">
                  <div className={`w-8 h-8 rounded-full flex items-center justify-center ${
                    activity.delivered ? 'bg-green-100' : 'bg-red-100'
                  }`}>
                    {activity.delivered ? (
                      <CheckCircle className="w-4 h-4 text-green-600" />
                    ) : (
                      <AlertCircle className="w-4 h-4 text-red-600" />
                    )}
                  </div>
                  <div>
                    <p className="text-sm font-medium text-gray-900">
                      {activity.type === 'reminder' ? 'Reminder' : activity.type} sent
                    </p>
                    <p className="text-xs text-gray-500">
                      {activity.clientName} - {activity.dogName}
                    </p>
                  </div>
                </div>
                <p className="text-xs text-gray-400">
                  {safeParseDate(activity.createdAt) ? formatDistanceToNow(safeParseDate(activity.createdAt)!, { addSuffix: true }) : 'Unknown time'}
                </p>
              </div>
            ))}
          </div>
        </Card>
      )}

      {/* How it works */}
      <Card>
        <h3 className="font-semibold text-gray-900 mb-3">How Automatic Reminders Work</h3>
        <div className="text-sm text-gray-600 space-y-2">
          <p>‚Ä¢ SMS reminders are sent automatically <strong>1 hour before</strong> each appointment</p>
          <p>‚Ä¢ Only clients with SMS consent and a phone number receive reminders</p>
          <p>‚Ä¢ The system checks every 15 minutes for upcoming appointments</p>
          <p>‚Ä¢ Each appointment only receives one reminder (no duplicates)</p>
        </div>
      </Card>

      {/* Dog Details Drawer/Modal */}
      <Modal
        isOpen={isDrawerOpen}
        onClose={closeDrawer}
        size="lg"
      >
        <div className="p-6">
          {loadingDog ? (
            <div className="flex items-center justify-center py-12">
              <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
            </div>
          ) : selectedDog ? (
            <div className="space-y-6">
              {/* Header with close button */}
              <div className="flex items-center justify-between mb-2">
                <h2 className="text-xl font-bold text-gray-900 flex items-center gap-2">
                  <DogIcon className="w-5 h-5 text-blue-600" />
                  {selectedDog.name}&apos;s Details
                </h2>
                <button
                  onClick={closeDrawer}
                  className="p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors"
                  aria-label="Close drawer"
                >
                  <X className="w-5 h-5" />
                </button>
              </div>

              {/* Dog Photo */}
              <div className="flex flex-col items-center">
                <div className="w-32 h-32 rounded-full overflow-hidden bg-gray-100 flex items-center justify-center mb-3">
                  {selectedDog.photo_url ? (
                    <img 
                      src={selectedDog.photo_url} 
                      alt={selectedDog.name}
                      className="w-full h-full object-cover"
                    />
                  ) : (
                    <div className="text-4xl">üêï</div>
                  )}
                </div>
                <div className="text-center">
                  <h3 className="text-lg font-semibold text-gray-900">{selectedDog.name}</h3>
                  <p className="text-gray-500">{selectedDog.breed || 'Mixed Breed'}</p>
                  {selectedDog.weight && (
                    <p className="text-sm text-gray-500">{selectedDog.weight} lbs</p>
                  )}
                </div>
              </div>

              {/* Owner Information */}
              {selectedDog.customer && (
                <div className="bg-blue-50 rounded-xl p-4">
                  <h4 className="font-medium text-gray-900 mb-2 flex items-center gap-2">
                    <User className="w-4 h-4" />
                    Owner Information
                  </h4>
                  <p className="text-gray-700">{selectedDog.customer.name}</p>
                  {selectedDog.customer.phone && (
                    <a 
                      href={`tel:${selectedDog.customer.phone}`}
                      className="text-blue-600 hover:text-blue-800 flex items-center gap-2 mt-1"
                    >
                      <Phone className="w-4 h-4" />
                      {selectedDog.customer.phone}
                    </a>
                  )}
                  {selectedDog.customer.email && (
                    <p className="text-gray-600 text-sm mt-1">{selectedDog.customer.email}</p>
                  )}
                </div>
              )}

              {/* Grooming Notes */}
              <div>
                <h4 className="font-medium text-gray-900 mb-2 flex items-center gap-2">
                  <FileText className="w-4 h-4" />
                  Grooming Notes
                </h4>
                <div className="bg-gray-50 rounded-lg p-4">
                  {selectedDog.grooming_preferences.clipping_length && (
                    <div className="mb-3">
                      <p className="text-sm text-gray-500">Clipping Length</p>
                      <p className="text-gray-900">{selectedDog.grooming_preferences.clipping_length}</p>
                    </div>
                  )}
                  {selectedDog.grooming_preferences.clipping_notes && (
                    <div className="mb-3">
                      <p className="text-sm text-gray-500">Clipping Notes</p>
                      <p className="text-gray-900">{selectedDog.grooming_preferences.clipping_notes}</p>
                    </div>
                  )}
                  {selectedDog.grooming_preferences.coat_notes && (
                    <div className="mb-3">
                      <p className="text-sm text-gray-500">Coat Notes</p>
                      <p className="text-gray-900">{selectedDog.grooming_preferences.coat_notes}</p>
                    </div>
                  )}
                  {selectedDog.notes && (
                    <div>
                      <p className="text-sm text-gray-500">General Notes</p>
                      <p className="text-gray-900">{selectedDog.notes}</p>
                    </div>
                  )}
                  {!selectedDog.grooming_preferences.clipping_length && 
                   !selectedDog.grooming_preferences.clipping_notes && 
                   !selectedDog.grooming_preferences.coat_notes && 
                   !selectedDog.notes && (
                    <p className="text-gray-500 italic">No grooming notes recorded yet.</p>
                  )}
                </div>
              </div>

              {/* Behavioral Tags */}
              <div>
                <h4 className="font-medium text-gray-900 mb-2 flex items-center gap-2">
                  <Tag className="w-4 h-4" />
                  Behavioral Information
                </h4>
                <div className="flex flex-wrap gap-2">
                  {selectedDog.grooming_preferences.behavior_notes && (
                    <div className="bg-amber-100 text-amber-800 px-3 py-1 rounded-full text-sm">
                      {selectedDog.grooming_preferences.behavior_notes}
                    </div>
                  )}
                  {selectedDog.grooming_preferences.special_instructions && (
                    <div className="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm">
                      {selectedDog.grooming_preferences.special_instructions}
                    </div>
                  )}
                  {selectedDog.grooming_preferences.nail_tool && (
                    <div className="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm">
                      Nail tool: {selectedDog.grooming_preferences.nail_tool}
                    </div>
                  )}
                  {!selectedDog.grooming_preferences.behavior_notes && 
                   !selectedDog.grooming_preferences.special_instructions && 
                   !selectedDog.grooming_preferences.nail_tool && (
                    <p className="text-gray-500 italic">No behavioral information recorded.</p>
                  )}
                </div>
              </div>

              {/* Additional Info */}
              <div className="pt-4 border-t border-gray-200">
                <p className="text-sm text-gray-500">
                  Dog added on {safeParseDate(selectedDog.created_at) ? format(safeParseDate(selectedDog.created_at)!, 'MMMM d, yyyy') : 'Unknown date'}
                </p>
                <p className="text-sm text-gray-500">
                  {selectedDog.history.length} past appointments
                </p>
              </div>
            </div>
          ) : (
            <div className="text-center py-8">
              <p className="text-gray-500">No dog details available.</p>
            </div>
          )}
        </div>
      </Modal>
    </div>
  )
}
</file>

<file path="components/dashboard/QuickActions.tsx">
'use client'

import { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card'
import { Button } from '@/components/ui/Button'
import { CalendarPlus, UserPlus, Bell, BarChart3 } from 'lucide-react'

const actions = [
  { id: 'new-appointment', label: 'New Appointment', icon: CalendarPlus, color: 'bg-blue-600', href: '/calendar/new' },
  { id: 'add-client', label: 'New Client', icon: UserPlus, color: 'bg-blue-500', href: '/clients/new' },
  { id: 'send-reminder', label: 'Send Reminders', icon: Bell, color: 'bg-amber-500', href: '/notifications' },
  { id: 'view-reports', label: 'View Reports', icon: BarChart3, color: 'bg-green-500', href: '/reports' },
]

export function QuickActions() {
  return (
    <Card>
      <CardHeader>
        <CardTitle>Quick Actions</CardTitle>
      </CardHeader>
      <CardContent>
        <div className="grid grid-cols-2 gap-3">
          {actions.map((action) => {
            const Icon = action.icon
            return (
              <Button
                key={action.id}
                variant="secondary"
                href={action.href}
                className="flex flex-col items-center gap-2 h-auto py-4"
              >
                <div className={`${action.color} p-2 rounded-lg text-white`}>
                  <Icon className="w-5 h-5" />
                </div>
                <span className="text-xs">{action.label}</span>
              </Button>
            )
          })}
        </div>
      </CardContent>
    </Card>
  )
}
</file>

<file path="components/layout/KeyboardShortcuts.tsx">
'use client'

import { useEffect } from 'react'
import { useRouter } from 'next/navigation'

const shortcuts: Record<string, string> = {
  '1': '/',              // Dashboard
  '2': '/clients',       // Humans
  '3': '/dogs',          // Dogs
  '4': '/calendar',      // Calendar
  '5': '/notifications', // Notifications
  '6': '/history',       // History
  '7': '/settings',      // Settings
  'n': '/calendar/new',  // New appointment
  'd': '/dogs',          // Dogs shortcut
}

export function KeyboardShortcuts() {
  const router = useRouter()

  useEffect(() => {
    function handleKeyDown(e: KeyboardEvent) {
      // ‚åò + ‚å• + number (Mac) or Ctrl + Alt + number (Windows)
      if ((e.metaKey || e.ctrlKey) && e.altKey) {
        const route = shortcuts[e.key]
        if (route) {
          e.preventDefault()
          router.push(route)
        }
      }
    }

    window.addEventListener('keydown', handleKeyDown)
    return () => window.removeEventListener('keydown', handleKeyDown)
  }, [router])

  return null
}
</file>

<file path="components/DogDetail.tsx">
'use client'

import { Dog } from '@/app/types'
import { safeParseDate } from '@/lib/utils/date'

export default function DogDetail({ dog, onClose }: { dog: Dog; onClose: () => void }) {
  return (
    <div className="bg-white rounded-2xl shadow-lg p-6 border-2 border-pink-100">
      <div className="flex justify-between items-start mb-6">
        <h2 className="text-3xl font-bold text-gray-800 flex items-center gap-2">
          <span className="text-3xl">üêï</span>
          {dog.dog_name}
        </h2>
        <button
          onClick={onClose}
          className="px-5 py-3 text-sm font-medium text-rose-700 bg-rose-50 rounded-lg hover:bg-rose-100 min-h-[44px] transition-colors"
        >
          ‚Üê Back
        </button>
      </div>

      <div className="space-y-6">
        <div className="bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-5 border border-purple-100">
          <h3 className="text-lg font-bold text-gray-900 mb-4 flex items-center gap-2">
            <span>üë§</span>
            Owner Information
          </h3>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label className="text-xs font-semibold text-purple-700 uppercase tracking-wide">Name</label>
              <p className="text-gray-900 font-medium mt-1">{dog.owner_name}</p>
            </div>
            {dog.owner_phone && (
              <div>
                <label className="text-xs font-semibold text-purple-700 uppercase tracking-wide">Phone</label>
                <p className="text-gray-900 font-medium mt-1">üìû {dog.owner_phone}</p>
              </div>
            )}
            {dog.owner_email && (
              <div className="md:col-span-2">
                <label className="text-xs font-semibold text-purple-700 uppercase tracking-wide">Email</label>
                <p className="text-gray-900 font-medium mt-1">‚úâÔ∏è {dog.owner_email}</p>
              </div>
            )}
          </div>
        </div>

        <div className="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-5 border border-blue-100">
          <h3 className="text-lg font-bold text-gray-900 mb-4 flex items-center gap-2">
            <span>üêæ</span>
            Pup Information
          </h3>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label className="text-xs font-semibold text-blue-700 uppercase tracking-wide">Name</label>
              <p className="text-gray-900 font-medium mt-1">{dog.dog_name}</p>
            </div>
            {dog.breed && (
              <div>
                <label className="text-xs font-semibold text-blue-700 uppercase tracking-wide">Breed</label>
                <p className="text-gray-900 font-medium mt-1 italic">{dog.breed}</p>
              </div>
            )}
          </div>
        </div>

        <div className="bg-gradient-to-r from-pink-50 to-rose-50 rounded-xl p-5 border border-pink-100">
          <h3 className="text-lg font-bold text-gray-900 mb-4 flex items-center gap-2">
            <span>‚úÇÔ∏è</span>
            Grooming Preferences
          </h3>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            {dog.clipper_blade_size && (
              <div>
                <label className="text-xs font-semibold text-pink-700 uppercase tracking-wide">Blade Size</label>
                <p className="text-gray-900 text-2xl font-bold mt-1 text-pink-600">{dog.clipper_blade_size}</p>
              </div>
            )}
            {dog.nail_clipper_size && (
              <div>
                <label className="text-xs font-semibold text-pink-700 uppercase tracking-wide">Nail Clipper Size</label>
                <p className="text-gray-900 font-medium mt-1">{dog.nail_clipper_size}</p>
              </div>
            )}
          </div>
        </div>

        {dog.grooming_notes && (
          <div className="bg-gradient-to-r from-amber-50 to-yellow-50 rounded-xl p-5 border border-amber-100">
            <label className="text-xs font-semibold text-amber-700 uppercase tracking-wide flex items-center gap-2 mb-2">
              <span>üìù</span>
              Grooming Notes
            </label>
            <p className="text-gray-900 mt-2 whitespace-pre-wrap leading-relaxed">{dog.grooming_notes}</p>
          </div>
        )}

        {dog.behavioral_notes && (
          <div className="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-5 border border-green-100">
            <label className="text-xs font-semibold text-green-700 uppercase tracking-wide flex items-center gap-2 mb-2">
              <span>üíö</span>
              Behavioral Notes
            </label>
            <p className="text-gray-900 mt-2 whitespace-pre-wrap leading-relaxed">{dog.behavioral_notes}</p>
          </div>
        )}

        <div className="text-xs text-gray-400 text-center pt-4">
          Added: {safeParseDate(dog.created_at)?.toLocaleDateString() ?? 'N/A'}
        </div>
      </div>
    </div>
  )
}
</file>

<file path="lib/actions/clients.ts">
'use server'

import { createClient } from '@/utils/supabase/server'
import { revalidatePath } from 'next/cache'
import { safeParseDate } from '@/lib/utils/date'

interface DogInput {
  name: string
  breed: string
  weight: string
  notes: string
}

interface ClientInput {
  firstName: string
  surname: string
  email: string
  phone: string
}

export async function createClient_action(
  clientData: ClientInput,
  dogs: DogInput[]
): Promise<{ success: boolean; error?: string; clientId?: string }> {
  const supabase = await createClient()

  // Combine first name and surname for the name field
  const fullName = `${clientData.firstName} ${clientData.surname}`.trim()

  // Insert customer (customers table has: id, name, email, phone, sms_consent, created_at, updated_at)
  const { data: customer, error: customerError } = await supabase
    .from('customers')
    .insert({
      name: fullName,
      email: clientData.email || null,
      phone: clientData.phone || null,
    })
    .select('id')
    .single()

  if (customerError) {
    console.error('[Clients] Create customer failed:', customerError)
    return { success: false, error: customerError.message }
  }

  // Insert dogs for this customer
  const dogsToInsert = dogs
    .filter(dog => dog.name.trim()) // Only insert dogs with names
    .map(dog => ({
      customer_id: customer.id,
      name: dog.name.trim(),
      breed: dog.breed.trim() || null,
      weight: dog.weight ? parseFloat(dog.weight) : null,
      notes: dog.notes.trim() || null,
    }))

  if (dogsToInsert.length > 0) {
    const { error: dogsError } = await supabase
      .from('dogs')
      .insert(dogsToInsert)

    if (dogsError) {
      console.error('[Clients] Create dogs failed:', dogsError)
      // Customer was created, but dogs failed - still return success but log warning
      return { success: true, clientId: customer.id, error: `Client created but dogs failed: ${dogsError.message}` }
    }
  }

  // Revalidate the clients page to show new data
  revalidatePath('/clients')

  return { success: true, clientId: customer.id }
}

/**
 * Delete a client (and their dogs/appointments)
 */
export async function deleteClient(clientId: string): Promise<{ success: boolean; error?: string }> {
  const supabase = await createClient()

  // Delete the client (dogs and appointments should cascade delete if FK is set up with ON DELETE CASCADE)
  const { error } = await supabase
    .from('customers')
    .delete()
    .eq('id', clientId)

  if (error) {
    console.error('[Clients] Delete failed:', error)
    return { success: false, error: error.message }
  }

  // Revalidate the clients page
  revalidatePath('/clients')

  return { success: true }
}

/**
 * Get all clients with their dogs for the clients list page
 */
export async function getAllClients() {
  const supabase = await createClient()

  // Get all customers with their dogs
  const { data: customers, error } = await supabase
    .from('customers')
    .select(`
      id,
      name,
      email,
      phone,
      created_at,
      dogs(id, name, breed, notes)
    `)
    .order('name', { ascending: true })

  if (error) {
    console.error('[Clients] Fetch all failed:', error)
    return []
  }

  // Get last visit for each customer
  const { data: appointments } = await supabase
    .from('appointments')
    .select('customer_id, scheduled_at')
    .order('scheduled_at', { ascending: false })

  // Build last visit map
  const lastVisitMap: Record<string, string> = {}
  if (appointments) {
    for (const appt of appointments) {
      if (!lastVisitMap[appt.customer_id]) {
        lastVisitMap[appt.customer_id] = appt.scheduled_at
      }
    }
  }

  // Transform to expected format
  return (customers || []).map(customer => {
    // Split name into surname and first name (assume "First Last" format)
    const nameParts = customer.name.split(' ')
    const firstName = nameParts[0] || ''
    const surname = nameParts.slice(1).join(' ') || ''

    // Derive concerns from dog notes
    const dogConcerns = (customer.dogs || [])
      .map((d: { notes: string | null }) => d.notes)
      .filter(Boolean)
      .join(', ')

    return {
      id: customer.id,
      surname,
      firstName,
      email: customer.email || '',
      phone: customer.phone || '',
      dogs: customer.dogs || [],
      lastVisit: lastVisitMap[customer.id]
        ? (safeParseDate(lastVisitMap[customer.id])?.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }) ?? null)
        : null,
      concerns: dogConcerns.length > 50 ? dogConcerns.slice(0, 47) + '...' : dogConcerns || null,
      status: 'active' as const, // Default to active for now
    }
  })
}
</file>

<file path="lib/actions/dashboard.ts">
'use server'

import { createClient } from '@/utils/supabase/server'
import { safeParseDate } from '@/lib/utils/date'


export interface DashboardAppointment {
  id: string
  scheduled_at: string
  services: string[]
  notes: string | null
  status: string
  dog: {
    id: string
    name: string
    breed: string | null
    grooming_preferences: {
      behavior_notes?: string
      special_instructions?: string
    } | null
  } | null
  customer: {
    id: string
    name: string
  } | null
  is_first_visit: boolean
  // Helper for direct access
  dogId: string | null
}

export interface TodayAtAGlance {
  remainingAppointments: number
  specialHandlingCount: number
  firstTimeVisits: number
  finalAppointmentTime: string | null
}

export interface WatchlistItem {
  dogName: string
  reason: string
  time: string
  appointmentId: string
  dogId: string
}

export interface DashboardData {
  appointments: DashboardAppointment[]
  glance: TodayAtAGlance
  watchlist: WatchlistItem[]
  totalDogs: number
}

/**
 * Get all dashboard data for today
 * @param timezoneOffset Optional timezone offset in minutes (e.g., -300 for EST, 660 for Australia/Sydney)
 */
export async function getTodayDashboardData(timezoneOffset?: number): Promise<DashboardData> {
  const supabase = await createClient()

  // Get today's date range adjusted for timezone
  const now = new Date()
  
  // If timezoneOffset is provided, adjust the date
  let today = now
  if (timezoneOffset !== undefined) {
    // Convert server local time to user's local time
    // timezoneOffset is user's getTimezoneOffset() (UTC - local)
    // To convert server time to user time: userTime = serverUTC - userTimezoneOffset
    const serverUTC = now.getTime() + (now.getTimezoneOffset() * 60000)
    today = new Date(serverUTC - (timezoneOffset * 60000))
  }
  
  const startOfDay = new Date(today.getFullYear(), today.getMonth(), today.getDate())
  const endOfDay = new Date(today.getFullYear(), today.getMonth(), today.getDate() + 1)

  // Fetch today's appointments with dog and customer info
  const { data: appointments, error } = await supabase
    .from('appointments')
    .select(`
      id,
      scheduled_at,
      services,
      notes,
      status,
      dog:dogs(id, name, breed, grooming_preferences, created_at),
      customer:customers(id, name)
    `)
    .gte('scheduled_at', startOfDay.toISOString())
    .lt('scheduled_at', endOfDay.toISOString())
    .order('scheduled_at', { ascending: true })

  if (error) {
    console.error('[Dashboard] Fetch appointments failed:', error)
    return {
      appointments: [],
      glance: {
        remainingAppointments: 0,
        specialHandlingCount: 0,
        firstTimeVisits: 0,
        finalAppointmentTime: null
      },
      watchlist: [],
      totalDogs: 0
    }
  }

  // Get total dogs count
  const { count: totalDogs } = await supabase
    .from('dogs')
    .select('*', { count: 'exact', head: true })

  // Check which dogs are on their first visit
  const dogIds = (appointments || [])
    .map(a => {
      const dog = Array.isArray(a.dog) ? a.dog[0] : a.dog
      return dog?.id
    })
    .filter(Boolean)

  // Get appointment counts for each dog
  const { data: appointmentCounts } = await supabase
    .from('appointments')
    .select('dog_id')
    .in('dog_id', dogIds)
    .lt('scheduled_at', startOfDay.toISOString()) // Only past appointments

  const dogVisitCounts: Record<string, number> = {}
  if (appointmentCounts) {
    for (const appt of appointmentCounts) {
      dogVisitCounts[appt.dog_id] = (dogVisitCounts[appt.dog_id] || 0) + 1
    }
  }

  // Process appointments - use the adjusted 'today' for comparison
  const processedAppointments: DashboardAppointment[] = (appointments || []).map(appt => {
    const dog = Array.isArray(appt.dog) ? appt.dog[0] : appt.dog
    const customer = Array.isArray(appt.customer) ? appt.customer[0] : appt.customer
    const isFirstVisit = dog?.id ? (dogVisitCounts[dog.id] || 0) === 0 : false

    return {
      ...appt,
      dog: dog ? {
        id: dog.id,
        name: dog.name,
        breed: dog.breed,
        grooming_preferences: (dog.grooming_preferences || null) as DashboardAppointment['dog'] extends { grooming_preferences: infer T } ? T : never
      } : null,
      customer,
      is_first_visit: isFirstVisit,
      dogId: dog?.id || null
    }
  })

  // Calculate "Today at a Glance" stats
  const remainingAppointments = processedAppointments.filter(
    a => {
      const aptDate = safeParseDate(a.scheduled_at)
      return a.status !== 'completed' && a.status !== 'cancelled' && aptDate && aptDate >= today
    }
  ).length

  const specialHandlingCount = processedAppointments.filter(a => {
    const prefs = a.dog?.grooming_preferences
    return prefs?.behavior_notes || prefs?.special_instructions
  }).length

  const firstTimeVisits = processedAppointments.filter(a => a.is_first_visit).length

  const nonCancelledAppointments = processedAppointments.filter(
    a => a.status !== 'cancelled'
  )
  const finalAppointment = nonCancelledAppointments[nonCancelledAppointments.length - 1]
  const finalAppointmentTime = finalAppointment
    ? formatTime(finalAppointment.scheduled_at)
    : null

  // Build watchlist (dogs requiring special attention)
  const watchlist: WatchlistItem[] = processedAppointments
    .filter(a => {
      if (a.status === 'completed' || a.status === 'cancelled') return false
      const prefs = a.dog?.grooming_preferences
      return prefs?.behavior_notes || prefs?.special_instructions || a.is_first_visit
    })
    .map(a => {
      const reasons: string[] = []
      const prefs = a.dog?.grooming_preferences

      if (a.is_first_visit) {
        reasons.push('First visit')
      }
      if (prefs?.behavior_notes) {
        // Extract key concerns from behavior notes
        const notes = prefs.behavior_notes.toLowerCase()
        if (notes.includes('anxious') || notes.includes('nervous')) reasons.push('Anxious')
        if (notes.includes('aggressive') || notes.includes('bites')) reasons.push('Aggressive')
        if (notes.includes('nail') || notes.includes('paw')) reasons.push('Nail sensitive')
        if (notes.includes('dryer') || notes.includes('loud')) reasons.push('Noise sensitive')
        // If no specific keywords, add a generic flag
        if (reasons.length === 0 || (reasons.length === 1 && reasons[0] === 'First visit')) {
          reasons.push('Behavior note')
        }
      }
      if (prefs?.special_instructions && reasons.length <= 1) {
        reasons.push('Special handling')
      }

      return {
        dogName: a.dog?.name || 'Unknown',
        reason: reasons.join(', '),
        time: formatTime(a.scheduled_at),
        appointmentId: a.id,
        dogId: a.dog?.id || ''
      }
    })
    .sort((a, b) => a.time.localeCompare(b.time))

  return {
    appointments: processedAppointments,
    glance: {
      remainingAppointments,
      specialHandlingCount,
      firstTimeVisits,
      finalAppointmentTime
    },
    watchlist,
    totalDogs: totalDogs || 0
  }
}

function formatTime(isoString: string): string {
  const date = safeParseDate(isoString)
  if (!date) return 'N/A'
  return date.toLocaleTimeString('en-US', {
    hour: 'numeric',
    minute: '2-digit',
    hour12: true
  })
}
</file>

<file path="lib/actions/onboarding.ts">
'use server'

import { createClient } from "@/utils/supabase/server";
import { redirect } from "next/navigation";
import { revalidatePath } from "next/cache";

export async function setupBusiness(formData: FormData) {
  const supabase = await createClient();
  const { data: { user } } = await supabase.auth.getUser();

  if (!user) redirect("/login");

  const businessName = formData.get("businessName") as string;
  const phone = formData.get("phone") as string;
  const currency = formData.get("currency") as string || "$";

  if (!businessName) {
    return { error: "Business Name is required" };
  }

  // Insert settings
  const { error } = await supabase
    .from("business_settings")
    .upsert({
      user_id: user.id,
      business_name: businessName,
      phone: phone,
      currency: currency,
    }, {
      onConflict: 'user_id'
    });

  if (error) {
    console.error("Onboarding Error:", error);
    return { error: error.message };
  }

  revalidatePath("/dashboard");
  redirect("/dashboard");
}
</file>

<file path="lib/actions/photos.ts">
'use server'

import { createClient } from '@/utils/supabase/server'
import { revalidatePath } from 'next/cache'

/**
 * Upload a dog photo to Supabase Storage and update the dog record
 */
export async function uploadDogPhoto(
  dogId: string,
  formData: FormData
): Promise<{ success: boolean; url?: string; error?: string }> {
  const supabase = await createClient()

  const file = formData.get('photo') as File
  if (!file) {
    return { success: false, error: 'No file provided' }
  }

  // Validate file type
  const allowedTypes = ['image/jpeg', 'image/png', 'image/webp', 'image/heic']
  if (!allowedTypes.includes(file.type)) {
    return { success: false, error: 'Invalid file type. Please upload a JPEG, PNG, or WebP image.' }
  }

  // Validate file size (max 5MB)
  const maxSize = 5 * 1024 * 1024
  if (file.size > maxSize) {
    return { success: false, error: 'File too large. Maximum size is 5MB.' }
  }

  // Generate unique filename
  const ext = file.name.split('.').pop()?.toLowerCase() || 'jpg'
  const filename = `${dogId}-${Date.now()}.${ext}`

  // Upload to Supabase Storage
  const { data: uploadData, error: uploadError } = await supabase.storage
    .from('dog-photos')
    .upload(filename, file, {
      cacheControl: '3600',
      upsert: true
    })

  if (uploadError) {
    console.error('[Photos] Upload failed:', uploadError)
    return { 
      success: false, 
      error: `Failed to upload photo: ${uploadError.message || 'Please try again.'}` 
    }
  }

  // Get public URL
  const { data: urlData } = supabase.storage
    .from('dog-photos')
    .getPublicUrl(filename)

  const photoUrl = urlData.publicUrl

  // Update dog record with photo URL
  const { error: updateError } = await supabase
    .from('dogs')
    .update({
      photo_url: photoUrl,
      updated_at: new Date().toISOString()
    })
    .eq('id', dogId)

  if (updateError) {
    console.error('[Photos] Update dog failed:', updateError)
    // Try to clean up uploaded file
    await supabase.storage.from('dog-photos').remove([filename])
    return { success: false, error: 'Failed to update dog record.' }
  }

  revalidatePath(`/dogs/${dogId}`)
  revalidatePath('/dogs')
  revalidatePath('/photos')

  return { success: true, url: photoUrl }
}

/**
 * Delete a dog's photo
 */
export async function deleteDogPhoto(
  dogId: string
): Promise<{ success: boolean; error?: string }> {
  const supabase = await createClient()

  // Get current photo URL
  const { data: dog, error: fetchError } = await supabase
    .from('dogs')
    .select('photo_url')
    .eq('id', dogId)
    .single()

  if (fetchError || !dog?.photo_url) {
    return { success: false, error: 'No photo to delete' }
  }

  // Extract filename from URL
  const url = new URL(dog.photo_url)
  const filename = url.pathname.split('/').pop()

  if (filename) {
    // Delete from storage
    await supabase.storage.from('dog-photos').remove([filename])
  }

  // Clear photo_url from dog record
  const { error: updateError } = await supabase
    .from('dogs')
    .update({
      photo_url: null,
      updated_at: new Date().toISOString()
    })
    .eq('id', dogId)

  if (updateError) {
    console.error('[Photos] Clear photo_url failed:', updateError)
    return { success: false, error: 'Failed to update dog record.' }
  }

  revalidatePath(`/dogs/${dogId}`)
  revalidatePath('/dogs')
  revalidatePath('/photos')

  return { success: true }
}

/**
 * Get all dogs with photos for the pin board
 */
export async function getDogsWithPhotos(): Promise<{
  id: string
  name: string
  breed: string | null
  photo_url: string
  customer_name: string | null
}[]> {
  const supabase = await createClient()

  const { data, error } = await supabase
    .from('dogs')
    .select(`
      id,
      name,
      breed,
      photo_url,
      customer:customers(name)
    `)
    .not('photo_url', 'is', null)
    .order('updated_at', { ascending: false })

  if (error) {
    console.error('[Photos] Fetch dogs with photos failed:', error)
    return []
  }

  return (data || []).map(dog => ({
    id: dog.id,
    name: dog.name,
    breed: dog.breed,
    photo_url: dog.photo_url!,
    customer_name: Array.isArray(dog.customer) ? dog.customer[0]?.name : (dog.customer as { name: string } | null)?.name || null
  }))
}

/**
 * Get ALL dogs for the upload dropdown (includes dogs without photos)
 */
export async function getAllDogsForUpload(): Promise<{
  id: string
  name: string
  customer_name: string | null
}[]> {
  const supabase = await createClient()

  const { data, error } = await supabase
    .from('dogs')
    .select(`
      id,
      name,
      customer:customers(name)
    `)
    .order('name', { ascending: true })

  if (error) {
    console.error('[Photos] Fetch all dogs failed:', error)
    return []
  }

  return (data || []).map(dog => ({
    id: dog.id,
    name: dog.name,
    customer_name: Array.isArray(dog.customer) ? dog.customer[0]?.name : (dog.customer as { name: string } | null)?.name || null
  }))
}
</file>

<file path="lib/stripe/client.ts">
import Stripe from 'stripe';

// Initialize Stripe with the secret key
const stripeSecretKey = process.env.STRIPE_SECRET_KEY;

// Create a mock Stripe client for development when key is missing
const createStripeClient = () => {
  if (!stripeSecretKey) {
    console.warn('STRIPE_SECRET_KEY is not set. Using mock Stripe client.');
    // Return a mock client that throws informative errors
    return {
      customers: {
        create: () => Promise.reject(new Error('STRIPE_SECRET_KEY is not set')),
      },
      checkout: {
        sessions: {
          create: () => Promise.reject(new Error('STRIPE_SECRET_KEY is not set')),
        },
      },
      subscriptions: {
        retrieve: () => Promise.reject(new Error('STRIPE_SECRET_KEY is not set')),
      },
      webhooks: {
        constructEvent: () => { throw new Error('STRIPE_WEBHOOK_SECRET is not set'); },
      },
      billingPortal: {
        sessions: {
          create: () => Promise.reject(new Error('STRIPE_SECRET_KEY is not set')),
        },
      },
    } as any;
  }

  return new Stripe(stripeSecretKey, {
    apiVersion: '2025-02-24.acacia' as const as any,
    typescript: true,
  });
};

export const stripe = createStripeClient();

// Helper to get or create Stripe customer for a user
export async function getOrCreateStripeCustomer(userId: string, email?: string) {
  const { createClient } = await import('@/utils/supabase/server');
  const supabase = await createClient();
  
  // Check if user already has a Stripe customer ID in the database
  const { data: existingSubscription } = await supabase
    .from('user_subscriptions')
    .select('stripe_customer_id')
    .eq('user_id', userId)
    .single();

  if (existingSubscription?.stripe_customer_id) {
    return existingSubscription.stripe_customer_id;
  }

  // Create new Stripe customer
  const customer = await stripe.customers.create({
    email,
    metadata: {
      userId,
    },
  });

  // Store the Stripe customer ID in the database
  await supabase
    .from('user_subscriptions')
    .upsert({
      user_id: userId,
      stripe_customer_id: customer.id,
      updated_at: new Date().toISOString(),
    }, {
      onConflict: 'user_id',
    });

  return customer.id;
}
</file>

<file path="tsconfig.json">
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": [
      "dom",
      "dom.iterable",
      "esnext"
    ],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "react-jsx",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": [
        "./*"
      ]
    }
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx",
    ".next/types/**/*.ts",
    ".next/dev/types/**/*.ts",
    "**/*.mts"
  ],
  "exclude": [
    "node_modules"
  ]
}
</file>

<file path="app/(app)/checkout/[appointmentId]/page.tsx">
'use client'

import { useState, useEffect, useCallback } from 'react'
import { useRouter, useParams } from 'next/navigation'
import { Card } from '@/components/ui/Card'
import { Button } from '@/components/ui/Button'
import { ArrowLeft, Check, Printer, Mail, Calendar, MessageSquare, AlertCircle } from 'lucide-react'
import Link from 'next/link'
import { completeCheckout } from '@/lib/actions/checkout'
import { getAppointmentForCheckout, markAppointmentCompleted } from '@/lib/actions/appointments'
import { safeParseDate } from '@/lib/utils/date'

// Service prices in cents - centralized pricing
const SERVICE_PRICES: Record<string, number> = {
  'Full Groom': 8500,
  'Bath & Brush': 4500,
  'Nail Trim': 2500,
  'De-shedding': 6500,
  'Teeth Cleaning': 3500,
  'Ear Cleaning': 2000,
}

interface AppointmentData {
  id: string
  scheduled_at: string
  services: string[]
  notes: string | null
  status: string
  customer: { id: string; name: string; email: string | null; phone: string | null } | null
  dog: { id: string; name: string; breed: string | null } | null
}

type Step = 'review' | 'payment' | 'receipt'

export default function CheckoutPage() {
  const router = useRouter()
  const params = useParams()
  const appointmentId = params.appointmentId as string

  // Core state
  const [appointment, setAppointment] = useState<AppointmentData | null>(null)
  const [loading, setLoading] = useState(true)
  const [error, setError] = useState<string | null>(null)
  const [step, setStep] = useState<Step>('review')
  const [isProcessing, setIsProcessing] = useState(false)

  // Payment form state
  const [paymentMethod, setPaymentMethod] = useState<'cash' | 'card'>('card')
  const [scheduleNext, setScheduleNext] = useState(true)
  const [nextDate, setNextDate] = useState('')
  const [nextTime, setNextTime] = useState('10:00')
  const [reminderWeeks, setReminderWeeks] = useState(6)

  // Receipt state
  const [receiptNumber, setReceiptNumber] = useState('')
  const [emailSent, setEmailSent] = useState(false)

  // Calculate default next date
  const getDefaultNextDate = useCallback((weeks: number) => {
    const date = new Date()
    date.setDate(date.getDate() + weeks * 7)
    return date.toISOString().split('T')[0]
  }, [])

  // Load appointment data
  useEffect(() => {
    let mounted = true

    async function loadAppointment() {
      try {
        setError(null)
        const data = await getAppointmentForCheckout(appointmentId)

        if (!mounted) return

        if (!data) {
          setError('Appointment not found')
          setLoading(false)
          return
        }

        // Validate appointment has required data
        if (!data.customer?.id || !data.dog?.id) {
          setError('Appointment is missing customer or dog information')
          setLoading(false)
          return
        }

        // Check if already completed
        if (data.status === 'completed') {
          setError('This appointment has already been completed')
          setLoading(false)
          return
        }

        if (data.status === 'cancelled') {
          setError('This appointment was cancelled')
          setLoading(false)
          return
        }

  

        setAppointment(data)
        setNextDate(getDefaultNextDate(reminderWeeks))
        setLoading(false)
      } catch (err) {
        if (!mounted) return
        console.error('Failed to load appointment:', err)
        setError('Failed to load appointment data')
        setLoading(false)
      }
    }

    loadAppointment()

    return () => {
      mounted = false
    }
  }, [appointmentId, getDefaultNextDate, reminderWeeks])

  // Calculate total - handle empty services array
  const totalCents = (appointment?.services || []).reduce((sum, service) => {
    return sum + (SERVICE_PRICES[service] || 0)
  }, 0)

  const formatCurrency = (cents: number) => {
    return `$${(cents / 100).toFixed(2)}`
  }

  const formatTime12h = (time24: string) => {
    const hour = parseInt(time24.split(':')[0])
    const ampm = hour >= 12 ? 'PM' : 'AM'
    const hour12 = hour === 0 ? 12 : hour > 12 ? hour - 12 : hour
    return `${hour12}:00 ${ampm}`
  }

  // Step 1: Mark service complete
  const handleCompleteService = async () => {
    if (isProcessing) return

    setIsProcessing(true)
    setError(null)

    try {
      const result = await markAppointmentCompleted(appointmentId)
      if (result.success) {
        setStep('payment')
      } else {
        setError(result.error || 'Failed to complete appointment')
      }
    } catch (err) {
      console.error('Error completing service:', err)
      setError('An unexpected error occurred')
    } finally {
      setIsProcessing(false)
    }
  }

  // Step 2: Process payment
  const handleProcessPayment = async () => {
    if (isProcessing) return
    if (!appointment?.customer?.id || !appointment?.dog?.id) {
      setError('Missing customer or dog information')
      return
    }

    setIsProcessing(true)
    setError(null)

    try {
      // Build next appointment data
      let reminderDate: string | undefined
      let nextAppointment: { scheduledAt: string; services: string[] } | undefined

      if (scheduleNext && nextDate && nextTime) {
        const parsedNextDate = safeParseDate(`${nextDate}T${nextTime}:00`)
        if (parsedNextDate) {
          nextAppointment = {
            scheduledAt: parsedNextDate.toISOString(),
            services: appointment.services || [],
          }
          // Reminder 1 week before
          const reminder = new Date(parsedNextDate)
          reminder.setDate(reminder.getDate() - 7)
          reminderDate = reminder.toISOString().split('T')[0]
        }
      }

      const result = await completeCheckout({
        customerId: appointment.customer.id,
        dogId: appointment.dog.id,
        completedAppointmentId: appointmentId,
        services: appointment.services || [],
        amountCents: totalCents,
        nextAppointment,
        reminderDate,
      })

      if (result.success) {
        setReceiptNumber(result.receiptNumber || `GG-${Date.now()}`)
        setStep('receipt')
      } else {
        setError(result.error || 'Payment processing failed')
      }
    } catch (err) {
      console.error('Error processing payment:', err)
      setError('An unexpected error occurred during payment')
    } finally {
      setIsProcessing(false)
    }
  }

  const handlePrint = () => {
    window.print()
  }

  const handleEmailReceipt = async () => {
    if (!appointment?.customer?.email) {
      setError('No email address on file')
      return
    }
    // In production, this would call an API to send the email
    setEmailSent(true)
  }

  // Loading state
  if (loading) {
    return (
      <div className="flex items-center justify-center min-h-[400px]">
        <div className="text-center">
          <div className="w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
          <p className="text-gray-500">Loading appointment...</p>
        </div>
      </div>
    )
  }

  // Error state - no appointment
  if (error && !appointment) {
    return (
      <div className="space-y-6 max-w-2xl mx-auto">
        <Card>
          <div className="text-center py-12">
            <AlertCircle className="w-12 h-12 text-red-500 mx-auto mb-4" />
            <p className="text-gray-900 font-medium mb-2">Cannot Complete Checkout</p>
            <p className="text-gray-500 mb-6">{error}</p>
            <Button href="/calendar">Back to Calendar</Button>
          </div>
        </Card>
      </div>
    )
  }

  // No appointment found
  if (!appointment) {
    return (
      <div className="space-y-6 max-w-2xl mx-auto">
        <Card>
          <div className="text-center py-12">
            <p className="text-gray-500 mb-4">Appointment not found</p>
            <Button href="/calendar">Back to Calendar</Button>
          </div>
        </Card>
      </div>
    )
  }

  const services = appointment.services || []

  return (
    <div className="space-y-6 max-w-2xl mx-auto">
      {/* Header */}
      <div className="flex items-center gap-4">
        <Link href="/calendar">
          <Button variant="ghost" size="sm">
            <ArrowLeft className="w-4 h-4 mr-2" />
            Back
          </Button>
        </Link>
        <div>
          <h1 className="text-2xl font-bold text-gray-900">Checkout</h1>
          <p className="text-gray-500">
            {appointment.dog?.name || 'Unknown Dog'} - {appointment.customer?.name || 'Unknown Customer'}
          </p>
        </div>
      </div>

      {/* Error Banner */}
      {error && (
        <div className="bg-red-50 border border-red-200 rounded-lg p-4 flex items-center gap-3">
          <AlertCircle className="w-5 h-5 text-red-500 flex-shrink-0" />
          <p className="text-red-700">{error}</p>
          <button onClick={() => setError(null)} className="ml-auto text-red-500 hover:text-red-700">
            &times;
          </button>
        </div>
      )}

      {/* Progress Steps */}
      <div className="flex items-center justify-center gap-2">
        {(['review', 'payment', 'receipt'] as Step[]).map((s, i) => {
          const stepIndex = ['review', 'payment', 'receipt'].indexOf(step)
          const isComplete = stepIndex > i
          const isCurrent = step === s

          return (
            <div key={s} className="flex items-center">
              <div className={`
                w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-colors
                ${isCurrent ? 'bg-blue-600 text-white' :
                  isComplete ? 'bg-green-500 text-white' : 'bg-gray-200 text-gray-500'}
              `}>
                {isComplete ? <Check className="w-4 h-4" /> : i + 1}
              </div>
              {i < 2 && <div className={`w-12 h-0.5 mx-1 ${isComplete ? 'bg-green-500' : 'bg-gray-200'}`} />}
            </div>
          )
        })}
      </div>

      {/* Step 1: Review Services */}
      {step === 'review' && (
        <Card>
          <h2 className="text-lg font-semibold mb-4">Review Services</h2>

          {services.length > 0 ? (
            <div className="space-y-3 mb-6">
              {services.map((service) => (
                <div key={service} className="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                  <span className="font-medium">{service}</span>
                  <span className="text-gray-600">{formatCurrency(SERVICE_PRICES[service] || 0)}</span>
                </div>
              ))}
            </div>
          ) : (
            <div className="p-4 bg-yellow-50 rounded-lg mb-6">
              <p className="text-yellow-800">No services recorded for this appointment</p>
            </div>
          )}

          <div className="border-t pt-4 mb-6">
            <div className="flex justify-between items-center text-lg font-bold">
              <span>Total</span>
              <span>{formatCurrency(totalCents)}</span>
            </div>
          </div>

          {appointment.notes && (
            <div className="mb-6 p-3 bg-yellow-50 rounded-lg">
              <p className="text-sm text-yellow-800">
                <strong>Notes:</strong> {appointment.notes}
              </p>
            </div>
          )}

          <Button
            onClick={handleCompleteService}
            disabled={isProcessing}
            className="w-full bg-green-600 hover:bg-green-700 disabled:bg-green-400"
          >
            <Check className="w-4 h-4 mr-2" />
            {isProcessing ? 'Processing...' : 'Mark Service Complete'}
          </Button>
        </Card>
      )}

      {/* Step 2: Payment */}
      {step === 'payment' && (
        <Card>
          <h2 className="text-lg font-semibold mb-4">Payment</h2>

          {/* Payment Method */}
          <div className="mb-6">
            <label className="block text-sm font-medium text-gray-700 mb-2">Payment Method</label>
            <div className="grid grid-cols-2 gap-3">
              <button
                type="button"
                onClick={() => setPaymentMethod('card')}
                className={`p-4 border-2 rounded-xl text-center transition-all ${
                  paymentMethod === 'card' ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-gray-300'
                }`}
              >
                <span className="text-2xl mb-1 block">üí≥</span>
                <span className="font-medium">Card</span>
              </button>
              <button
                type="button"
                onClick={() => setPaymentMethod('cash')}
                className={`p-4 border-2 rounded-xl text-center transition-all ${
                  paymentMethod === 'cash' ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-gray-300'
                }`}
              >
                <span className="text-2xl mb-1 block">üíµ</span>
                <span className="font-medium">Cash</span>
              </button>
            </div>
          </div>

          {/* Amount */}
          <div className="mb-6 p-4 bg-gray-50 rounded-xl">
            <div className="flex justify-between items-center text-xl font-bold">
              <span>Amount Due</span>
              <span className="text-green-600">{formatCurrency(totalCents)}</span>
            </div>
          </div>

          {/* Schedule Next Appointment */}
          <div className="mb-6">
            <label className="flex items-center gap-3 mb-4 cursor-pointer">
              <input
                type="checkbox"
                checked={scheduleNext}
                onChange={(e) => setScheduleNext(e.target.checked)}
                className="w-5 h-5 rounded text-blue-600 cursor-pointer"
              />
              <span className="font-medium">Schedule Next Appointment</span>
            </label>

            {scheduleNext && (
              <div className="pl-8 space-y-4">
                <div>
                  <label className="block text-sm text-gray-600 mb-1">Return in weeks</label>
                  <select
                    value={reminderWeeks}
                    onChange={(e) => {
                      const weeks = parseInt(e.target.value)
                      setReminderWeeks(weeks)
                      setNextDate(getDefaultNextDate(weeks))
                    }}
                    className="w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-300"
                  >
                    <option value={4}>4 weeks</option>
                    <option value={6}>6 weeks</option>
                    <option value={8}>8 weeks</option>
                    <option value={12}>12 weeks</option>
                  </select>
                </div>

                <div className="grid grid-cols-2 gap-3">
                  <div>
                    <label className="block text-sm text-gray-600 mb-1">Date</label>
                    <input
                      type="date"
                      value={nextDate}
                      onChange={(e) => setNextDate(e.target.value)}
                      min={new Date().toISOString().split('T')[0]}
                      className="w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-300"
                    />
                  </div>
                  <div>
                    <label className="block text-sm text-gray-600 mb-1">Time</label>
                    <select
                      value={nextTime}
                      onChange={(e) => setNextTime(e.target.value)}
                      className="w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-300"
                    >
                      <option value="08:00">8:00 AM</option>
                      <option value="08:30">8:30 AM</option>
                      <option value="09:00">9:00 AM</option>
                      <option value="09:30">9:30 AM</option>
                      <option value="10:00">10:00 AM</option>
                      <option value="10:30">10:30 AM</option>
                      <option value="11:00">11:00 AM</option>
                      <option value="11:30">11:30 AM</option>
                      <option value="12:00">12:00 PM</option>
                      <option value="12:30">12:30 PM</option>
                      <option value="13:00">1:00 PM</option>
                      <option value="13:30">1:30 PM</option>
                      <option value="14:00">2:00 PM</option>
                      <option value="14:30">2:30 PM</option>
                      <option value="15:00">3:00 PM</option>
                      <option value="15:30">3:30 PM</option>
                      <option value="16:00">4:00 PM</option>
                      <option value="16:30">4:30 PM</option>
                      <option value="17:00">5:00 PM</option>
                    </select>
                  </div>
                </div>

                <div className="flex items-center gap-2 text-sm text-blue-600">
                  <MessageSquare className="w-4 h-4" />
                  <span>SMS reminder will be sent 1 week before</span>
                </div>
              </div>
            )}
          </div>

          <Button
            onClick={handleProcessPayment}
            disabled={isProcessing}
            className="w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400"
          >
            {isProcessing ? 'Processing...' : `Complete Payment - ${formatCurrency(totalCents)}`}
          </Button>
        </Card>
      )}

      {/* Step 3: Receipt */}
      {step === 'receipt' && (
        <div className="space-y-4">
          <Card className="print:shadow-none">
            <div className="text-center mb-6">
              <div className="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <Check className="w-8 h-8 text-green-600" />
              </div>
              <h2 className="text-xl font-bold text-gray-900">Payment Complete!</h2>
              <p className="text-gray-500">Receipt #{receiptNumber}</p>
            </div>

            <div className="border-t border-b py-4 my-4">
              <div className="text-center mb-4">
                <h3 className="font-bold text-lg">GroomGroove</h3>
                <p className="text-sm text-gray-500">Professional Dog Grooming</p>
              </div>

              <div className="space-y-2 text-sm">
                <div className="flex justify-between">
                  <span className="text-gray-500">Date</span>
                  <span>{new Date().toLocaleDateString()}</span>
                </div>
                <div className="flex justify-between">
                  <span className="text-gray-500">Customer</span>
                  <span>{appointment.customer?.name || 'N/A'}</span>
                </div>
                <div className="flex justify-between">
                  <span className="text-gray-500">Dog</span>
                  <span>{appointment.dog?.name || 'N/A'}</span>
                </div>
              </div>

              <div className="mt-4 pt-4 border-t space-y-2">
                {services.map((service) => (
                  <div key={service} className="flex justify-between text-sm">
                    <span>{service}</span>
                    <span>{formatCurrency(SERVICE_PRICES[service] || 0)}</span>
                  </div>
                ))}
              </div>

              <div className="mt-4 pt-4 border-t">
                <div className="flex justify-between font-bold">
                  <span>Total Paid</span>
                  <span>{formatCurrency(totalCents)}</span>
                </div>
                <div className="flex justify-between text-sm text-gray-500 mt-1">
                  <span>Payment Method</span>
                  <span className="capitalize">{paymentMethod}</span>
                </div>
              </div>

              {scheduleNext && nextDate && (
                <div className="mt-4 pt-4 border-t">
                  <div className="flex items-center gap-2 text-blue-600">
                    <Calendar className="w-4 h-4" />
                    <span className="font-medium">Next Appointment</span>
                  </div>
                  <p className="text-sm mt-1">
                    {(safeParseDate(nextDate + 'T12:00:00'))?.toLocaleDateString('en-US', {
                      weekday: 'long',
                      month: 'long',
                      day: 'numeric',
                      year: 'numeric'
                    }) ?? 'Invalid date'} at {formatTime12h(nextTime)}
                  </p>
                  <p className="text-xs text-gray-500 mt-1">
                    Confirmation SMS will be sent. Reminder 1 week before.
                  </p>
                </div>
              )}
            </div>

            <p className="text-center text-sm text-gray-500">
              Thank you for choosing GroomGroove!
            </p>
          </Card>

          {/* Action Buttons */}
          <div className="grid grid-cols-2 gap-3 print:hidden">
            <Button onClick={handlePrint} variant="secondary" className="flex items-center justify-center">
              <Printer className="w-4 h-4 mr-2" />
              Print Receipt
            </Button>
            <Button
              onClick={handleEmailReceipt}
              variant="secondary"
              disabled={!appointment.customer?.email || emailSent}
              className="flex items-center justify-center"
            >
              <Mail className="w-4 h-4 mr-2" />
              {emailSent ? 'Sent!' : appointment.customer?.email ? 'Email Receipt' : 'No Email'}
            </Button>
          </div>

          <Button href="/calendar" className="w-full print:hidden bg-blue-600 hover:bg-blue-700">
            Back to Calendar
          </Button>
        </div>
      )}
    </div>
  )
}
</file>

<file path="app/(app)/dogs/[id]/page.tsx">
import { notFound } from 'next/navigation'
import { Card } from '@/components/ui/Card'
import { Button } from '@/components/ui/Button'
import { Badge } from '@/components/ui/Badge'
import { ArrowLeft, Calendar, Clock, CheckCircle } from 'lucide-react'
import Link from 'next/link'
import { getDogDetail } from '@/lib/actions/dogs'
import { DogQuickActions, DogPhoto, EditableGroomingPreferences, EditableGeneralNotes } from './DogDetailClient'
import { safeParseDate } from '@/lib/utils/date'

interface DogDetailPageProps {
  params: Promise<{ id: string }>
}

function formatDate(isoString: string): string {
  const date = safeParseDate(isoString)
  if (!date) return 'N/A'
  return date.toLocaleDateString('en-US', {
    month: 'short',
    day: 'numeric',
    year: 'numeric'
  })
}

function formatTime(isoString: string): string {
  const date = safeParseDate(isoString)
  if (!date) return 'N/A'
  return date.toLocaleTimeString('en-US', {
    hour: 'numeric',
    minute: '2-digit',
    hour12: true
  })
}

export default async function DogDetailPage({ params }: DogDetailPageProps) {
  const { id } = await params
  const dog = await getDogDetail(id)

  if (!dog) {
    notFound()
  }

  return (
    <div className="space-y-6">
      <div className="flex items-center justify-between">
        <div className="flex items-center gap-4">
          <Link href="/dogs">
            <Button variant="ghost" size="sm">
              <ArrowLeft className="w-4 h-4 mr-2" />
              Back to Dogs
            </Button>
          </Link>
          <div>
            <h1 className="text-2xl font-bold text-gray-900">{dog.name}</h1>
            <p className="text-gray-500">{dog.breed || 'Unknown breed'}</p>
          </div>
        </div>
        <div className="flex gap-3">
          <Link href="/calendar/new">
            <Button variant="secondary">
              <Calendar className="w-4 h-4 mr-2" />
              Book Appointment
            </Button>
          </Link>
        </div>
      </div>

      <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
        {/* Left Column - Dog Info */}
        <div className="lg:col-span-2 space-y-6">
          <Card>
            <div className="p-6">
              <div className="flex items-start gap-6">
                <DogPhoto
                  dogId={dog.id}
                  dogName={dog.name}
                  photoUrl={dog.photo_url}
                  isDemo={dog.id.startsWith('demo-dog-')}
                />
                <div className="flex-1">
                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <p className="text-sm text-gray-500">Owner</p>
                      <p className="font-medium text-gray-900">{dog.customer?.name || 'Unknown'}</p>
                    </div>
                    {dog.weight && (
                      <div>
                        <p className="text-sm text-gray-500">Weight</p>
                        <p className="font-medium text-gray-900">{dog.weight} lbs</p>
                      </div>
                    )}
                    {dog.customer?.phone && (
                      <div>
                        <p className="text-sm text-gray-500">Phone</p>
                        <p className="font-medium text-gray-900">{dog.customer.phone}</p>
                      </div>
                    )}
                    {dog.customer?.email && (
                      <div>
                        <p className="text-sm text-gray-500">Email</p>
                        <p className="font-medium text-gray-900">{dog.customer.email}</p>
                      </div>
                    )}
                    <div>
                      <p className="text-sm text-gray-500">Total Visits</p>
                      <p className="font-medium text-gray-900">{dog.history.length}</p>
                    </div>
                    {dog.history.length > 0 && (
                      <div>
                        <p className="text-sm text-gray-500">Last Visit</p>
                        <p className="font-medium text-gray-900">{formatDate(dog.history[0].scheduled_at)}</p>
                      </div>
                    )}
                  </div>
                </div>
              </div>
            </div>
          </Card>

          {/* Grooming Preferences - Editable */}
          <EditableGroomingPreferences
            dogId={dog.id}
            initialPreferences={dog.grooming_preferences}
            isDemo={dog.id.startsWith('demo-dog-')}
          />

          {/* General Notes - Editable */}
          <EditableGeneralNotes
            dogId={dog.id}
            dogName={dog.name}
            initialNotes={dog.notes}
            isDemo={dog.id.startsWith('demo-dog-')}
          />

          {/* Grooming History */}
          <Card>
            <div className="p-6">
              <div className="flex items-center justify-between mb-4">
                <h3 className="font-semibold text-gray-900">Grooming History</h3>
                <span className="text-sm text-gray-500">{dog.history.length} visits</span>
              </div>
              {dog.history.length > 0 ? (
                <div className="space-y-3">
                  {dog.history.map((appt) => (
                    <div key={appt.id} className="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                      <div className="flex items-center gap-4">
                        {appt.status === 'completed' ? (
                          <div className="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                            <CheckCircle className="w-5 h-5 text-green-600" />
                          </div>
                        ) : (
                          <div className="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                            <Clock className="w-5 h-5 text-blue-600" />
                          </div>
                        )}
                        <div>
                          <p className="font-medium text-gray-900">
                            {appt.services?.join(', ') || 'Grooming'}
                          </p>
                          <p className="text-sm text-gray-500">
                            {formatDate(appt.scheduled_at)} at {formatTime(appt.scheduled_at)}
                          </p>
                          {appt.notes && (
                            <p className="text-xs text-gray-400 mt-1">{appt.notes}</p>
                          )}
                        </div>
                      </div>
                      <Badge variant={appt.status === 'completed' ? 'success' : appt.status === 'cancelled' ? 'warning' : 'info'}>
                        {appt.status.replace('_', ' ')}
                      </Badge>
                    </div>
                  ))}
                </div>
              ) : (
                <div className="text-center py-8">
                  <Clock className="w-12 h-12 mx-auto mb-3 text-gray-300" />
                  <p className="text-gray-500">No grooming history yet</p>
                  <Link href="/calendar/new" className="inline-block mt-3">
                    <Button variant="secondary" size="sm">
                      <Calendar className="w-4 h-4 mr-2" />
                      Book First Appointment
                    </Button>
                  </Link>
                </div>
              )}
            </div>
          </Card>
        </div>

        {/* Right Column - Quick Actions */}
        <div className="space-y-6">
          <DogQuickActions
            dogId={dog.id}
            dogName={dog.name}
            customerPhone={dog.customer?.phone || null}
            photoUrl={dog.photo_url}
            groomingPreferences={dog.grooming_preferences}
            isDemo={dog.id.startsWith('demo-dog-')}
          />
        </div>
      </div>
    </div>
  )
}
</file>

<file path="app/(auth)/login/page.tsx">
'use client'

import { useState } from 'react'
import Image from 'next/image'
import { createClient } from '@/utils/supabase/client'
import { useRouter } from 'next/navigation'
import Link from 'next/link'

export default function LoginPage() {
  const [email, setEmail] = useState('')
  const [password, setPassword] = useState('')
  const [loading, setLoading] = useState(false)
  const [error, setError] = useState('')
  const router = useRouter()

  const handleLogin = async (e: React.FormEvent) => {
    e.preventDefault()
    setLoading(true)
    setError('')

    const supabase = createClient()
    const { error } = await supabase.auth.signInWithPassword({
      email,
      password,
    })

    if (error) {
      setError(error.message)
      setLoading(false)
    } else {
      router.push('/')
      router.refresh()
    }
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center py-12 px-4">
      <div className="max-w-md w-full">
        <div className="text-center mb-8">
          <div className="flex justify-center mb-4">
            <Image
              src="/logo.png"
              alt="Groom Groove"
              width={200}
              height={140}
              priority
              className="object-contain"
            />
          </div>
          <p className="text-lg text-gray-600">Sign in to your account</p>
        </div>

        <div className="bg-white rounded-lg shadow-md p-8">
          <form onSubmit={handleLogin} className="space-y-6">
            <div>
              <label htmlFor="email" className="block text-sm font-medium text-gray-700">
                Email
              </label>
              <input
                id="email"
                type="email"
                required
                className="mt-1 block w-full rounded-md border border-gray-300 p-3 text-gray-900 shadow-sm focus:border-blue-500 focus:ring-blue-500 min-h-[44px]"
                value={email}
                onChange={(e) => setEmail(e.target.value)}
              />
            </div>

            <div>
              <label htmlFor="password" className="block text-sm font-medium text-gray-700">
                Password
              </label>
              <input
                id="password"
                type="password"
                required
                className="mt-1 block w-full rounded-md border border-gray-300 p-3 text-gray-900 shadow-sm focus:border-blue-500 focus:ring-blue-500 min-h-[44px]"
                value={password}
                onChange={(e) => setPassword(e.target.value)}
              />
            </div>

            {error && (
              <div className="text-red-600 text-sm text-center bg-red-50 p-3 rounded-md">
                {error}
              </div>
            )}

            <button
              type="submit"
              disabled={loading}
              className="w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 min-h-[44px]"
            >
              {loading ? 'Signing in...' : 'Sign In'}
            </button>
          </form>

          <div className="mt-6 text-center">
            <p className="text-sm text-gray-600">
              Don&apos;t have an account?{' '}
              <Link href="/signup" className="font-medium text-blue-600 hover:text-blue-500">
                Sign up
              </Link>
            </p>
          </div>
        </div>
      </div>
    </div>
  )
}
</file>

<file path="app/(auth)/signup/page.tsx">
'use client'

import { useState } from 'react'
import Image from 'next/image'
import { createClient } from '@/utils/supabase/client'
import { useRouter } from 'next/navigation'
import Link from 'next/link'

export default function SignupPage() {
  const [email, setEmail] = useState('')
  const [password, setPassword] = useState('')
  const [loading, setLoading] = useState(false)
  const [error, setError] = useState('')
  const [success, setSuccess] = useState(false)
  const router = useRouter()

  const handleSignup = async (e: React.FormEvent) => {
    e.preventDefault()
    setLoading(true)
    setError('')
    setSuccess(false)

    const supabase = createClient()
    const { error } = await supabase.auth.signUp({
      email,
      password,
      options: {
        emailRedirectTo: `${window.location.origin}/pricing`,
      },
    })

    if (error) {
      setError(error.message)
      setLoading(false)
    } else {
      setSuccess(true)
      setLoading(false)
      // Redirect to pricing page after signup
      setTimeout(() => {
        router.push('/pricing')
        router.refresh()
      }, 2000)
    }
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center py-12 px-4">
      <div className="max-w-md w-full">
        <div className="text-center mb-8">
          <div className="flex justify-center mb-4">
            <Image
              src="/logo.png"
              alt="Groom Groove"
              width={200}
              height={140}
              priority
              className="object-contain"
            />
          </div>
          <p className="text-lg text-gray-600">Create your account</p>
        </div>

        <div className="bg-white rounded-lg shadow-md p-8">
          <form onSubmit={handleSignup} className="space-y-6">
            <div>
              <label htmlFor="email" className="block text-sm font-medium text-gray-700">
                Email
              </label>
              <input
                id="email"
                type="email"
                required
                className="mt-1 block w-full rounded-md border border-gray-300 p-3 text-gray-900 shadow-sm focus:border-blue-500 focus:ring-blue-500 min-h-[44px]"
                value={email}
                onChange={(e) => setEmail(e.target.value)}
              />
            </div>

            <div>
              <label htmlFor="password" className="block text-sm font-medium text-gray-700">
                Password
              </label>
              <input
                id="password"
                type="password"
                required
                minLength={6}
                className="mt-1 block w-full rounded-md border border-gray-300 p-3 text-gray-900 shadow-sm focus:border-blue-500 focus:ring-blue-500 min-h-[44px]"
                value={password}
                onChange={(e) => setPassword(e.target.value)}
              />
              <p className="mt-1 text-xs text-gray-500">Minimum 6 characters</p>
            </div>

            {error && (
              <div className="text-red-600 text-sm text-center bg-red-50 p-3 rounded-md">
                {error}
              </div>
            )}

            {success && (
              <div className="text-green-600 text-sm text-center bg-green-50 p-3 rounded-md">
                Account created! Redirecting...
              </div>
            )}

            <button
              type="submit"
              disabled={loading}
              className="w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 min-h-[44px]"
            >
              {loading ? 'Creating account...' : 'Sign Up'}
            </button>
          </form>

          <div className="mt-6 text-center">
            <p className="text-sm text-gray-600">
              Already have an account?{' '}
              <Link href="/login" className="font-medium text-blue-600 hover:text-blue-500">
                Sign in
              </Link>
            </p>
          </div>
        </div>
      </div>
    </div>
  )
}
</file>

<file path="components/dashboard/TodayAppointments.tsx">
"use client";

import { useState } from "react";
import { useRouter } from "next/navigation";
import { createClient } from "@/utils/supabase/client";
import { format, isValid } from "date-fns";
import { safeParseDate } from "@/lib/utils/date";
import { Check, Clock, Play, XCircle } from "lucide-react";

// --- Internal Row Component ---
function AppointmentRow({ appointment }: { appointment: any }) {
  const router = useRouter();
  const supabase = createClient();
  const [status, setStatus] = useState(appointment.status);
  const [isLoading, setIsLoading] = useState(false);

  // Safe Date Formatting
  const dateObj = safeParseDate(appointment.scheduled_at);
  const timeString = dateObj && isValid(dateObj) ? format(dateObj, "h:mm a") : "Time N/A";

  const handleStatusUpdate = async (newStatus: string) => {
    if (isLoading) return;
    setIsLoading(true);
    
    // Optimistic Update
    setStatus(newStatus);

    try {
      const { error } = await supabase
        .from("appointments")
        .update({ status: newStatus })
        .eq("id", appointment.id);

      if (error) throw error;
      
      router.refresh(); // Refresh to update the "Next Up" banner
    } catch (error) {
      console.error(error);
      alert("Update failed.");
      setStatus(appointment.status); // Revert on error
    } finally {
      setIsLoading(false);
    }
  };

  // Status Colors & Icons
  const getStatusColor = (s: string) => {
    switch(s) {
      case 'confirmed': return 'bg-blue-100 text-blue-700 border-blue-200';
      case 'in_progress': return 'bg-orange-100 text-orange-700 border-orange-200';
      case 'completed': return 'bg-green-100 text-green-700 border-green-200';
      case 'cancelled': return 'bg-red-50 text-red-500 border-red-100';
      default: return 'bg-gray-100 text-gray-600 border-gray-200';
    }
  };

  return (
    <div className="flex items-center justify-between p-4 bg-white border border-gray-100 rounded-xl mb-3 shadow-sm hover:shadow-md transition-shadow">
      <div className="flex items-center gap-6">
        {/* TIME */}
        <div className="text-gray-900 font-bold text-lg w-20 text-center bg-gray-50 p-2 rounded-lg border border-gray-200">
          {timeString}
        </div>

        {/* DETAILS */}
        <div>
          <h3 className="font-bold text-gray-900 text-lg">{appointment.dog?.name || "Unknown Dog"}</h3>
          <p className="text-sm text-gray-500">{appointment.customer?.name || "Unknown Owner"} ‚Ä¢ {appointment.service_type || "Grooming"}</p>
          
          {/* BEHAVIOR TAGS */}
          <div className="flex gap-2 mt-1">
             {appointment.dog?.grooming_preferences?.behavior_notes && (
               <span className="text-xs px-2 py-0.5 bg-yellow-100 text-yellow-800 rounded-full font-medium">
                 ‚ö†Ô∏è {appointment.dog.grooming_preferences.behavior_notes}
               </span>
             )}
          </div>
        </div>
      </div>

      {/* STATUS DROPDOWN */}
      <div className="relative">
        <select
          value={status}
          onChange={(e) => handleStatusUpdate(e.target.value)}
          disabled={isLoading}
          className={`appearance-none pl-4 pr-10 py-2 rounded-lg font-bold text-sm border-2 cursor-pointer focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-purple-500 ${getStatusColor(status)}`}
        >
          <option value="pending">Pending</option>
          <option value="confirmed">Confirmed</option>
          <option value="in_progress">‚úÇÔ∏è Grooming</option>
          <option value="completed">‚úÖ Done</option>
          <option value="cancelled">‚ùå Cancel</option>
        </select>
        
        {/* Chevron Icon Override */}
        <div className="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-current opacity-50">
          <svg className="h-4 w-4 fill-current" viewBox="0 0 20 20"><path d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"/></svg>
        </div>
      </div>
    </div>
  );
}

// --- Main List ---
export default function TodayAppointments({ appointments }: { appointments: any[] }) {
  if (!appointments || appointments.length === 0) {
    return <div className="text-gray-500 italic">No active appointments.</div>;
  }

  return (
    <div className="space-y-1">
      {appointments.map((appt) => (
        <AppointmentRow key={appt.id} appointment={appt} />
      ))}
    </div>
  );
}
</file>

<file path="components/ui/Button.tsx">
'use client'

import { cn } from '@/lib/utils'
import Link from 'next/link'

interface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: 'primary' | 'secondary' | 'ghost' | 'outline'
  size?: 'sm' | 'md' | 'lg'
  href?: string
  children: React.ReactNode
}

const baseStyles = 'inline-flex items-center justify-center font-medium rounded-xl transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-rose-500/20 focus:ring-offset-1 disabled:opacity-50 disabled:cursor-not-allowed'

const variantStyles = {
  primary: 'bg-rose-500 text-white hover:bg-rose-600 shadow-sm hover:shadow active:bg-rose-700',
  secondary: 'bg-white text-gray-700 border border-gray-200 hover:bg-gray-50 hover:border-gray-300',
  ghost: 'text-gray-600 hover:text-gray-900 hover:bg-gray-100',
  outline: 'bg-transparent border border-rose-500 text-rose-500 hover:bg-rose-50',
}

const sizeStyles = {
  sm: 'px-3 py-1.5 text-sm',
  md: 'px-4 py-2.5 text-sm',
  lg: 'px-6 py-3 text-base',
}

export function Button({
  variant = 'primary',
  size = 'md',
  href,
  className,
  children,
  ...props
}: ButtonProps) {
  const combinedClassName = cn(
    baseStyles,
    variantStyles[variant],
    sizeStyles[size],
    className
  )

  if (href) {
    return (
      <Link
        href={href}
        className={combinedClassName}
      >
        {children}
      </Link>
    )
  }

  return (
    <button type="button" className={combinedClassName} {...props}>
      {children}
    </button>
  )
}
</file>

<file path="lib/actions/groomers.ts">
'use server'

import { createClient } from '@/utils/supabase/server'
import { revalidatePath } from 'next/cache'

export interface Groomer {
  id: string
  name: string
  email: string | null
  phone: string | null
  role: string
  color: string | null
  avatar_url: string | null
  is_active: boolean
  on_duty: boolean
  created_at: string
  updated_at: string
}

export interface CreateGroomerInput {
  name: string
  email?: string
  phone?: string
  role?: string
  color?: string
}

/**
 * Get all groomers
 */
export async function getGroomers(): Promise<Groomer[]> {
  const supabase = await createClient()

  const { data, error } = await supabase
    .from('groomers')
    .select('*')
    .eq('is_active', true)
    .order('name', { ascending: true })

  if (error) {
    console.error('[Groomers] Fetch failed:', error)
    return []
  }

  return data || []
}

/**
 * Create a new groomer
 */
export async function createGroomer(prevState: any, formData: FormData) {
  const supabase = await createClient();
  const { data: { user } } = await supabase.auth.getUser();

  if (!user) return { message: "User not authenticated" };

  const name = formData.get("name") as string;
  const role = formData.get("role") as string;

  // FIX: Include user_id in the insert
  const { error } = await supabase.from("groomers").insert({
    name,
    role,
    user_id: user.id, // <--- CRITICAL FIX
    status: "active",
  });

  if (error) {
    console.error("Groomer Error:", error);
    return { message: error.message }; // Return actual error
  }

  revalidatePath("/groomers");
  return { message: "success" };
}

/**
 * Update a groomer
 */
export async function updateGroomer(
  id: string,
  input: Partial<CreateGroomerInput>
): Promise<{ success: boolean; error?: string }> {
  const supabase = await createClient()

  const { error } = await supabase
    .from('groomers')
    .update({
      ...input,
      updated_at: new Date().toISOString(),
    })
    .eq('id', id)

  if (error) {
    console.error('[Groomers] Update failed:', error)
    return { success: false, error: error.message }
  }

  revalidatePath('/groomers')
  return { success: true }
}

/**
 * Delete (deactivate) a groomer
 */
export async function deleteGroomer(id: string): Promise<{ success: boolean; error?: string }> {
  const supabase = await createClient()

  const { error } = await supabase
    .from('groomers')
    .update({
      is_active: false,
      updated_at: new Date().toISOString(),
    })
    .eq('id', id)

  if (error) {
    console.error('[Groomers] Delete failed:', error)
    return { success: false, error: error.message }
  }

  revalidatePath('/groomers')
  return { success: true }
}

/**
 * Set groomer on_duty status (clock in/out)
 */
export async function setGroomerOnDuty(
  id: string,
  onDuty: boolean
): Promise<{ success: boolean; error?: string }> {
  const supabase = await createClient()

  const { error } = await supabase
    .from('groomers')
    .update({
      on_duty: onDuty,
      updated_at: new Date().toISOString(),
    })
    .eq('id', id)

  if (error) {
    console.error('[Groomers] Set on_duty failed:', error)
    return { success: false, error: error.message }
  }

  revalidatePath('/dashboard')
  revalidatePath('/groomers')
  return { success: true }
}

/**
 * Get groomers currently on duty
 */
export async function getGroomersOnDuty(): Promise<Groomer[]> {
  const supabase = await createClient()

  const { data, error } = await supabase
    .from('groomers')
    .select('*')
    .eq('is_active', true)
    .eq('on_duty', true)
    .order('name', { ascending: true })

  if (error) {
    console.error('[Groomers] Fetch on duty failed:', error)
    return []
  }

  return data || []
}

/**
 * Get groomers currently off duty
 */
export async function getGroomersOffDuty(): Promise<Groomer[]> {
  const supabase = await createClient()

  const { data, error } = await supabase
    .from('groomers')
    .select('*')
    .eq('is_active', true)
    .eq('on_duty', false)
    .order('name', { ascending: true })

  if (error) {
    console.error('[Groomers] Fetch off duty failed:', error)
    return []
  }

  return data || []
}
</file>

<file path="utils/supabase/middleware.ts">
import { createServerClient } from '@supabase/ssr'
import { NextResponse, type NextRequest } from 'next/server'

export async function updateSession(request: NextRequest) {
  let response = NextResponse.next({
    request: {
      headers: request.headers,
    },
  })

  const supabase = createServerClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
    {
      cookies: {
        getAll() {
          return request.cookies.getAll()
        },
        setAll(cookiesToSet) {
          cookiesToSet.forEach(({ name, value }) =>
            request.cookies.set(name, value)
          )
          response = NextResponse.next({
            request,
          })
          cookiesToSet.forEach(({ name, value, options }) =>
            response.cookies.set(name, value, options)
          )
        },
      },
    }
  )

  await supabase.auth.getUser()

  return response
}
</file>

<file path="app/(app)/dogs/DogsPageClient.tsx">
'use client'

import Link from 'next/link'
import Image from 'next/image'
import { Card } from '@/components/ui/Card'
import { Button } from '@/components/ui/Button'
import { Badge } from '@/components/ui/Badge'
import { Plus, Dog } from 'lucide-react'
import type { GroomingPreferences } from '@/lib/actions/dogs'
import { safeParseDate } from '@/lib/utils/date'

interface DogWithOwner {
  id: string
  name: string
  breed: string | null
  weight: number | null
  notes: string | null
  photo_url: string | null
  created_at: string
  grooming_preferences: GroomingPreferences
  customer: { id: string; name: string; phone: string | null } | null
  appointment_count: number
  last_visit: string | null
}

interface DogsPageClientProps {
  dogs: DogWithOwner[]
}

function formatDate(isoString: string | null): string {
  if (!isoString) return 'No visits yet'
  const date = safeParseDate(isoString)
  if (!date) return 'No visits yet'
  return date.toLocaleDateString('en-US', {
    month: 'short',
    day: 'numeric',
    year: 'numeric'
  })
}

export function DogsPageClient({ dogs }: DogsPageClientProps) {
  const totalDogs = dogs.length
  const activeClients = dogs.filter(d => d.appointment_count > 0).length
  const newThisMonth = dogs.filter(d => {
    const created = safeParseDate(d.created_at)
    if (!created) return false
    const now = new Date()
    return created.getMonth() === now.getMonth() && created.getFullYear() === now.getFullYear()
  }).length

  return (
    <div className="space-y-6">
      <div className="flex items-center justify-between">
        <div>
          <h1 className="text-2xl font-bold text-gray-900">Dogs</h1>
          <p className="text-gray-500">All registered dogs and their owners</p>
        </div>
        <Button href="/dogs/new" className="bg-blue-600 hover:bg-blue-700">
          <Plus className="w-4 h-4 mr-2" />
          Add Dog
        </Button>
      </div>

      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
        <Card>
          <p className="text-sm text-gray-500">Total Dogs</p>
          <p className="text-2xl font-bold text-gray-900">{totalDogs}</p>
        </Card>
        <Card>
          <p className="text-sm text-gray-500">Active Humans</p>
          <p className="text-2xl font-bold text-blue-600">{activeClients}</p>
        </Card>
        <Card>
          <p className="text-sm text-gray-500">New This Month</p>
          <p className="text-2xl font-bold text-gray-900">{newThisMonth}</p>
        </Card>
      </div>

      {dogs.length > 0 ? (
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          {dogs.map((dog) => (
            <Link key={dog.id} href={`/dogs/${dog.id}`}>
              <Card className="hover:shadow-md transition-shadow cursor-pointer h-full">
                <div className="flex items-start gap-4">
                  <div className="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 overflow-hidden relative">
                    {dog.photo_url ? (
                      <Image
                        src={dog.photo_url}
                        alt={dog.name}
                        fill
                        className="object-cover"
                      />
                    ) : (
                      <Dog className="w-6 h-6 text-blue-600" />
                    )}
                  </div>
                  <div className="flex-1 min-w-0">
                    <div className="flex items-center gap-2">
                      <h3 className="font-semibold text-gray-900 truncate">{dog.name}</h3>
                      {dog.appointment_count > 0 && (
                        <Badge variant="info">{dog.appointment_count} visits</Badge>
                      )}
                    </div>
                    <p className="text-sm text-gray-500">{dog.breed || 'Unknown breed'}</p>
                    {dog.weight && (
                      <p className="text-xs text-gray-400">{dog.weight} lbs</p>
                    )}
                    <div className="mt-2 pt-2 border-t border-gray-100">
                      <p className="text-xs text-gray-600 font-medium">
                        Owner: {dog.customer?.name || 'No owner'}
                      </p>
                      {dog.customer?.phone && (
                        <p className="text-xs text-gray-400">{dog.customer.phone}</p>
                      )}
                    </div>
                    <p className="text-xs text-gray-400 mt-1">
                      Last visit: {formatDate(dog.last_visit)}
                    </p>
                    {(dog.grooming_preferences?.behavior_notes || dog.grooming_preferences?.special_instructions) && (
                      <p className="text-xs text-amber-600 mt-1 font-medium">
                        Has grooming notes
                      </p>
                    )}
                  </div>
                </div>
              </Card>
            </Link>
          ))}
        </div>
      ) : (
        <Card>
          <div className="text-center py-12 text-gray-500">
            <Dog className="w-12 h-12 mx-auto mb-4 text-gray-300" />
            <p className="text-lg">No dogs registered yet</p>
            <p className="text-sm mt-1">Add your first furry friend to get started</p>
            <Button href="/dogs/new" className="mt-4 bg-blue-600 hover:bg-blue-700">
              <Plus className="w-4 h-4 mr-2" />
              Add Dog
            </Button>
          </div>
        </Card>
      )}
    </div>
  )
}
</file>

<file path="app/(app)/pricing/page.tsx">
"use client";

import { useState } from "react";
import { Button } from "@/components/ui/Button";
import { Check } from "lucide-react";

export default function PricingPage() {
  const [loadingTrial, setLoadingTrial] = useState(false);
  const [loadingBuy, setLoadingBuy] = useState(false);

  const PRICE_ID = "price_1SpjQlGzqO94XgciE9C3FJsE";

  async function handleCheckout(skipTrial: boolean) {
    if (skipTrial) setLoadingBuy(true);
    else setLoadingTrial(true);

    try {
      const endpoint = skipTrial ? "/api/stripe/checkout" : "/api/trial/start";

      const res = await fetch(endpoint, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          priceId: PRICE_ID,
          skipTrial: skipTrial,
        }),
      });

      const text = await res.text();
      if (!res.ok) throw new Error(text);
      const data = JSON.parse(text);
      if (data.url) window.location.href = data.url;
    } catch (error) {
      console.error(error);
      alert("Error: " + error);
    } finally {
      setLoadingTrial(false);
      setLoadingBuy(false);
    }
  }


  return (
    <div className="max-w-4xl mx-auto p-6 text-center">
      <h1 className="text-3xl font-bold mb-4">Upgrade to Pro</h1>
      <p className="text-gray-500 mb-12">Unlock the full power of Groom Groove.</p>

      <div className="bg-white rounded-2xl shadow-xl border border-blue-100 overflow-hidden max-w-md mx-auto">
        <div className="bg-blue-50 p-6 border-b border-blue-100">
          <h2 className="text-2xl font-bold text-gray-900">Pro Plan</h2>
          <div className="mt-4 flex items-baseline justify-center">
            <span className="text-5xl font-extrabold text-gray-900">$79</span>
            <span className="ml-2 text-xl text-gray-500">/month</span>
          </div>
        </div>

        <div className="p-8">
          <ul className="space-y-4 text-left mb-8">
            {[
              "Unlimited Dogs",
              "SMS Reminders",
              "Revenue Reports",
              "Priority Support",
            ].map((feat) => (
              <li key={feat} className="flex items-center">
                <Check className="h-5 w-5 text-green-500 mr-3" />
                <span>{feat}</span>
              </li>
            ))}
          </ul>

          <div className="space-y-4">
            <Button
              onClick={() => handleCheckout(false)}
              disabled={loadingTrial || loadingBuy}
              className="w-full h-12 text-lg font-bold bg-blue-600 hover:bg-blue-700 text-white"
            >
              {loadingTrial ? "Loading..." : "Start 14-Day Free Trial"}
            </Button>

            <div className="relative flex py-2 items-center">
              <div className="flex-grow border-t border-gray-200"></div>
              <span className="flex-shrink-0 mx-4 text-gray-400 text-sm">OR</span>
              <div className="flex-grow border-t border-gray-200"></div>
            </div>

            <Button
              onClick={() => handleCheckout(true)}
              disabled={loadingTrial || loadingBuy}
              variant="outline"
              className="w-full h-12 text-lg font-bold border-2 border-gray-200 hover:bg-gray-50 text-gray-700"
            >
              {loadingBuy ? "Loading..." : "Pay Now (Skip Trial)"}
            </Button>
          </div>

          <p className="mt-6 text-xs text-gray-400">
            Secure payment via Stripe. Cancel anytime.
          </p>
        </div>
      </div>
    </div>
  );
}
</file>

<file path="app/api/stripe/webhook/route.ts">
import { headers } from "next/headers";
import { NextResponse } from "next/server";
import Stripe from "stripe";
import { createClient } from "@supabase/supabase-js";

// FORCE STABLE VERSION to prevent crashes
const stripe = new Stripe(process.env.STRIPE_SECRET_KEY!, {
  apiVersion: "2023-10-16" as any,
  typescript: true,
});

const supabase = createClient(
  process.env.NEXT_PUBLIC_SUPABASE_URL!,
  process.env.SUPABASE_SERVICE_ROLE_KEY!
);

export async function POST(req: Request) {
  const body = await req.text();
  const signature = (await headers()).get("Stripe-Signature") as string;
  const webhookSecret = process.env.STRIPE_WEBHOOK_SECRET!;

  let event: Stripe.Event;

  try {
    event = stripe.webhooks.constructEvent(body, signature, webhookSecret);
  } catch (err: any) {
    console.error(`Webhook signature verification failed: ${err.message}`);
    return new NextResponse(`Webhook Error: ${err.message}`, { status: 400 });
  }

  try {
    if (event.type === "checkout.session.completed") {
      const session = event.data.object as Stripe.Checkout.Session;
      const userId = session.metadata?.userId; // We attached this in checkout
      const subscriptionId = session.subscription as string;

      if (!userId || !subscriptionId) {
        throw new Error("Missing userId or subscriptionId in metadata");
      }

      console.log(`Processing subscription for User ${userId}`);

      // 1. Fetch Subscription Details from Stripe
      const subscription = await stripe.subscriptions.retrieve(subscriptionId);

      // 2. Upsert into Supabase
      const { error } = await supabase.from("subscriptions").upsert({
        id: subscription.id,
        user_id: userId,
        status: subscription.status,
        price_id: subscription.items.data[0].price.id,
        // Convert seconds to ISO strings
        current_period_start: new Date(subscription.current_period_start * 1000).toISOString(),
        current_period_end: new Date(subscription.current_period_end * 1000).toISOString(),
        cancel_at_period_end: subscription.cancel_at_period_end,
      });

      if (error) throw error;
      console.log("Subscription saved to Supabase!");
    }

    return new NextResponse("Received", { status: 200 });
  } catch (error: any) {
    console.error("Webhook handler failed:", error);
    return new NextResponse("Internal Server Error", { status: 500 });
  }
}
</file>

<file path="app/page.tsx">
import Link from "next/link"
import Image from "next/image"
import { Button } from "@/components/ui/Button"
import { Check, Smartphone, Clock, ShieldCheck, ArrowRight, Star, Calendar, HelpCircle } from "lucide-react"
import { createClient } from "@/utils/supabase/server"

export default async function LandingPage() {
  const supabase = await createClient()
  const { data: { user } } = await supabase.auth.getUser()

  return (
    <div className="flex flex-col min-h-screen font-sans bg-white text-gray-900">
      {/* Navigation */}
      <header className="px-4 lg:px-6 h-20 flex items-center justify-between border-b sticky top-0 bg-white/95 backdrop-blur z-50 shadow-sm">
        <Link className="flex items-center gap-3" href="/">
          <div className="relative w-10 h-10">
             <Image src="/logo.png" alt="Groom Groove Logo" fill className="object-contain" />
          </div>
          <span className="font-extrabold text-2xl tracking-tight text-gray-900">Groom Groove</span>
        </Link>
        <div className="flex items-center gap-6">
          <nav className="hidden md:flex gap-6 items-center">
             <Link className="text-sm font-semibold text-gray-600 hover:text-blue-600 transition-colors" href="#features">Features</Link>
             <Link className="text-sm font-semibold text-gray-600 hover:text-blue-600 transition-colors" href="#pricing">Pricing</Link>
             <Link className="text-sm font-semibold text-gray-600 hover:text-blue-600 transition-colors" href="#faq">FAQ</Link>
          </nav>
          
          {user ? (
             <Link href="/dashboard">
               <Button className="bg-blue-600 hover:bg-blue-700 text-white rounded-full px-6 font-bold shadow-md hover:shadow-lg transition-all">
                 Go to Dashboard
               </Button>
             </Link>
          ) : (
            <div className="flex items-center gap-4">
              <Link className="text-sm font-bold text-gray-700 hover:text-blue-600 hidden sm:block" href="/login">
                Log In
              </Link>
              <Link href="/signup">
                <Button className="bg-blue-600 hover:bg-blue-700 text-white rounded-full px-6 font-bold shadow-md hover:shadow-lg transition-all transform hover:-translate-y-0.5">
                  Start Free Trial
                </Button>
              </Link>
            </div>
          )}
        </div>
      </header>

      <main className="flex-1">
        {/* Hero Section */}
        <section className="w-full py-20 md:py-32 bg-gradient-to-b from-blue-50 via-white to-white">
          <div className="container px-4 md:px-6 mx-auto text-center">
            <div className="inline-flex items-center rounded-full border border-blue-200 bg-blue-50 px-3 py-1 text-sm font-medium text-blue-800 mb-6">
              <span className="flex h-2 w-2 rounded-full bg-blue-600 mr-2"></span>
              New: SMS Reminders included in Pro Plan
            </div>
            <h1 className="text-5xl font-extrabold tracking-tight sm:text-6xl md:text-7xl text-gray-900 mb-6 leading-tight">
              Stop No-Shows. <br />
              <span className="text-blue-600">Start Growing.</span>
            </h1>
            <p className="mx-auto max-w-[800px] text-gray-600 md:text-xl mb-10 leading-relaxed font-medium">
              The all-in-one app for independent dog groomers. Schedule appointments, manage client profiles, and get paid‚Äîall from your phone or iPad.
            </p>
            <div className="flex flex-col sm:flex-row justify-center gap-4 mb-12">
              <Link href="/signup">
                <Button className="bg-blue-600 hover:bg-blue-700 text-white h-14 px-10 rounded-full text-lg font-bold shadow-xl hover:shadow-2xl transition-all w-full sm:w-auto">
                  Start My 14-Day Free Trial
                  <ArrowRight className="ml-2 h-5 w-5" />
                </Button>
              </Link>
              <Link href="#pricing">
                <Button variant="outline" className="h-14 px-10 rounded-full text-lg font-bold border-2 border-gray-200 text-gray-700 hover:border-gray-300 hover:bg-gray-50 w-full sm:w-auto">
                  View Pricing
                </Button>
              </Link>
            </div>
            <div className="flex flex-col sm:flex-row items-center justify-center gap-6 text-sm font-medium text-gray-500">
              <div className="flex items-center"><Check className="h-5 w-5 text-green-500 mr-2" /> No credit card required</div>
              <div className="flex items-center"><Check className="h-5 w-5 text-green-500 mr-2" /> Cancel anytime</div>
              <div className="flex items-center"><Check className="h-5 w-5 text-green-500 mr-2" /> 24/7 Support</div>
            </div>
          </div>
        </section>

        {/* Features Grid */}
        <section id="features" className="w-full py-24 bg-white">
          <div className="container px-4 mx-auto">
            <div className="text-center mb-16">
              <h2 className="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl mb-4">Run your salon on Autopilot</h2>
              <p className="text-lg text-gray-500 max-w-2xl mx-auto">We handle the boring admin stuff so you can focus on making dogs look awesome.</p>
            </div>
            <div className="grid md:grid-cols-3 gap-10">
              {/* Feature 1 */}
              <div className="group p-8 bg-gray-50 rounded-3xl border border-gray-100 hover:border-blue-100 hover:shadow-xl transition-all duration-300">
                <div className="w-14 h-14 bg-blue-100 rounded-2xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform">
                  <Clock className="h-7 w-7 text-blue-600" />
                </div>
                <h3 className="text-2xl font-bold mb-3 text-gray-900">Smart Scheduling</h3>
                <p className="text-gray-600 leading-relaxed">
                  Drag-and-drop calendar designed for groomers. Color-code by appointment type (Bath, Full Groom, Nails) and never double-book again.
                </p>
              </div>
              {/* Feature 2 */}
              <div className="group p-8 bg-gray-50 rounded-3xl border border-gray-100 hover:border-blue-100 hover:shadow-xl transition-all duration-300">
                <div className="w-14 h-14 bg-purple-100 rounded-2xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform">
                  <Smartphone className="h-7 w-7 text-purple-600" />
                </div>
                <h3 className="text-2xl font-bold mb-3 text-gray-900">SMS Reminders</h3>
                <p className="text-gray-600 leading-relaxed">
                  We automatically text your clients 24 hours before their appointment. Reduce no-shows by 80% instantly.
                </p>
              </div>
              {/* Feature 3 */}
              <div className="group p-8 bg-gray-50 rounded-3xl border border-gray-100 hover:border-blue-100 hover:shadow-xl transition-all duration-300">
                <div className="w-14 h-14 bg-green-100 rounded-2xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform">
                  <ShieldCheck className="h-7 w-7 text-green-600" />
                </div>
                <h3 className="text-2xl font-bold mb-3 text-gray-900">Dog Profiles</h3>
                <p className="text-gray-600 leading-relaxed">
                  Save blade lengths, shampoo preferences, and vet notes. Next time Bella comes in, you know exactly what to do.
                </p>
              </div>
            </div>
          </div>
        </section>

        {/* Pricing Section - THE MONEY SHOT */}
        <section id="pricing" className="w-full py-24 bg-gray-900 text-white relative overflow-hidden">
          {/* Background decoration */}
          <div className="absolute top-0 left-0 w-full h-full overflow-hidden opacity-10 pointer-events-none">
             <div className="absolute -top-24 -right-24 w-96 h-96 bg-blue-500 rounded-full blur-3xl"></div>
             <div className="absolute top-1/2 left-0 w-64 h-64 bg-purple-500 rounded-full blur-3xl"></div>
          </div>

          <div className="container px-4 mx-auto relative z-10">
            <div className="text-center mb-16">
               <h2 className="text-3xl font-bold tracking-tight sm:text-5xl mb-4">Simple, Transparent Pricing</h2>
               <p className="text-xl text-gray-400">One plan. Everything included. No hidden fees.</p>
            </div>
            
            <div className="max-w-lg mx-auto bg-white text-gray-900 rounded-3xl shadow-2xl overflow-hidden transform hover:scale-105 transition-transform duration-300 border-4 border-blue-500">
               <div className="bg-blue-600 text-white text-center py-3 font-bold uppercase tracking-wider text-sm">
                  Launch Special
               </div>
               <div className="p-10 text-center">
                  <h3 className="text-2xl font-bold text-gray-500 uppercase tracking-wide mb-2">Pro Groomer</h3>
                  <div className="flex items-baseline justify-center my-6">
                     <span className="text-6xl font-extrabold text-gray-900">$79</span>
                     <span className="ml-2 text-2xl text-gray-500 font-medium">/month</span>
                  </div>
                  <p className="text-gray-600 mb-8">Perfect for independent mobile groomers and salons.</p>
                  
                  <Link href="/signup">
                     <Button className="w-full bg-blue-600 hover:bg-blue-700 text-white h-14 rounded-xl text-xl font-bold shadow-lg hover:shadow-blue-500/50 transition-all">
                        Start 14-Day Free Trial
                     </Button>
                  </Link>
                  <p className="mt-4 text-xs text-gray-400">No credit card required to sign up.</p>
               </div>
               <div className="bg-gray-50 p-10 border-t border-gray-100">
                  <ul className="space-y-4">
                     <li className="flex items-center text-gray-700 font-medium">
                        <Check className="h-6 w-6 text-green-500 mr-3 flex-shrink-0" />
                        Unlimited Appointments
                     </li>
                     <li className="flex items-center text-gray-700 font-medium">
                        <Check className="h-6 w-6 text-green-500 mr-3 flex-shrink-0" />
                        Unlimited Client Profiles
                     </li>
                     <li className="flex items-center text-gray-700 font-medium">
                        <Check className="h-6 w-6 text-green-500 mr-3 flex-shrink-0" />
                        <span className="font-bold text-blue-600">SMS Reminders Included</span>
                     </li>
                     <li className="flex items-center text-gray-700 font-medium">
                        <Check className="h-6 w-6 text-green-500 mr-3 flex-shrink-0" />
                        Revenue & Tax Reports
                     </li>
                     <li className="flex items-center text-gray-700 font-medium">
                        <Check className="h-6 w-6 text-green-500 mr-3 flex-shrink-0" />
                        iPhone, iPad & Web App
                     </li>
                  </ul>
               </div>
            </div>
          </div>
        </section>

        {/* FAQ Section */}
        <section id="faq" className="w-full py-24 bg-white">
           <div className="container px-4 mx-auto max-w-4xl">
              <h2 className="text-3xl font-bold text-center mb-12 text-gray-900">Frequently Asked Questions</h2>
              <div className="space-y-8">
                 <div className="bg-gray-50 p-6 rounded-2xl">
                    <h3 className="font-bold text-xl mb-2 flex items-center"><HelpCircle className="h-5 w-5 text-blue-600 mr-2"/> Can I use this on my phone?</h3>
                    <p className="text-gray-600">Yes! Groom Groove works perfectly on any iPhone, Android, iPad, or laptop. Your data syncs instantly across all devices.</p>
                 </div>
                 <div className="bg-gray-50 p-6 rounded-2xl">
                    <h3 className="font-bold text-xl mb-2 flex items-center"><HelpCircle className="h-5 w-5 text-blue-600 mr-2"/> Is it hard to switch from paper?</h3>
                    <p className="text-gray-600">Not at all. We designed it specifically for people who hate complicated software. It takes about 5 minutes to learn.</p>
                 </div>
                 <div className="bg-gray-50 p-6 rounded-2xl">
                    <h3 className="font-bold text-xl mb-2 flex items-center"><HelpCircle className="h-5 w-5 text-blue-600 mr-2"/> What if I have multiple groomers?</h3>
                    <p className="text-gray-600">Currently, the Pro plan is designed for single users. If you have a larger salon, contact us for our Team pricing.</p>
                 </div>
              </div>
           </div>
        </section>

      </main>

      <footer className="py-12 bg-gray-50 border-t">
        <div className="container px-4 mx-auto text-center">
            <div className="flex justify-center items-center gap-2 mb-4">
              <div className="relative w-6 h-6">
                 <Image src="/logo.png" alt="Logo" fill className="object-contain opacity-50" />
              </div>
              <span className="font-bold text-gray-500">Groom Groove</span>
            </div>
            <p className="text-sm text-gray-400">
            ¬© 2026 Groom Groove. Built for groomers, by groomers.
            </p>
        </div>
      </footer>
    </div>
  )
}
</file>

<file path="components/DogDetailModal.tsx">
'use client'

import { useState, useEffect, useCallback } from 'react'
import { Modal } from '@/components/ui/Modal'
import { Badge } from '@/components/ui/Badge'
import { Button } from '@/components/ui/Button'
import { Dog, User, Calendar, Scissors, AlertCircle, Save, Clock, CheckCircle } from 'lucide-react'
import { getDogDetail, updateGroomingPreferences, type DogDetail, type GroomingPreferences } from '@/lib/actions/dogs'
import { safeParseDate } from '@/lib/utils/date'
import { BLADE_SIZES } from '@/lib/constants/grooming'

interface DogDetailModalProps {
  dogId: string | null
  isOpen: boolean
  onClose: () => void
}

export function DogDetailModal({ dogId, isOpen, onClose }: DogDetailModalProps) {
  const [dog, setDog] = useState<DogDetail | null>(null)
  const [loading, setLoading] = useState(false)
  const [error, setError] = useState<string | null>(null)
  const [saving, setSaving] = useState(false)
  const [saveSuccess, setSaveSuccess] = useState(false)

  // Editable preferences state
  const [preferences, setPreferences] = useState<GroomingPreferences>({})

  const loadDogDetail = useCallback(async () => {
    if (!dogId) return

    setLoading(true)
    setError(null)
    setSaveSuccess(false)

    try {
      const data = await getDogDetail(dogId)
      if (data) {
        setDog(data)
        setPreferences(data.grooming_preferences || {})
      } else {
        setError('Dog not found')
      }
    } catch (err) {
      console.error('Failed to load dog:', err)
      setError('Failed to load dog details')
    } finally {
      setLoading(false)
    }
  }, [dogId])

  // Load dog data when modal opens
  useEffect(() => {
    if (isOpen && dogId) {
      loadDogDetail()
    }
  }, [isOpen, dogId, loadDogDetail])

  async function handleSavePreferences() {
    if (!dogId) return

    setSaving(true)
    setError(null)
    setSaveSuccess(false)

    try {
      const result = await updateGroomingPreferences(dogId, preferences)
      if (result.success) {
        setSaveSuccess(true)
        // Update local dog state
        if (dog) {
          setDog({ ...dog, grooming_preferences: preferences })
        }
        // Clear success message after 3 seconds
        setTimeout(() => setSaveSuccess(false), 3000)
      } else {
        setError(result.error || 'Failed to save preferences')
      }
    } catch (err) {
      console.error('Failed to save preferences:', err)
      setError('Failed to save preferences')
    } finally {
      setSaving(false)
    }
  }

  function updatePreference<K extends keyof GroomingPreferences>(key: K, value: GroomingPreferences[K]) {
    setPreferences(prev => ({ ...prev, [key]: value }))
    setSaveSuccess(false) // Clear success when editing
  }

  function formatDate(isoString: string): string {
    const date = safeParseDate(isoString)
    if (!date) return 'N/A'
    return date.toLocaleDateString('en-US', {
      weekday: 'short',
      month: 'short',
      day: 'numeric',
      year: 'numeric'
    })
  }

  function formatTime(isoString: string): string {
    const date = safeParseDate(isoString)
    if (!date) return 'N/A'
    return date.toLocaleTimeString('en-US', {
      hour: 'numeric',
      minute: '2-digit',
      hour12: true
    })
  }

  if (loading) {
    return (
      <Modal isOpen={isOpen} onClose={onClose} title="Dog Details" size="xl">
        <div className="flex items-center justify-center py-12">
          <div className="w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"></div>
        </div>
      </Modal>
    )
  }

  if (error && !dog) {
    return (
      <Modal isOpen={isOpen} onClose={onClose} title="Dog Details" size="xl">
        <div className="text-center py-12 px-6">
          <AlertCircle className="w-12 h-12 text-red-500 mx-auto mb-4" />
          <p className="text-gray-900 font-medium mb-2">Error</p>
          <p className="text-gray-500">{error}</p>
        </div>
      </Modal>
    )
  }

  if (!dog) return null

  return (
    <Modal isOpen={isOpen} onClose={onClose} title={`${dog.name}'s Profile`} size="xl">
      <div className="px-6 py-4 space-y-6">
        {error && (
          <div className="bg-red-50 border border-red-200 rounded-lg p-3 flex items-center gap-2">
            <AlertCircle className="w-4 h-4 text-red-500 flex-shrink-0" />
            <p className="text-sm text-red-700">{error}</p>
          </div>
        )}

        {saveSuccess && (
          <div className="bg-green-50 border border-green-200 rounded-lg p-3 flex items-center gap-2">
            <CheckCircle className="w-4 h-4 text-green-500 flex-shrink-0" />
            <p className="text-sm text-green-700">Preferences saved successfully</p>
          </div>
        )}

        <section className="bg-gray-50 rounded-xl p-4">
          <div className="flex items-start gap-4">
            <div className="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0">
              <Dog className="w-8 h-8 text-blue-600" />
            </div>
            <div className="flex-1 min-w-0">
              <div className="flex items-center gap-2 mb-1">
                <h3 className="text-xl font-bold text-gray-900">{dog.name}</h3>
                {dog.history.length > 0 && (
                  <Badge variant="info">{dog.history.length} visits</Badge>
                )}
              </div>
              <p className="text-gray-600">{dog.breed || 'Unknown breed'}</p>
              {dog.weight && <p className="text-sm text-gray-500">{dog.weight} lbs</p>}

              <div className="mt-3 pt-3 border-t border-gray-200 grid grid-cols-2 gap-4">
                <div className="flex items-center gap-2">
                  <User className="w-4 h-4 text-gray-400" />
                  <div>
                    <p className="text-sm font-medium text-gray-900">{dog.customer?.name || 'No owner'}</p>
                    {dog.customer?.phone && (
                      <p className="text-xs text-gray-500">{dog.customer.phone}</p>
                    )}
                  </div>
                </div>
                <div className="flex items-center gap-2">
                  <Calendar className="w-4 h-4 text-gray-400" />
                  <div>
                    <p className="text-sm font-medium text-gray-900">Last Visit</p>
                    <p className="text-xs text-gray-500">
                      {dog.history[0] ? formatDate(dog.history[0].scheduled_at) : 'No visits yet'}
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <section>
          <div className="flex items-center justify-between mb-4">
            <div className="flex items-center gap-2">
              <Scissors className="w-5 h-5 text-gray-600" />
              <h4 className="font-semibold text-gray-900">Grooming Preferences</h4>
            </div>
            <Button
              onClick={handleSavePreferences}
              disabled={saving}
              size="sm"
              className="bg-blue-600 hover:bg-blue-700"
            >
              <Save className="w-4 h-4 mr-1" />
              {saving ? 'Saving...' : 'Save'}
            </Button>
          </div>

          <div className="space-y-4">
            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">
                  Clipper Blade Size
                </label>
                <select
                  value={preferences.blade_size || ''}
                  onChange={(e) => updatePreference('blade_size', e.target.value)}
                  className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-300"
                >
                  <option value="">Not specified</option>
                  {BLADE_SIZES.map((size) => (
                    <option key={size.value} value={size.value}>
                      {size.label}
                    </option>
                  ))}
                </select>
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">
                  Clipping Notes
                </label>
                <input
                  type="text"
                  value={preferences.clipping_notes || ''}
                  onChange={(e) => updatePreference('clipping_notes', e.target.value)}
                  placeholder="e.g., Shorter on belly, leave ears longer"
                  className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-300"
                />
              </div>
            </div>

            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">
                  Nail Clipper Size
                </label>
                <select
                  value={preferences.nail_clipper_size || ''}
                  onChange={(e) => updatePreference('nail_clipper_size', e.target.value as GroomingPreferences['nail_clipper_size'])}
                  className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-300"
                >
                  <option value="">Not specified</option>
                  <option value="small">Small</option>
                  <option value="medium">Medium</option>
                  <option value="large">Large</option>
                </select>
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">
                  Nail Tool Preference
                </label>
                <select
                  value={preferences.nail_tool || ''}
                  onChange={(e) => updatePreference('nail_tool', e.target.value as GroomingPreferences['nail_tool'])}
                  className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-300"
                >
                  <option value="">Not specified</option>
                  <option value="clipper">Clipper</option>
                  <option value="grinder">Grinder</option>
                </select>
              </div>
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Coat Handling Notes
              </label>
              <textarea
                value={preferences.coat_notes || ''}
                onChange={(e) => updatePreference('coat_notes', e.target.value)}
                placeholder="e.g., Heavy shedder, prone to matting behind ears, sensitive skin"
                rows={2}
                className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-300"
              />
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Behavior Notes
              </label>
              <textarea
                value={preferences.behavior_notes || ''}
                onChange={(e) => updatePreference('behavior_notes', e.target.value)}
                placeholder="e.g., Anxious around dryers, doesn't like paws touched, needs breaks"
                rows={2}
                className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-300"
              />
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Special Instructions
              </label>
              <textarea
                value={preferences.special_instructions || ''}
                onChange={(e) => updatePreference('special_instructions', e.target.value)}
                placeholder="e.g., Use calming spray before grooming, owner prefers specific shampoo"
                rows={2}
                className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-300"
              />
            </div>
          </div>
        </section>

        <section>
          <div className="flex items-center gap-2 mb-4">
            <Clock className="w-5 h-5 text-gray-600" />
            <h4 className="font-semibold text-gray-900">Grooming History</h4>
          </div>

          {dog.history.length > 0 ? (
            <div className="space-y-2 max-h-64 overflow-y-auto">
              {dog.history.map((appt) => (
                <div
                  key={appt.id}
                  className="p-3 bg-gray-50 rounded-lg"
                >
                  <div className="flex items-center justify-between mb-1">
                    <div className="flex items-center gap-2">
                      <span className="text-sm font-medium text-gray-900">
                        {formatDate(appt.scheduled_at)}
                      </span>
                      <span className="text-xs text-gray-500">
                        {formatTime(appt.scheduled_at)}
                      </span>
                    </div>
                    <Badge
                      variant={appt.status === 'completed' ? 'success' : appt.status === 'cancelled' ? 'default' : 'info'}
                    >
                      {appt.status}
                    </Badge>
                  </div>
                  <p className="text-sm text-gray-600">
                    {appt.services?.join(', ') || 'No services recorded'}
                  </p>
                  {appt.notes && (
                    <p className="text-xs text-gray-500 mt-1 italic">
                      {appt.notes}
                    </p>
                  )}
                </div>
              ))}
            </div>
          ) : (
            <div className="text-center py-8 text-gray-500 bg-gray-50 rounded-lg">
              <Calendar className="w-8 h-8 mx-auto mb-2 text-gray-300" />
              <p className="text-sm">No grooming history yet</p>
            </div>
          )}
        </section>
      </div>
    </Modal>
  )
}
</file>

<file path="lib/actions/dogs.ts">
'use server'

import { createClient } from '@/utils/supabase/server'

// Demo dog data for development mode - matches demo appointments in dashboard
function getDemoDogDetail(demoId: string): DogDetail | null {
  const demoDogs: Record<string, DogDetail> = {
    'demo-dog-1': {
      id: 'demo-dog-1',
      name: 'Bella',
      breed: 'Golden Retriever',
      weight: 65,
      notes: 'Sweet girl, loves treats during grooming',
      photo_url: null,
      grooming_preferences: {
        clipping_length: '#4 blade all over',
        nail_tool: 'grinder',
        coat_notes: 'Dense double coat, regular deshedding recommended'
      },
      created_at: '2024-06-15T00:00:00Z',
      customer: {
        id: 'demo-cust-1',
        name: 'Sarah Johnson',
        phone: '(555) 123-4567',
        email: 'sarah.j@email.com'
      },
      history: [
        { id: 'hist-1', scheduled_at: '2024-12-15T09:00:00Z', services: ['Full Groom'], notes: null, status: 'completed' },
        { id: 'hist-2', scheduled_at: '2024-11-01T10:30:00Z', services: ['Bath & Brush', 'Nail Trim'], notes: null, status: 'completed' },
        { id: 'hist-3', scheduled_at: '2024-09-20T14:00:00Z', services: ['Full Groom'], notes: 'Extra deshedding', status: 'completed' }
      ]
    },
    'demo-dog-2': {
      id: 'demo-dog-2',
      name: 'Max',
      breed: 'German Shepherd',
      weight: 85,
      notes: 'Working on building trust with grooming process',
      photo_url: null,
      grooming_preferences: {
        clipping_length: 'Minimal trimming, neaten only',
        nail_tool: 'clipper',
        nail_clipper_size: 'large',
        coat_notes: 'Shedding heavily in spring/fall',
        behavior_notes: 'Can be anxious around dryers - use low setting, take breaks'
      },
      created_at: '2024-03-10T00:00:00Z',
      customer: {
        id: 'demo-cust-2',
        name: 'Mike Chen',
        phone: '(555) 234-5678',
        email: 'mike.chen@email.com'
      },
      history: [
        { id: 'hist-4', scheduled_at: '2024-12-01T10:30:00Z', services: ['Bath & Brush', 'Nail Trim'], notes: 'Used gentle shampoo', status: 'completed' },
        { id: 'hist-5', scheduled_at: '2024-10-15T11:00:00Z', services: ['Deshedding Treatment'], notes: null, status: 'completed' }
      ]
    },
    'demo-dog-3': {
      id: 'demo-dog-3',
      name: 'Luna',
      breed: 'Husky',
      weight: 55,
      notes: 'Beautiful coat, very friendly',
      photo_url: null,
      grooming_preferences: {
        clipping_length: 'Never clip - brush out only',
        nail_tool: 'grinder',
        coat_notes: 'Heavy shedder, extra time needed for undercoat removal',
        behavior_notes: 'Talkative but cooperative'
      },
      created_at: '2024-01-20T00:00:00Z',
      customer: {
        id: 'demo-cust-3',
        name: 'Lisa Park',
        phone: '(555) 345-6789',
        email: 'lisa.park@email.com'
      },
      history: [
        { id: 'hist-6', scheduled_at: '2024-11-20T13:00:00Z', services: ['De-shedding Treatment'], notes: 'Removed lots of undercoat', status: 'completed' },
        { id: 'hist-7', scheduled_at: '2024-09-05T09:00:00Z', services: ['Bath & Brush', 'De-shedding Treatment'], notes: null, status: 'completed' },
        { id: 'hist-8', scheduled_at: '2024-06-10T14:30:00Z', services: ['De-shedding Treatment'], notes: 'Summer blowout', status: 'completed' }
      ]
    },
    'demo-dog-4': {
      id: 'demo-dog-4',
      name: 'Daisy',
      breed: 'Poodle',
      weight: 45,
      notes: 'First time client - getting to know her preferences',
      photo_url: null,
      grooming_preferences: {
        clipping_length: 'To be determined after first visit',
        coat_notes: 'Curly coat, no shedding'
      },
      created_at: '2025-01-08T00:00:00Z',
      customer: {
        id: 'demo-cust-4',
        name: 'Emma Wilson',
        phone: '(555) 456-7890',
        email: 'emma.w@email.com'
      },
      history: []
    },
    'demo-dog-5': {
      id: 'demo-dog-5',
      name: 'Rocky',
      breed: 'Bulldog',
      weight: 50,
      notes: 'Sweetest boy, just sensitive about his feet',
      photo_url: null,
      grooming_preferences: {
        nail_tool: 'clipper',
        nail_clipper_size: 'small',
        coat_notes: 'Short coat, focus on wrinkle cleaning',
        behavior_notes: 'Nail sensitive, go slow',
        special_instructions: 'Use smallest clipper, lots of treats, take breaks between paws'
      },
      created_at: '2024-05-01T00:00:00Z',
      customer: {
        id: 'demo-cust-5',
        name: 'James Brown',
        phone: '(555) 567-8901',
        email: 'james.b@email.com'
      },
      history: [
        { id: 'hist-9', scheduled_at: '2024-12-10T16:00:00Z', services: ['Nail Trim'], notes: 'Took extra time, went well', status: 'completed' },
        { id: 'hist-10', scheduled_at: '2024-10-25T15:00:00Z', services: ['Bath', 'Nail Trim'], notes: 'Cleaned wrinkles thoroughly', status: 'completed' }
      ]
    }
  }

  return demoDogs[demoId] || null
}

// Grooming preferences structure
export interface GroomingPreferences {
  blade_size?: string
  comb_attachment?: string
  default_service?: string
  clipping_length?: string  // Legacy field
  clipping_notes?: string
  nail_clipper_size?: 'small' | 'medium' | 'large'
  nail_tool?: 'clipper' | 'grinder'
  coat_notes?: string
  behavior_notes?: string
  special_instructions?: string
}

// Full dog detail with history
export interface DogDetail {
  id: string
  name: string
  breed: string | null
  weight: number | null
  notes: string | null
  photo_url: string | null
  grooming_preferences: GroomingPreferences
  created_at: string
  customer: {
    id: string
    name: string
    phone: string | null
    email: string | null
  } | null
  history: AppointmentHistory[]
}

export interface AppointmentHistory {
  id: string
  scheduled_at: string
  services: string[]
  notes: string | null
  status: string
}

/**
 * Get full dog details including grooming preferences and history
 */
export async function getDogDetail(dogId: string): Promise<DogDetail | null> {
  // In development, check for demo dog IDs first
  if (process.env.NODE_ENV === 'development' && dogId.startsWith('demo-dog-')) {
    return getDemoDogDetail(dogId)
  }

  const supabase = await createClient()

  // Fetch dog with owner
  const { data: dog, error: dogError } = await supabase
    .from('dogs')
    .select(`
      id,
      name,
      breed,
      weight,
      notes,
      photo_url,
      grooming_preferences,
      created_at,
      customer:customers(id, name, phone, email)
    `)
    .eq('id', dogId)
    .single()

  if (dogError || !dog) {
    console.error('[Dogs] Fetch detail failed:', dogError)
    return null
  }

  // Fetch appointment history for this dog
  const { data: appointments, error: historyError } = await supabase
    .from('appointments')
    .select('id, scheduled_at, services, notes, status')
    .eq('dog_id', dogId)
    .order('scheduled_at', { ascending: false })
    .limit(20) // Last 20 appointments

  if (historyError) {
    console.error('[Dogs] Fetch history failed:', historyError)
  }

  return {
    ...dog,
    customer: Array.isArray(dog.customer) ? dog.customer[0] : dog.customer,
    grooming_preferences: (dog.grooming_preferences as GroomingPreferences) || {},
    history: appointments || []
  }
}

/**
 * Update dog's grooming preferences
 */
export async function updateGroomingPreferences(
  dogId: string,
  preferences: GroomingPreferences
): Promise<{ success: boolean; error?: string }> {
  const supabase = await createClient()

  const { error } = await supabase
    .from('dogs')
    .update({
      grooming_preferences: preferences,
      updated_at: new Date().toISOString()
    })
    .eq('id', dogId)

  if (error) {
    console.error('[Dogs] Update preferences failed:', error)
    return { success: false, error: error.message }
  }

  return { success: true }
}

/**
 * Add a timestamped grooming note to a dog's notes field
 */
export async function addGroomingNote(
  dogId: string,
  note: string
): Promise<{ success: boolean; error?: string }> {
  const supabase = await createClient()

  // Get current notes
  const { data: dog, error: fetchError } = await supabase
    .from('dogs')
    .select('notes')
    .eq('id', dogId)
    .single()

  if (fetchError) {
    console.error('[Dogs] Fetch for note failed:', fetchError)
    return { success: false, error: fetchError.message }
  }

  // Format new note with timestamp
  const timestamp = new Date().toLocaleDateString('en-US', {
    month: 'short',
    day: 'numeric',
    year: 'numeric'
  })
  const newNote = `[${timestamp}] ${note}`

  // Append to existing notes or start fresh
  const updatedNotes = dog?.notes
    ? `${dog.notes}\n\n${newNote}`
    : newNote

  const { error } = await supabase
    .from('dogs')
    .update({
      notes: updatedNotes,
      updated_at: new Date().toISOString()
    })
    .eq('id', dogId)

  if (error) {
    console.error('[Dogs] Add note failed:', error)
    return { success: false, error: error.message }
  }

  return { success: true }
}

/**
 * Delete a dog (and optionally their appointments)
 */
export async function deleteDog(dogId: string): Promise<{ success: boolean; error?: string }> {
  const supabase = await createClient()

  // Delete the dog (appointments should cascade delete if FK is set up with ON DELETE CASCADE)
  const { error } = await supabase
    .from('dogs')
    .delete()
    .eq('id', dogId)

  if (error) {
    console.error('[Dogs] Delete failed:', error)
    return { success: false, error: error.message }
  }

  return { success: true }
}

/**
 * Create a new dog with owner information
 */
export async function createDog(dogData: {
  dog_name: string
  owner_name: string
  owner_phone: string
  owner_email: string
  breed?: string
  clipper_blade_size?: string
  comb_attachment?: string
  nail_clipper_size?: string
  grooming_notes?: string
  behavioral_notes?: string
}): Promise<{ success: boolean; data?: any; error?: string }> {
  const supabase = await createClient()

  // Get the current user
  const { data: { user } } = await supabase.auth.getUser()

  if (!user) {
    return { success: false, error: 'You must be logged in.' }
  }

  // Prepare data for insertion
  const dataToInsert = {
    dog_name: dogData.dog_name,
    owner_name: dogData.owner_name,
    owner_phone: dogData.owner_phone,
    owner_email: dogData.owner_email,
    breed: dogData.breed || null,
    clipper_blade_size: dogData.clipper_blade_size || null,
    nail_clipper_size: dogData.nail_clipper_size || null,
    // Append comb attachment to grooming notes if provided
    grooming_notes: dogData.comb_attachment
      ? `${dogData.grooming_notes ? dogData.grooming_notes + '\n' : ''}Comb Attachment: ${dogData.comb_attachment}`
      : dogData.grooming_notes || null,
    behavioral_notes: dogData.behavioral_notes || null,
    user_id: user.id
  }

  // Insert the dog into the database
  const { data, error } = await supabase
    .from('dogs')
    .insert([dataToInsert])
    .select()
    .single()

  if (error) {
    console.error('[Dogs] Create failed:', error)
    return { success: false, error: error.message }
  }

  return { success: true, data }
}

/**
 * Get all dogs for the dogs list page (server component)
 */
export async function getAllDogs() {
  const supabase = await createClient()

  const { data: dogs, error } = await supabase
    .from('dogs')
    .select(`
      id,
      name,
      breed,
      weight,
      notes,
      photo_url,
      grooming_preferences,
      created_at,
      customer:customers(id, name, phone)
    `)
    .order('name', { ascending: true })

  if (error) {
    console.error('[Dogs] Fetch all failed:', error)
    return []
  }

  // Fetch appointment stats
  const { data: appointmentStats } = await supabase
    .from('appointments')
    .select('dog_id, scheduled_at')
    .order('scheduled_at', { ascending: false })

  // Build stats map
  const dogStats: Record<string, { count: number; lastVisit: string | null }> = {}
  if (appointmentStats) {
    for (const appt of appointmentStats) {
      if (!dogStats[appt.dog_id]) {
        dogStats[appt.dog_id] = { count: 0, lastVisit: null }
      }
      dogStats[appt.dog_id].count++
      if (!dogStats[appt.dog_id].lastVisit) {
        dogStats[appt.dog_id].lastVisit = appt.scheduled_at
      }
    }
  }

  return (dogs || []).map(dog => ({
    ...dog,
    customer: Array.isArray(dog.customer) ? dog.customer[0] : dog.customer,
    grooming_preferences: (dog.grooming_preferences as GroomingPreferences) || {},
    appointment_count: dogStats[dog.id]?.count || 0,
    last_visit: dogStats[dog.id]?.lastVisit || null
  }))
}
</file>

<file path="app/(app)/calendar/new/NewAppointmentForm.tsx">
'use client'

import { useState, useEffect, useRef } from 'react'
import { useRouter, useSearchParams } from 'next/navigation'
import { Card } from '@/components/ui/Card'
import { Button } from '@/components/ui/Button'
import { Input } from '@/components/ui/Input'
import { Textarea } from '@/components/ui/Textarea'
import { ArrowLeft, Calendar, Clock, User, Dog as DogIcon, Search, Plus, AlertCircle } from 'lucide-react'
import Link from 'next/link'
import { searchDogs, createDogWithOwner, createBooking } from '@/lib/actions/booking'

interface DogResult {
  id: string
  name: string
  breed: string | null
  customer: {
    id: string
    name: string
    phone: string | null
  } | null
}

type FlowStep = 'search' | 'create-dog' | 'booking'

const SERVICE_OPTIONS = [
  'Full Groom',
  'Bath and tidy',
  'Bath and dry',
  'Bath/tidy/de-shed',
  'Nail trim',
  'Puppy Groom',
]

const TIME_OPTIONS = [
  { value: '08:00', label: '8:00 AM' },
  { value: '08:30', label: '8:30 AM' },
  { value: '09:00', label: '9:00 AM' },
  { value: '09:30', label: '9:30 AM' },
  { value: '10:00', label: '10:00 AM' },
  { value: '10:30', label: '10:30 AM' },
  { value: '11:00', label: '11:00 AM' },
  { value: '11:30', label: '11:30 AM' },
  { value: '12:00', label: '12:00 PM' },
  { value: '12:30', label: '12:30 PM' },
  { value: '13:00', label: '1:00 PM' },
  { value: '13:30', label: '1:30 PM' },
  { value: '14:00', label: '2:00 PM' },
  { value: '14:30', label: '2:30 PM' },
  { value: '15:00', label: '3:00 PM' },
  { value: '15:30', label: '3:30 PM' },
  { value: '16:00', label: '4:00 PM' },
  { value: '16:30', label: '4:30 PM' },
  { value: '17:00', label: '5:00 PM' },
]

export function NewAppointmentForm() {
  const router = useRouter()
  const searchParams = useSearchParams()
  const prefilledDate = searchParams.get('date') || ''
  const dropdownRef = useRef<HTMLDivElement>(null)

  // Flow state
  const [step, setStep] = useState<FlowStep>('search')
  const [error, setError] = useState<string | null>(null)

  // Search state
  const [searchQuery, setSearchQuery] = useState('')
  const [searchResults, setSearchResults] = useState<DogResult[]>([])
  const [isSearching, setIsSearching] = useState(false)
  const [isDropdownOpen, setIsDropdownOpen] = useState(false)

  // Selected dog state (for existing dogs)
  const [selectedDog, setSelectedDog] = useState<DogResult | null>(null)

  // New dog form state
  const [newDogName, setNewDogName] = useState('')
  const [newDogBreed, setNewDogBreed] = useState('')
  const [newDogWeight, setNewDogWeight] = useState('')
  const [ownerName, setOwnerName] = useState('')
  const [ownerPhone, setOwnerPhone] = useState('')
  const [ownerEmail, setOwnerEmail] = useState('')
  const [isCreatingDog, setIsCreatingDog] = useState(false)

  // Booking form state
  const [appointmentDate, setAppointmentDate] = useState(prefilledDate)
  const [appointmentTime, setAppointmentTime] = useState('')
  const [selectedServices, setSelectedServices] = useState<string[]>([])
  const [notes, setNotes] = useState('')
  const [isSubmitting, setIsSubmitting] = useState(false)

  // Debounced search
  useEffect(() => {
    if (searchQuery.length < 2) {
      setSearchResults([])
      return
    }

    const timer = setTimeout(async () => {
      setIsSearching(true)
      const results = await searchDogs(searchQuery)
      setSearchResults(results)
      setIsSearching(false)
      setIsDropdownOpen(true)
    }, 300)

    return () => clearTimeout(timer)
  }, [searchQuery])

  // Close dropdown when clicking outside
  useEffect(() => {
    const handleClickOutside = (event: MouseEvent) => {
      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {
        setIsDropdownOpen(false)
      }
    }
    document.addEventListener('mousedown', handleClickOutside)
    return () => document.removeEventListener('mousedown', handleClickOutside)
  }, [])

  // Handle selecting an existing dog
  const handleSelectDog = (dog: DogResult) => {
    setSelectedDog(dog)
    setSearchQuery(dog.name)
    setIsDropdownOpen(false)
    setStep('booking')
    setError(null)
  }

  // Handle clicking "Create New Dog"
  const handleCreateNewDog = () => {
    setNewDogName(searchQuery)
    setStep('create-dog')
    setIsDropdownOpen(false)
    setError(null)
  }

  // Handle saving new dog
  const handleSaveNewDog = async () => {
    if (!newDogName.trim()) {
      setError('Dog name is required')
      return
    }
    if (!ownerName.trim()) {
      setError('Owner name is required')
      return
    }

    setIsCreatingDog(true)
    setError(null)

    const result = await createDogWithOwner({
      dog: {
        name: newDogName.trim(),
        breed: newDogBreed.trim() || undefined,
        weight: newDogWeight || undefined,
      },
      owner: {
        name: ownerName.trim(),
        phone: ownerPhone.trim() || undefined,
        email: ownerEmail.trim() || undefined,
      },
    })

    if (result.success && result.dogId && result.customerId) {
      // Set the newly created dog as selected
      setSelectedDog({
        id: result.dogId,
        name: newDogName.trim(),
        breed: newDogBreed.trim() || null,
        customer: {
          id: result.customerId,
          name: ownerName.trim(),
          phone: ownerPhone.trim() || null,
        },
      })
      setStep('booking')
    } else {
      setError(result.error || 'Failed to create dog')
    }

    setIsCreatingDog(false)
  }

  // Handle toggling a service
  const handleToggleService = (service: string) => {
    setSelectedServices((prev) =>
      prev.includes(service) ? prev.filter((s) => s !== service) : [...prev, service]
    )
  }

  // Handle booking submission
  const handleSubmitBooking = async () => {
    if (!selectedDog || !selectedDog.customer) {
      setError('No dog selected')
      return
    }
    if (!appointmentDate) {
      setError('Please select a date')
      return
    }
    if (!appointmentTime) {
      setError('Please select a time')
      return
    }
    if (selectedServices.length === 0) {
      setError('Please select at least one service')
      return
    }

    setIsSubmitting(true)
    setError(null)

    // Fix Timezone: Create a Date object in the user's local time
    const localDate = new Date(`${appointmentDate}T${appointmentTime}`);
    // Convert to UTC string (e.g. 2026-01-24T23:00:00.000Z)
    const scheduledAt = localDate.toISOString();

    const result = await createBooking({
      dogId: selectedDog.id,
      customerId: selectedDog.customer.id,
      scheduledAt,
      services: selectedServices,
      notes: notes.trim() || undefined,
    })

    if (result.success) {
      router.push(`/calendar${appointmentDate ? `?date=${appointmentDate}` : ''}`)
    } else {
      setError(result.error || 'Failed to create appointment')
      setIsSubmitting(false)
    }
  }

  // Handle going back to search
  const handleBackToSearch = () => {
    setStep('search')
    setSelectedDog(null)
    setSearchQuery('')
    setSearchResults([])
    setNewDogName('')
    setNewDogBreed('')
    setNewDogWeight('')
    setOwnerName('')
    setOwnerPhone('')
    setOwnerEmail('')
    setError(null)
  }

  return (
    <div className="space-y-6 max-w-2xl">
      <div className="flex items-center gap-4">
        <Link href="/calendar">
          <Button variant="ghost" size="sm">
            <ArrowLeft className="w-4 h-4 mr-2" />
            Back to Calendar
          </Button>
        </Link>
      </div>

      <div>
        <h1 className="text-2xl font-bold text-gray-900">New Appointment</h1>
        <p className="text-gray-500">Schedule a new grooming appointment</p>
      </div>

      {error && (
        <div className="bg-red-50 border border-red-200 rounded-lg p-4 flex items-center gap-3">
          <AlertCircle className="w-5 h-5 text-red-500 flex-shrink-0" />
          <p className="text-red-700">{error}</p>
        </div>
      )}

      <Card>
        <div className="p-6 space-y-6">
          {/* STEP 1: Dog Search (Always visible at top when in search mode) */}
          {step === 'search' && (
            <div className="space-y-4">
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  <DogIcon className="w-4 h-4 inline mr-1" />
                  Search for Dog
                </label>
                <div className="relative" ref={dropdownRef}>
                  <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" />
                  <Input
                    value={searchQuery}
                    onChange={(e) => {
                      setSearchQuery(e.target.value)
                      setIsDropdownOpen(true)
                    }}
                    onFocus={() => searchQuery.length >= 2 && setIsDropdownOpen(true)}
                    placeholder="Type dog name to search..."
                    className="pl-10 text-lg py-3"
                    autoFocus
                  />

                  {/* Dropdown */}
                  {isDropdownOpen && searchQuery.length >= 2 && (
                    <div className="absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-xl shadow-lg max-h-80 overflow-y-auto">
                      {isSearching ? (
                        <div className="p-4 text-center text-gray-500">Searching...</div>
                      ) : (
                        <>
                          {searchResults.map((dog) => (
                            <button
                              key={dog.id}
                              type="button"
                              onClick={() => handleSelectDog(dog)}
                              className="w-full p-4 text-left hover:bg-gray-50 border-b border-gray-100 last:border-b-0 transition-colors"
                            >
                              <div className="flex items-center gap-3">
                                <div className="w-10 h-10 bg-rose-100 rounded-full flex items-center justify-center flex-shrink-0">
                                  <DogIcon className="w-5 h-5 text-rose-600" />
                                </div>
                                <div>
                                  <p className="font-medium text-gray-900">
                                    {dog.name}
                                    {dog.breed && (
                                      <span className="text-gray-500 font-normal"> ({dog.breed})</span>
                                    )}
                                  </p>
                                  {dog.customer && (
                                    <p className="text-sm text-gray-500">Owner: {dog.customer.name}</p>
                                  )}
                                </div>
                              </div>
                            </button>
                          ))}

                          {/* Create New Dog Option */}
                          <button
                            type="button"
                            onClick={handleCreateNewDog}
                            className="w-full p-4 text-left hover:bg-rose-50 bg-gray-50 transition-colors"
                          >
                            <div className="flex items-center gap-3">
                              <div className="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0">
                                <Plus className="w-5 h-5 text-green-600" />
                              </div>
                              <div>
                                <p className="font-medium text-green-700">
                                  Create New Dog: "{searchQuery}"
                                </p>
                                <p className="text-sm text-gray-500">Add a new dog to the system</p>
                              </div>
                            </div>
                          </button>
                        </>
                      )}
                    </div>
                  )}
                </div>
                <p className="text-sm text-gray-500 mt-2">
                  Start typing a dog's name to search, or create a new dog
                </p>
              </div>
            </div>
          )}

          {/* STEP 2: Create New Dog Form */}
          {step === 'create-dog' && (
            <div className="space-y-6">
              <div className="flex items-center justify-between">
                <h3 className="font-semibold text-gray-900 flex items-center gap-2">
                  <Plus className="w-5 h-5 text-green-600" />
                  Create New Dog
                </h3>
                <button
                  type="button"
                  onClick={handleBackToSearch}
                  className="text-sm text-gray-500 hover:text-gray-700"
                >
                  ‚Üê Back to search
                </button>
              </div>

              {/* Dog Details */}
              <div className="space-y-4">
                <div className="flex items-center gap-2 text-sm font-medium text-gray-700">
                  <DogIcon className="w-4 h-4 text-rose-600" />
                  Dog Details
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">
                    Dog Name <span className="text-red-500">*</span>
                  </label>
                  <Input
                    value={newDogName}
                    onChange={(e) => setNewDogName(e.target.value)}
                    placeholder="e.g. Max"
                  />
                </div>

                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-1">Breed</label>
                    <Input
                      value={newDogBreed}
                      onChange={(e) => setNewDogBreed(e.target.value)}
                      placeholder="e.g. Golden Retriever"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-1">Weight (kg)</label>
                    <Input
                      type="number"
                      value={newDogWeight}
                      onChange={(e) => setNewDogWeight(e.target.value)}
                      placeholder="e.g. 25"
                    />
                  </div>
                </div>
              </div>

              {/* Divider */}
              <div className="border-t border-gray-200" />

              {/* Owner Details */}
              <div className="space-y-4">
                <div className="flex items-center gap-2 text-sm font-medium text-gray-700">
                  <User className="w-4 h-4 text-gray-600" />
                  Owner Details
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">
                    Owner Name <span className="text-red-500">*</span>
                  </label>
                  <Input
                    value={ownerName}
                    onChange={(e) => setOwnerName(e.target.value)}
                    placeholder="e.g. John Smith"
                  />
                </div>

                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-1">Phone</label>
                    <Input
                      value={ownerPhone}
                      onChange={(e) => setOwnerPhone(e.target.value)}
                      placeholder="e.g. 0400 000 000"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-1">Email</label>
                    <Input
                      type="email"
                      value={ownerEmail}
                      onChange={(e) => setOwnerEmail(e.target.value)}
                      placeholder="e.g. john@email.com"
                    />
                  </div>
                </div>
              </div>

              {/* Action buttons */}
              <div className="flex gap-3 pt-4">
                <Button
                  type="button"
                  variant="secondary"
                  onClick={handleBackToSearch}
                  className="flex-1"
                >
                  Cancel
                </Button>
                <Button
                  type="button"
                  onClick={handleSaveNewDog}
                  disabled={isCreatingDog}
                  className="flex-1"
                >
                  {isCreatingDog ? 'Saving...' : 'Next: Book Appointment'}
                </Button>
              </div>
            </div>
          )}

          {/* STEP 3: Booking Form (for existing or newly created dog) */}
          {step === 'booking' && selectedDog && (
            <div className="space-y-6">
              {/* Selected Dog Display */}
              <div>
                <div className="flex items-center justify-between mb-3">
                  <h3 className="font-semibold text-gray-900">Booking for</h3>
                  <button
                    type="button"
                    onClick={handleBackToSearch}
                    className="text-sm text-gray-500 hover:text-gray-700"
                  >
                    ‚Üê Change dog
                  </button>
                </div>
                <div className="p-4 bg-rose-50 rounded-xl border border-rose-100">
                  <div className="flex items-center gap-4">
                    <div className="w-12 h-12 bg-rose-100 rounded-full flex items-center justify-center">
                      <DogIcon className="w-6 h-6 text-rose-600" />
                    </div>
                    <div>
                      <p className="font-semibold text-gray-900 text-lg">
                        {selectedDog.name}
                        {selectedDog.breed && (
                          <span className="text-gray-500 font-normal text-base">
                            {' '}
                            ({selectedDog.breed})
                          </span>
                        )}
                      </p>
                      {selectedDog.customer && (
                        <p className="text-gray-600">
                          <User className="w-4 h-4 inline mr-1" />
                          Owner: {selectedDog.customer.name}
                          {selectedDog.customer.phone && ` ‚Ä¢ ${selectedDog.customer.phone}`}
                        </p>
                      )}
                    </div>
                  </div>
                </div>
              </div>

              {/* Date & Time */}
              <div className="grid grid-cols-2 gap-4">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">
                    <Calendar className="w-4 h-4 inline mr-1" />
                    Date
                  </label>
                  <input
                    type="date"
                    value={appointmentDate}
                    onChange={(e) => setAppointmentDate(e.target.value)}
                    className="w-full px-3 py-2 border border-gray-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-rose-500/20 focus:border-rose-300"
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">
                    <Clock className="w-4 h-4 inline mr-1" />
                    Time
                  </label>
                  <select
                    value={appointmentTime}
                    onChange={(e) => setAppointmentTime(e.target.value)}
                    className="w-full px-3 py-2 border border-gray-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-rose-500/20 focus:border-rose-300"
                  >
                    <option value="">Select time...</option>
                    {TIME_OPTIONS.map((opt) => (
                      <option key={opt.value} value={opt.value}>
                        {opt.label}
                      </option>
                    ))}
                  </select>
                </div>
              </div>

              {/* Services */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">Services</label>
                <div className="grid grid-cols-2 gap-2">
                  {SERVICE_OPTIONS.map((service) => (
                    <button
                      key={service}
                      type="button"
                      onClick={() => handleToggleService(service)}
                      className={`p-3 text-sm rounded-lg border text-left transition-colors ${
                        selectedServices.includes(service)
                          ? 'bg-rose-50 border-rose-500 text-rose-700'
                          : 'border-gray-200 text-gray-700 hover:bg-gray-50'
                      }`}
                    >
                      {service}
                    </button>
                  ))}
                </div>
              </div>

              {/* Notes */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">Notes</label>
                <Textarea
                  value={notes}
                  onChange={(e) => setNotes(e.target.value)}
                  placeholder="Any special instructions or notes..."
                  rows={3}
                />
              </div>

              {/* Submit */}
              <div className="flex gap-3 pt-4">
                <Link href="/calendar" className="flex-1">
                  <Button type="button" variant="secondary" className="w-full">
                    Cancel
                  </Button>
                </Link>
                <Button
                  type="button"
                  onClick={handleSubmitBooking}
                  disabled={isSubmitting}
                  className="flex-1"
                >
                  {isSubmitting ? 'Creating...' : 'Create Appointment'}
                </Button>
              </div>
            </div>
          )}
        </div>
      </Card>
    </div>
  )
}
</file>

<file path="app/(app)/calendar/page.tsx">
'use client'

import { useState, useEffect } from 'react'
import { useRouter, useSearchParams } from 'next/navigation'
import { createClient } from '@/utils/supabase/client'
import { Card } from '@/components/ui/Card'
import { Button } from '@/components/ui/Button'
import { Badge } from '@/components/ui/Badge'
import { Plus, Check, Dog as DogIcon, User, Calendar as CalendarIcon } from 'lucide-react'
import CalendarGrid from './CalendarGrid'
import QuickBookModal from '@/components/booking/QuickBookModal'
import { formatTime as safeFormatTime, safeParseDate } from '@/lib/utils/date'

interface Appointment {
  id: string
  scheduled_at: string
  services: string[]
  notes: string | null
  status: string
  customer: { name: string } | null
  dog: { name: string } | null
}

function formatTime(isoString: string): string {
  return safeFormatTime(isoString)
}

function formatDateForDisplay(dateStr: string): string {
  const date = safeParseDate(dateStr + 'T12:00:00')
  if (!date) return 'Invalid Date'
  return date.toLocaleDateString('en-US', {
    weekday: 'long',
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  })
}

function getDateFromISO(isoString: string): string {
  return isoString.split('T')[0]
}

function StatusBadge({ status }: { status: string }) {
  const variants: Record<string, 'default' | 'info' | 'success'> = {
    pending_confirmation: 'default',
    confirmed: 'info',
    completed: 'success',
    cancelled: 'default'
  }
  const labels: Record<string, string> = {
    pending_confirmation: 'Pending',
    confirmed: 'Confirmed',
    completed: 'Completed',
    cancelled: 'Cancelled'
  }
  return <Badge variant={variants[status] || 'default'}>{labels[status] || status}</Badge>
}

export default function CalendarPage() {
  const router = useRouter()
  const searchParams = useSearchParams()
  const selectedDate = searchParams.get('date')
  const supabase = createClient()

  const [appointments, setAppointments] = useState<Appointment[]>([])
  const [datesWithAppointments, setDatesWithAppointments] = useState<string[]>([])
  const [isBookingModalOpen, setIsBookingModalOpen] = useState(false)

  const loadAppointments = async () => {
    const { data: appointmentsData, error: appointmentsError } = await supabase
      .from('appointments')
      .select(`
        id,
        scheduled_at,
        services,
        notes,
        status,
        customer:customers(name),
        dog:dogs(name)
      `)
      .order('scheduled_at', { ascending: true })

    if (appointmentsError) {
      console.error('Failed to fetch appointments:', appointmentsError)
    } else {
      const allAppointments: Appointment[] = (appointmentsData || []).map(appt => ({
        ...appt,
        customer: Array.isArray(appt.customer) ? appt.customer[0] : appt.customer,
        dog: Array.isArray(appt.dog) ? appt.dog[0] : appt.dog
      }))

      setAppointments(allAppointments)

      // Get dates that have appointments
      const dates = [...new Set(allAppointments.map(appt => getDateFromISO(appt.scheduled_at)))]
      setDatesWithAppointments(dates)
    }
  }

  useEffect(() => {
    loadAppointments()
  }, []) // eslint-disable-line react-hooks/exhaustive-deps

  // Get appointments for selected date
  const selectedDateAppointments = selectedDate
    ? appointments.filter(appt => getDateFromISO(appt.scheduled_at) === selectedDate)
    : []

  // Handle date selection from calendar
  const handleDateSelect = (date: string) => {
    router.push(`/calendar?date=${date}`)
  }

  // Handle booking success - refresh appointments
  const handleBookingSuccess = () => {
    loadAppointments()
  }

  return (
    <div className="space-y-6">
      <div className="flex items-center justify-between">
        <div>
          <h1 className="text-2xl font-bold text-gray-900">Calendar</h1>
          <p className="text-gray-500">Schedule and manage appointments</p>
        </div>
        <Button href="/calendar/new" className="bg-rose-500 hover:bg-rose-600">
          <Plus className="w-4 h-4 mr-2" />
          New Appointment
        </Button>
      </div>

      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <CalendarGrid
          selectedDate={selectedDate}
          datesWithAppointments={datesWithAppointments}
          onDateSelect={handleDateSelect}
        />

        <Card>
          {selectedDate ? (
            <div className="h-full flex flex-col">
              <div className="flex items-center justify-between mb-6">
                <div>
                  <h3 className="text-lg font-semibold text-gray-900">
                    {formatDateForDisplay(selectedDate)}
                  </h3>
                  <p className="text-sm text-gray-500">
                    {selectedDateAppointments.length} appointment{selectedDateAppointments.length !== 1 ? 's' : ''}
                  </p>
                </div>
                <Button
                  onClick={() => setIsBookingModalOpen(true)}
                  size="sm"
                  className="bg-rose-500 hover:bg-rose-600"
                >
                  <Plus className="w-4 h-4 mr-2" />
                  Book Appointment
                </Button>
              </div>

              <div className="flex-1 overflow-y-auto">
                {selectedDateAppointments.length > 0 ? (
                  <div className="space-y-3">
                    {selectedDateAppointments.map((appt) => (
                      <div
                        key={appt.id}
                        className="p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"
                      >
                        <div className="flex items-start justify-between">
                          <div className="flex-1">
                            <div className="flex items-center gap-2 mb-1">
                              <span className="font-semibold text-gray-900">
                                {formatTime(appt.scheduled_at)}
                              </span>
                              <StatusBadge status={appt.status} />
                            </div>
                            <div className="text-sm space-y-1">
                              <div className="flex items-center gap-1">
                                <DogIcon className="w-4 h-4 text-gray-400" />
                                <span className="font-medium">{appt.dog?.name || 'Unknown Dog'}</span>
                              </div>
                              <div className="flex items-center gap-1">
                                <User className="w-4 h-4 text-gray-400" />
                                <span className="text-gray-500">{appt.customer?.name || 'Unknown Owner'}</span>
                              </div>
                              <div className="text-gray-600 mt-2">
                                {appt.services?.join(', ') || 'No services'}
                              </div>
                              {appt.notes && (
                                <div className="text-gray-500 text-xs mt-2 italic">
                                  {appt.notes}
                                </div>
                              )}
                            </div>
                          </div>
                          {appt.status !== 'completed' && appt.status !== 'cancelled' && (
                            <a href={`/checkout/${appt.id}`}>
                              <button className="flex items-center gap-1 px-3 py-1.5 bg-green-600 text-white text-sm font-medium rounded-lg hover:bg-green-700 transition-colors">
                                <Check className="w-4 h-4" />
                                Complete
                              </button>
                            </a>
                          )}
                        </div>
                      </div>
                    ))}
                  </div>
                ) : (
                  <div className="text-center py-12 text-gray-500">
                    <CalendarIcon className="w-12 h-12 mx-auto text-gray-300 mb-2" />
                    <p className="text-lg mb-2">No appointments scheduled</p>
                    <p className="text-sm mb-4">Click &quot;Book Appointment&quot; to add one</p>
                    <Button
                      onClick={() => setIsBookingModalOpen(true)}
                      className="bg-rose-500 hover:bg-rose-600"
                    >
                      <Plus className="w-4 h-4 mr-2" />
                      Book Appointment
                    </Button>
                  </div>
                )}
              </div>
            </div>
          ) : (
            <div className="text-center py-12 text-gray-500">
              <CalendarIcon className="w-12 h-12 mx-auto text-gray-300 mb-2" />
              <p className="text-lg mb-2">Select a date</p>
              <p className="text-sm">Click on a day in the calendar to view appointments</p>
            </div>
          )}
        </Card>
      </div>

      {/* Quick Book Modal */}
      {selectedDate && (
        <QuickBookModal
          isOpen={isBookingModalOpen}
          onClose={() => setIsBookingModalOpen(false)}
          selectedDate={selectedDate}
          onSuccess={handleBookingSuccess}
        />
      )}
    </div>
  )
}
</file>

<file path="components/DogForm.tsx">
'use client'

import { useState } from 'react'
import { createClient } from '@/utils/supabase/client' // Ensure you have this utility
import { Loader2, Save } from 'lucide-react'
import { BLADE_SIZES } from '@/lib/constants/grooming'

export default function DogForm({ onSuccess }: { onSuccess?: () => void }) {
  const supabase = createClient()
  const [loading, setLoading] = useState(false)
  const [message, setMessage] = useState('')

  const [formData, setFormData] = useState({
    owner_name: '',
    owner_phone: '',
    owner_email: '',
    dog_name: '',
    breed: '',
    clipper_blade_size: '10',
    comb_attachment: '',
    default_service: '',
    nail_clipper_size: '',
    grooming_notes: '',
    behavioral_notes: ''
  })

  const COMB_ATTACHMENTS = [
    { value: '3mm', label: '3mm' },
    { value: '6mm', label: '6mm' },
    { value: '10mm', label: '10mm' },
    { value: '13mm', label: '13mm' },
    { value: '16mm', label: '16mm' },
    { value: '19mm', label: '19mm' },
  ]

  const DEFAULT_SERVICES = [
    { value: 'Full Groom', label: 'Full Groom' },
    { value: 'Bath and tidy', label: 'Bath and tidy' },
    { value: 'Bath and dry', label: 'Bath and dry' },
    { value: 'Bath/tidy/de-shed', label: 'Bath/tidy/de-shed' },
    { value: 'Nail trim', label: 'Nail trim' },
    { value: 'Puppy Groom', label: 'Puppy Groom' },
  ]

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault()
    setLoading(true)
    setMessage('')

    try {
      const { data: { user } } = await supabase.auth.getUser()
      
      if (!user) throw new Error('Not authenticated')

      // Build grooming notes with comb attachment and default service appended
      let groomingNotes = formData.grooming_notes || ''
      if (formData.comb_attachment) {
        groomingNotes += `${groomingNotes ? '\n' : ''}Comb Attachment: ${formData.comb_attachment}`
      }
      if (formData.default_service) {
        groomingNotes += `${groomingNotes ? '\n' : ''}Default Service: ${formData.default_service}`
      }

      // Prepare data for insertion
      const dataToInsert = {
        owner_name: formData.owner_name,
        owner_phone: formData.owner_phone,
        owner_email: formData.owner_email,
        dog_name: formData.dog_name,
        breed: formData.breed,
        clipper_blade_size: formData.clipper_blade_size,
        nail_clipper_size: formData.nail_clipper_size,
        grooming_notes: groomingNotes,
        behavioral_notes: formData.behavioral_notes,
        user_id: user.id
      }

      const { error } = await supabase
        .from('dogs')
        .insert([dataToInsert])

      if (error) throw error

      setMessage('‚úÖ Dog saved successfully!')
      setFormData({
        owner_name: '', owner_phone: '', owner_email: '',
        dog_name: '', breed: '', clipper_blade_size: '10',
        comb_attachment: '', default_service: '', nail_clipper_size: '', grooming_notes: '', behavioral_notes: ''
      })
      if (onSuccess) onSuccess()
    } catch (error) {
      console.error(error)
      setMessage('‚ùå Error saving dog. Please try again.')
    } finally {
      setLoading(false)
    }
  }

  const inputClass = "w-full p-4 rounded-lg border border-gray-300 text-lg min-h-[50px] focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
  const labelClass = "block text-sm font-semibold text-gray-700 mb-2 uppercase tracking-wide"

  return (
    <div className="bg-white p-6 md:p-8 rounded-xl shadow-sm border border-gray-100 max-w-4xl mx-auto">
      <h2 className="text-2xl font-bold mb-6 text-gray-900">Add New Human & Dog</h2>
      
      {message && (
        <div className={`p-4 mb-6 rounded-lg text-lg font-medium ${message.includes('Error') ? 'bg-red-50 text-red-700' : 'bg-green-50 text-green-700'}`}>
          {message}
        </div>
      )}

      <form onSubmit={handleSubmit} className="space-y-8">
        {/* Owner Section */}
        <div className="bg-gray-50 p-6 rounded-xl space-y-6">
          <h3 className="text-xl font-bold text-gray-800 flex items-center gap-2">üë§ Owner Details</h3>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label className={labelClass}>Owner Name *</label>
              <input 
                required
                type="text" 
                className={inputClass}
                value={formData.owner_name}
                onChange={e => setFormData({...formData, owner_name: e.target.value})}
              />
            </div>
            <div>
              <label className={labelClass}>Phone *</label>
              <input 
                required
                type="tel" 
                className={inputClass}
                value={formData.owner_phone}
                onChange={e => setFormData({...formData, owner_phone: e.target.value})}
              />
            </div>
            <div className="md:col-span-2">
              <label className={labelClass}>Email (Optional)</label>
              <input 
                type="email" 
                className={inputClass}
                value={formData.owner_email}
                onChange={e => setFormData({...formData, owner_email: e.target.value})}
              />
            </div>
          </div>
        </div>

        {/* Dog Section */}
        <div className="bg-blue-50 p-6 rounded-xl space-y-6">
          <h3 className="text-xl font-bold text-gray-800 flex items-center gap-2">üêï Dog Details</h3>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label className={labelClass}>Dog Name *</label>
              <input 
                required
                type="text" 
                className={inputClass}
                value={formData.dog_name}
                onChange={e => setFormData({...formData, dog_name: e.target.value})}
              />
            </div>
            <div>
              <label className={labelClass}>Breed</label>
              <input 
                type="text" 
                className={inputClass}
                value={formData.breed}
                onChange={e => setFormData({...formData, breed: e.target.value})}
              />
            </div>
          </div>
        </div>

        {/* Grooming Specifics - CRITICAL */}
        <div className="bg-amber-50 p-6 rounded-xl space-y-6 border-2 border-amber-100">
          <h3 className="text-xl font-bold text-amber-900 flex items-center gap-2">‚úÇÔ∏è Grooming Specifics</h3>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label className={labelClass}>Blade Size *</label>
              <select 
                className={`${inputClass} bg-white`}
                value={formData.clipper_blade_size}
                onChange={e => setFormData({...formData, clipper_blade_size: e.target.value})}
              >
                {BLADE_SIZES.map(({ value, label }) => (
                  <option key={value} value={value}>{label}</option>
                ))}
              </select>
            </div>
            <div>
              <label className={labelClass}>Comb Attachment</label>
              <select
                className={`${inputClass} bg-white`}
                value={formData.comb_attachment}
                onChange={e => setFormData({...formData, comb_attachment: e.target.value})}
              >
                <option value="">Select comb attachment</option>
                {COMB_ATTACHMENTS.map(({ value, label }) => (
                  <option key={value} value={value}>{label}</option>
                ))}
              </select>
            </div>
            <div>
              <label className={labelClass}>Default Service</label>
              <select
                className={`${inputClass} bg-white`}
                value={formData.default_service}
                onChange={e => setFormData({...formData, default_service: e.target.value})}
              >
                <option value="">Select default service</option>
                {DEFAULT_SERVICES.map(({ value, label }) => (
                  <option key={value} value={value}>{label}</option>
                ))}
              </select>
            </div>
            <div>
              <label className={labelClass}>Nail Clipper Size</label>
              <input 
                type="text" 
                placeholder="e.g. Small / Large / Dremel"
                className={inputClass}
                value={formData.nail_clipper_size}
                onChange={e => setFormData({...formData, nail_clipper_size: e.target.value})}
              />
            </div>
            <div className="md:col-span-2">
              <label className={labelClass}>Grooming Notes</label>
              <textarea 
                rows={3}
                className={inputClass}
                placeholder="Style preferences, pattern notes..."
                value={formData.grooming_notes}
                onChange={e => setFormData({...formData, grooming_notes: e.target.value})}
              />
            </div>
            <div className="md:col-span-2">
              <label className={labelClass}>Behavioral Notes ‚ö†Ô∏è</label>
              <textarea 
                rows={2}
                className={`${inputClass} border-red-200 focus:border-red-500 focus:ring-red-200`}
                placeholder="Nervous with dryers, cage aggressive, etc."
                value={formData.behavioral_notes}
                onChange={e => setFormData({...formData, behavioral_notes: e.target.value})}
              />
            </div>
          </div>
        </div>

        <button 
          type="submit" 
          disabled={loading}
          className="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold text-xl py-5 rounded-xl shadow-lg transform transition active:scale-[0.98] flex items-center justify-center gap-3"
        >
          {loading ? <Loader2 className="animate-spin h-6 w-6" /> : <Save className="h-6 w-6" />}
          Save New Human
        </button>
      </form>
    </div>
  )
}
</file>

<file path="app/(app)/dogs/[id]/DogDetailClient.tsx">
'use client'

import { useState, useRef, useEffect } from 'react'
import Link from 'next/link'
import Image from 'next/image'
import { Calendar, FileText, Camera, X, Loader2, Trash2 } from 'lucide-react'
import { Button } from '@/components/ui/Button'
import { Card } from '@/components/ui/Card'
import { Modal } from '@/components/ui/Modal'
import { addGroomingNote, updateGroomingPreferences, deleteDog, type GroomingPreferences } from '@/lib/actions/dogs'
import { uploadDogPhoto, deleteDogPhoto } from '@/lib/actions/photos'
import { useRouter } from 'next/navigation'
import { BLADE_SIZES } from '@/lib/constants/grooming'

interface DogQuickActionsProps {
  dogId: string
  dogName: string
  customerPhone: string | null
  photoUrl: string | null
  groomingPreferences?: GroomingPreferences
  isDemo?: boolean
}

// Editable Grooming Preferences Panel
interface EditableGroomingPreferencesProps {
  dogId: string
  initialPreferences: GroomingPreferences
  isDemo?: boolean
}

export function EditableGroomingPreferences({ dogId, initialPreferences, isDemo }: EditableGroomingPreferencesProps) {
  const [isEditing, setIsEditing] = useState(false)
  const [preferences, setPreferences] = useState<GroomingPreferences>(initialPreferences)
  const [saving, setSaving] = useState(false)

  const handleSave = async () => {
    setSaving(true)

    if (isDemo) {
      await new Promise(resolve => setTimeout(resolve, 500))
      setIsEditing(false)
      setSaving(false)
      return
    }

    const result = await updateGroomingPreferences(dogId, preferences)
    if (result.success) {
      setIsEditing(false)
      window.location.reload()
    }

    setSaving(false)
  }

  const handleCancel = () => {
    setPreferences(initialPreferences)
    setIsEditing(false)
  }

  return (
    <Card>
      <div className="p-6">
        <div className="flex items-center justify-between mb-4">
          <h3 className="font-semibold text-gray-900">Grooming Preferences</h3>
          {isEditing && (
            <div className="flex gap-2">
              <Button variant="ghost" size="sm" onClick={handleCancel} disabled={saving}>
                Cancel
              </Button>
              <Button variant="primary" size="sm" onClick={handleSave} disabled={saving}>
                {saving ? 'Saving...' : 'Save'}
              </Button>
            </div>
          )}
        </div>

        {isEditing ? (
          <div className="space-y-4">
            <div className="grid grid-cols-2 gap-3">
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">
                  Blade Size
                </label>
                <select
                  value={preferences.blade_size || ''}
                  onChange={(e) => setPreferences({ ...preferences, blade_size: e.target.value })}
                  className="w-full p-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"
                >
                  <option value="">Select blade</option>
                  {BLADE_SIZES.map((size) => (
                    <option key={size.value} value={size.value}>
                      {size.label}
                    </option>
                  ))}
                </select>
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">
                  Comb Attachment
                </label>
                <select
                  value={preferences.comb_attachment || ''}
                  onChange={(e) => setPreferences({ ...preferences, comb_attachment: e.target.value })}
                  className="w-full p-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"
                >
                  <option value="">Select comb</option>
                  <option value="3mm">3mm</option>
                  <option value="6mm">6mm</option>
                  <option value="10mm">10mm</option>
                  <option value="13mm">13mm</option>
                  <option value="16mm">16mm</option>
                  <option value="19mm">19mm</option>
                </select>
              </div>
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Default Service
              </label>
              <select
                value={preferences.default_service || ''}
                onChange={(e) => setPreferences({ ...preferences, default_service: e.target.value })}
                className="w-full p-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"
              >
                <option value="">Select service</option>
                <option value="Full Groom">Full Groom</option>
                <option value="Bath and tidy">Bath and tidy</option>
                <option value="Bath and dry">Bath and dry</option>
                <option value="Bath/tidy/de-shed">Bath/tidy/de-shed</option>
                <option value="Nail trim">Nail trim</option>
                <option value="Puppy Groom">Puppy Groom</option>
              </select>
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Clipping Notes
              </label>
              <textarea
                value={preferences.clipping_notes || ''}
                onChange={(e) => setPreferences({ ...preferences, clipping_notes: e.target.value })}
                placeholder="e.g. Shorter on belly, leave tail fluffy..."
                className="w-full h-16 p-2 border border-gray-200 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"
              />
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Coat Notes
              </label>
              <textarea
                value={preferences.coat_notes || ''}
                onChange={(e) => setPreferences({ ...preferences, coat_notes: e.target.value })}
                placeholder="e.g. Heavy shedder..."
                className="w-full h-16 p-2 border border-gray-200 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"
              />
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Behavior Notes
              </label>
              <textarea
                value={preferences.behavior_notes || ''}
                onChange={(e) => setPreferences({ ...preferences, behavior_notes: e.target.value })}
                placeholder="e.g. Anxious around dryers..."
                className="w-full h-16 p-2 border border-gray-200 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"
              />
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Special Instructions
              </label>
              <textarea
                value={preferences.special_instructions || ''}
                onChange={(e) => setPreferences({ ...preferences, special_instructions: e.target.value })}
                placeholder="e.g. Use calming spray..."
                className="w-full h-16 p-2 border border-gray-200 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"
              />
            </div>
          </div>
        ) : (
          <div
            onClick={() => setIsEditing(true)}
            className="space-y-4 cursor-pointer hover:bg-gray-50 -mx-2 -mb-2 p-2 rounded-lg transition-colors"
          >
            {preferences.blade_size && (
              <div>
                <p className="text-sm text-gray-500">Blade Size</p>
                <p className="text-gray-900">{preferences.blade_size}</p>
              </div>
            )}
            {preferences.comb_attachment && (
              <div>
                <p className="text-sm text-gray-500">Comb Attachment</p>
                <p className="text-gray-900">{preferences.comb_attachment}</p>
              </div>
            )}
            {preferences.default_service && (
              <div>
                <p className="text-sm text-gray-500">Default Service</p>
                <p className="text-gray-900">{preferences.default_service}</p>
              </div>
            )}
            {preferences.clipping_notes && (
              <div>
                <p className="text-sm text-gray-500">Clipping Notes</p>
                <p className="text-gray-900">{preferences.clipping_notes}</p>
              </div>
            )}
            {preferences.coat_notes && (
              <div>
                <p className="text-sm text-gray-500">Coat Notes</p>
                <p className="text-gray-900">{preferences.coat_notes}</p>
              </div>
            )}
            {preferences.behavior_notes && (
              <div>
                <p className="text-sm text-gray-500">Behavior Notes</p>
                <p className="text-gray-900">{preferences.behavior_notes}</p>
              </div>
            )}
            {preferences.special_instructions && (
              <div>
                <p className="text-sm text-gray-500">Special Instructions</p>
                <p className="text-gray-900">{preferences.special_instructions}</p>
              </div>
            )}
            {Object.keys(preferences).length === 0 && (
              <p className="text-gray-500 italic">No grooming preferences recorded yet. Tap to add.</p>
            )}
            <p className="text-xs text-gray-400 mt-4 flex items-center gap-1">
              <FileText className="w-3 h-3" />
              Tap anywhere to edit
            </p>
          </div>
        )}
      </div>
    </Card>
  )
}

// Editable General Notes Panel
interface EditableGeneralNotesProps {
  dogId: string
  dogName: string
  initialNotes: string | null
  isDemo?: boolean
}

export function EditableGeneralNotes({ dogId, dogName, initialNotes, isDemo }: EditableGeneralNotesProps) {
  const [isEditing, setIsEditing] = useState(false)
  const [notes, setNotes] = useState(initialNotes || '')
  const [saving, setSaving] = useState(false)

  const handleSave = async () => {
    setSaving(true)

    if (isDemo) {
      await new Promise(resolve => setTimeout(resolve, 500))
      setIsEditing(false)
      setSaving(false)
      return
    }

    const result = await addGroomingNote(dogId, notes)
    if (result.success) {
      setIsEditing(false)
      window.location.reload()
    }

    setSaving(false)
  }

  const handleCancel = () => {
    setNotes(initialNotes || '')
    setIsEditing(false)
  }

  return (
    <Card>
      <div className="p-6">
        <div className="flex items-center justify-between mb-4">
          <h3 className="font-semibold text-gray-900">Notes</h3>
          {isEditing && (
            <div className="flex gap-2">
              <Button variant="ghost" size="sm" onClick={handleCancel} disabled={saving}>
                Cancel
              </Button>
              <Button variant="primary" size="sm" onClick={handleSave} disabled={saving}>
                {saving ? 'Saving...' : 'Save'}
              </Button>
            </div>
          )}
        </div>

        {isEditing ? (
          <textarea
            value={notes}
            onChange={(e) => setNotes(e.target.value)}
            placeholder={`Add notes about ${dogName}...`}
            className="w-full h-32 p-3 border border-gray-200 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-rose-500 focus:border-transparent"
          />
        ) : (
          <div
            onClick={() => setIsEditing(true)}
            className="cursor-pointer hover:bg-gray-50 -mx-2 -mb-2 p-2 rounded-lg transition-colors"
          >
            <p className="text-gray-700 whitespace-pre-wrap mb-3">
              {notes || <span className="text-gray-500 italic">No notes yet. Tap to add.</span>}
            </p>
            <p className="text-xs text-gray-400 flex items-center gap-1">
              <FileText className="w-3 h-3" />
              Tap anywhere to edit
            </p>
          </div>
        )}
      </div>
    </Card>
  )
}

// Dog Photo Component
interface DogPhotoProps {
  dogId: string
  dogName: string
  photoUrl: string | null
  isDemo?: boolean
}

export function DogPhoto({ dogId, dogName, photoUrl, isDemo }: DogPhotoProps) {
  const [currentPhoto, setCurrentPhoto] = useState(photoUrl)
  const [uploading, setUploading] = useState(false)
  const [deleting, setDeleting] = useState(false)
  const [error, setError] = useState<string | null>(null)
  const fileInputRef = useRef<HTMLInputElement>(null)

  const handleFileSelect = async (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0]
    if (!file) return

    setError(null)
    setUploading(true)

    if (isDemo) {
      // Demo mode - create a local preview
      const reader = new FileReader()
      reader.onload = (event) => {
        setCurrentPhoto(event.target?.result as string)
        setUploading(false)
      }
      reader.readAsDataURL(file)
      return
    }

    const formData = new FormData()
    formData.append('photo', file)

    const result = await uploadDogPhoto(dogId, formData)

    if (result.success && result.url) {
      setCurrentPhoto(result.url)
    } else {
      setError(result.error || 'Upload failed')
    }

    setUploading(false)
    // Reset file input
    if (fileInputRef.current) {
      fileInputRef.current.value = ''
    }
  }

  const handleDelete = async () => {
    if (isDemo) {
      setCurrentPhoto(null)
      return
    }

    setDeleting(true)
    const result = await deleteDogPhoto(dogId)

    if (result.success) {
      setCurrentPhoto(null)
    } else {
      setError(result.error || 'Delete failed')
    }

    setDeleting(false)
  }

  return (
    <div className="relative">
      {currentPhoto ? (
        <div className="relative w-24 h-24 rounded-full overflow-hidden group">
          <Image
            src={currentPhoto}
            alt={dogName}
            fill
            className="object-cover"
          />
          <div className="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2">
            <button
              onClick={() => fileInputRef.current?.click()}
              disabled={uploading || deleting}
              className="p-1.5 bg-white/90 rounded-full hover:bg-white transition-colors"
              title="Change photo"
            >
              <Camera className="w-4 h-4 text-gray-700" />
            </button>
            <button
              onClick={handleDelete}
              disabled={uploading || deleting}
              className="p-1.5 bg-white/90 rounded-full hover:bg-white transition-colors"
              title="Remove photo"
            >
              {deleting ? (
                <Loader2 className="w-4 h-4 text-gray-700 animate-spin" />
              ) : (
                <X className="w-4 h-4 text-gray-700" />
              )}
            </button>
          </div>
        </div>
      ) : (
        <button
          onClick={() => fileInputRef.current?.click()}
          disabled={uploading}
          className="w-24 h-24 bg-rose-100 rounded-full flex flex-col items-center justify-center text-rose-600 hover:bg-rose-200 transition-colors cursor-pointer"
        >
          {uploading ? (
            <Loader2 className="w-8 h-8 animate-spin" />
          ) : (
            <>
              <span className="text-3xl mb-1">üêï</span>
              <span className="text-xs flex items-center gap-1">
                <Camera className="w-3 h-3" />
                Add
              </span>
            </>
          )}
        </button>
      )}

      <input
        ref={fileInputRef}
        type="file"
        accept="image/jpeg,image/png,image/webp,image/heic"
        onChange={handleFileSelect}
        className="hidden"
      />

      {error && (
        <p className="absolute -bottom-6 left-0 right-0 text-xs text-red-500 text-center">
          {error}
        </p>
      )}
    </div>
  )
}

export function DogQuickActions({ dogId, dogName, customerPhone, photoUrl, groomingPreferences = {}, isDemo }: DogQuickActionsProps) {
  const router = useRouter()
  const [showNoteModal, setShowNoteModal] = useState(false)
  const [showPreferencesModal, setShowPreferencesModal] = useState(false)
  const [showDeleteModal, setShowDeleteModal] = useState(false)
  const [note, setNote] = useState('')
  const [saving, setSaving] = useState(false)
  const [saved, setSaved] = useState(false)
  const [deleting, setDeleting] = useState(false)
  const [currentPhoto, setCurrentPhoto] = useState(photoUrl)
  const [uploading, setUploading] = useState(false)
  const [preferences, setPreferences] = useState<GroomingPreferences>(groomingPreferences)
  const textareaRef = useRef<HTMLTextAreaElement>(null)
  const photoInputRef = useRef<HTMLInputElement>(null)

  const handlePhotoSelect = async (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0]
    if (!file) return

    setUploading(true)

    if (isDemo) {
      const reader = new FileReader()
      reader.onload = (event) => {
        setCurrentPhoto(event.target?.result as string)
        setUploading(false)
      }
      reader.readAsDataURL(file)
      return
    }

    const formData = new FormData()
    formData.append('photo', file)

    const result = await uploadDogPhoto(dogId, formData)

    if (result.success && result.url) {
      setCurrentPhoto(result.url)
    }

    setUploading(false)
    if (photoInputRef.current) {
      photoInputRef.current.value = ''
    }
  }

  // Focus textarea when modal opens
  useEffect(() => {
    if (showNoteModal && textareaRef.current) {
      textareaRef.current.focus()
    }
  }, [showNoteModal])

  const handleSave = async () => {
    if (!note.trim()) return

    setSaving(true)

    if (isDemo) {
      // Demo mode - just show success without persisting
      await new Promise(resolve => setTimeout(resolve, 500))
      setSaved(true)
      setTimeout(() => {
        setShowNoteModal(false)
        setNote('')
        setSaved(false)
      }, 1000)
    } else {
      const result = await addGroomingNote(dogId, note.trim())
      if (result.success) {
        setSaved(true)
        setTimeout(() => {
          setShowNoteModal(false)
          setNote('')
          setSaved(false)
        }, 1000)
      }
    }

    setSaving(false)
  }

  const handleCancel = () => {
    setShowNoteModal(false)
    setNote('')
  }

  const handleSavePreferences = async () => {
    setSaving(true)

    if (isDemo) {
      // Demo mode - just show success without persisting
      await new Promise(resolve => setTimeout(resolve, 500))
      setSaved(true)
      setTimeout(() => {
        setShowPreferencesModal(false)
        setSaved(false)
      }, 1000)
    } else {
      const result = await updateGroomingPreferences(dogId, preferences)
      if (result.success) {
        setSaved(true)
        setTimeout(() => {
          setShowPreferencesModal(false)
          setSaved(false)
          // Reload page to show updated preferences
          window.location.reload()
        }, 1000)
      }
    }

    setSaving(false)
  }

  const handleCancelPreferences = () => {
    setShowPreferencesModal(false)
    setPreferences(groomingPreferences)
  }

  const handleDeleteDog = async () => {
    if (isDemo) {
      // In demo mode, just navigate away
      router.push('/dogs')
      return
    }

    setDeleting(true)
    const result = await deleteDog(dogId)
    
    if (result.success) {
      router.push('/dogs')
    } else {
      alert(result.error || 'Failed to delete dog')
      setDeleting(false)
    }
  }

  return (
    <>
      <Card>
        <div className="p-6">
          <h3 className="font-semibold text-gray-900 mb-4">Quick Actions</h3>
          <div className="space-y-3">
            <Link href="/calendar/new" className="block">
              <Button variant="secondary" className="w-full justify-start">
                <Calendar className="w-4 h-4 mr-2" />
                Schedule Grooming
              </Button>
            </Link>
            <Button
              variant="secondary"
              className="w-full justify-start"
              onClick={() => setShowPreferencesModal(true)}
            >
              <FileText className="w-4 h-4 mr-2" />
              Grooming Notes & Preferences
            </Button>
            <Button
              variant="secondary"
              className="w-full justify-start"
              onClick={() => photoInputRef.current?.click()}
              disabled={uploading}
            >
              <Camera className="w-4 h-4 mr-2" />
              {uploading ? 'Uploading...' : currentPhoto ? 'Change Photo' : 'Add Photo'}
            </Button>
            <div className="pt-3 border-t border-gray-200">
              <Button 
                variant="ghost" 
                className="w-full justify-start text-red-600 hover:text-red-700 hover:bg-red-50"
                onClick={() => setShowDeleteModal(true)}
              >
                <Trash2 className="w-4 h-4 mr-2" />
                Delete Dog
              </Button>
            </div>
            <input
              ref={photoInputRef}
              type="file"
              accept="image/jpeg,image/png,image/webp,image/heic"
              onChange={handlePhotoSelect}
              className="hidden"
            />
          </div>
        </div>
      </Card>

      {/* Add Grooming Note Modal */}
      <Modal
        isOpen={showNoteModal}
        onClose={handleCancel}
        title={`Add Grooming Note for ${dogName}`}
        size="md"
      >
        <div className="p-6">
          <textarea
            ref={textareaRef}
            value={note}
            onChange={(e) => setNote(e.target.value)}
            placeholder="e.g. Nervous during dryer, prefers low heat..."
            className="w-full h-32 p-3 border border-gray-200 rounded-xl resize-none focus:outline-none focus:ring-2 focus:ring-rose-500 focus:border-transparent"
            disabled={saving || saved}
          />
          <div className="flex justify-end gap-3 mt-4">
            <Button
              variant="ghost"
              onClick={handleCancel}
              disabled={saving}
            >
              Cancel
            </Button>
            <Button
              variant="primary"
              onClick={handleSave}
              disabled={!note.trim() || saving || saved}
            >
              {saved ? 'Saved!' : saving ? 'Saving...' : 'Save Note'}
            </Button>
          </div>
        </div>
      </Modal>

      {/* Update Grooming Preferences Modal */}
      <Modal
        isOpen={showPreferencesModal}
        onClose={handleCancelPreferences}
        title={`Grooming Preferences for ${dogName}`}
        size="lg"
      >
        <div className="p-6 space-y-6">
          {/* Blade & Comb */}
          <div className="grid grid-cols-2 gap-4">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Blade Size
              </label>
              <select
                value={preferences.blade_size || ''}
                onChange={(e) => setPreferences({ ...preferences, blade_size: e.target.value })}
                className="w-full p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                disabled={saving || saved}
              >
                <option value="">Select blade</option>
                {BLADE_SIZES.map((size) => (
                  <option key={size.value} value={size.value}>
                    {size.label}
                  </option>
                ))}
              </select>
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Comb Attachment
              </label>
              <select
                value={preferences.comb_attachment || ''}
                onChange={(e) => setPreferences({ ...preferences, comb_attachment: e.target.value })}
                className="w-full p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                disabled={saving || saved}
              >
                <option value="">Select comb</option>
                <option value="3mm">3mm</option>
                <option value="6mm">6mm</option>
                <option value="10mm">10mm</option>
                <option value="13mm">13mm</option>
                <option value="16mm">16mm</option>
                <option value="19mm">19mm</option>
              </select>
            </div>
          </div>

          {/* Default Service */}
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">
              Default Service
            </label>
            <select
              value={preferences.default_service || ''}
              onChange={(e) => setPreferences({ ...preferences, default_service: e.target.value })}
              className="w-full p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              disabled={saving || saved}
            >
              <option value="">Select service</option>
              <option value="Full Groom">Full Groom</option>
              <option value="Bath and tidy">Bath and tidy</option>
              <option value="Bath and dry">Bath and dry</option>
              <option value="Bath/tidy/de-shed">Bath/tidy/de-shed</option>
              <option value="Nail trim">Nail trim</option>
              <option value="Puppy Groom">Puppy Groom</option>
            </select>
          </div>

          {/* Clipping Notes */}
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">
              Clipping Notes
            </label>
            <textarea
              value={preferences.clipping_notes || ''}
              onChange={(e) => setPreferences({ ...preferences, clipping_notes: e.target.value })}
              placeholder="e.g. Shorter on belly, leave tail fluffy..."
              className="w-full h-20 p-3 border border-gray-200 rounded-xl resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              disabled={saving || saved}
            />
          </div>

          {/* Coat Notes */}
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">
              Coat Notes
            </label>
            <textarea
              value={preferences.coat_notes || ''}
              onChange={(e) => setPreferences({ ...preferences, coat_notes: e.target.value })}
              placeholder="e.g. Heavy shedder, matting behind ears, sensitive skin..."
              className="w-full h-20 p-3 border border-gray-200 rounded-xl resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              disabled={saving || saved}
            />
          </div>

          {/* Behavior Notes */}
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">
              Behavior Notes
            </label>
            <textarea
              value={preferences.behavior_notes || ''}
              onChange={(e) => setPreferences({ ...preferences, behavior_notes: e.target.value })}
              placeholder="e.g. Anxious around dryers, doesn't like paws touched..."
              className="w-full h-20 p-3 border border-gray-200 rounded-xl resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              disabled={saving || saved}
            />
          </div>

          {/* Special Instructions */}
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">
              Special Instructions
            </label>
            <textarea
              value={preferences.special_instructions || ''}
              onChange={(e) => setPreferences({ ...preferences, special_instructions: e.target.value })}
              placeholder="e.g. Use calming spray, take frequent breaks..."
              className="w-full h-20 p-3 border border-gray-200 rounded-xl resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              disabled={saving || saved}
            />
          </div>

          <div className="flex justify-end gap-3 pt-4 border-t">
            <Button
              variant="ghost"
              onClick={handleCancelPreferences}
              disabled={saving}
            >
              Cancel
            </Button>
            <Button
              variant="primary"
              onClick={handleSavePreferences}
              disabled={saving || saved}
            >
              {saved ? 'Saved!' : saving ? 'Saving...' : 'Save Preferences'}
            </Button>
          </div>
        </div>
      </Modal>

      {/* Delete Confirmation Modal */}
      <Modal
        isOpen={showDeleteModal}
        onClose={() => setShowDeleteModal(false)}
        title="Delete Dog?"
        size="sm"
      >
        <div className="p-6">
          <p className="text-gray-700 mb-4">
            Are you sure you want to delete <span className="font-semibold">{dogName}</span>? 
            This will also delete all associated grooming history and appointments.
          </p>
          <p className="text-sm text-red-600 mb-6">
            This action cannot be undone.
          </p>
          <div className="flex justify-end gap-3">
            <Button
              variant="ghost"
              onClick={() => setShowDeleteModal(false)}
              disabled={deleting}
            >
              Cancel
            </Button>
            <Button
              variant="primary"
              onClick={handleDeleteDog}
              disabled={deleting}
              className="bg-red-600 hover:bg-red-700"
            >
              {deleting ? 'Deleting...' : 'Delete Dog'}
            </Button>
          </div>
        </div>
      </Modal>
    </>
  )
}
</file>

<file path="components/layout/Sidebar.tsx">
'use client'

import Link from 'next/link'
import Image from 'next/image'
import { usePathname } from 'next/navigation'
import { cn } from '@/lib/utils'
import { Home, Dog, Calendar, Bell, Clock, Settings, Image as ImageIcon, Smile } from 'lucide-react'

const navItems = [
  { href: '/dashboard', label: 'Dashboard', icon: Home },
  { href: '/dogs', label: 'Dogs', icon: Dog },
  { href: '/calendar', label: 'Calendar', icon: Calendar },
  { href: '/photos', label: 'Photos', icon: ImageIcon },
  { href: '/groomers', label: 'Groomers', icon: Smile },
  { href: '/notifications', label: 'Notifications', icon: Bell },
  { href: '/history', label: 'History', icon: Clock },
  { href: '/settings', label: 'Settings', icon: Settings },
]

export function Sidebar() {
  const pathname = usePathname()

  return (
    <aside className="w-64 bg-white border-r border-gray-100 min-h-screen flex flex-col shadow-sm">
      {/* Logo */}
      <div className="p-6 border-b border-gray-100">
        <Link href="/dashboard" className="flex items-center justify-center">
          <Image
            src="/oh-my-dawg-logo.png"
            alt="Oh My Dawg! Grooming"
            width={180}
            height={120}
            priority
            className="object-contain"
          />
        </Link>
      </div>

      {/* Navigation */}
      <nav className="flex-1 p-4">
        <ul className="space-y-1">
          {navItems.map((item) => {
            const isActive = pathname === item.href || pathname.startsWith(item.href + '/')
            const Icon = item.icon
            return (
              <li key={item.href}>
                <Link
                  href={item.href}
                  className={cn(
                    'flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium transition-all duration-200',
                    isActive
                      ? 'bg-rose-500 text-white shadow-sm'
                      : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900'
                  )}
                >
                  <Icon className={cn('w-5 h-5', isActive ? 'text-white' : 'text-gray-400')} />
                  {item.label}
                </Link>
              </li>
            )
          })}
        </ul>
      </nav>

      {/* Pro Tip Footer */}
      <div className="p-4 border-t border-gray-100">
        <div className="bg-gradient-to-r from-rose-50 to-pink-50 rounded-xl p-4">
          <p className="text-xs font-medium text-rose-600 mb-1">Pro Tip</p>
          <p className="text-sm text-gray-600">
            Use keyboard shortcuts for faster navigation!
          </p>
        </div>
      </div>
    </aside>
  )
}
</file>

<file path="components/AddDogForm.tsx">
'use client'

import { useState } from 'react'
import { createDog } from '@/lib/actions/dogs'
// We import the Dog type we just made
import { Dog } from '@/app/types' 
import { BLADE_SIZES } from '@/lib/constants/grooming'

export default function AddDogForm({ onDogAdded }: { onDogAdded?: (dog: Dog) => void }) {
  const [loading, setLoading] = useState(false)
  const [message, setMessage] = useState('')

  // Form state
  const [formData, setFormData] = useState({
    dog_name: '',
    owner_name: '',
    owner_phone: '',
    owner_email: '',
    breed: '',
    clipper_blade_size: '',
    comb_attachment: '',
    nail_clipper_size: '',
    grooming_notes: '',
    behavioral_notes: '',
  })

  const handleNameChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    setFormData({ ...formData, dog_name: e.target.value })
  }

  const handlePhoneChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    setFormData({ ...formData, owner_phone: e.target.value })
  }

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault()
    setLoading(true)
    setMessage('')

    // Call the createDog server action
    const result = await createDog({
      dog_name: formData.dog_name,
      owner_name: formData.owner_name,
      owner_phone: formData.owner_phone,
      owner_email: formData.owner_email,
      breed: formData.breed,
      clipper_blade_size: formData.clipper_blade_size,
      comb_attachment: formData.comb_attachment,
      nail_clipper_size: formData.nail_clipper_size,
      grooming_notes: formData.grooming_notes,
      behavioral_notes: formData.behavioral_notes,
    })

    if (!result.success) {
      console.error('Error adding dog:', result.error)
      setMessage(`Error: ${result.error || 'Failed to add dog'}`)
    } else {
      setMessage('Success! Dog added.')
      // Clear the form
      setFormData({
        dog_name: '',
        owner_name: '',
        owner_phone: '',
        owner_email: '',
        breed: '',
        clipper_blade_size: '',
        comb_attachment: '',
        nail_clipper_size: '',
        grooming_notes: '',
        behavioral_notes: '',
      })
      // Notify parent component if needed
      if (onDogAdded && result.data) onDogAdded(result.data)
    }
    setLoading(false)
  }

  return (
    <div className="p-6 bg-white rounded-2xl shadow-lg border-2 border-pink-100 max-w-md">
      <h2 className="text-2xl font-bold mb-6 text-gray-800 flex items-center gap-2">
        <span className="text-2xl">üêï</span>
        Add New Pup
      </h2>
      
      <form onSubmit={handleSubmit} className="space-y-4">
        <div>
          <label className="block text-sm font-medium text-gray-700">Dog Name</label>
          <input
            type="text"
            required
            name="dog_name"
            id="dog_name"
            className="mt-1 block w-full rounded-lg border-2 border-pink-200 p-3 text-gray-900 shadow-sm focus:border-pink-400 focus:ring-pink-400 min-h-[44px]"
            value={formData.dog_name}
            onChange={handleNameChange}
          />
        </div>

        <div>
          <label className="block text-sm font-medium text-gray-700">Owner Name</label>
          <input
            type="text"
            required
            name="owner_name"
            id="owner_name"
            className="mt-1 block w-full rounded-lg border-2 border-pink-200 p-3 text-gray-900 shadow-sm focus:border-pink-400 focus:ring-pink-400 min-h-[44px]"
            value={formData.owner_name}
            onChange={(e) => setFormData({ ...formData, owner_name: e.target.value })}
          />
        </div>

        <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label className="block text-sm font-medium text-gray-700">Phone</label>
            <input
              type="tel"
              required
              name="owner_phone"
              id="owner_phone"
              className="mt-1 block w-full rounded-lg border-2 border-pink-200 p-3 text-gray-900 shadow-sm focus:border-pink-400 focus:ring-pink-400 min-h-[44px]"
              value={formData.owner_phone}
              onChange={handlePhoneChange}
            />
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-700">Email</label>
            <input
              type="email"
              required
              name="owner_email"
              id="owner_email"
              className="mt-1 block w-full rounded-lg border-2 border-pink-200 p-3 text-gray-900 shadow-sm focus:border-pink-400 focus:ring-pink-400 min-h-[44px]"
              value={formData.owner_email}
              onChange={(e) => setFormData({ ...formData, owner_email: e.target.value })}
            />
          </div>
        </div>

        <div>
          <label className="block text-sm font-medium text-gray-700">Breed</label>
          <input
            type="text"
            required
            name="breed"
            id="breed"
            className="mt-1 block w-full rounded-lg border-2 border-pink-200 p-3 text-gray-900 shadow-sm focus:border-pink-400 focus:ring-pink-400 min-h-[44px]"
            value={formData.breed}
            onChange={(e) => setFormData({ ...formData, breed: e.target.value })}
          />
        </div>

        <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label className="block text-sm font-medium text-gray-700">Blade Size</label>
            <select
              name="clipper_blade_size"
              id="clipper_blade_size"
              className="mt-1 block w-full rounded-lg border-2 border-pink-200 p-3 text-gray-900 shadow-sm focus:border-pink-400 focus:ring-pink-400 min-h-[44px]"
              value={formData.clipper_blade_size}
              onChange={(e) => setFormData({ ...formData, clipper_blade_size: e.target.value })}
            >
              <option value="">Select blade size</option>
              {BLADE_SIZES.map((size) => (
                <option key={size.value} value={size.value}>
                  {size.label}
                </option>
              ))}
            </select>
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-700">Comb Attachment</label>
            <select
              name="comb_attachment"
              id="comb_attachment"
              className="mt-1 block w-full rounded-lg border-2 border-pink-200 p-3 text-gray-900 shadow-sm focus:border-pink-400 focus:ring-pink-400 min-h-[44px]"
              value={formData.comb_attachment}
              onChange={(e) => setFormData({ ...formData, comb_attachment: e.target.value })}
            >
              <option value="">Select comb attachment</option>
              <option value="3mm">3mm</option>
              <option value="6mm">6mm</option>
              <option value="10mm">10mm</option>
              <option value="13mm">13mm</option>
              <option value="16mm">16mm</option>
              <option value="19mm">19mm</option>
            </select>
          </div>
        </div>
        <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label className="block text-sm font-medium text-gray-700">Nail Clipper Size</label>
            <input
              type="text"
              name="nail_clipper_size"
              id="nail_clipper_size"
              className="mt-1 block w-full rounded-lg border-2 border-pink-200 p-3 text-gray-900 shadow-sm focus:border-pink-400 focus:ring-pink-400 min-h-[44px]"
              value={formData.nail_clipper_size}
              onChange={(e) => setFormData({ ...formData, nail_clipper_size: e.target.value })}
            />
          </div>
        </div>

        <div>
          <label className="block text-sm font-medium text-gray-700">Grooming Notes</label>
          <textarea
            name="grooming_notes"
            id="grooming_notes"
            className="mt-1 block w-full rounded-lg border-2 border-pink-200 p-3 text-gray-900 shadow-sm focus:border-pink-400 focus:ring-pink-400"
            rows={3}
            placeholder="Coat preferences, style notes, etc."
            value={formData.grooming_notes}
            onChange={(e) => setFormData({ ...formData, grooming_notes: e.target.value })}
          />
        </div>

        <div>
          <label className="block text-sm font-medium text-gray-700">Behavioral Notes</label>
          <textarea
            name="behavioral_notes"
            id="behavioral_notes"
            className="mt-1 block w-full rounded-lg border-2 border-pink-200 p-3 text-gray-900 shadow-sm focus:border-pink-400 focus:ring-pink-400"
            rows={3}
            placeholder="Temperament, handling requirements, etc."
            value={formData.behavioral_notes}
            onChange={(e) => setFormData({ ...formData, behavioral_notes: e.target.value })}
          />
        </div>

        <button
          type="submit"
          disabled={loading}
          className="w-full flex justify-center items-center gap-2 py-4 px-4 border border-transparent rounded-xl shadow-lg text-base font-semibold text-white bg-gradient-to-r from-pink-500 to-rose-500 hover:from-pink-600 hover:to-rose-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pink-500 disabled:opacity-50 min-h-[52px] transition-all duration-200"
        >
          {loading ? 'üí´ Saving...' : '‚ú® Add Pup'}
        </button>

        {message && (
          <p className={`text-sm text-center ${message.includes('Error') ? 'text-red-600' : 'text-green-600'}`}>
            {message}
          </p>
        )}
      </form>
    </div>
  )
}
</file>

<file path="package.json">
{
  "name": "groom-groove",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "eslint"
  },
  "dependencies": {
    "@supabase/ssr": "^0.5.2",
    "@supabase/supabase-js": "^2.90.1",
    "@vercel/analytics": "^1.6.1",
    "class-variance-authority": "^0.7.1",
    "clsx": "^2.1.1",
    "date-fns": "^4.1.0",
    "lucide-react": "^0.468.0",
    "next": "^16.1.3",
    "react": "19.0.0",
    "react-dom": "19.0.0",
    "stripe": "^17.7.0",
    "tailwind-merge": "^3.4.0",
    "zod": "^4.3.5"
  },
  "devDependencies": {
    "@tailwindcss/postcss": "^4",
    "@types/node": "^20",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "eslint": "^9",
    "eslint-config-next": "15.5.9",
    "tailwindcss": "^4",
    "typescript": "^5"
  }
}
</file>

<file path="app/(app)/dashboard/page.tsx">
import { createClient } from "@/utils/supabase/server";
import { redirect } from "next/navigation";
import TodayAppointments from "@/components/dashboard/TodayAppointments";
import { GroomersTodayCard } from "@/components/dashboard/GroomersTodayCard";
import Link from "next/link";
import { Plus, Calendar, Clock } from "lucide-react";
import { formatTime } from "@/lib/utils/date";
import { getGroomersOnDuty, getGroomersOffDuty } from "@/lib/actions/groomers";

export default async function DashboardPage() {
  const supabase = await createClient();
  const { data: { user } } = await supabase.auth.getUser();

  if (!user) redirect("/login");

  // 1. Subscription Check (Latest Active)
  const { data: subscription } = await supabase
    .from("subscriptions")
    .select("status, current_period_end")
    .eq("user_id", user.id)
    .order('current_period_end', { ascending: false })
    .limit(1)
    .maybeSingle();

  if (!subscription) redirect("/pricing");

  const expiry = new Date(subscription.current_period_end);
  if (expiry < new Date()) redirect("/pricing?expired=true");

  // 2. Onboarding Check
  const { data: settings } = await supabase
    .from("business_settings")
    .select("id")
    .eq("user_id", user.id)
    .maybeSingle();

  if (!settings) redirect("/onboarding");

  // 3. DATA FETCHING - LOCKED TO USER_ID
  const today = new Date().toISOString().split('T')[0];
  
  const [appointmentsResult, onDutyGroomers, offDutyGroomers] = await Promise.all([
    supabase
      .from("appointments")
      .select(`*, dog:dogs(id, name, grooming_preferences), customer:customers(id, name)`)
      .eq("user_id", user.id) // <--- CRITICAL SECURITY LOCK
      .gte('scheduled_at', `${today}T00:00:00`)
      .lt('scheduled_at', `${today}T23:59:59`)
      .in('status', ['pending', 'confirmed', 'in_progress'])
      .order('scheduled_at', { ascending: true }),
    getGroomersOnDuty(),
    getGroomersOffDuty(),
  ]);

  const appointments = appointmentsResult.data;
  const remainingJobs = appointments?.length || 0;
  const nextJob = appointments?.[0];

  return (
    <div className="p-6 max-w-7xl mx-auto">
      {/* Header */}
      <div className="flex items-center justify-between mb-8">
        <div>
          <h1 className="text-3xl font-bold text-gray-900">Salon Dashboard</h1>
          <p className="text-gray-500">{new Date().toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' })}</p>
        </div>
        <div className="bg-rose-100 text-rose-700 px-4 py-2 rounded-full font-bold">
           {remainingJobs} Dogs Remaining
        </div>
      </div>

      {/* Next Up */}
      {nextJob ? (
        <div className="mb-8 bg-gradient-to-r from-rose-500 to-pink-600 rounded-2xl p-6 text-white shadow-xl">
          <div className="flex items-center gap-3 mb-2 text-rose-100 uppercase text-xs font-bold tracking-wider">
            <Clock className="h-4 w-4" /> Next Up
          </div>
          <div className="flex justify-between items-end">
             <div>
                <h2 className="text-3xl font-bold">{nextJob.dog?.name}</h2>
                <p className="text-lg opacity-90">{nextJob.customer?.name} ‚Ä¢ {nextJob.service_type || "Full Groom"}</p>
             </div>
             <div className="text-right">
                <p className="text-3xl font-bold">{formatTime(nextJob.scheduled_at)}</p>
             </div>
          </div>
        </div>
      ) : null}

      {/* Quick Actions */}
      <div className="grid grid-cols-3 gap-4 mb-8">
        {/* CHANGED LINK TO /calendar/new (The Fixed Form) */}
        <Link href="/calendar/new" className="bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex flex-col items-center justify-center hover:border-rose-300 transition-colors group">
          <div className="bg-rose-50 p-3 rounded-full mb-2 group-hover:bg-rose-100"><Plus className="h-6 w-6 text-rose-600" /></div>
          <span className="font-semibold text-gray-700">Add Dog</span>
        </Link>
        <Link href="/calendar/new" className="bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex flex-col items-center justify-center hover:border-rose-300 transition-colors group">
          <div className="bg-rose-50 p-3 rounded-full mb-2 group-hover:bg-rose-100"><Calendar className="h-6 w-6 text-rose-600" /></div>
          <span className="font-semibold text-gray-700">Book Appt</span>
        </Link>
        <GroomersTodayCard
          onDutyGroomers={onDutyGroomers}
          offDutyGroomers={offDutyGroomers}
        />
      </div>

      {/* Schedule */}
      <div className="bg-white rounded-2xl shadow-sm border border-gray-100 p-6">
        <h2 className="text-xl font-bold text-gray-900 mb-4">Today&apos;s Schedule</h2>
        {remainingJobs > 0 ? (
          <TodayAppointments appointments={appointments || []} />
        ) : (
          <div className="text-center py-10 text-gray-400">
            <p>All clear! No pending jobs for today.</p>
          </div>
        )}
      </div>
    </div>
  );
}
</file>

<file path="app/api/stripe/checkout/route.ts">
import { createServerClient } from "@supabase/ssr";
import { cookies } from "next/headers";
import { NextResponse } from "next/server";
import Stripe from "stripe";

// 1. Force Stable API Version
const stripe = new Stripe(process.env.STRIPE_SECRET_KEY!, {
  apiVersion: "2023-10-16" as any, 
  typescript: true,
});

export async function POST(req: Request) {
  try {
    const cookieStore = await cookies();
    const supabase = createServerClient(
      process.env.NEXT_PUBLIC_SUPABASE_URL!,
      process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
      {
        cookies: {
          getAll() { return cookieStore.getAll() },
          setAll(cookiesToSet: any[]) {
             try {
               cookiesToSet.forEach(({ name, value, options }) =>
                 cookieStore.set(name, value, options)
               );
             } catch {}
          },
        },
      }
    );

    const { data: { user } } = await supabase.auth.getUser();

    if (!user) {
      console.error("User not found");
      return new NextResponse("Unauthorized", { status: 401 });
    }

    const body = await req.json();
    const { priceId, skipTrial } = body;

    // 2. HARDCODED URLS (To rule out Env Var issues)
    const success_url = "https://groom-groove.vercel.app/dashboard?payment=success";
    const cancel_url = "https://groom-groove.vercel.app/pricing?payment=cancelled";

    const sessionParams: Stripe.Checkout.SessionCreateParams = {
      mode: "subscription",
      payment_method_types: ["card"],
      line_items: [{ price: priceId, quantity: 1 }],
      customer_email: user.email,
      metadata: { userId: user.id },
      client_reference_id: user.id,
      success_url: success_url,
      cancel_url: cancel_url,
    };

    if (!skipTrial) {
      sessionParams.subscription_data = {
        trial_period_days: 14,
      };
    }

    console.log("Creating session...");
    const session = await stripe.checkout.sessions.create(sessionParams);

    return NextResponse.json({ sessionId: session.id, url: session.url });
  } catch (error: any) {
    console.error("Stripe Checkout Error:", error);
    return new NextResponse("Internal Error: " + error.message, { status: 500 });
  }
}
</file>

</files>
